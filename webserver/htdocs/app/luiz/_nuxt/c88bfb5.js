/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{508:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));n(11),n(10),n(18),n(19);var r=n(2),o=(n(27),n(14),n(4),n(327),n(12),n(52),n(117),n(507),n(522),n(510)),l=n(248),c=n(21),d=n(8),f=n(6);function h(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}var m=Object(d.a)(o.a,l.a,c.a).extend({name:"base-item-group",props:{activeClass:{type:String,default:"v-item--active"},mandatory:Boolean,max:{type:[Number,String],default:null},multiple:Boolean,tag:{type:String,default:"div"}},data:function(){return{internalLazyValue:void 0!==this.value?this.value:this.multiple?[]:void 0,items:[]}},computed:{classes:function(){return function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?h(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):h(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({"v-item-group":!0},this.themeClasses)},selectedIndex:function(){return this.selectedItem&&this.items.indexOf(this.selectedItem)||-1},selectedItem:function(){if(!this.multiple)return this.selectedItems[0]},selectedItems:function(){var e=this;return this.items.filter((function(t,n){return e.toggleMethod(e.getValue(t,n))}))},selectedValues:function(){return null==this.internalValue?[]:Array.isArray(this.internalValue)?this.internalValue:[this.internalValue]},toggleMethod:function(){var e=this;if(!this.multiple)return function(t){return e.valueComparator(e.internalValue,t)};var t=this.internalValue;return Array.isArray(t)?function(n){return t.some((function(t){return e.valueComparator(t,n)}))}:function(){return!1}}},watch:{internalValue:"updateItemsState",items:"updateItemsState"},created:function(){this.multiple&&!Array.isArray(this.internalValue)&&Object(f.c)("Model must be bound to an array if the multiple property is true.",this)},methods:{genData:function(){return{class:this.classes}},getValue:function(e,i){return void 0===e.value?i:e.value},onClick:function(e){this.updateInternalValue(this.getValue(e,this.items.indexOf(e)))},register:function(e){var t=this,n=this.items.push(e)-1;e.$on("change",(function(){return t.onClick(e)})),this.mandatory&&!this.selectedValues.length&&this.updateMandatory(),this.updateItem(e,n)},unregister:function(e){if(!this._isDestroyed){var t=this.items.indexOf(e),n=this.getValue(e,t);if(this.items.splice(t,1),!(this.selectedValues.indexOf(n)<0)){if(!this.mandatory)return this.updateInternalValue(n);this.multiple&&Array.isArray(this.internalValue)?this.internalValue=this.internalValue.filter((function(e){return e!==n})):this.internalValue=void 0,this.selectedItems.length||this.updateMandatory(!0)}}},updateItem:function(e,t){var n=this.getValue(e,t);e.isActive=this.toggleMethod(n)},updateItemsState:function(){var e=this;this.$nextTick((function(){if(e.mandatory&&!e.selectedItems.length)return e.updateMandatory();e.items.forEach(e.updateItem)}))},updateInternalValue:function(e){this.multiple?this.updateMultiple(e):this.updateSingle(e)},updateMandatory:function(e){if(this.items.length){var t=this.items.slice();e&&t.reverse();var n=t.find((function(e){return!e.disabled}));if(n){var r=this.items.indexOf(n);this.updateInternalValue(this.getValue(n,r))}}},updateMultiple:function(e){var t=this,n=(Array.isArray(this.internalValue)?this.internalValue:[]).slice(),r=n.findIndex((function(n){return t.valueComparator(n,e)}));this.mandatory&&r>-1&&n.length-1<1||null!=this.max&&r<0&&n.length+1>this.max||(r>-1?n.splice(r,1):n.push(e),this.internalValue=n)},updateSingle:function(e){var t=this.valueComparator(this.internalValue,e);this.mandatory&&t||(this.internalValue=t?void 0:e)}},render:function(e){return e(this.tag,this.genData(),this.$slots.default)}});m.extend({name:"v-item-group",provide:function(){return{itemGroup:this}}})},510:function(e,t,n){"use strict";var r=n(1),o=n(0);t.a=r.a.extend({name:"comparable",props:{valueComparator:{type:Function,default:o.j}}})},522:function(e,t,n){var content=n(523);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(23).default)("73707fd0",content,!0,{sourceMap:!1})},523:function(e,t,n){var r=n(22)(!1);r.push([e.i,".v-item-group{flex:0 1 auto;position:relative;max-width:100%;transition:.3s cubic-bezier(0.25, 0.8, 0.5, 1)}",""]),e.exports=r},563:function(e,t,n){var content=n(564);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(23).default)("01907af4",content,!0,{sourceMap:!1})},564:function(e,t,n){var r=n(22)(!1);r.push([e.i,".theme--light.v-btn-toggle:not(.v-btn-toggle--group){background:#fff;color:rgba(0,0,0,.87)}.theme--light.v-btn-toggle:not(.v-btn-toggle--group) .v-btn.v-btn{border-color:rgba(0,0,0,.12) !important}.theme--light.v-btn-toggle:not(.v-btn-toggle--group) .v-btn.v-btn:focus:not(:active){border-color:rgba(0,0,0,.26)}.theme--light.v-btn-toggle:not(.v-btn-toggle--group) .v-btn.v-btn .v-icon{color:#000}.theme--dark.v-btn-toggle:not(.v-btn-toggle--group){background:#1e1e1e;color:#fff}.theme--dark.v-btn-toggle:not(.v-btn-toggle--group) .v-btn.v-btn{border-color:rgba(255,255,255,.12) !important}.theme--dark.v-btn-toggle:not(.v-btn-toggle--group) .v-btn.v-btn:focus:not(:active){border-color:rgba(255,255,255,.3)}.theme--dark.v-btn-toggle:not(.v-btn-toggle--group) .v-btn.v-btn .v-icon{color:#fff}.v-btn-toggle{border-radius:4px;display:inline-flex;max-width:100%}.v-btn-toggle>.v-btn.v-btn{border-radius:0;border-style:solid;border-width:thin;box-shadow:none;box-shadow:none;opacity:.8;padding:0 12px}.v-application--is-ltr .v-btn-toggle>.v-btn.v-btn:first-child{border-top-left-radius:inherit;border-bottom-left-radius:inherit}.v-application--is-rtl .v-btn-toggle>.v-btn.v-btn:first-child{border-top-right-radius:inherit;border-bottom-right-radius:inherit}.v-application--is-ltr .v-btn-toggle>.v-btn.v-btn:last-child{border-top-right-radius:inherit;border-bottom-right-radius:inherit}.v-application--is-rtl .v-btn-toggle>.v-btn.v-btn:last-child{border-top-left-radius:inherit;border-bottom-left-radius:inherit}.v-btn-toggle>.v-btn.v-btn--active{color:inherit;opacity:1}.v-btn-toggle>.v-btn.v-btn:after{display:none}.v-application--is-ltr .v-btn-toggle>.v-btn.v-btn:not(:first-child){border-left-width:0}.v-application--is-rtl .v-btn-toggle>.v-btn.v-btn:not(:last-child){border-left-width:0}.v-btn-toggle .v-btn.v-btn.v-size--default{min-width:48px;min-height:0}.v-btn-toggle:not(.v-btn-toggle--dense) .v-btn.v-btn.v-size--default{height:48px}.v-btn-toggle--borderless>.v-btn.v-btn{border-width:0}.v-btn-toggle--dense>.v-btn.v-btn{padding:0 8px}.v-btn-toggle--group{border-radius:0}.v-btn-toggle--group>.v-btn.v-btn{background-color:transparent !important;border-color:transparent;margin:4px;min-width:auto}.v-btn-toggle--rounded{border-radius:24px}.v-btn-toggle--shaped{border-radius:24px 4px}.v-btn-toggle--tile{border-radius:0}",""]),e.exports=r},566:function(e,t,n){var content=n(567);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(23).default)("7f6d4ad6",content,!0,{sourceMap:!1})},567:function(e,t,n){var r=n(22)(!1);r.push([e.i,".theme--light.v-pagination .v-pagination__item{background:#fff;color:rgba(0,0,0,.87)}.theme--light.v-pagination .v-pagination__item--active{color:#fff}.theme--light.v-pagination .v-pagination__navigation{background:#fff}.theme--dark.v-pagination .v-pagination__item{background:#1e1e1e;color:#fff}.theme--dark.v-pagination .v-pagination__item--active{color:#fff}.theme--dark.v-pagination .v-pagination__navigation{background:#1e1e1e}.v-pagination{align-items:center;display:inline-flex;list-style-type:none;justify-content:center;margin:0;max-width:100%;width:100%}.v-pagination.v-pagination{padding-left:0}.v-pagination>li{align-items:center;display:flex}.v-pagination--circle .v-pagination__item,.v-pagination--circle .v-pagination__more,.v-pagination--circle .v-pagination__navigation{border-radius:50%}.v-pagination--disabled{pointer-events:none;opacity:.6}.v-pagination__item{background:transparent;border-radius:4px;font-size:1rem;height:34px;margin:.3rem;min-width:34px;padding:0 5px;text-decoration:none;transition:.3s cubic-bezier(0, 0, 0.2, 1);width:auto;box-shadow:0px 3px 1px -2px rgba(0,0,0,.2),0px 2px 2px 0px rgba(0,0,0,.14),0px 1px 5px 0px rgba(0,0,0,.12)}.v-pagination__item--active{box-shadow:0px 2px 4px -1px rgba(0,0,0,.2),0px 4px 5px 0px rgba(0,0,0,.14),0px 1px 10px 0px rgba(0,0,0,.12)}.v-pagination__navigation{box-shadow:0px 3px 1px -2px rgba(0,0,0,.2),0px 2px 2px 0px rgba(0,0,0,.14),0px 1px 5px 0px rgba(0,0,0,.12);border-radius:4px;display:inline-flex;justify-content:center;align-items:center;text-decoration:none;height:32px;width:32px;margin:.3rem 10px}.v-pagination__navigation .v-icon{transition:.2s cubic-bezier(0.4, 0, 0.6, 1);vertical-align:middle}.v-pagination__navigation--disabled{opacity:.6;pointer-events:none}.v-pagination__more{margin:.3rem;display:inline-flex;align-items:flex-end;justify-content:center;height:32px;width:32px}",""]),e.exports=r},571:function(e,t,n){var r;!function(o,l,c,d){"use strict";var f,h=["","webkit","Moz","MS","ms","o"],m=l.createElement("div"),v=Math.round,y=Math.abs,x=Date.now;function j(e,t,n){return setTimeout(I(e,n),t)}function w(e,t,n){return!!Array.isArray(e)&&(T(e,n[t],n),!0)}function T(e,t,n){var i;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==d)for(i=0;i<e.length;)t.call(n,e[i],i,e),i++;else for(i in e)e.hasOwnProperty(i)&&t.call(n,e[i],i,e)}function E(e,t,n){var r="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",l=o.console&&(o.console.warn||o.console.log);return l&&l.call(o.console,r,n),e.apply(this,arguments)}}f="function"!=typeof Object.assign?function(e){if(e===d||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var output=Object(e),t=1;t<arguments.length;t++){var source=arguments[t];if(source!==d&&null!==source)for(var n in source)source.hasOwnProperty(n)&&(output[n]=source[n])}return output}:Object.assign;var O=E((function(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;)(!n||n&&e[r[i]]===d)&&(e[r[i]]=t[r[i]]),i++;return e}),"extend","Use `assign`."),C=E((function(e,t){return O(e,t,!0)}),"merge","Use `assign`.");function S(e,base,t){var n,r=base.prototype;(n=e.prototype=Object.create(r)).constructor=e,n._super=r,t&&f(n,t)}function I(e,t){return function(){return e.apply(t,arguments)}}function M(e,t){return"function"==typeof e?e.apply(t&&t[0]||d,t):e}function P(e,t){return e===d?t:e}function _(e,t,n){T(A(t),(function(t){e.addEventListener(t,n,!1)}))}function D(e,t,n){T(A(t),(function(t){e.removeEventListener(t,n,!1)}))}function k(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function L(e,t){return e.indexOf(t)>-1}function A(e){return e.trim().split(/\s+/g)}function R(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var i=0;i<e.length;){if(n&&e[i][n]==t||!n&&e[i]===t)return i;i++}return-1}function B(e){return Array.prototype.slice.call(e,0)}function U(e,t,n){for(var r=[],o=[],i=0;i<e.length;){var l=t?e[i][t]:e[i];R(o,l)<0&&r.push(e[i]),o[i]=l,i++}return n&&(r=t?r.sort((function(a,b){return a[t]>b[t]})):r.sort()),r}function F(e,t){for(var n,r,o=t[0].toUpperCase()+t.slice(1),i=0;i<h.length;){if((r=(n=h[i])?n+o:t)in e)return r;i++}return d}var H=1;function N(element){var e=element.ownerDocument||element;return e.defaultView||e.parentWindow||o}var z="ontouchstart"in o,V=F(o,"PointerEvent")!==d,W=z&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),G="touch",Y="mouse",X=24,Z=["x","y"],K=["clientX","clientY"];function J(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){M(e.options.enable,[e])&&n.handler(t)},this.init()}function $(e,t,input){var n=input.pointers.length,r=input.changedPointers.length,o=1&t&&n-r==0,l=12&t&&n-r==0;input.isFirst=!!o,input.isFinal=!!l,o&&(e.session={}),input.eventType=t,function(e,input){var t=e.session,n=input.pointers,r=n.length;t.firstInput||(t.firstInput=Q(input));r>1&&!t.firstMultiple?t.firstMultiple=Q(input):1===r&&(t.firstMultiple=!1);var o=t.firstInput,l=t.firstMultiple,c=l?l.center:o.center,f=input.center=ee(n);input.timeStamp=x(),input.deltaTime=input.timeStamp-o.timeStamp,input.angle=re(c,f),input.distance=ae(c,f),function(e,input){var t=input.center,n=e.offsetDelta||{},r=e.prevDelta||{},o=e.prevInput||{};1!==input.eventType&&4!==o.eventType||(r=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},n=e.offsetDelta={x:t.x,y:t.y});input.deltaX=r.x+(t.x-n.x),input.deltaY=r.y+(t.y-n.y)}(t,input),input.offsetDirection=ne(input.deltaX,input.deltaY);var h=te(input.deltaTime,input.deltaX,input.deltaY);input.overallVelocityX=h.x,input.overallVelocityY=h.y,input.overallVelocity=y(h.x)>y(h.y)?h.x:h.y,input.scale=l?(m=l.pointers,v=n,ae(v[0],v[1],K)/ae(m[0],m[1],K)):1,input.rotation=l?function(e,t){return re(t[1],t[0],K)+re(e[1],e[0],K)}(l.pointers,n):0,input.maxPointers=t.prevInput?input.pointers.length>t.prevInput.maxPointers?input.pointers.length:t.prevInput.maxPointers:input.pointers.length,function(e,input){var t,n,r,o,l=e.lastInterval||input,c=input.timeStamp-l.timeStamp;if(8!=input.eventType&&(c>25||l.velocity===d)){var f=input.deltaX-l.deltaX,h=input.deltaY-l.deltaY,m=te(c,f,h);n=m.x,r=m.y,t=y(m.x)>y(m.y)?m.x:m.y,o=ne(f,h),e.lastInterval=input}else t=l.velocity,n=l.velocityX,r=l.velocityY,o=l.direction;input.velocity=t,input.velocityX=n,input.velocityY=r,input.direction=o}(t,input);var m,v;var j=e.element;k(input.srcEvent.target,j)&&(j=input.srcEvent.target);input.target=j}(e,input),e.emit("hammer.input",input),e.recognize(input),e.session.prevInput=input}function Q(input){for(var e=[],i=0;i<input.pointers.length;)e[i]={clientX:v(input.pointers[i].clientX),clientY:v(input.pointers[i].clientY)},i++;return{timeStamp:x(),pointers:e,center:ee(e),deltaX:input.deltaX,deltaY:input.deltaY}}function ee(e){var t=e.length;if(1===t)return{x:v(e[0].clientX),y:v(e[0].clientY)};for(var n=0,r=0,i=0;i<t;)n+=e[i].clientX,r+=e[i].clientY,i++;return{x:v(n/t),y:v(r/t)}}function te(e,t,n){return{x:t/e||0,y:n/e||0}}function ne(e,t){return e===t?1:y(e)>=y(t)?e<0?2:4:t<0?8:16}function ae(e,t,n){n||(n=Z);var r=t[n[0]]-e[n[0]],o=t[n[1]]-e[n[1]];return Math.sqrt(r*r+o*o)}function re(e,t,n){n||(n=Z);var r=t[n[0]]-e[n[0]],o=t[n[1]]-e[n[1]];return 180*Math.atan2(o,r)/Math.PI}J.prototype={handler:function(){},init:function(){this.evEl&&_(this.element,this.evEl,this.domHandler),this.evTarget&&_(this.target,this.evTarget,this.domHandler),this.evWin&&_(N(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&D(this.element,this.evEl,this.domHandler),this.evTarget&&D(this.target,this.evTarget,this.domHandler),this.evWin&&D(N(this.element),this.evWin,this.domHandler)}};var oe={mousedown:1,mousemove:2,mouseup:4},ie="mousedown",se="mousemove mouseup";function le(){this.evEl=ie,this.evWin=se,this.pressed=!1,J.apply(this,arguments)}S(le,J,{handler:function(e){var t=oe[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:Y,srcEvent:e}))}});var ue={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},ce={2:G,3:"pen",4:Y,5:"kinect"},de="pointerdown",fe="pointermove pointerup pointercancel";function he(){this.evEl=de,this.evWin=fe,J.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}o.MSPointerEvent&&!o.PointerEvent&&(de="MSPointerDown",fe="MSPointerMove MSPointerUp MSPointerCancel"),S(he,J,{handler:function(e){var t=this.store,n=!1,r=e.type.toLowerCase().replace("ms",""),o=ue[r],l=ce[e.pointerType]||e.pointerType,c=l==G,d=R(t,e.pointerId,"pointerId");1&o&&(0===e.button||c)?d<0&&(t.push(e),d=t.length-1):12&o&&(n=!0),d<0||(t[d]=e,this.callback(this.manager,o,{pointers:t,changedPointers:[e],pointerType:l,srcEvent:e}),n&&t.splice(d,1))}});var ge={touchstart:1,touchmove:2,touchend:4,touchcancel:8},me="touchstart",ve="touchstart touchmove touchend touchcancel";function pe(){this.evTarget=me,this.evWin=ve,this.started=!1,J.apply(this,arguments)}function be(e,t){var n=B(e.touches),r=B(e.changedTouches);return 12&t&&(n=U(n.concat(r),"identifier",!0)),[n,r]}S(pe,J,{handler:function(e){var t=ge[e.type];if(1===t&&(this.started=!0),this.started){var n=be.call(this,e,t);12&t&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:G,srcEvent:e})}}});var ye={touchstart:1,touchmove:2,touchend:4,touchcancel:8},xe="touchstart touchmove touchend touchcancel";function je(){this.evTarget=xe,this.targetIds={},J.apply(this,arguments)}function we(e,t){var n=B(e.touches),r=this.targetIds;if(3&t&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,l=B(e.changedTouches),c=[],d=this.target;if(o=n.filter((function(e){return k(e.target,d)})),1===t)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<l.length;)r[l[i].identifier]&&c.push(l[i]),12&t&&delete r[l[i].identifier],i++;return c.length?[U(o.concat(c),"identifier",!0),c]:void 0}S(je,J,{handler:function(e){var t=ye[e.type],n=we.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:G,srcEvent:e})}});function Te(){J.apply(this,arguments);var e=I(this.handler,this);this.touch=new je(this.manager,e),this.mouse=new le(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function Ee(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,Oe.call(this,t)):12&e&&Oe.call(this,t)}function Oe(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var i=r.indexOf(n);i>-1&&r.splice(i,1)}),2500)}}function Ce(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var r=this.lastTouches[i],o=Math.abs(t-r.x),l=Math.abs(n-r.y);if(o<=25&&l<=25)return!0}return!1}S(Te,J,{handler:function(e,t,n){var r=n.pointerType==G,o=n.pointerType==Y;if(!(o&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)Ee.call(this,t,n);else if(o&&Ce.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Se=F(m.style,"touchAction"),Ie=Se!==d,Me="compute",Pe="auto",_e="manipulation",De="none",ke="pan-x",Le="pan-y",Ae=function(){if(!Ie)return!1;var e={},t=o.CSS&&o.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){e[n]=!t||o.CSS.supports("touch-action",n)})),e}();function Re(e,t){this.manager=e,this.set(t)}Re.prototype={set:function(e){e==Me&&(e=this.compute()),Ie&&this.manager.element.style&&Ae[e]&&(this.manager.element.style[Se]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return T(this.manager.recognizers,(function(t){M(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),function(e){if(L(e,De))return De;var t=L(e,ke),n=L(e,Le);if(t&&n)return De;if(t||n)return t?ke:Le;if(L(e,_e))return _e;return Pe}(e.join(" "))},preventDefaults:function(input){var e=input.srcEvent,t=input.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var n=this.actions,r=L(n,De)&&!Ae.none,o=L(n,Le)&&!Ae["pan-y"],l=L(n,ke)&&!Ae["pan-x"];if(r){var c=1===input.pointers.length,d=input.distance<2,f=input.deltaTime<250;if(c&&d&&f)return}if(!l||!o)return r||o&&6&t||l&&t&X?this.preventSrc(e):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Be=32;function Ue(e){this.options=f({},this.defaults,e||{}),this.id=H++,this.manager=null,this.options.enable=P(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Fe(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function He(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function Ne(e,t){var n=t.manager;return n?n.get(e):e}function ze(){Ue.apply(this,arguments)}function Ve(){ze.apply(this,arguments),this.pX=null,this.pY=null}function qe(){ze.apply(this,arguments)}function We(){Ue.apply(this,arguments),this._timer=null,this._input=null}function Ge(){ze.apply(this,arguments)}function Ye(){ze.apply(this,arguments)}function Xe(){Ue.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ze(element,e){return(e=e||{}).recognizers=P(e.recognizers,Ze.defaults.preset),new Ke(element,e)}Ue.prototype={defaults:{},set:function(e){return f(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(w(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Ne(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return w(e,"dropRecognizeWith",this)||(e=Ne(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(w(e,"requireFailure",this))return this;var t=this.requireFail;return-1===R(t,e=Ne(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(w(e,"dropRequireFailure",this))return this;e=Ne(e,this);var t=R(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(input){var e=this,t=this.state;function n(t){e.manager.emit(t,input)}t<8&&n(e.options.event+Fe(t)),n(e.options.event),input.additionalEvent&&n(input.additionalEvent),t>=8&&n(e.options.event+Fe(t))},tryEmit:function(input){if(this.canEmit())return this.emit(input);this.state=Be},canEmit:function(){for(var i=0;i<this.requireFail.length;){if(!(33&this.requireFail[i].state))return!1;i++}return!0},recognize:function(e){var t=f({},e);if(!M(this.options.enable,[this,t]))return this.reset(),void(this.state=Be);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},S(ze,Ue,{defaults:{pointers:1},attrTest:function(input){var e=this.options.pointers;return 0===e||input.pointers.length===e},process:function(input){var e=this.state,t=input.eventType,n=6&e,r=this.attrTest(input);return n&&(8&t||!r)?16|e:n||r?4&t?8|e:2&e?4|e:2:Be}}),S(Ve,ze,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(Le),e&X&&t.push(ke),t},directionTest:function(input){var e=this.options,t=!0,n=input.distance,r=input.direction,o=input.deltaX,l=input.deltaY;return r&e.direction||(6&e.direction?(r=0===o?1:o<0?2:4,t=o!=this.pX,n=Math.abs(input.deltaX)):(r=0===l?1:l<0?8:16,t=l!=this.pY,n=Math.abs(input.deltaY))),input.direction=r,t&&n>e.threshold&&r&e.direction},attrTest:function(input){return ze.prototype.attrTest.call(this,input)&&(2&this.state||!(2&this.state)&&this.directionTest(input))},emit:function(input){this.pX=input.deltaX,this.pY=input.deltaY;var e=He(input.direction);e&&(input.additionalEvent=this.options.event+e),this._super.emit.call(this,input)}}),S(qe,ze,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[De]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.scale-1)>this.options.threshold||2&this.state)},emit:function(input){if(1!==input.scale){var e=input.scale<1?"in":"out";input.additionalEvent=this.options.event+e}this._super.emit.call(this,input)}}),S(We,Ue,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Pe]},process:function(input){var e=this.options,t=input.pointers.length===e.pointers,n=input.distance<e.threshold,r=input.deltaTime>e.time;if(this._input=input,!n||!t||12&input.eventType&&!r)this.reset();else if(1&input.eventType)this.reset(),this._timer=j((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&input.eventType)return 8;return Be},reset:function(){clearTimeout(this._timer)},emit:function(input){8===this.state&&(input&&4&input.eventType?this.manager.emit(this.options.event+"up",input):(this._input.timeStamp=x(),this.manager.emit(this.options.event,this._input)))}}),S(Ge,ze,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[De]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.rotation)>this.options.threshold||2&this.state)}}),S(Ye,ze,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Ve.prototype.getTouchAction.call(this)},attrTest:function(input){var e,t=this.options.direction;return 30&t?e=input.overallVelocity:6&t?e=input.overallVelocityX:t&X&&(e=input.overallVelocityY),this._super.attrTest.call(this,input)&&t&input.offsetDirection&&input.distance>this.options.threshold&&input.maxPointers==this.options.pointers&&y(e)>this.options.velocity&&4&input.eventType},emit:function(input){var e=He(input.offsetDirection);e&&this.manager.emit(this.options.event+e,input),this.manager.emit(this.options.event,input)}}),S(Xe,Ue,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[_e]},process:function(input){var e=this.options,t=input.pointers.length===e.pointers,n=input.distance<e.threshold,r=input.deltaTime<e.time;if(this.reset(),1&input.eventType&&0===this.count)return this.failTimeout();if(n&&r&&t){if(4!=input.eventType)return this.failTimeout();var o=!this.pTime||input.timeStamp-this.pTime<e.interval,l=!this.pCenter||ae(this.pCenter,input.center)<e.posThreshold;if(this.pTime=input.timeStamp,this.pCenter=input.center,l&&o?this.count+=1:this.count=1,this._input=input,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=j((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return Be},failTimeout:function(){return this._timer=j((function(){this.state=Be}),this.options.interval,this),Be},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ze.VERSION="2.0.7",Ze.defaults={domEvents:!1,touchAction:Me,enable:!0,inputTarget:null,inputClass:null,preset:[[Ge,{enable:!1}],[qe,{enable:!1},["rotate"]],[Ye,{direction:6}],[Ve,{direction:6},["swipe"]],[Xe],[Xe,{event:"doubletap",taps:2},["tap"]],[We]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Ke(element,e){var t;this.options=f({},Ze.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||element,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=element,this.input=new((t=this).options.inputClass||(V?he:W?je:z?Te:le))(t,$),this.touchAction=new Re(this,this.options.touchAction),Je(this,!0),T(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function Je(e,t){var n,element=e.element;element.style&&(T(e.options.cssProps,(function(r,o){n=F(element.style,o),t?(e.oldCssProps[n]=element.style[n],element.style[n]=r):element.style[n]=e.oldCssProps[n]||""})),t||(e.oldCssProps={}))}Ke.prototype={set:function(e){return f(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var r=this.recognizers,o=t.curRecognizer;(!o||o&&8&o.state)&&(o=t.curRecognizer=null);for(var i=0;i<r.length;)n=r[i],2===t.stopped||o&&n!=o&&!n.canRecognizeWith(o)?n.reset():n.recognize(e),!o&&14&n.state&&(o=t.curRecognizer=n),i++}},get:function(e){if(e instanceof Ue)return e;for(var t=this.recognizers,i=0;i<t.length;i++)if(t[i].options.event==e)return t[i];return null},add:function(e){if(w(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(w(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=R(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==d&&t!==d){var n=this.handlers;return T(A(e),(function(e){n[e]=n[e]||[],n[e].push(t)})),this}},off:function(e,t){if(e!==d){var n=this.handlers;return T(A(e),(function(e){t?n[e]&&n[e].splice(R(n[e],t),1):delete n[e]})),this}},emit:function(e,data){this.options.domEvents&&function(e,data){var t=l.createEvent("Event");t.initEvent(e,!0,!0),t.gesture=data,data.target.dispatchEvent(t)}(e,data);var t=this.handlers[e]&&this.handlers[e].slice();if(t&&t.length){data.type=e,data.preventDefault=function(){data.srcEvent.preventDefault()};for(var i=0;i<t.length;)t[i](data),i++}},destroy:function(){this.element&&Je(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},f(Ze,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Be,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:X,DIRECTION_ALL:30,Manager:Ke,Input:J,TouchAction:Re,TouchInput:je,MouseInput:le,PointerEventInput:he,TouchMouseInput:Te,SingleTouchInput:pe,Recognizer:Ue,AttrRecognizer:ze,Tap:Xe,Pan:Ve,Swipe:Ye,Pinch:qe,Rotate:Ge,Press:We,on:_,off:D,each:T,merge:C,extend:O,assign:f,inherit:S,bindFn:I,prefixed:F}),(void 0!==o?o:"undefined"!=typeof self?self:{}).Hammer=Ze,(r=function(){return Ze}.call(t,n,t,e))===d||(e.exports=r)}(window,document)},572:function(e,t,n){(function(t,r){e.exports=function(e){return a=[function(t,n){t.exports=e},function(e,n,s){"use strict";s.r(n),s.d(n,"isStringVr",(function(){return l})),s.d(n,"isPrivateTag",(function(){return c})),s.d(n,"parsePN",(function(){return a})),s.d(n,"parseTM",(function(){return d})),s.d(n,"parseDA",(function(){return f})),s.d(n,"explicitElementToString",(function(){return h})),s.d(n,"explicitDataSetToJS",(function(){return u})),s.d(n,"createJPEGBasicOffsetTable",(function(){return p})),s.d(n,"parseDicomDataSetExplicit",(function(){return q})),s.d(n,"parseDicomDataSetImplicit",(function(){return L})),s.d(n,"readFixedString",(function(){return b})),s.d(n,"alloc",(function(){return A})),s.d(n,"version",(function(){return R})),s.d(n,"bigEndianByteArrayParser",(function(){return B})),s.d(n,"ByteStream",(function(){return H})),s.d(n,"sharedCopy",(function(){return U})),s.d(n,"DataSet",(function(){return T})),s.d(n,"findAndSetUNElementLength",(function(){return x})),s.d(n,"findEndOfEncapsulatedElement",(function(){return g})),s.d(n,"findItemDelimitationItemAndSetElementLength",(function(){return E})),s.d(n,"littleEndianByteArrayParser",(function(){return N})),s.d(n,"parseDicom",(function(){return W})),s.d(n,"readDicomElementExplicit",(function(){return k})),s.d(n,"readDicomElementImplicit",(function(){return C})),s.d(n,"readEncapsulatedImageFrame",(function(){return K})),s.d(n,"readEncapsulatedPixelData",(function(){return $})),s.d(n,"readEncapsulatedPixelDataFromFragments",(function(){return Y})),s.d(n,"readPart10Header",(function(){return z})),s.d(n,"readSequenceItemsExplicit",(function(){return _})),s.d(n,"readSequenceItemsImplicit",(function(){return M})),s.d(n,"readSequenceItem",(function(){return S})),s.d(n,"readTag",(function(){return y}));var o={AE:!0,AS:!0,AT:!1,CS:!0,DA:!0,DS:!0,DT:!0,FL:!1,FD:!1,IS:!0,LO:!0,LT:!0,OB:!1,OD:!1,OF:!1,OW:!1,PN:!0,SH:!0,SL:!1,SQ:!1,SS:!1,ST:!0,TM:!0,UI:!0,UL:!1,UN:void 0,UR:!0,US:!1,UT:!0},l=function(e){return o[e]},c=function(e){return parseInt(e[4],10)%2==1},a=function(e){if(void 0!==e)return{familyName:(e=e.split("^"))[0],givenName:e[1],middleName:e[2],prefix:e[3],suffix:e[4]}};function d(e,t){if(2<=e.length){var n=parseInt(e.substring(0,2),10),a=4<=e.length?parseInt(e.substring(2,4),10):void 0,r=6<=e.length?parseInt(e.substring(4,6),10):void 0,i=(i=8<=e.length?e.substring(7,13):void 0)?parseInt(i,10)*Math.pow(10,6-i.length):void 0;if(t&&(isNaN(n)||void 0!==a&&isNaN(a)||void 0!==r&&isNaN(r)||void 0!==i&&isNaN(i)||n<0||23<n||a&&(a<0||59<a)||r&&(r<0||59<r)||i&&(i<0||999999<i)))throw"invalid TM '".concat(e,"'");return{hours:n,minutes:a,seconds:r,fractionalSeconds:i}}if(t)throw"invalid TM '".concat(e,"'")}function i(e,t,n){return!isNaN(n)&&0<t&&t<=12&&0<e&&e<=function(e,t){switch(e){case 2:return t%4==0&&t%100||t%400==0?29:28;case 9:case 4:case 6:case 11:return 30;default:return 31}}(t,n)}function f(e,t){if(e&&8===e.length){var n=parseInt(e.substring(0,4),10),a=parseInt(e.substring(4,6),10),r=parseInt(e.substring(6,8),10);if(t&&!0!==i(r,a,n))throw"invalid DA '".concat(e,"'");return{year:n,month:a,day:r}}if(t)throw"invalid DA '".concat(e,"'")}function h(e,t){if(void 0===e||void 0===t)throw"dicomParser.explicitElementToString: missing required parameters";if(void 0===t.vr)throw"dicomParser.explicitElementToString: cannot convert implicit element to string";var n,r=t.vr,i=t.tag;function a(t,n){for(var r="",a=0;a<t;a++)0!==a&&(r+="/"),r+=n.call(e,i,a).toString();return r}if(!0===l(r))n=e.string(i);else{if("AT"===r){var o=e.uint32(i);return void 0===o?void 0:"x".concat((o=o<0?4294967295+o+1:o).toString(16).toUpperCase())}"US"===r?n=a(t.length/2,e.uint16):"SS"===r?n=a(t.length/2,e.int16):"UL"===r?n=a(t.length/4,e.uint32):"SL"===r?n=a(t.length/4,e.int32):"FD"===r?n=a(t.length/8,e.double):"FL"===r&&(n=a(t.length/4,e.float))}return n}function u(e,t){if(void 0===e)throw"dicomParser.explicitDataSetToJS: missing required parameter dataSet";t=t||{omitPrivateAttibutes:!0,maxElementLength:128};var n,a={};for(n in e.elements){var r=e.elements[n];if(!0!==t.omitPrivateAttibutes||!c(n))if(r.items){for(var i=[],o=0;o<r.items.length;o++)i.push(u(r.items[o].dataSet,t));a[n]=i}else{var s=void 0;r.length<t.maxElementLength&&(s=h(e,r)),a[n]=void 0!==s?s:{dataOffset:r.dataOffset,length:r.length}}}return a}function m(e,t){return 255===e.byteArray[t]&&217===e.byteArray[t+1]}function v(e,t,n){for(var a,r,i=n;i<t.fragments.length;i++)if(r=i,m(a=e,(r=t.fragments[r]).position+r.length-2)||m(a,r.position+r.length-3))return i}function p(e,t,n){if(void 0===e)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter dataSet";if(void 0===t)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter pixelDataElement";if("x7fe00010"!==t.tag)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010'";if(!0!==t.encapsulatedPixelData)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==t.hadUndefinedLength)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.basicOffsetTable)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.fragments)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(t.fragments.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(n&&n.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'fragments' must not be zero length";n=n||t.fragments;for(var a=[],r=0;;){a.push(t.fragments[r].offset);var i=v(e,t,r);if(void 0===i||i===t.fragments.length-1)return a;r=i+1}}function y(e){if(void 0===e)throw"dicomParser.readTag: missing required parameter 'byteStream'";var t=256*e.readUint16()*256;return e=e.readUint16(),"x".concat("00000000".concat((t+e).toString(16)).substr(-8))}function g(e,t,n){if(void 0===e)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'byteStream'";if(void 0===t)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'element'";if(t.encapsulatedPixelData=!0,t.basicOffsetTable=[],t.fragments=[],"xfffee000"!==y(e))throw"dicomParser.findEndOfEncapsulatedElement: basic offset table not found";for(var a=e.readUint32()/4,r=0;r<a;r++){var i=e.readUint32();t.basicOffsetTable.push(i)}for(var o=e.position;e.position<e.byteArray.length;){var s=y(e),l=e.readUint32();if("xfffee0dd"===s)return e.seek(l),void(t.length=e.position-t.dataOffset);if("xfffee000"!==s)return n&&n.push("unexpected tag ".concat(s," while searching for end of pixel data element with undefined length")),l>e.byteArray.length-e.position&&(l=e.byteArray.length-e.position),t.fragments.push({offset:e.position-o-8,position:e.position,length:l}),e.seek(l),void(t.length=e.position-t.dataOffset);t.fragments.push({offset:e.position-o-8,position:e.position,length:l}),e.seek(l)}n&&n.push("pixel data element ".concat(t.tag," missing sequence delimiter tag xfffee0dd"))}function x(e,t){if(void 0===e)throw"dicomParser.findAndSetUNElementLength: missing required parameter 'byteStream'";for(var n=e.byteArray.length-8;e.position<=n;)if(65534===e.readUint16()&&57565===e.readUint16())return 0!==e.readUint32()&&e.warnings("encountered non zero length following item delimiter at position ".concat(e.position-4," while reading element of undefined length with tag ").concat(t.tag)),void(t.length=e.position-t.dataOffset);t.length=e.byteArray.length-t.dataOffset,e.seek(e.byteArray.length-e.position)}function b(e,t,n){if(n<0)throw"dicomParser.readFixedString - length cannot be less than 0";if(t+n>e.length)throw"dicomParser.readFixedString: attempt to read past end of buffer";for(var a,r="",i=0;i<n;i++){if(0===(a=e[t+i]))return t+=n,r;r+=String.fromCharCode(a)}return r}function j(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function w(e,t){return void 0!==e.parser?e.parser:t}var T=function(){function a(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this.byteArrayParser=e,this.byteArray=t,this.elements=n}var e,t,n;return e=a,(t=[{key:"uint16",value:function(e,t){if(t=void 0!==t?t:0,(e=this.elements[e])&&0!==e.length)return w(e,this.byteArrayParser).readUint16(this.byteArray,e.dataOffset+2*t)}},{key:"int16",value:function(e,t){if(t=void 0!==t?t:0,(e=this.elements[e])&&0!==e.length)return w(e,this.byteArrayParser).readInt16(this.byteArray,e.dataOffset+2*t)}},{key:"uint32",value:function(e,t){if(t=void 0!==t?t:0,(e=this.elements[e])&&0!==e.length)return w(e,this.byteArrayParser).readUint32(this.byteArray,e.dataOffset+4*t)}},{key:"int32",value:function(e,t){if(t=void 0!==t?t:0,(e=this.elements[e])&&0!==e.length)return w(e,this.byteArrayParser).readInt32(this.byteArray,e.dataOffset+4*t)}},{key:"float",value:function(e,t){if(t=void 0!==t?t:0,(e=this.elements[e])&&0!==e.length)return w(e,this.byteArrayParser).readFloat(this.byteArray,e.dataOffset+4*t)}},{key:"double",value:function(e,t){if(t=void 0!==t?t:0,(e=this.elements[e])&&0!==e.length)return w(e,this.byteArrayParser).readDouble(this.byteArray,e.dataOffset+8*t)}},{key:"numStringValues",value:function(e){if((e=this.elements[e])&&0<e.length)return null===(e=b(this.byteArray,e.dataOffset,e.length).match(/\\/g))?1:e.length+1}},{key:"string",value:function(e,t){return(e=this.elements[e])&&e.Value?e.Value:e&&0<e.length?(e=b(this.byteArray,e.dataOffset,e.length),0<=t?e.split("\\")[t].trim():e.trim()):void 0}},{key:"text",value:function(e,t){if((e=this.elements[e])&&0<e.length)return e=b(this.byteArray,e.dataOffset,e.length),0<=t?e.split("\\")[t].replace(/ +$/,""):e.replace(/ +$/,"")}},{key:"floatString",value:function(e,t){var n=this.elements[e];if(n&&0<n.length&&void 0!==(t=this.string(e,t=void 0!==t?t:0)))return parseFloat(t)}},{key:"intString",value:function(e,t){var n=this.elements[e];if(n&&0<n.length&&void 0!==(t=this.string(e,t=void 0!==t?t:0)))return parseInt(t)}},{key:"attributeTag",value:function(e){if((n=this.elements[e])&&4===n.length){var t=w(n,this.byteArrayParser).readUint16,n=(e=this.byteArray,n.dataOffset);return"x".concat("00000000".concat((256*t(e,n)*256+t(e,n+2)).toString(16)).substr(-8))}}}])&&j(e.prototype,t),n&&j(e,n),Object.defineProperty(e,"prototype",{writable:!1}),a}();function E(e,t){if(void 0===e)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";for(var n=e.byteArray.length-8;e.position<=n;)if(65534===e.readUint16()&&57357===e.readUint16())return 0!==e.readUint32()&&e.warnings("encountered non zero length following item delimiter at position ".concat(e.position-4," while reading element of undefined length with tag ").concat(t.tag)),void(t.length=e.position-t.dataOffset);t.length=e.byteArray.length-t.dataOffset,e.seek(e.byteArray.length-e.position)}var O=function(e,t,n){return void 0!==n?"SQ"===n(e.tag):t.position+4<=t.byteArray.length?(e=y(t),t.seek(-4),"xfffee000"===e||"xfffee0dd"===e):(t.warnings.push("eof encountered before finding sequence item tag or sequence delimiter tag in peeking to determine VR"),!1)};function C(e,t,n){if(void 0===e)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";var a={tag:y(e),length:e.readUint32(),dataOffset:e.position};return 4294967295===a.length&&(a.hadUndefinedLength=!0),a.tag===t||(O(a,e,n)&&!c(a.tag)?M(e,a):a.hadUndefinedLength?E(e,a):e.seek(a.length)),a}function S(e){if(void 0===e)throw"dicomParser.readSequenceItem: missing required parameter 'byteStream'";var t={tag:y(e),length:e.readUint32(),dataOffset:e.position};if("xfffee000"!==t.tag)throw"dicomParser.readSequenceItem: item tag (FFFE,E000) not found at offset ".concat(e.position);return t}function I(e,t){var n=S(e);return 4294967295===n.length?(n.hadUndefinedLength=!0,n.dataSet=function(e,t){for(var n={};e.position<e.byteArray.length;){var a=C(e,void 0,t);if("xfffee00d"===(n[a.tag]=a).tag)return new T(e.byteArrayParser,e.byteArray,n)}return e.warnings.push("eof encountered before finding sequence item delimiter in sequence item of undefined length"),new T(e.byteArrayParser,e.byteArray,n)}(e,t),n.length=e.position-n.dataOffset):(n.dataSet=new T(e.byteArrayParser,e.byteArray,{}),L(n.dataSet,e,e.position+n.length,{vrCallback:t})),n}function M(e,t,n){if(void 0===e)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'byteStream'";if(void 0===t)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'element'";t.items=[],(4294967295===t.length?function(e,t,n){for(;e.position+4<=e.byteArray.length;){var a=y(e);if(e.seek(-4),"xfffee0dd"===a)return t.length=e.position-t.dataOffset,e.seek(8);a=I(e,n),t.items.push(a)}e.warnings.push("eof encountered before finding sequence delimiter in sequence of undefined length"),t.length=e.byteArray.length-t.dataOffset}:function(e,t,n){for(var a=t.dataOffset+t.length;e.position<a;){var r=I(e,n);t.items.push(r)}})(e,t,n)}function P(e,t){var n=S(e);return 4294967295===n.length?(n.hadUndefinedLength=!0,n.dataSet=function(e,t){for(var n={};e.position<e.byteArray.length;){var a=k(e,t);if("xfffee00d"===(n[a.tag]=a).tag)return new T(e.byteArrayParser,e.byteArray,n)}return t.push("eof encountered before finding item delimiter tag while reading sequence item of undefined length"),new T(e.byteArrayParser,e.byteArray,n)}(e,t),n.length=e.position-n.dataOffset):(n.dataSet=new T(e.byteArrayParser,e.byteArray,{}),q(n.dataSet,e,e.position+n.length)),n}function _(e,t,n){if(void 0===e)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'byteStream'";if(void 0===t)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'element'";t.items=[],(4294967295===t.length?function(e,t,n){for(;e.position+4<=e.byteArray.length;){var a=y(e);if(e.seek(-4),"xfffee0dd"===a)return t.length=e.position-t.dataOffset,e.seek(8);a=P(e,n),t.items.push(a)}n.push("eof encountered before finding sequence delimitation tag while reading sequence of undefined length"),t.length=e.position-t.dataOffset}:function(e,t,n){for(var a=t.dataOffset+t.length;e.position<a;){var r=P(e,n);t.items.push(r)}})(e,t,n)}var D=function(e){return"OB"===e||"OD"===e||"OL"===e||"OW"===e||"SQ"===e||"OF"===e||"UC"===e||"UR"===e||"UT"===e||"UN"===e?4:2};function k(e,t,n){if(void 0===e)throw"dicomParser.readDicomElementExplicit: missing required parameter 'byteStream'";var a={tag:y(e),vr:e.readFixedString(2)};return 2===D(a.vr)?a.length=e.readUint16():(e.seek(2),a.length=e.readUint32()),a.dataOffset=e.position,4294967295===a.length&&(a.hadUndefinedLength=!0),a.tag===n||("SQ"===a.vr?_(e,a,t):4294967295===a.length?"x7fe00010"===a.tag?g(e,a,t):("UN"===a.vr?M:E)(e,a):e.seek(a.length)),a}function q(e,t,n){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};if(n=void 0===n?t.byteArray.length:n,void 0===t)throw"dicomParser.parseDicomDataSetExplicit: missing required parameter 'byteStream'";if(n<t.position||n>t.byteArray.length)throw"dicomParser.parseDicomDataSetExplicit: invalid value for parameter 'maxP osition'";for(var r=e.elements;t.position<n;){var i=k(t,e.warnings,a.untilTag);if((r[i.tag]=i).tag===a.untilTag)return}if(t.position>n)throw"dicomParser:parseDicomDataSetExplicit: buffer overrun"}function L(e,t,n){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};if(n=void 0===n?e.byteArray.length:n,void 0===t)throw"dicomParser.parseDicomDataSetImplicit: missing required parameter 'byteStream'";if(n<t.position||n>t.byteArray.length)throw"dicomParser.parseDicomDataSetImplicit: invalid value for parameter 'maxPosition'";for(var r=e.elements;t.position<n;){var i=C(t,a.untilTag,a.vrCallback);if((r[i.tag]=i).tag===a.untilTag)return}}function A(e,n){if(void 0!==t&&e instanceof t)return t.alloc(n);if(e instanceof Uint8Array)return new Uint8Array(n);throw"dicomParser.alloc: unknown type for byteArray"}var R="1.8.12",B={readUint16:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readUint16: position cannot be less than 0";if(t+2>e.length)throw"bigEndianByteArrayParser.readUint16: attempt to read past end of buffer";return(e[t]<<8)+e[t+1]},readInt16:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readInt16: position cannot be less than 0";if(t+2>e.length)throw"bigEndianByteArrayParser.readInt16: attempt to read past end of buffer";return 32768&(t=(e[t]<<8)+e[t+1])?t-65535-1:t},readUint32:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readUint32: position cannot be less than 0";if(t+4>e.length)throw"bigEndianByteArrayParser.readUint32: attempt to read past end of buffer";return 256*(256*(256*e[t]+e[t+1])+e[t+2])+e[t+3]},readInt32:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readInt32: position cannot be less than 0";if(t+4>e.length)throw"bigEndianByteArrayParser.readInt32: attempt to read past end of buffer";return(e[t]<<24)+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3]},readFloat:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readFloat: position cannot be less than 0";if(t+4>e.length)throw"bigEndianByteArrayParser.readFloat: attempt to read past end of buffer";var n=new Uint8Array(4);return n[3]=e[t],n[2]=e[t+1],n[1]=e[t+2],n[0]=e[t+3],new Float32Array(n.buffer)[0]},readDouble:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readDouble: position cannot be less than 0";if(t+8>e.length)throw"bigEndianByteArrayParser.readDouble: attempt to read past end of buffer";var n=new Uint8Array(8);return n[7]=e[t],n[6]=e[t+1],n[5]=e[t+2],n[4]=e[t+3],n[3]=e[t+4],n[2]=e[t+5],n[1]=e[t+6],n[0]=e[t+7],new Float64Array(n.buffer)[0]}};function U(e,n,r){if(void 0!==t&&e instanceof t)return e.slice(n,n+r);if(e instanceof Uint8Array)return new Uint8Array(e.buffer,e.byteOffset+n,r);throw"dicomParser.from: unknown type for byteArray"}function F(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var H=function(){function a(e,n,r){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),void 0===e)throw"dicomParser.ByteStream: missing required parameter 'byteArrayParser'";if(void 0===n)throw"dicomParser.ByteStream: missing required parameter 'byteArray'";if(n instanceof Uint8Array==0&&(void 0===t||n instanceof t==0))throw"dicomParser.ByteStream: parameter byteArray is not of type Uint8Array or Buffer";if(r<0)throw"dicomParser.ByteStream: parameter 'position' cannot be less than 0";if(r>=n.length)throw"dicomParser.ByteStream: parameter 'position' cannot be greater than or equal to 'byteArray' length";this.byteArrayParser=e,this.byteArray=n,this.position=r||0,this.warnings=[]}var e,n,r;return e=a,(n=[{key:"seek",value:function(e){if(this.position+e<0)throw"dicomParser.ByteStream.prototype.seek: cannot seek to position < 0";this.position+=e}},{key:"readByteStream",value:function(e){if(this.position+e>this.byteArray.length)throw"dicomParser.ByteStream.prototype.readByteStream: readByteStream - buffer overread";var t=U(this.byteArray,this.position,e);return this.position+=e,new a(this.byteArrayParser,t)}},{key:"getSize",value:function(){return this.byteArray.length}},{key:"readUint16",value:function(){var e=this.byteArrayParser.readUint16(this.byteArray,this.position);return this.position+=2,e}},{key:"readUint32",value:function(){var e=this.byteArrayParser.readUint32(this.byteArray,this.position);return this.position+=4,e}},{key:"readFixedString",value:function(e){var t=b(this.byteArray,this.position,e);return this.position+=e,t}}])&&F(e.prototype,n),r&&F(e,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(),N={readUint16:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readUint16: position cannot be less than 0";if(t+2>e.length)throw"littleEndianByteArrayParser.readUint16: attempt to read past end of buffer";return e[t]+256*e[t+1]},readInt16:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readInt16: position cannot be less than 0";if(t+2>e.length)throw"littleEndianByteArrayParser.readInt16: attempt to read past end of buffer";return 32768&(t=e[t]+(e[t+1]<<8))?t-65535-1:t},readUint32:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readUint32: position cannot be less than 0";if(t+4>e.length)throw"littleEndianByteArrayParser.readUint32: attempt to read past end of buffer";return e[t]+256*e[t+1]+256*e[t+2]*256+256*e[t+3]*256*256},readInt32:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readInt32: position cannot be less than 0";if(t+4>e.length)throw"littleEndianByteArrayParser.readInt32: attempt to read past end of buffer";return e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24)},readFloat:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readFloat: position cannot be less than 0";if(t+4>e.length)throw"littleEndianByteArrayParser.readFloat: attempt to read past end of buffer";var n=new Uint8Array(4);return n[0]=e[t],n[1]=e[t+1],n[2]=e[t+2],n[3]=e[t+3],new Float32Array(n.buffer)[0]},readDouble:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readDouble: position cannot be less than 0";if(t+8>e.length)throw"littleEndianByteArrayParser.readDouble: attempt to read past end of buffer";var n=new Uint8Array(8);return n[0]=e[t],n[1]=e[t+1],n[2]=e[t+2],n[3]=e[t+3],n[4]=e[t+4],n[5]=e[t+5],n[6]=e[t+6],n[7]=e[t+7],new Float64Array(n.buffer)[0]}};function z(e){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(void 0===e)throw"dicomParser.readPart10Header: missing required parameter 'byteArray'";var t=i.TransferSyntaxUID,s=new H(N,e);return function(){var e=function(){if(s.getSize()<=132&&t)return!1;if(s.seek(128),"DICM"===s.readFixedString(4))return!0;if(!(i||{}).TransferSyntaxUID)throw"dicomParser.readPart10Header: DICM prefix not found at location 132 - this is not a valid DICOM P10 file.";return s.seek(0),!1}(),n=[],r={};if(!e)return s.position=0,{elements:{x00020010:{tag:"x00020010",vr:"UI",Value:t}},warnings:n};for(;s.position<s.byteArray.length;){var a=s.position,o=k(s,n);if("x0002ffff"<o.tag){s.position=a;break}o.parser=N,r[o.tag]=o}return(e=new T(s.byteArrayParser,s.byteArray,r)).warnings=s.warnings,e.position=s.position,e}()}var V="1.2.840.10008.1.2.2";function W(i){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(void 0===i)throw new Error("dicomParser.parseDicom: missing required parameter 'byteArray'");var t,a=function(e){if(void 0===e.elements.x00020010)throw new Error("dicomParser.parseDicom: missing required meta header attribute 0002,0010");return(e=e.elements.x00020010)&&e.Value||b(i,e.dataOffset,e.length)};function n(t){var n="1.2.840.10008.1.2"!==(o=a(t)),o=function(t,n){var o="[object process]"===Object.prototype.toString.call(void 0!==r?r:0);if("1.2.840.10008.1.2.1.99"!==t)return new H(t===V?B:N,i,n);if(e&&e.inflater)return t=e.inflater(i,n),new H(N,t,0);if(1==o){var a=s(0),l=U(i,n,i.length-n);return a=a.inflateRawSync(l),l=A(i,a.length+n),i.copy(l,0,0,n),a.copy(l,n),new H(N,l,0)}if("undefined"==typeof pako)throw"dicomParser.parseDicom: no inflater available to handle deflate transfer syntax";return a=i.slice(n),l=pako.inflateRaw(a),(a=A(i,l.length+n)).set(i.slice(0,n),0),a.set(l,n),new H(N,a,0)}(o,t.position);(t=new T(o.byteArrayParser,o.byteArray,{})).warnings=o.warnings;try{(n?q:L)(t,o,o.byteArray.length,e)}catch(o){throw{exception:o,dataSet:t}}return t}return function(e,t){for(var n in e.elements)e.elements.hasOwnProperty(n)&&(t.elements[n]=e.elements[n]);return void 0!==e.warnings&&(t.warnings=e.warnings.concat(t.warnings)),t}(t=z(i,e),n(t))}var G=function(e,t,n){for(var a=0,r=t;r<t+n;r++)a+=e[r].length;return a};function Y(e,t,n,a,r){if(r=r||t.fragments,void 0===e)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'dataSet'";if(void 0===t)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'pixelDataElement'";if(void 0===n)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'startFragmentIndex'";if(void 0===(a=a||1))throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'numFragments'";if("x7fe00010"!==t.tag)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010";if(!0!==t.encapsulatedPixelData)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==t.hadUndefinedLength)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.basicOffsetTable)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.fragments)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(t.fragments.length<=0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(n<0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be >= 0";if(n>=t.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be < number of fragments";if(a<1)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'numFragments' must be > 0";if(n+a>t.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragment' + 'numFragments' < number of fragments";var i=new H(e.byteArrayParser,e.byteArray,t.dataOffset);if("xfffee000"!==(t=S(i)).tag)throw"dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";i.seek(t.length);var o=i.position;if(1===a)return U(i.byteArray,o+r[n].offset+8,r[n].length);t=G(r,n,a);for(var s=A(i.byteArray,t),l=0,c=n;c<n+a;c++)for(var d=o+r[c].offset+8,u=0;u<r[c].length;u++)s[l++]=i.byteArray[d++];return s}var X=function(e,t){for(var n=0;n<e.length;n++)if(e[n].offset===t)return n},Z=function(e,t,n,a){if(e===t.length-1)return n.length-a;for(var r=t[e+1],i=a+1;i<n.length;i++)if(n[i].offset===r)return i-a;throw"dicomParser.calculateNumberOfFragmentsForFrame: could not find fragment with offset matching basic offset table"};function K(e,t,n,a,r){if(a=a||t.basicOffsetTable,r=r||t.fragments,void 0===e)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'dataSet'";if(void 0===t)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'pixelDataElement'";if(void 0===n)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'frameIndex'";if(void 0===a)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' does not have basicOffsetTable";if("x7fe00010"!==t.tag)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010)";if(!0!==t.encapsulatedPixelData)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==t.hadUndefinedLength)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have undefined length";if(void 0===t.fragments)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have fragments";if(0===a.length)throw"dicomParser.readEncapsulatedImageFrame: basicOffsetTable has zero entries";if(n<0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be >= 0";if(n>=a.length)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be < basicOffsetTable.length";var i=a[n];if(void 0===(i=X(r,i)))throw"dicomParser.readEncapsulatedImageFrame: unable to find fragment that matches basic offset table entry";return Y(e,t,i,Z(n,a,r,i),r)}var J=!1;function $(e,t,n){if(J||(J=!0,console&&console.log&&console.log("WARNING: dicomParser.readEncapsulatedPixelData() has been deprecated")),void 0===e)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'dataSet'";if(void 0===t)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'element'";if(void 0===n)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'frame'";if("x7fe00010"!==t.tag)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to non pixel data tag (expected tag = x7fe00010)";if(!0!==t.encapsulatedPixelData)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(!0!==t.hadUndefinedLength)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.basicOffsetTable)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.fragments)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(n<0)throw"dicomParser.readEncapsulatedPixelData: parameter 'frame' must be >= 0";return 0!==t.basicOffsetTable.length?K(e,t,n):Y(e,t,0,t.fragments.length)}n.default={isStringVr:l,isPrivateTag:c,parsePN:a,parseTM:d,parseDA:f,explicitElementToString:h,explicitDataSetToJS:u,createJPEGBasicOffsetTable:p,parseDicomDataSetExplicit:q,parseDicomDataSetImplicit:L,readFixedString:b,alloc:A,version:R,bigEndianByteArrayParser:B,ByteStream:H,sharedCopy:U,DataSet:T,findAndSetUNElementLength:x,findEndOfEncapsulatedElement:g,findItemDelimitationItemAndSetElementLength:E,littleEndianByteArrayParser:N,parseDicom:W,readDicomElementExplicit:k,readDicomElementImplicit:C,readEncapsulatedImageFrame:K,readEncapsulatedPixelData:$,readEncapsulatedPixelDataFromFragments:Y,readPart10Header:z,readSequenceItemsExplicit:_,readSequenceItemsImplicit:M,readSequenceItem:S,readTag:y,LEI:"1.2.840.10008.1.2",LEE:"1.2.840.10008.1.2.1"}}],i={},n.m=a,n.c=i,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1);function n(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return a[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}var a,i}(n(577))}).call(this,n(573).Buffer,n(227))},573:function(e,t,n){"use strict";(function(e){var r=n(574),o=n(575),l=n(576);function c(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function d(e,t){if(c()<t)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=f.prototype:(null===e&&(e=new f(t)),e.length=t),e}function f(e,t,n){if(!(f.TYPED_ARRAY_SUPPORT||this instanceof f))return new f(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return v(this,e)}return h(this,e,t,n)}function h(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);f.TYPED_ARRAY_SUPPORT?(e=t).__proto__=f.prototype:e=y(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!f.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|j(t,n),o=(e=d(e,r)).write(t,n);o!==r&&(e=e.slice(0,o));return e}(e,t,n):function(e,t){if(f.isBuffer(t)){var n=0|x(t.length);return 0===(e=d(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?d(e,0):y(e,t);if("Buffer"===t.type&&l(t.data))return y(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function m(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function v(e,t){if(m(t),e=d(e,t<0?0:0|x(t)),!f.TYPED_ARRAY_SUPPORT)for(var i=0;i<t;++i)e[i]=0;return e}function y(e,t){var n=t.length<0?0:0|x(t.length);e=d(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function x(e){if(e>=c())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+c().toString(16)+" bytes");return 0|e}function j(e,t){if(f.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return K(e).length;default:if(r)return Z(e).length;t=(""+t).toLowerCase(),r=!0}}function w(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return B(this,t,n);case"utf8":case"utf-8":return k(this,t,n);case"ascii":return A(this,t,n);case"latin1":case"binary":return R(this,t,n);case"base64":return D(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function T(b,e,t){var i=b[e];b[e]=b[t],b[t]=i}function E(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=f.from(t,r)),f.isBuffer(t))return 0===t.length?-1:O(e,t,n,r,o);if("number"==typeof t)return t&=255,f.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):O(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function O(e,t,n,r,o){var i,l=1,c=e.length,d=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;l=2,c/=2,d/=2,n/=2}function f(e,i){return 1===l?e[i]:e.readUInt16BE(i*l)}if(o){var h=-1;for(i=n;i<c;i++)if(f(e,i)===f(t,-1===h?0:i-h)){if(-1===h&&(h=i),i-h+1===d)return h*l}else-1!==h&&(i-=i-h),h=-1}else for(n+d>c&&(n=c-d),i=n;i>=0;i--){for(var m=!0,v=0;v<d;v++)if(f(e,i+v)!==f(t,v)){m=!1;break}if(m)return i}return-1}function C(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var l=t.length;if(l%2!=0)throw new TypeError("Invalid hex string");r>l/2&&(r=l/2);for(var i=0;i<r;++i){var c=parseInt(t.substr(2*i,2),16);if(isNaN(c))return i;e[n+i]=c}return i}function S(e,t,n,r){return J(Z(t,e.length-n),e,n,r)}function I(e,t,n,r){return J(function(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(t),e,n,r)}function M(e,t,n,r){return I(e,t,n,r)}function P(e,t,n,r){return J(K(t),e,n,r)}function _(e,t,n,r){return J(function(e,t){for(var n,r,o,l=[],i=0;i<e.length&&!((t-=2)<0);++i)r=(n=e.charCodeAt(i))>>8,o=n%256,l.push(o),l.push(r);return l}(t,e.length-n),e,n,r)}function D(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function k(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,l,c,d,f=e[i],h=null,m=f>239?4:f>223?3:f>191?2:1;if(i+m<=n)switch(m){case 1:f<128&&(h=f);break;case 2:128==(192&(o=e[i+1]))&&(d=(31&f)<<6|63&o)>127&&(h=d);break;case 3:o=e[i+1],l=e[i+2],128==(192&o)&&128==(192&l)&&(d=(15&f)<<12|(63&o)<<6|63&l)>2047&&(d<55296||d>57343)&&(h=d);break;case 4:o=e[i+1],l=e[i+2],c=e[i+3],128==(192&o)&&128==(192&l)&&128==(192&c)&&(d=(15&f)<<18|(63&o)<<12|(63&l)<<6|63&c)>65535&&d<1114112&&(h=d)}null===h?(h=65533,m=1):h>65535&&(h-=65536,r.push(h>>>10&1023|55296),h=56320|1023&h),r.push(h),i+=m}return function(e){var t=e.length;if(t<=L)return String.fromCharCode.apply(String,e);var n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=L));return n}(r)}t.Buffer=f,t.SlowBuffer=function(e){+e!=e&&(e=0);return f.alloc(+e)},t.INSPECT_MAX_BYTES=50,f.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=c(),f.poolSize=8192,f._augment=function(e){return e.__proto__=f.prototype,e},f.from=function(e,t,n){return h(null,e,t,n)},f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0})),f.alloc=function(e,t,n){return function(e,t,n,r){return m(t),t<=0?d(e,t):void 0!==n?"string"==typeof r?d(e,t).fill(n,r):d(e,t).fill(n):d(e,t)}(null,e,t,n)},f.allocUnsafe=function(e){return v(null,e)},f.allocUnsafeSlow=function(e){return v(null,e)},f.isBuffer=function(b){return!(null==b||!b._isBuffer)},f.compare=function(a,b){if(!f.isBuffer(a)||!f.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var e=a.length,t=b.length,i=0,n=Math.min(e,t);i<n;++i)if(a[i]!==b[i]){e=a[i],t=b[i];break}return e<t?-1:t<e?1:0},f.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(e,t){if(!l(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return f.alloc(0);var i;if(void 0===t)for(t=0,i=0;i<e.length;++i)t+=e[i].length;var n=f.allocUnsafe(t),r=0;for(i=0;i<e.length;++i){var o=e[i];if(!f.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,r),r+=o.length}return n},f.byteLength=j,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<e;i+=2)T(this,i,i+1);return this},f.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<e;i+=4)T(this,i,i+3),T(this,i+1,i+2);return this},f.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<e;i+=8)T(this,i,i+7),T(this,i+1,i+6),T(this,i+2,i+5),T(this,i+3,i+4);return this},f.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?k(this,0,e):w.apply(this,arguments)},f.prototype.equals=function(b){if(!f.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===f.compare(this,b)},f.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},f.prototype.compare=function(e,t,n,r,o){if(!f.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var l=(o>>>=0)-(r>>>=0),c=(n>>>=0)-(t>>>=0),d=Math.min(l,c),h=this.slice(r,o),m=e.slice(t,n),i=0;i<d;++i)if(h[i]!==m[i]){l=h[i],c=m[i];break}return l<c?-1:c<l?1:0},f.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},f.prototype.indexOf=function(e,t,n){return E(this,e,t,n,!0)},f.prototype.lastIndexOf=function(e,t,n){return E(this,e,t,n,!1)},f.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var l=!1;;)switch(r){case"hex":return C(this,e,t,n);case"utf8":case"utf-8":return S(this,e,t,n);case"ascii":return I(this,e,t,n);case"latin1":case"binary":return M(this,e,t,n);case"base64":return P(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,n);default:if(l)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),l=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var L=4096;function A(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function R(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function B(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=X(e[i]);return o}function U(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function F(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function H(e,t,n,r,o,l){if(!f.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<l)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function N(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function z(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function V(e,t,n,r,o,l){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function W(e,t,n,r,l){return l||V(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function G(e,t,n,r,l){return l||V(e,0,n,8),o.write(e,t,n,r,52,8),n+8}f.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),f.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=f.prototype;else{var o=t-e;n=new f(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},f.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||F(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},f.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||F(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},f.prototype.readUInt8=function(e,t){return t||F(e,1,this.length),this[e]},f.prototype.readUInt16LE=function(e,t){return t||F(e,2,this.length),this[e]|this[e+1]<<8},f.prototype.readUInt16BE=function(e,t){return t||F(e,2,this.length),this[e]<<8|this[e+1]},f.prototype.readUInt32LE=function(e,t){return t||F(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},f.prototype.readUInt32BE=function(e,t){return t||F(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},f.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||F(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},f.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||F(e,t,this.length);for(var i=t,r=1,o=this[e+--i];i>0&&(r*=256);)o+=this[e+--i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*t)),o},f.prototype.readInt8=function(e,t){return t||F(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},f.prototype.readInt16LE=function(e,t){t||F(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},f.prototype.readInt16BE=function(e,t){t||F(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},f.prototype.readInt32LE=function(e,t){return t||F(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},f.prototype.readInt32BE=function(e,t){return t||F(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},f.prototype.readFloatLE=function(e,t){return t||F(e,4,this.length),o.read(this,e,!0,23,4)},f.prototype.readFloatBE=function(e,t){return t||F(e,4,this.length),o.read(this,e,!1,23,4)},f.prototype.readDoubleLE=function(e,t){return t||F(e,8,this.length),o.read(this,e,!0,52,8)},f.prototype.readDoubleBE=function(e,t){return t||F(e,8,this.length),o.read(this,e,!1,52,8)},f.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||H(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},f.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||H(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},f.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||H(this,e,t,1,255,0),f.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},f.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||H(this,e,t,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):N(this,e,t,!0),t+2},f.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||H(this,e,t,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):N(this,e,t,!1),t+2},f.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||H(this,e,t,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):z(this,e,t,!0),t+4},f.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||H(this,e,t,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):z(this,e,t,!1),t+4},f.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);H(this,e,t,n,o-1,-o)}var i=0,l=1,sub=0;for(this[t]=255&e;++i<n&&(l*=256);)e<0&&0===sub&&0!==this[t+i-1]&&(sub=1),this[t+i]=(e/l>>0)-sub&255;return t+n},f.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);H(this,e,t,n,o-1,-o)}var i=n-1,l=1,sub=0;for(this[t+i]=255&e;--i>=0&&(l*=256);)e<0&&0===sub&&0!==this[t+i+1]&&(sub=1),this[t+i]=(e/l>>0)-sub&255;return t+n},f.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||H(this,e,t,1,127,-128),f.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},f.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||H(this,e,t,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):N(this,e,t,!0),t+2},f.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||H(this,e,t,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):N(this,e,t,!1),t+2},f.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||H(this,e,t,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):z(this,e,t,!0),t+4},f.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||H(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),f.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):z(this,e,t,!1),t+4},f.prototype.writeFloatLE=function(e,t,n){return W(this,e,t,!0,n)},f.prototype.writeFloatBE=function(e,t,n){return W(this,e,t,!1,n)},f.prototype.writeDoubleLE=function(e,t,n){return G(this,e,t,!0,n)},f.prototype.writeDoubleBE=function(e,t,n){return G(this,e,t,!1,n)},f.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!f.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},f.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var code=e.charCodeAt(0);code<256&&(e=code)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!f.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var o=f.isBuffer(e)?e:Z(new f(e,r).toString()),l=o.length;for(i=0;i<n-t;++i)this[i+t]=o[i%l]}return this};var Y=/[^+\/0-9A-Za-z-_]/g;function X(e){return e<16?"0"+e.toString(16):e.toString(16)}function Z(e,t){var n;t=t||1/0;for(var r=e.length,o=null,l=[],i=0;i<r;++i){if((n=e.charCodeAt(i))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&l.push(239,191,189);continue}if(i+1===r){(t-=3)>-1&&l.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&l.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&l.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;l.push(n)}else if(n<2048){if((t-=2)<0)break;l.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;l.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;l.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return l}function K(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(Y,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function J(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(73))},574:function(e,t,n){"use strict";t.byteLength=function(e){var t=d(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,i,n=d(e),r=n[0],c=n[1],f=new l(function(e,t,n){return 3*(t+n)/4-n}(0,r,c)),h=0,m=c>0?r-4:r;for(i=0;i<m;i+=4)t=o[e.charCodeAt(i)]<<18|o[e.charCodeAt(i+1)]<<12|o[e.charCodeAt(i+2)]<<6|o[e.charCodeAt(i+3)],f[h++]=t>>16&255,f[h++]=t>>8&255,f[h++]=255&t;2===c&&(t=o[e.charCodeAt(i)]<<2|o[e.charCodeAt(i+1)]>>4,f[h++]=255&t);1===c&&(t=o[e.charCodeAt(i)]<<10|o[e.charCodeAt(i+1)]<<4|o[e.charCodeAt(i+2)]>>2,f[h++]=t>>8&255,f[h++]=255&t);return f},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,l=[],c=16383,i=0,d=n-o;i<d;i+=c)l.push(f(e,i,i+c>d?d:i+c));1===o?(t=e[n-1],l.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],l.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return l.join("")};for(var r=[],o=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,c=code.length;i<c;++i)r[i]=code[i],o[code.charCodeAt(i)]=i;function d(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function f(e,t,n){for(var o,l,output=[],i=t;i<n;i+=3)o=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),output.push(r[(l=o)>>18&63]+r[l>>12&63]+r[l>>6&63]+r[63&l]);return output.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},575:function(e,t){t.read=function(e,t,n,r,o){var l,c,d=8*o-r-1,f=(1<<d)-1,h=f>>1,m=-7,i=n?o-1:0,v=n?-1:1,s=e[t+i];for(i+=v,l=s&(1<<-m)-1,s>>=-m,m+=d;m>0;l=256*l+e[t+i],i+=v,m-=8);for(c=l&(1<<-m)-1,l>>=-m,m+=r;m>0;c=256*c+e[t+i],i+=v,m-=8);if(0===l)l=1-h;else{if(l===f)return c?NaN:1/0*(s?-1:1);c+=Math.pow(2,r),l-=h}return(s?-1:1)*c*Math.pow(2,l-r)},t.write=function(e,t,n,r,o,l){var c,d,f,h=8*l-o-1,m=(1<<h)-1,v=m>>1,rt=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,i=r?0:l-1,y=r?1:-1,s=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(d=isNaN(t)?1:0,c=m):(c=Math.floor(Math.log(t)/Math.LN2),t*(f=Math.pow(2,-c))<1&&(c--,f*=2),(t+=c+v>=1?rt/f:rt*Math.pow(2,1-v))*f>=2&&(c++,f/=2),c+v>=m?(d=0,c=m):c+v>=1?(d=(t*f-1)*Math.pow(2,o),c+=v):(d=t*Math.pow(2,v-1)*Math.pow(2,o),c=0));o>=8;e[n+i]=255&d,i+=y,d/=256,o-=8);for(c=c<<o|d,h+=o;h>0;e[n+i]=255&c,i+=y,c/=256,h-=8);e[n+i-y]|=128*s}},576:function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},578:function(e,t,n){var r;window,r=function(){return function(e){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(e,n){!function(e,t){if(S[e]&&C[e]){for(var n in C[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(j[n]=t[n]);0==--T&&0===E&&_()}}(e,n),t&&t(e,n)};var n,r=!0,o="4d8d88ba53621f59b9a9",l={},c=[],d=[];function f(e){var t=k[e];if(!t)return L;var r=function(r){return t.hot.active?(k[r]?-1===k[r].parents.indexOf(e)&&k[r].parents.push(e):(c=[e],n=r),-1===t.children.indexOf(r)&&t.children.push(r)):(console.warn("[HMR] unexpected require("+r+") from disposed module "+e),c=[]),L(r)},o=function(e){return{configurable:!0,enumerable:!0,get:function(){return L[e]},set:function(t){L[e]=t}}};for(var l in L)Object.prototype.hasOwnProperty.call(L,l)&&"e"!==l&&"t"!==l&&Object.defineProperty(r,l,o(l));return r.e=function(e){return"ready"===v&&y("prepare"),E++,L.e(e).then(t,(function(e){throw t(),e}));function t(){E--,"prepare"===v&&(O[e]||P(e),0===E&&0===T&&_())}},r.t=function(e,t){return 1&t&&(e=r(e)),L.t(e,-2&t)},r}function h(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:n!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var i=0;i<e.length;i++)t._acceptedDependencies[e[i]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var i=0;i<e.length;i++)t._declinedDependencies[e[i]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:M,apply:D,status:function(e){if(!e)return v;m.push(e)},addStatusHandler:function(e){m.push(e)},removeStatusHandler:function(e){var t=m.indexOf(e);t>=0&&m.splice(t,1)},data:l[e]};return n=void 0,t}var m=[],v="idle";function y(e){v=e;for(var i=0;i<m.length;i++)m[i].call(null,e)}var x,j,w,T=0,E=0,O={},C={},S={};function I(e){return+e+""===e?+e:e}function M(e){if("idle"!==v)throw new Error("check() is only allowed in idle status");return r=e,y("check"),(t=1e4,t=t||1e4,new Promise((function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var r=new XMLHttpRequest,l=L.p+""+o+".hot-update.json";r.open("GET",l,!0),r.timeout=t,r.send(null)}catch(e){return n(e)}r.onreadystatechange=function(){if(4===r.readyState)if(0===r.status)n(new Error("Manifest request to "+l+" timed out."));else if(404===r.status)e();else if(200!==r.status&&304!==r.status)n(new Error("Manifest request to "+l+" failed."));else{try{var t=JSON.parse(r.responseText)}catch(e){return void n(e)}e(t)}}}))).then((function(e){if(!e)return y("idle"),null;C={},O={},S=e.c,w=e.h,y("prepare");var t=new Promise((function(e,t){x={resolve:e,reject:t}}));return j={},P("cornerstone"),"prepare"===v&&0===E&&0===T&&_(),t}));var t}function P(e){S[e]?(C[e]=!0,T++,function(e){var head=document.getElementsByTagName("head")[0],script=document.createElement("script");script.charset="utf-8",script.src=L.p+""+e+"."+o+".hot-update.js",head.appendChild(script)}(e)):O[e]=!0}function _(){y("ready");var e=x;if(x=null,e)if(r)Promise.resolve().then((function(){return D(r)})).then((function(t){e.resolve(t)}),(function(t){e.reject(t)}));else{var t=[];for(var n in j)Object.prototype.hasOwnProperty.call(j,n)&&t.push(I(n));e.resolve(t)}}function D(t){if("ready"!==v)throw new Error("apply() is only allowed in ready status");var n,i,r,d,f;function h(e){for(var t=[e],n={},r=t.slice().map((function(e){return{chain:[e],id:e}}));r.length>0;){var o=r.pop(),l=o.id,c=o.chain;if((d=k[l])&&!d.hot._selfAccepted){if(d.hot._selfDeclined)return{type:"self-declined",chain:c,moduleId:l};if(d.hot._main)return{type:"unaccepted",chain:c,moduleId:l};for(var i=0;i<d.parents.length;i++){var f=d.parents[i],h=k[f];if(h){if(h.hot._declinedDependencies[l])return{type:"declined",chain:c.concat([f]),moduleId:l,parentId:f};-1===t.indexOf(f)&&(h.hot._acceptedDependencies[l]?(n[f]||(n[f]=[]),m(n[f],[l])):(delete n[f],t.push(f),r.push({chain:c.concat([f]),id:f})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function m(a,b){for(var i=0;i<b.length;i++){var e=b[i];-1===a.indexOf(e)&&a.push(e)}}t=t||{};var x={},T=[],E={},O=function(){console.warn("[HMR] unexpected require("+M.moduleId+") to disposed module")};for(var C in j)if(Object.prototype.hasOwnProperty.call(j,C)){var M;f=I(C);var P=!1,_=!1,D=!1,A="";switch((M=j[C]?h(f):{type:"disposed",moduleId:C}).chain&&(A="\nUpdate propagation: "+M.chain.join(" -> ")),M.type){case"self-declined":t.onDeclined&&t.onDeclined(M),t.ignoreDeclined||(P=new Error("Aborted because of self decline: "+M.moduleId+A));break;case"declined":t.onDeclined&&t.onDeclined(M),t.ignoreDeclined||(P=new Error("Aborted because of declined dependency: "+M.moduleId+" in "+M.parentId+A));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(M),t.ignoreUnaccepted||(P=new Error("Aborted because "+f+" is not accepted"+A));break;case"accepted":t.onAccepted&&t.onAccepted(M),_=!0;break;case"disposed":t.onDisposed&&t.onDisposed(M),D=!0;break;default:throw new Error("Unexception type "+M.type)}if(P)return y("abort"),Promise.reject(P);if(_)for(f in E[f]=j[f],m(T,M.outdatedModules),M.outdatedDependencies)Object.prototype.hasOwnProperty.call(M.outdatedDependencies,f)&&(x[f]||(x[f]=[]),m(x[f],M.outdatedDependencies[f]));D&&(m(T,[M.moduleId]),E[f]=O)}var R,B=[];for(i=0;i<T.length;i++)f=T[i],k[f]&&k[f].hot._selfAccepted&&B.push({module:f,errorHandler:k[f].hot._selfAccepted});y("dispose"),Object.keys(S).forEach((function(e){!1===S[e]&&function(e){delete installedChunks[e]}(e)}));for(var U,F,H=T.slice();H.length>0;)if(f=H.pop(),d=k[f]){var data={},N=d.hot._disposeHandlers;for(r=0;r<N.length;r++)(n=N[r])(data);for(l[f]=data,d.hot.active=!1,delete k[f],delete x[f],r=0;r<d.children.length;r++){var z=k[d.children[r]];z&&(R=z.parents.indexOf(f))>=0&&z.parents.splice(R,1)}}for(f in x)if(Object.prototype.hasOwnProperty.call(x,f)&&(d=k[f]))for(F=x[f],r=0;r<F.length;r++)U=F[r],(R=d.children.indexOf(U))>=0&&d.children.splice(R,1);for(f in y("apply"),o=w,E)Object.prototype.hasOwnProperty.call(E,f)&&(e[f]=E[f]);var V=null;for(f in x)if(Object.prototype.hasOwnProperty.call(x,f)&&(d=k[f])){F=x[f];var W=[];for(i=0;i<F.length;i++)if(U=F[i],n=d.hot._acceptedDependencies[U]){if(-1!==W.indexOf(n))continue;W.push(n)}for(i=0;i<W.length;i++){n=W[i];try{n(F)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:f,dependencyId:F[i],error:e}),t.ignoreErrored||V||(V=e)}}}for(i=0;i<B.length;i++){var G=B[i];f=G.module,c=[f];try{L(f)}catch(e){if("function"==typeof G.errorHandler)try{G.errorHandler(e)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:f,error:n,originalError:e}),t.ignoreErrored||V||(V=n),V||(V=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:f,error:e}),t.ignoreErrored||V||(V=e)}}return V?(y("fail"),Promise.reject(V)):(y("idle"),new Promise((function(e){e(T)})))}var k={};function L(t){if(k[t])return k[t].exports;var n=k[t]={i:t,l:!1,exports:{},hot:h(t),parents:(d=c,c=[],d),children:[]};return e[t].call(n.exports,n,n.exports,f(t)),n.l=!0,n.exports}return L.m=e,L.c=k,L.d=function(e,t,n){L.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},L.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},L.t=function(e,t){if(1&t&&(e=L(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(L.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)L.d(n,r,function(t){return e[t]}.bind(null,r));return n},L.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return L.d(t,"a",t),t},L.o=function(object,e){return Object.prototype.hasOwnProperty.call(object,e)},L.p="",L.h=function(){return o},f("./index.js")(L.s="./index.js")}({"./canvasToPixel.js":function(e,t,n){"use strict";n.r(t);var r=n("./enabledElements.js"),o=n("./internal/getTransform.js");t.default=function(element,e){var t=Object(r.getEnabledElement)(element),n=Object(o.default)(t);return n.invert(),n.transformPoint(e.x,e.y)}},"./colors/colormap.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getColormapsList",(function(){return f})),n.d(t,"getColormap",(function(){return h}));var r=n("./colors/lookupTable.js"),o=[0,0,0,0],l={hotIron:{name:"Hot Iron",numOfColors:256,colors:[[0,0,0,255],[2,0,0,255],[4,0,0,255],[6,0,0,255],[8,0,0,255],[10,0,0,255],[12,0,0,255],[14,0,0,255],[16,0,0,255],[18,0,0,255],[20,0,0,255],[22,0,0,255],[24,0,0,255],[26,0,0,255],[28,0,0,255],[30,0,0,255],[32,0,0,255],[34,0,0,255],[36,0,0,255],[38,0,0,255],[40,0,0,255],[42,0,0,255],[44,0,0,255],[46,0,0,255],[48,0,0,255],[50,0,0,255],[52,0,0,255],[54,0,0,255],[56,0,0,255],[58,0,0,255],[60,0,0,255],[62,0,0,255],[64,0,0,255],[66,0,0,255],[68,0,0,255],[70,0,0,255],[72,0,0,255],[74,0,0,255],[76,0,0,255],[78,0,0,255],[80,0,0,255],[82,0,0,255],[84,0,0,255],[86,0,0,255],[88,0,0,255],[90,0,0,255],[92,0,0,255],[94,0,0,255],[96,0,0,255],[98,0,0,255],[100,0,0,255],[102,0,0,255],[104,0,0,255],[106,0,0,255],[108,0,0,255],[110,0,0,255],[112,0,0,255],[114,0,0,255],[116,0,0,255],[118,0,0,255],[120,0,0,255],[122,0,0,255],[124,0,0,255],[126,0,0,255],[128,0,0,255],[130,0,0,255],[132,0,0,255],[134,0,0,255],[136,0,0,255],[138,0,0,255],[140,0,0,255],[142,0,0,255],[144,0,0,255],[146,0,0,255],[148,0,0,255],[150,0,0,255],[152,0,0,255],[154,0,0,255],[156,0,0,255],[158,0,0,255],[160,0,0,255],[162,0,0,255],[164,0,0,255],[166,0,0,255],[168,0,0,255],[170,0,0,255],[172,0,0,255],[174,0,0,255],[176,0,0,255],[178,0,0,255],[180,0,0,255],[182,0,0,255],[184,0,0,255],[186,0,0,255],[188,0,0,255],[190,0,0,255],[192,0,0,255],[194,0,0,255],[196,0,0,255],[198,0,0,255],[200,0,0,255],[202,0,0,255],[204,0,0,255],[206,0,0,255],[208,0,0,255],[210,0,0,255],[212,0,0,255],[214,0,0,255],[216,0,0,255],[218,0,0,255],[220,0,0,255],[222,0,0,255],[224,0,0,255],[226,0,0,255],[228,0,0,255],[230,0,0,255],[232,0,0,255],[234,0,0,255],[236,0,0,255],[238,0,0,255],[240,0,0,255],[242,0,0,255],[244,0,0,255],[246,0,0,255],[248,0,0,255],[250,0,0,255],[252,0,0,255],[254,0,0,255],[255,0,0,255],[255,2,0,255],[255,4,0,255],[255,6,0,255],[255,8,0,255],[255,10,0,255],[255,12,0,255],[255,14,0,255],[255,16,0,255],[255,18,0,255],[255,20,0,255],[255,22,0,255],[255,24,0,255],[255,26,0,255],[255,28,0,255],[255,30,0,255],[255,32,0,255],[255,34,0,255],[255,36,0,255],[255,38,0,255],[255,40,0,255],[255,42,0,255],[255,44,0,255],[255,46,0,255],[255,48,0,255],[255,50,0,255],[255,52,0,255],[255,54,0,255],[255,56,0,255],[255,58,0,255],[255,60,0,255],[255,62,0,255],[255,64,0,255],[255,66,0,255],[255,68,0,255],[255,70,0,255],[255,72,0,255],[255,74,0,255],[255,76,0,255],[255,78,0,255],[255,80,0,255],[255,82,0,255],[255,84,0,255],[255,86,0,255],[255,88,0,255],[255,90,0,255],[255,92,0,255],[255,94,0,255],[255,96,0,255],[255,98,0,255],[255,100,0,255],[255,102,0,255],[255,104,0,255],[255,106,0,255],[255,108,0,255],[255,110,0,255],[255,112,0,255],[255,114,0,255],[255,116,0,255],[255,118,0,255],[255,120,0,255],[255,122,0,255],[255,124,0,255],[255,126,0,255],[255,128,4,255],[255,130,8,255],[255,132,12,255],[255,134,16,255],[255,136,20,255],[255,138,24,255],[255,140,28,255],[255,142,32,255],[255,144,36,255],[255,146,40,255],[255,148,44,255],[255,150,48,255],[255,152,52,255],[255,154,56,255],[255,156,60,255],[255,158,64,255],[255,160,68,255],[255,162,72,255],[255,164,76,255],[255,166,80,255],[255,168,84,255],[255,170,88,255],[255,172,92,255],[255,174,96,255],[255,176,100,255],[255,178,104,255],[255,180,108,255],[255,182,112,255],[255,184,116,255],[255,186,120,255],[255,188,124,255],[255,190,128,255],[255,192,132,255],[255,194,136,255],[255,196,140,255],[255,198,144,255],[255,200,148,255],[255,202,152,255],[255,204,156,255],[255,206,160,255],[255,208,164,255],[255,210,168,255],[255,212,172,255],[255,214,176,255],[255,216,180,255],[255,218,184,255],[255,220,188,255],[255,222,192,255],[255,224,196,255],[255,226,200,255],[255,228,204,255],[255,230,208,255],[255,232,212,255],[255,234,216,255],[255,236,220,255],[255,238,224,255],[255,240,228,255],[255,242,232,255],[255,244,236,255],[255,246,240,255],[255,248,244,255],[255,250,248,255],[255,252,252,255],[255,255,255,255]]},pet:{name:"PET",numColors:256,colors:[[0,0,0,255],[0,2,1,255],[0,4,3,255],[0,6,5,255],[0,8,7,255],[0,10,9,255],[0,12,11,255],[0,14,13,255],[0,16,15,255],[0,18,17,255],[0,20,19,255],[0,22,21,255],[0,24,23,255],[0,26,25,255],[0,28,27,255],[0,30,29,255],[0,32,31,255],[0,34,33,255],[0,36,35,255],[0,38,37,255],[0,40,39,255],[0,42,41,255],[0,44,43,255],[0,46,45,255],[0,48,47,255],[0,50,49,255],[0,52,51,255],[0,54,53,255],[0,56,55,255],[0,58,57,255],[0,60,59,255],[0,62,61,255],[0,65,63,255],[0,67,65,255],[0,69,67,255],[0,71,69,255],[0,73,71,255],[0,75,73,255],[0,77,75,255],[0,79,77,255],[0,81,79,255],[0,83,81,255],[0,85,83,255],[0,87,85,255],[0,89,87,255],[0,91,89,255],[0,93,91,255],[0,95,93,255],[0,97,95,255],[0,99,97,255],[0,101,99,255],[0,103,101,255],[0,105,103,255],[0,107,105,255],[0,109,107,255],[0,111,109,255],[0,113,111,255],[0,115,113,255],[0,117,115,255],[0,119,117,255],[0,121,119,255],[0,123,121,255],[0,125,123,255],[0,128,125,255],[1,126,127,255],[3,124,129,255],[5,122,131,255],[7,120,133,255],[9,118,135,255],[11,116,137,255],[13,114,139,255],[15,112,141,255],[17,110,143,255],[19,108,145,255],[21,106,147,255],[23,104,149,255],[25,102,151,255],[27,100,153,255],[29,98,155,255],[31,96,157,255],[33,94,159,255],[35,92,161,255],[37,90,163,255],[39,88,165,255],[41,86,167,255],[43,84,169,255],[45,82,171,255],[47,80,173,255],[49,78,175,255],[51,76,177,255],[53,74,179,255],[55,72,181,255],[57,70,183,255],[59,68,185,255],[61,66,187,255],[63,64,189,255],[65,63,191,255],[67,61,193,255],[69,59,195,255],[71,57,197,255],[73,55,199,255],[75,53,201,255],[77,51,203,255],[79,49,205,255],[81,47,207,255],[83,45,209,255],[85,43,211,255],[86,41,213,255],[88,39,215,255],[90,37,217,255],[92,35,219,255],[94,33,221,255],[96,31,223,255],[98,29,225,255],[100,27,227,255],[102,25,229,255],[104,23,231,255],[106,21,233,255],[108,19,235,255],[110,17,237,255],[112,15,239,255],[114,13,241,255],[116,11,243,255],[118,9,245,255],[120,7,247,255],[122,5,249,255],[124,3,251,255],[126,1,253,255],[128,0,255,255],[130,2,252,255],[132,4,248,255],[134,6,244,255],[136,8,240,255],[138,10,236,255],[140,12,232,255],[142,14,228,255],[144,16,224,255],[146,18,220,255],[148,20,216,255],[150,22,212,255],[152,24,208,255],[154,26,204,255],[156,28,200,255],[158,30,196,255],[160,32,192,255],[162,34,188,255],[164,36,184,255],[166,38,180,255],[168,40,176,255],[170,42,172,255],[171,44,168,255],[173,46,164,255],[175,48,160,255],[177,50,156,255],[179,52,152,255],[181,54,148,255],[183,56,144,255],[185,58,140,255],[187,60,136,255],[189,62,132,255],[191,64,128,255],[193,66,124,255],[195,68,120,255],[197,70,116,255],[199,72,112,255],[201,74,108,255],[203,76,104,255],[205,78,100,255],[207,80,96,255],[209,82,92,255],[211,84,88,255],[213,86,84,255],[215,88,80,255],[217,90,76,255],[219,92,72,255],[221,94,68,255],[223,96,64,255],[225,98,60,255],[227,100,56,255],[229,102,52,255],[231,104,48,255],[233,106,44,255],[235,108,40,255],[237,110,36,255],[239,112,32,255],[241,114,28,255],[243,116,24,255],[245,118,20,255],[247,120,16,255],[249,122,12,255],[251,124,8,255],[253,126,4,255],[255,128,0,255],[255,130,4,255],[255,132,8,255],[255,134,12,255],[255,136,16,255],[255,138,20,255],[255,140,24,255],[255,142,28,255],[255,144,32,255],[255,146,36,255],[255,148,40,255],[255,150,44,255],[255,152,48,255],[255,154,52,255],[255,156,56,255],[255,158,60,255],[255,160,64,255],[255,162,68,255],[255,164,72,255],[255,166,76,255],[255,168,80,255],[255,170,85,255],[255,172,89,255],[255,174,93,255],[255,176,97,255],[255,178,101,255],[255,180,105,255],[255,182,109,255],[255,184,113,255],[255,186,117,255],[255,188,121,255],[255,190,125,255],[255,192,129,255],[255,194,133,255],[255,196,137,255],[255,198,141,255],[255,200,145,255],[255,202,149,255],[255,204,153,255],[255,206,157,255],[255,208,161,255],[255,210,165,255],[255,212,170,255],[255,214,174,255],[255,216,178,255],[255,218,182,255],[255,220,186,255],[255,222,190,255],[255,224,194,255],[255,226,198,255],[255,228,202,255],[255,230,206,255],[255,232,210,255],[255,234,214,255],[255,236,218,255],[255,238,222,255],[255,240,226,255],[255,242,230,255],[255,244,234,255],[255,246,238,255],[255,248,242,255],[255,250,246,255],[255,252,250,255],[255,255,255,255]]},hotMetalBlue:{name:"Hot Metal Blue",numColors:256,colors:[[0,0,0,255],[0,0,2,255],[0,0,4,255],[0,0,6,255],[0,0,8,255],[0,0,10,255],[0,0,12,255],[0,0,14,255],[0,0,16,255],[0,0,17,255],[0,0,19,255],[0,0,21,255],[0,0,23,255],[0,0,25,255],[0,0,27,255],[0,0,29,255],[0,0,31,255],[0,0,33,255],[0,0,35,255],[0,0,37,255],[0,0,39,255],[0,0,41,255],[0,0,43,255],[0,0,45,255],[0,0,47,255],[0,0,49,255],[0,0,51,255],[0,0,53,255],[0,0,55,255],[0,0,57,255],[0,0,59,255],[0,0,61,255],[0,0,63,255],[0,0,65,255],[0,0,67,255],[0,0,69,255],[0,0,71,255],[0,0,73,255],[0,0,75,255],[0,0,77,255],[0,0,79,255],[0,0,81,255],[0,0,83,255],[0,0,84,255],[0,0,86,255],[0,0,88,255],[0,0,90,255],[0,0,92,255],[0,0,94,255],[0,0,96,255],[0,0,98,255],[0,0,100,255],[0,0,102,255],[0,0,104,255],[0,0,106,255],[0,0,108,255],[0,0,110,255],[0,0,112,255],[0,0,114,255],[0,0,116,255],[0,0,117,255],[0,0,119,255],[0,0,121,255],[0,0,123,255],[0,0,125,255],[0,0,127,255],[0,0,129,255],[0,0,131,255],[0,0,133,255],[0,0,135,255],[0,0,137,255],[0,0,139,255],[0,0,141,255],[0,0,143,255],[0,0,145,255],[0,0,147,255],[0,0,149,255],[0,0,151,255],[0,0,153,255],[0,0,155,255],[0,0,157,255],[0,0,159,255],[0,0,161,255],[0,0,163,255],[0,0,165,255],[0,0,167,255],[3,0,169,255],[6,0,171,255],[9,0,173,255],[12,0,175,255],[15,0,177,255],[18,0,179,255],[21,0,181,255],[24,0,183,255],[26,0,184,255],[29,0,186,255],[32,0,188,255],[35,0,190,255],[38,0,192,255],[41,0,194,255],[44,0,196,255],[47,0,198,255],[50,0,200,255],[52,0,197,255],[55,0,194,255],[57,0,191,255],[59,0,188,255],[62,0,185,255],[64,0,182,255],[66,0,179,255],[69,0,176,255],[71,0,174,255],[74,0,171,255],[76,0,168,255],[78,0,165,255],[81,0,162,255],[83,0,159,255],[85,0,156,255],[88,0,153,255],[90,0,150,255],[93,2,144,255],[96,4,138,255],[99,6,132,255],[102,8,126,255],[105,9,121,255],[108,11,115,255],[111,13,109,255],[114,15,103,255],[116,17,97,255],[119,19,91,255],[122,21,85,255],[125,23,79,255],[128,24,74,255],[131,26,68,255],[134,28,62,255],[137,30,56,255],[140,32,50,255],[143,34,47,255],[146,36,44,255],[149,38,41,255],[152,40,38,255],[155,41,35,255],[158,43,32,255],[161,45,29,255],[164,47,26,255],[166,49,24,255],[169,51,21,255],[172,53,18,255],[175,55,15,255],[178,56,12,255],[181,58,9,255],[184,60,6,255],[187,62,3,255],[190,64,0,255],[194,66,0,255],[198,68,0,255],[201,70,0,255],[205,72,0,255],[209,73,0,255],[213,75,0,255],[217,77,0,255],[221,79,0,255],[224,81,0,255],[228,83,0,255],[232,85,0,255],[236,87,0,255],[240,88,0,255],[244,90,0,255],[247,92,0,255],[251,94,0,255],[255,96,0,255],[255,98,3,255],[255,100,6,255],[255,102,9,255],[255,104,12,255],[255,105,15,255],[255,107,18,255],[255,109,21,255],[255,111,24,255],[255,113,26,255],[255,115,29,255],[255,117,32,255],[255,119,35,255],[255,120,38,255],[255,122,41,255],[255,124,44,255],[255,126,47,255],[255,128,50,255],[255,130,53,255],[255,132,56,255],[255,134,59,255],[255,136,62,255],[255,137,65,255],[255,139,68,255],[255,141,71,255],[255,143,74,255],[255,145,76,255],[255,147,79,255],[255,149,82,255],[255,151,85,255],[255,152,88,255],[255,154,91,255],[255,156,94,255],[255,158,97,255],[255,160,100,255],[255,162,103,255],[255,164,106,255],[255,166,109,255],[255,168,112,255],[255,169,115,255],[255,171,118,255],[255,173,121,255],[255,175,124,255],[255,177,126,255],[255,179,129,255],[255,181,132,255],[255,183,135,255],[255,184,138,255],[255,186,141,255],[255,188,144,255],[255,190,147,255],[255,192,150,255],[255,194,153,255],[255,196,156,255],[255,198,159,255],[255,200,162,255],[255,201,165,255],[255,203,168,255],[255,205,171,255],[255,207,174,255],[255,209,176,255],[255,211,179,255],[255,213,182,255],[255,215,185,255],[255,216,188,255],[255,218,191,255],[255,220,194,255],[255,222,197,255],[255,224,200,255],[255,226,203,255],[255,228,206,255],[255,229,210,255],[255,231,213,255],[255,233,216,255],[255,235,219,255],[255,237,223,255],[255,239,226,255],[255,240,229,255],[255,242,232,255],[255,244,236,255],[255,246,239,255],[255,248,242,255],[255,250,245,255],[255,251,249,255],[255,253,252,255],[255,255,255,255]]},pet20Step:{name:"PET 20 Step",numColors:256,colors:[[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[0,0,0,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[96,0,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,80,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[48,48,112,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[80,80,128,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[96,96,176,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[112,112,192,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[128,128,224,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,96,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[48,144,48,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[80,192,80,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[64,224,64,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[224,224,80,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,208,96,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,176,64,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[208,144,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[192,96,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[176,48,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,0,0,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255],[255,255,255,255]]},gray:{name:"Gray",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,1,1]]}},jet:{name:"Jet",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.35,0,0],[.66,1,1],[.89,1,1],[1,.5,.5]],green:[[0,0,0],[.125,0,0],[.375,1,1],[.64,1,1],[.91,0,0],[1,0,0]],blue:[[0,.5,.5],[.11,1,1],[.34,1,1],[.65,0,0],[1,0,0]]}},hsv:{name:"HSV",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[.15873,1,1],[.174603,.96875,.96875],[.333333,.03125,.03125],[.349206,0,0],[.666667,0,0],[.68254,.03125,.03125],[.84127,.96875,.96875],[.857143,1,1],[1,1,1]],green:[[0,0,0],[.15873,.9375,.9375],[.174603,1,1],[.507937,1,1],[.666667,.0625,.0625],[.68254,0,0],[1,0,0]],blue:[[0,0,0],[.333333,0,0],[.349206,.0625,.0625],[.507937,1,1],[.84127,1,1],[.857143,.9375,.9375],[1,.09375,.09375]]}},hot:{name:"Hot",numColors:256,gamma:1,segmentedData:{red:[[0,.0416,.0416],[.365079,1,1],[1,1,1]],green:[[0,0,0],[.365079,0,0],[.746032,1,1],[1,1,1]],blue:[[0,0,0],[.746032,0,0],[1,1,1]]}},cool:{name:"Cool",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,1,1],[1,0,0]],blue:[[0,1,1],[1,1,1]]}},spring:{name:"Spring",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,0,0]]}},summer:{name:"Summer",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,1,1]],green:[[0,.5,.5],[1,1,1]],blue:[[0,.4,.4],[1,.4,.4]]}},autumn:{name:"Autumn",numColors:256,gamma:1,segmentedData:{red:[[0,1,1],[1,1,1]],green:[[0,0,0],[1,1,1]],blue:[[0,0,0],[1,0,0]]}},winter:{name:"Winter",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[1,0,0]],green:[[0,0,0],[1,1,1]],blue:[[0,1,1],[1,.5,.5]]}},bone:{name:"Bone",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.746032,.652778,.652778],[1,1,1]],green:[[0,0,0],[.365079,.319444,.319444],[.746032,.777778,.777778],[1,1,1]],blue:[[0,0,0],[.365079,.444444,.444444],[1,1,1]]}},copper:{name:"Copper",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.809524,1,1],[1,1,1]],green:[[0,0,0],[1,.7812,.7812]],blue:[[0,0,0],[1,.4975,.4975]]}},spectral:{name:"Spectral",numColors:256,gamma:1,segmentedData:{red:[[0,0,0],[.05,.4667,.4667],[.1,.5333,.5333],[.15,0,0],[.2,0,0],[.25,0,0],[.3,0,0],[.35,0,0],[.4,0,0],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,.7333,.7333],[.7,.9333,.9333],[.75,1,1],[.8,1,1],[.85,1,1],[.9,.8667,.8667],[.95,.8,.8],[1,.8,.8]],green:[[0,0,0],[.05,0,0],[.1,0,0],[.15,0,0],[.2,0,0],[.25,.4667,.4667],[.3,.6,.6],[.35,.6667,.6667],[.4,.6667,.6667],[.45,.6,.6],[.5,.7333,.7333],[.55,.8667,.8667],[.6,1,1],[.65,1,1],[.7,.9333,.9333],[.75,.8,.8],[.8,.6,.6],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]],blue:[[0,0,0],[.05,.5333,.5333],[.1,.6,.6],[.15,.6667,.6667],[.2,.8667,.8667],[.25,.8667,.8667],[.3,.8667,.8667],[.35,.6667,.6667],[.4,.5333,.5333],[.45,0,0],[.5,0,0],[.55,0,0],[.6,0,0],[.65,0,0],[.7,0,0],[.75,0,0],[.8,0,0],[.85,0,0],[.9,0,0],[.95,0,0],[1,.8,.8]]}},coolwarm:{name:"CoolWarm",numColors:256,gamma:1,segmentedData:{red:[[0,.2298057,.2298057],[.03125,.26623388,.26623388],[.0625,.30386891,.30386891],[.09375,.342804478,.342804478],[.125,.38301334,.38301334],[.15625,.424369608,.424369608],[.1875,.46666708,.46666708],[.21875,.509635204,.509635204],[.25,.552953156,.552953156],[.28125,.596262162,.596262162],[.3125,.639176211,.639176211],[.34375,.681291281,.681291281],[.375,.722193294,.722193294],[.40625,.761464949,.761464949],[.4375,.798691636,.798691636],[.46875,.833466556,.833466556],[.5,.865395197,.865395197],[.53125,.897787179,.897787179],[.5625,.924127593,.924127593],[.59375,.944468518,.944468518],[.625,.958852946,.958852946],[.65625,.96732803,.96732803],[.6875,.969954137,.969954137],[.71875,.966811177,.966811177],[.75,.958003065,.958003065],[.78125,.943660866,.943660866],[.8125,.923944917,.923944917],[.84375,.89904617,.89904617],[.875,.869186849,.869186849],[.90625,.834620542,.834620542],[.9375,.795631745,.795631745],[.96875,.752534934,.752534934],[1,.705673158,.705673158]],green:[[0,.298717966,.298717966],[.03125,.353094838,.353094838],[.0625,.406535296,.406535296],[.09375,.458757618,.458757618],[.125,.50941904,.50941904],[.15625,.558148092,.558148092],[.1875,.604562568,.604562568],[.21875,.648280772,.648280772],[.25,.688929332,.688929332],[.28125,.726149107,.726149107],[.3125,.759599947,.759599947],[.34375,.788964712,.788964712],[.375,.813952739,.813952739],[.40625,.834302879,.834302879],[.4375,.849786142,.849786142],[.46875,.860207984,.860207984],[.5,.86541021,.86541021],[.53125,.848937047,.848937047],[.5625,.827384882,.827384882],[.59375,.800927443,.800927443],[.625,.769767752,.769767752],[.65625,.734132809,.734132809],[.6875,.694266682,.694266682],[.71875,.650421156,.650421156],[.75,.602842431,.602842431],[.78125,.551750968,.551750968],[.8125,.49730856,.49730856],[.84375,.439559467,.439559467],[.875,.378313092,.378313092],[.90625,.312874446,.312874446],[.9375,.24128379,.24128379],[.96875,.157246067,.157246067],[1,.01555616,.01555616]],blue:[[0,.753683153,.753683153],[.03125,.801466763,.801466763],[.0625,.84495867,.84495867],[.09375,.883725899,.883725899],[.125,.917387822,.917387822],[.15625,.945619588,.945619588],[.1875,.968154911,.968154911],[.21875,.98478814,.98478814],[.25,.995375608,.995375608],[.28125,.999836203,.999836203],[.3125,.998151185,.998151185],[.34375,.990363227,.990363227],[.375,.976574709,.976574709],[.40625,.956945269,.956945269],[.4375,.931688648,.931688648],[.46875,.901068838,.901068838],[.5,.865395561,.865395561],[.53125,.820880546,.820880546],[.5625,.774508472,.774508472],[.59375,.726736146,.726736146],[.625,.678007945,.678007945],[.65625,.628751763,.628751763],[.6875,.579375448,.579375448],[.71875,.530263762,.530263762],[.75,.481775914,.481775914],[.78125,.434243684,.434243684],[.8125,.387970225,.387970225],[.84375,.343229596,.343229596],[.875,.300267182,.300267182],[.90625,.259301199,.259301199],[.9375,.220525627,.220525627],[.96875,.184115123,.184115123],[1,.150232812,.150232812]]}},blues:{name:"Blues",numColors:256,gamma:1,segmentedData:{red:[[0,.9686274528503418,.9686274528503418],[.125,.8705882430076599,.8705882430076599],[.25,.7764706015586853,.7764706015586853],[.375,.6196078658103943,.6196078658103943],[.5,.41960784792900085,.41960784792900085],[.625,.25882354378700256,.25882354378700256],[.75,.12941177189350128,.12941177189350128],[.875,.0313725508749485,.0313725508749485],[1,.0313725508749485,.0313725508749485]],green:[[0,.9843137264251709,.9843137264251709],[.125,.9215686321258545,.9215686321258545],[.25,.8588235378265381,.8588235378265381],[.375,.7921568751335144,.7921568751335144],[.5,.6823529601097107,.6823529601097107],[.625,.572549045085907,.572549045085907],[.75,.4431372582912445,.4431372582912445],[.875,.3176470696926117,.3176470696926117],[1,.1882352977991104,.1882352977991104]],blue:[[0,1,1],[.125,.9686274528503418,.9686274528503418],[.25,.9372549057006836,.9372549057006836],[.375,.8823529481887817,.8823529481887817],[.5,.8392156958580017,.8392156958580017],[.625,.7764706015586853,.7764706015586853],[.75,.7098039388656616,.7098039388656616],[.875,.6117647290229797,.6117647290229797],[1,.41960784792900085,.41960784792900085]]}}};function c(e,t){for(var n=0,r=e.length-1;n<=r;){var o=n+Math.floor((r-n)/2),l=e[o];if(l===t)return o;t<l?r=o-1:n=o+1}return n}function d(e,data,t){var i,n=[],r=[],o=[],l=[];for(t=null===t?1:t,i=0;i<data.length;i++){var element=data[i];n.push((e-1)*element[0]),r.push(element[1]),o.push(element[1])}var d=function(a,b,e){for(var t=(b-a)/((e=null===e?100:e)-1),n=[];e-- >0;)n.push(a),a+=t;return n[n.length-1]=b,n}(0,1,e);for(i=0;i<e;i++)d[i]=(e-1)*Math.pow(d[i],t);var f=function(e,t){var i,n=[],r=t.length;for(e.sort((function(a,b){return a-b})),i=0;i<r;i++)n[i]=c(e,t[i]);return n}(n,d);for(i=1;i<e-1;i++){var h=f[i],m=(d[i]-n[h-1])/(n[h]-n[h-1]),v=r[h]-o[h-1];l[i]=m*v+o[h-1]}return l[0]=o[0],l[e-1]=r[data.length-1],l}function f(){var e=[];return Object.keys(l).forEach((function(t){if(l.hasOwnProperty(t)){var n=l[t];e.push({id:t,name:n.name})}})),e.sort((function(a,b){var e=a.name.toLowerCase(),t=b.name.toLowerCase();return e===t?0:e<t?-1:1})),e}function h(e,t){var n=l[e];return n||(n=l[e]=t||{name:"",colors:[]}),!n.colors&&n.segmentedData&&(n.colors=function(e,t,n){var i,r=[];n=null===n?1:n;var o=d(t=null===t?256:t,e.red,n),l=d(t,e.green,n),c=d(t,e.blue,n);for(i=0;i<t;i++){var f=[Math.round(255*o[i]),Math.round(255*l[i]),Math.round(255*c[i]),255];r.push(f)}return r}(n.segmentedData,n.numColors,n.gamma)),{getId:function(){return e},getColorSchemeName:function(){return n.name},setColorSchemeName:function(e){n.name=e},getNumberOfColors:function(){return n.colors.length},setNumberOfColors:function(e){for(;n.colors.length<e;)n.colors.push(o);n.colors.length=e},getColor:function(e){return this.isValidIndex(e)?n.colors[e]:o},getColorRepeating:function(e){var t=n.colors.length;return e=t?e%t:0,this.getColor(e)},setColor:function(e,t){this.isValidIndex(e)&&(n.colors[e]=t)},addColor:function(e){n.colors.push(e)},insertColor:function(e,t){this.isValidIndex(e)&&n.colors.splice(e,1,t)},removeColor:function(e){this.isValidIndex(e)&&n.colors.splice(e,1)},clearColors:function(){n.colors=[]},buildLookupTable:function(e){if(e){var t=n.colors.length;e.setNumberOfTableValues(t);for(var i=0;i<t;i++)e.setTableValue(i,n.colors[i])}},createLookupTable:function(){var e=new r.default;return this.buildLookupTable(e),e},isValidIndex:function(e){return e>=0&&e<n.colors.length}}}},"./colors/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./colors/colormap.js"),o=n("./colors/lookupTable.js");t.default={getColormap:r.getColormap,getColormapsList:r.getColormapsList,LookupTable:o.default}},"./colors/lookupTable.js":function(e,t,n){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,n){if(e>1)throw new Error("HSVToRGB expects hue < 1");var r=[];if(0===t)return r[0]=n,r[1]=n,r[2]=n,r;var o=Math.floor(6*e),l=6*e-o,c=n*(1-t),d=n*(1-t*l),f=n*(1-t*(1-l));switch(o){case 0:case 6:r[0]=n,r[1]=f,r[2]=c;break;case 1:r[0]=d,r[1]=n,r[2]=c;break;case 2:r[0]=c,r[1]=n,r[2]=f;break;case 3:r[0]=c,r[1]=d,r[2]=n;break;case 4:r[0]=f,r[1]=c,r[2]=n;break;case 5:r[0]=n,r[1]=c,r[2]=d}return r}n.r(t);var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.NumberOfColors=256,this.Ramp="linear",this.TableRange=[0,255],this.HueRange=[0,.66667],this.SaturationRange=[1,1],this.ValueRange=[1,1],this.AlphaRange=[1,1],this.NaNColor=[128,0,0,255],this.BelowRangeColor=[0,0,0,255],this.UseBelowRangeColor=!0,this.AboveRangeColor=[255,255,255,255],this.UseAboveRangeColor=!0,this.InputRange=[0,255],this.Table=[]}var t,n,l;return t=e,n=[{key:"setNumberOfTableValues",value:function(e){this.NumberOfColors=e}},{key:"setRamp",value:function(e){this.Ramp=e}},{key:"setTableRange",value:function(e,t){this.TableRange[0]=e,this.TableRange[1]=t}},{key:"setHueRange",value:function(e,t){this.HueRange[0]=e,this.HueRange[1]=t}},{key:"setSaturationRange",value:function(e,t){this.SaturationRange[0]=e,this.SaturationRange[1]=t}},{key:"setValueRange",value:function(e,t){this.ValueRange[0]=e,this.ValueRange[1]=t}},{key:"setRange",value:function(e,t){this.InputRange[0]=e,this.InputRange[1]=t}},{key:"setAlphaRange",value:function(e,t){this.AlphaRange[0]=e,this.AlphaRange[1]=t}},{key:"getColor",value:function(e){return this.mapValue(e)}},{key:"build",value:function(e){if(!(this.Table.length>1)||e){this.Table=[];var t,n,r,l,c=this.NumberOfColors-1;c?(t=(this.HueRange[1]-this.HueRange[0])/c,n=(this.SaturationRange[1]-this.SaturationRange[0])/c,r=(this.ValueRange[1]-this.ValueRange[0])/c,l=(this.AlphaRange[1]-this.AlphaRange[0])/c):t=n=r=l=0;for(var i=0;i<=c;i++){var d=this.HueRange[0]+i*t,f=this.SaturationRange[0]+i*n,h=this.ValueRange[0]+i*r,m=this.AlphaRange[0]+i*l,v=o(d,f,h),y=[];switch(this.Ramp){case"scurve":y[0]=Math.floor(127.5*(1+Math.cos((1-v[0])*Math.PI))),y[1]=Math.floor(127.5*(1+Math.cos((1-v[1])*Math.PI))),y[2]=Math.floor(127.5*(1+Math.cos((1-v[2])*Math.PI))),y[3]=Math.floor(255*m);break;case"linear":y[0]=Math.floor(255*v[0]+.5),y[1]=Math.floor(255*v[1]+.5),y[2]=Math.floor(255*v[2]+.5),y[3]=Math.floor(255*m+.5);break;case"sqrt":y[0]=Math.floor(255*Math.sqrt(v[0])+.5),y[1]=Math.floor(255*Math.sqrt(v[1])+.5),y[2]=Math.floor(255*Math.sqrt(v[2])+.5),y[3]=Math.floor(255*Math.sqrt(m)+.5);break;default:throw new Error("Invalid Ramp value (".concat(this.Ramp,")"))}this.Table.push(y)}this.buildSpecialColors()}}},{key:"buildSpecialColors",value:function(){var e=this.NumberOfColors,t=e+0,n=e+1,r=e+2;this.UseBelowRangeColor||0===e?this.Table[t]=this.BelowRangeColor:this.Table[t]=this.Table[0],this.UseAboveRangeColor||0===e?this.Table[n]=this.AboveRangeColor:this.Table[n]=this.Table[e-1],this.Table[r]=this.NaNColor}},{key:"mapValue",value:function(e){var t=this.getIndex(e);if(t<0)return this.NaNColor;if(0===t){if(this.UseBelowRangeColor&&e<this.TableRange[0])return this.BelowRangeColor}else if(t===this.NumberOfColors-1&&this.UseAboveRangeColor&&e>this.TableRange[1])return this.AboveRangeColor;return this.Table[t]}},{key:"getIndex",value:function(e){var p={Range:[]};if(p.MaxIndex=this.NumberOfColors-1,p.Shift=-this.TableRange[0],this.TableRange[1]<=this.TableRange[0]?p.Scale=Number.MAX_VALUE:p.Scale=p.MaxIndex/(this.TableRange[1]-this.TableRange[0]),p.Range[0]=this.TableRange[0],p.Range[1]=this.TableRange[1],isNaN(e))return-1;var t=function(e,p){var t;return t=e<p.Range[0]?p.MaxIndex+0+1.5:e>p.Range[1]?p.MaxIndex+1+1.5:(e+p.Shift)*p.Scale,Math.floor(t)}(e,p);return t===this.NumberOfColors+0?t=0:t===this.NumberOfColors+1&&(t=this.NumberOfColors-1),t}},{key:"setTableValue",value:function(e,t){if(5===arguments.length&&(t=Array.prototype.slice.call(arguments,1)),e<0)throw new Error("Can't set the table value for negative index (".concat(e,")"));e>=this.NumberOfColors&&new Error("Index ".concat(e," is greater than the number of colors ").concat(this.NumberOfColors)),this.Table[e]=t,0!==e&&e!==this.NumberOfColors-1||this.buildSpecialColors()}}],n&&r(t.prototype,n),l&&r(t,l),e}();t.default=l},"./disable.js":function(e,t,n){"use strict";n.r(t);var r=n("./enabledElements.js"),o=n("./triggerEvent.js"),l=n("./events.js");t.default=function(element){if(void 0===element)throw new Error("disable: element must not be undefined");for(var e=Object(r.getEnabledElements)(),i=0;i<e.length;i++)if(e[i].element===element){var t={element:element};Object(o.default)(element,l.default.ELEMENT_DISABLED,t),Object(o.default)(l.events,l.default.ELEMENT_DISABLED,t),e[i].element.removeChild(e[i].canvas),e[i].canvas=void 0,e.splice(i,1);break}}},"./displayImage.js":function(e,t,n){"use strict";n.r(t);var r=n("./enabledElements.js"),o=n("./internal/getDefaultViewport.js"),l=n("./updateImage.js"),c=n("./internal/now.js"),d=n("./layers.js"),f=n("./triggerEvent.js"),h=n("./events.js");t.default=function(element,image,e){if(void 0===element)throw new Error("displayImage: parameter element must not be undefined");if(void 0===image)throw new Error("displayImage: parameter image must not be undefined");var t,n=Object(r.getEnabledElement)(element),m=n.image;if(n.image=image,n.layers&&n.layers.length&&Object(d.setLayerImage)(element,image),void 0===n.viewport&&(n.viewport=Object(o.default)(n.canvas,image)),e)for(var v in e)null!==e[v]&&(n.viewport[v]=e[v]);void 0!==n.lastImageTimeStamp&&(t=(1e3/(Object(c.default)()-n.lastImageTimeStamp)).toFixed()),n.lastImageTimeStamp=Object(c.default)();var y={viewport:n.viewport,element:n.element,image:n.image,oldImage:m,enabledElement:n,frameRate:t};Object(f.default)(n.element,h.default.NEW_IMAGE,y),Object(l.default)(element)}},"./draw.js":function(e,t,n){"use strict";n.r(t);var r=n("./enabledElements.js"),o=n("./internal/drawImage.js");t.default=function(element){var e=Object(r.getEnabledElement)(element);Object(o.default)(e)}},"./drawInvalidated.js":function(e,t,n){"use strict";n.r(t);var r=n("./enabledElements.js"),o=n("./internal/drawImage.js");t.default=function(){for(var e=Object(r.getEnabledElements)(),i=0;i<e.length;i++){var t=e[i];!0===t.invalid&&Object(o.default)(t,!0)}}},"./enable.js":function(e,t,n){"use strict";n.r(t);var r=n("./enabledElements.js"),o=n("./resize.js"),l=n("./internal/drawImageSync.js"),c=n("./internal/requestAnimationFrame.js"),d=n("./internal/tryEnableWebgl.js"),f=n("./triggerEvent.js"),h=n("./generateUUID.js"),m=n("./events.js"),v=n("./internal/getCanvas.js");t.default=function(element,e){if(void 0===element)throw new Error("enable: parameter element cannot be undefined");e&&e.renderer&&"webgl"===e.renderer.toLowerCase()&&Object(d.default)(e);var t={element:element,canvas:Object(v.default)(element),image:void 0,invalid:!1,needsRedraw:!0,options:Object.assign({},e),layers:[],data:{},renderingTools:{},uuid:Object(h.default)()};Object(r.addEnabledElement)(t),Object(f.default)(m.events,m.default.ELEMENT_ENABLED,t),Object(o.default)(element,!0),function e(n){if(void 0!==t.canvas){var r={enabledElement:t,timestamp:n};Object(f.default)(t.element,m.default.PRE_RENDER,r),t.needsRedraw&&function(e){return void 0!==e.image||e.layers.length>0}(t)&&Object(l.default)(t,t.invalid),Object(c.default)(e)}}()}},"./enabledElementData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getElementData",(function(){return o})),n.d(t,"removeElementData",(function(){return l}));var r=n("./enabledElements.js");function o(element,e){var t=Object(r.getEnabledElement)(element);return!1===t.data.hasOwnProperty(e)&&(t.data[e]={}),t.data[e]}function l(element,e){delete Object(r.getEnabledElement)(element).data[e]}},"./enabledElements.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getEnabledElement",(function(){return o})),n.d(t,"addEnabledElement",(function(){return l})),n.d(t,"getEnabledElementsByImageId",(function(){return c})),n.d(t,"getEnabledElements",(function(){return d}));var r=[];function o(element){if(void 0===element)throw new Error("getEnabledElement: parameter element must not be undefined");for(var i=0;i<r.length;i++)if(r[i].element===element)return r[i];throw new Error("element not enabled")}function l(e){if(void 0===e)throw new Error("getEnabledElement: enabledElement element must not be undefined");r.push(e)}function c(e){var t=[];return r.forEach((function(n){n.image&&n.image.imageId===e&&t.push(n)})),t}function d(){return r}},"./events.js":function(e,t,n){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}n.r(t),n.d(t,"events",(function(){return o})),t.default={NEW_IMAGE:"cornerstonenewimage",INVALIDATED:"cornerstoneinvalidated",PRE_RENDER:"cornerstoneprerender",IMAGE_CACHE_MAXIMUM_SIZE_CHANGED:"cornerstoneimagecachemaximumsizechanged",IMAGE_CACHE_PROMISE_REMOVED:"cornerstoneimagecachepromiseremoved",IMAGE_CACHE_FULL:"cornerstoneimagecachefull",IMAGE_CACHE_CHANGED:"cornerstoneimagecachechanged",WEBGL_TEXTURE_REMOVED:"cornerstonewebgltextureremoved",WEBGL_TEXTURE_CACHE_FULL:"cornerstonewebgltexturecachefull",IMAGE_LOADED:"cornerstoneimageloaded",IMAGE_LOAD_PROGRESS:"cornerstoneimageloadprogress",IMAGE_LOAD_FAILED:"cornerstoneimageloadfailed",ELEMENT_RESIZED:"cornerstoneelementresized",IMAGE_RENDERED:"cornerstoneimagerendered",LAYER_ADDED:"cornerstonelayeradded",LAYER_REMOVED:"cornerstonelayerremoved",ACTIVE_LAYER_CHANGED:"cornerstoneactivelayerchanged",ELEMENT_DISABLED:"cornerstoneelementdisabled",ELEMENT_ENABLED:"cornerstoneelementenabled"};var o=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listeners={},this.namespaces={}}var t,n,o;return t=e,(n=[{key:"addEventNamespaceListener",value:function(e,t){e.indexOf(".")<=0||(this.namespaces[e]=t,this.addEventListener(e.split(".")[0],t))}},{key:"removeEventNamespaceListener",value:function(e){e.indexOf(".")<=0||!this.namespaces[e]||(this.removeEventListener(e.split(".")[0],this.namespaces[e]),delete this.namespaces[e])}},{key:"addEventListener",value:function(e,t){e.indexOf(".")>0?this.addEventNamespaceListener(e,t):(e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t))}},{key:"removeEventListener",value:function(e,t){if(e.indexOf(".")>0)this.removeEventNamespaceListener(e);else if(e in this.listeners)for(var n=this.listeners[e],i=0,r=n.length;i<r;i++)if(n[i]===t)return void n.splice(i,1)}},{key:"dispatchEvent",value:function(e){if(!(e.type in this.listeners))return!0;for(var t=this.listeners[e.type].slice(),i=0,n=t.length;i<n;i++)t[i].call(this,e);return!e.defaultPrevented}}])&&r(t.prototype,n),o&&r(t,o),e}())},"./falseColorMapping.js":function(e,t,n){"use strict";n.r(t),n.d(t,"convertImageToFalseColorImage",(function(){return d})),n.d(t,"convertToFalseColorImage",(function(){return f})),n.d(t,"restoreImage",(function(){return c}));var r=n("./enabledElements.js"),o=n("./pixelDataToFalseColorData.js"),l=n("./colors/colormap.js");function c(image){return!(!image.restore||"function"!=typeof image.restore||(image.restore(),0))}function d(image,e){if(image.color&&!image.falseColor)throw new Error("Color transforms are not implemented yet");var t=(e=function(e){return e&&"string"==typeof e&&(e=Object(l.getColormap)(e)),e}(e)).getId();if(image.colormapId===t)return!1;if(c(image),t){var n=image.minPixelValue||0,r=image.maxPixelValue||255;image.restore=function(image){if(image.restore)return image.restore;var e=image.color,t=image.rgba,n=image.cachedLut,r=image.slope,o=image.windowWidth,l=image.windowCenter,c=image.minPixelValue,d=image.maxPixelValue;return function(){if(image.color=e,image.rgba=t,image.cachedLut=n,image.slope=r,image.windowWidth=o,image.windowCenter=l,image.minPixelValue=c,image.maxPixelValue=d,image.origPixelData){var f=image.origPixelData;image.getPixelData=function(){return f}}image.origPixelData=void 0,image.colormapId=void 0,image.falseColor=void 0}}(image);var d=e.createLookupTable();d.setTableRange(n,r),Object(o.default)(image,d);var f=function(e){for(var t,n=Number.MAX_VALUE,r=Number.MIN_VALUE,o=e.length,i=0;i<o;i++)n=n<(t=e[i])?n:t,r=r>t?r:t;return{minPixelValue:n,maxPixelValue:r}}(image.getPixelData());image.minPixelValue=f.minPixelValue,image.maxPixelValue=f.maxPixelValue,image.windowWidth=255,image.windowCenter=128,image.colormapId=t}return!0}function f(element,e){return d(Object(r.getEnabledElement)(element).image,e)}},"./fitToWindow.js":function(e,t,n){"use strict";n.r(t);var r=n("./enabledElements.js"),o=n("./updateImage.js"),l=n("./internal/getImageFitScale.js");t.default=function(element){var e=Object(r.getEnabledElement)(element),image=e.image;e.viewport.scale=Object(l.default)(e.canvas,image,e.viewport.rotation).scaleFactor,e.viewport.translation.x=0,e.viewport.translation.y=0,Object(o.default)(element)}},"./generateUUID.js":function(e,t,n){"use strict";n.r(t),t.default=function(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"x.x.x.x.x.x.xxxx.xxx.x.x.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}},"./getDefaultViewportForImage.js":function(e,t,n){"use strict";n.r(t);var r=n("./enabledElements.js"),o=n("./internal/getDefaultViewport.js");t.default=function(element,image){var e=Object(r.getEnabledElement)(element);return Object(o.default)(e.canvas,image)}},"./getImage.js":function(e,t,n){"use strict";n.r(t);var r=n("./enabledElements.js");t.default=function(element){return Object(r.getEnabledElement)(element).image}},"./getPixels.js":function(e,t,n){"use strict";n.r(t);var r=n("./enabledElements.js"),o=n("./getStoredPixels.js"),l=n("./internal/getModalityLUT.js");t.default=function(element,e,t,n,c){var d=Object(o.default)(element,e,t,n,c),f=Object(r.getEnabledElement)(element),h=Object(l.default)(f.image.slope,f.image.intercept,f.viewport.modalityLUT);return d.map(h)}},"./getStoredPixels.js":function(e,t,n){"use strict";n.r(t);var r=n("./enabledElements.js");t.default=function(element,e,t,n,o){if(void 0===element)throw new Error("getStoredPixels: parameter element must not be undefined");e=Math.round(e),t=Math.round(t);for(var l=Object(r.getEnabledElement)(element),c=[],d=0,f=l.image.getPixelData(),h=0;h<o;h++)for(var m=0;m<n;m++){var v=(h+t)*l.image.columns+(m+e);c[d++]=f[v]}return c}},"./getViewport.js":function(e,t,n){"use strict";n.r(t);var r=n("./enabledElements.js");t.default=function(element){var e=Object(r.getEnabledElement)(element).viewport;if(void 0!==e)return Object.assign({},e)}},"./imageCache.js":function(e,t,n){"use strict";n.r(t),n.d(t,"cachedImages",(function(){return f})),n.d(t,"setMaximumSizeBytes",(function(){return h})),n.d(t,"putImageLoadObject",(function(){return v})),n.d(t,"getImageLoadObject",(function(){return y})),n.d(t,"removeImageLoadObject",(function(){return x})),n.d(t,"getCacheInfo",(function(){return j})),n.d(t,"purgeCache",(function(){return w})),n.d(t,"changeImageIdCacheSize",(function(){return T}));var r=n("./events.js"),o=n("./triggerEvent.js"),l=1073741824,c=0,d={},f=[];function h(e){if(void 0===e)throw new Error("setMaximumSizeBytes: parameter numBytes must not be undefined");if(void 0===e.toFixed)throw new Error("setMaximumSizeBytes: parameter numBytes must be a number");l=e,Object(o.default)(r.events,r.default.IMAGE_CACHE_MAXIMUM_SIZE_CHANGED),m()}function m(){if(!(c<=l)){for(f.sort((function(a,b){return a.timeStamp>b.timeStamp?-1:a.timeStamp<b.timeStamp?1:0}));c>l;){var e=f[f.length-1].imageId;x(e),Object(o.default)(r.events,r.default.IMAGE_CACHE_PROMISE_REMOVED,{imageId:e})}var t=j();Object(o.default)(r.events,r.default.IMAGE_CACHE_FULL,t)}}function v(e,t){if(void 0===e)throw new Error("putImageLoadObject: imageId must not be undefined");if(void 0===t.promise)throw new Error("putImageLoadObject: imageLoadObject.promise must not be undefined");if(!0===d.hasOwnProperty(e))throw new Error("putImageLoadObject: imageId already in cache");if(t.cancelFn&&"function"!=typeof t.cancelFn)throw new Error("putImageLoadObject: imageLoadObject.cancelFn must be a function");var n={loaded:!1,imageId:e,sharedCacheKey:void 0,imageLoadObject:t,timeStamp:Date.now(),sizeInBytes:0};d[e]=n,f.push(n),t.promise.then((function(image){if(-1!==f.indexOf(n)){if(n.loaded=!0,n.image=image,void 0===image.sizeInBytes)throw new Error("putImageLoadObject: image.sizeInBytes must not be undefined");if(void 0===image.sizeInBytes.toFixed)throw new Error("putImageLoadObject: image.sizeInBytes is not a number");n.sizeInBytes=image.sizeInBytes,c+=n.sizeInBytes;var e={action:"addImage",image:n};Object(o.default)(r.events,r.default.IMAGE_CACHE_CHANGED,e),n.sharedCacheKey=image.sharedCacheKey,m()}}),(function(){var t=d[e];f.splice(f.indexOf(t),1),delete d[e]}))}function y(e){if(void 0===e)throw new Error("getImageLoadObject: imageId must not be undefined");var t=d[e];if(void 0!==t)return t.timeStamp=Date.now(),t.imageLoadObject}function x(e){if(void 0===e)throw new Error("removeImageLoadObject: imageId must not be undefined");var t=d[e];if(void 0===t)throw new Error("removeImageLoadObject: imageId was not present in imageCache");f.splice(f.indexOf(t),1),c-=t.sizeInBytes;var n,l={action:"deleteImage",image:t};Object(o.default)(r.events,r.default.IMAGE_CACHE_CHANGED,l),(n=t.imageLoadObject).promise.then((function(){n.decache&&n.decache()}),(function(){n.decache&&n.decache()})),delete d[e]}function j(){return{maximumSizeInBytes:l,cacheSizeInBytes:c,numberOfImagesCached:f.length}}function w(){for(;f.length>0;)x(f[0].imageId)}function T(e,t){var n=d[e];n&&n.imageLoadObject.promise.then((function(image){var e=t-image.sizeInBytes;image.sizeInBytes=t,n.sizeInBytes=t,c+=e;var l={action:"changeImageSize",image:image};Object(o.default)(r.events,r.default.IMAGE_CACHE_CHANGED,l)}))}t.default={imageCache:d,cachedImages:f,setMaximumSizeBytes:h,putImageLoadObject:v,getImageLoadObject:y,removeImageLoadObject:x,getCacheInfo:j,purgeCache:w,changeImageIdCacheSize:T}},"./imageLoader.js":function(e,t,n){"use strict";n.r(t),n.d(t,"loadImage",(function(){return h})),n.d(t,"loadAndCacheImage",(function(){return m})),n.d(t,"registerImageLoader",(function(){return v})),n.d(t,"registerUnknownImageLoader",(function(){return y}));var r,o=n("./imageCache.js"),l=n("./events.js"),c=n("./triggerEvent.js"),d={};function f(e,t){var n=e.indexOf(":"),o=e.substring(0,n),f=d[o];if(null==f){if(void 0!==r)return r(e);throw new Error("loadImageFromImageLoader: no image loader for imageId")}var h=f(e,t);return h.promise.then((function(image){Object(c.default)(l.events,l.default.IMAGE_LOADED,{image:image})}),(function(t){var n={imageId:e,error:t};Object(c.default)(l.events,l.default.IMAGE_LOAD_FAILED,n)})),h}function h(e,t){if(void 0===e)throw new Error("loadImage: parameter imageId must not be undefined");var n=Object(o.getImageLoadObject)(e);return void 0!==n?n.promise:f(e,t).promise}function m(e,t){if(void 0===e)throw new Error("loadAndCacheImage: parameter imageId must not be undefined");var n=Object(o.getImageLoadObject)(e);return void 0!==n||(n=f(e,t),Object(o.putImageLoadObject)(e,n)),n.promise}function v(e,t){d[e]=t}function y(e){var t=r;return r=e,t}},"./index.js":function(e,t,n){"use strict";n.r(t);var r=n("./events.js");n.d(t,"EVENTS",(function(){return r.default})),n.d(t,"events",(function(){return r.events}));var o=n("./enabledElements.js");n.d(t,"getEnabledElement",(function(){return o.getEnabledElement})),n.d(t,"addEnabledElement",(function(){return o.addEnabledElement})),n.d(t,"getEnabledElementsByImageId",(function(){return o.getEnabledElementsByImageId})),n.d(t,"getEnabledElements",(function(){return o.getEnabledElements}));var l=n("./layers.js");n.d(t,"addLayer",(function(){return l.addLayer})),n.d(t,"removeLayer",(function(){return l.removeLayer})),n.d(t,"getLayer",(function(){return l.getLayer})),n.d(t,"getLayers",(function(){return l.getLayers})),n.d(t,"getVisibleLayers",(function(){return l.getVisibleLayers})),n.d(t,"setActiveLayer",(function(){return l.setActiveLayer})),n.d(t,"getActiveLayer",(function(){return l.getActiveLayer})),n.d(t,"purgeLayers",(function(){return l.purgeLayers})),n.d(t,"setLayerImage",(function(){return l.setLayerImage}));var c=n("./falseColorMapping.js");n.d(t,"convertImageToFalseColorImage",(function(){return c.convertImageToFalseColorImage})),n.d(t,"convertToFalseColorImage",(function(){return c.convertToFalseColorImage})),n.d(t,"restoreImage",(function(){return c.restoreImage}));var d=n("./enabledElementData.js");n.d(t,"getElementData",(function(){return d.getElementData})),n.d(t,"removeElementData",(function(){return d.removeElementData}));var f=n("./imageLoader.js");n.d(t,"loadImage",(function(){return f.loadImage})),n.d(t,"loadAndCacheImage",(function(){return f.loadAndCacheImage})),n.d(t,"registerImageLoader",(function(){return f.registerImageLoader})),n.d(t,"registerUnknownImageLoader",(function(){return f.registerUnknownImageLoader}));var h=n("./requestPool/imageLoadPoolManager.ts");n.d(t,"imageLoadPoolManager",(function(){return h.default}));var m=n("./requestPool/imageRetrievalPoolManager.ts");n.d(t,"imageRetrievalPoolManager",(function(){return m.default}));var v=n("./requestPool/RequestPoolManager.ts");n.d(t,"RequestPoolManager",(function(){return v.RequestPoolManager}));var y=n("./canvasToPixel.js");n.d(t,"canvasToPixel",(function(){return y.default}));var x=n("./colors/index.js");n.d(t,"colors",(function(){return x.default}));var j=n("./disable.js");n.d(t,"disable",(function(){return j.default}));var w=n("./displayImage.js");n.d(t,"displayImage",(function(){return w.default}));var T=n("./draw.js");n.d(t,"draw",(function(){return T.default}));var E=n("./internal/drawImage.js");n.d(t,"drawImage",(function(){return E.default}));var O=n("./drawInvalidated.js");n.d(t,"drawInvalidated",(function(){return O.default}));var C=n("./enable.js");n.d(t,"enable",(function(){return C.default}));var S=n("./fitToWindow.js");n.d(t,"fitToWindow",(function(){return S.default}));var I=n("./internal/generateLut.js");n.d(t,"generateLut",(function(){return I.default}));var M=n("./internal/getDefaultViewport.js");n.d(t,"getDefaultViewport",(function(){return M.default}));var P=n("./getDefaultViewportForImage.js");n.d(t,"getDefaultViewportForImage",(function(){return P.default}));var _=n("./internal/getDisplayedArea.js");n.d(t,"getDisplayedArea",(function(){return _.default}));var D=n("./getImage.js");n.d(t,"getImage",(function(){return D.default}));var k=n("./getPixels.js");n.d(t,"getPixels",(function(){return k.default}));var L=n("./getStoredPixels.js");n.d(t,"getStoredPixels",(function(){return L.default}));var A=n("./getViewport.js");n.d(t,"getViewport",(function(){return A.default}));var R=n("./imageCache.js");n.d(t,"imageCache",(function(){return R.default}));var B=n("./internal/index.js");n.d(t,"internal",(function(){return B.default}));var U=n("./invalidate.js");n.d(t,"invalidate",(function(){return U.default}));var F=n("./invalidateImageId.js");n.d(t,"invalidateImageId",(function(){return F.default}));var H=n("./metaData.js");n.d(t,"metaData",(function(){return H.default}));var N=n("./pageToPixel.js");n.d(t,"pageToPixel",(function(){return N.default}));var z=n("./pixelDataToFalseColorData.js");n.d(t,"pixelDataToFalseColorData",(function(){return z.default}));var V=n("./pixelToCanvas.js");n.d(t,"pixelToCanvas",(function(){return V.default}));var W=n("./rendering/renderColorImage.js");n.d(t,"renderColorImage",(function(){return W.renderColorImage}));var G=n("./rendering/renderGrayscaleImage.js");n.d(t,"renderGrayscaleImage",(function(){return G.renderGrayscaleImage}));var Y=n("./rendering/renderLabelMapImage.js");n.d(t,"renderLabelMapImage",(function(){return Y.renderLabelMapImage}));var X=n("./rendering/renderPseudoColorImage.js");n.d(t,"renderPseudoColorImage",(function(){return X.renderPseudoColorImage}));var Z=n("./rendering/renderToCanvas.js");n.d(t,"renderToCanvas",(function(){return Z.default}));var K=n("./rendering/renderWebImage.js");n.d(t,"renderWebImage",(function(){return K.renderWebImage}));var J=n("./rendering/index.js");n.d(t,"rendering",(function(){return J.default}));var $=n("./internal/requestAnimationFrame.js");n.d(t,"requestAnimationFrame",(function(){return $.default}));var Q=n("./reset.js");n.d(t,"reset",(function(){return Q.default}));var ee=n("./resize.js");n.d(t,"resize",(function(){return ee.default}));var te=n("./internal/setDefaultViewport.js");n.d(t,"setDefaultViewport",(function(){return te.default}));var ne=n("./setToPixelCoordinateSystem.js");n.d(t,"setToPixelCoordinateSystem",(function(){return ne.default}));var ae=n("./setViewport.js");n.d(t,"setViewport",(function(){return ae.default}));var re=n("./internal/storedColorPixelDataToCanvasImageData.js");n.d(t,"storedColorPixelDataToCanvasImageData",(function(){return re.default}));var oe=n("./internal/storedPixelDataToCanvasImageData.js");n.d(t,"storedPixelDataToCanvasImageData",(function(){return oe.default}));var ie=n("./internal/storedPixelDataToCanvasImageDataColorLUT.js");n.d(t,"storedPixelDataToCanvasImageDataColorLUT",(function(){return ie.default}));var se=n("./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js");n.d(t,"storedPixelDataToCanvasImageDataPseudocolorLUT",(function(){return se.default}));var le=n("./triggerEvent.js");n.d(t,"triggerEvent",(function(){return le.default}));var ue=n("./updateImage.js");n.d(t,"updateImage",(function(){return ue.default}));var ce=n("./webgl/index.js");n.d(t,"webGL",(function(){return ce.default}));var de={drawImage:E.default,generateLut:I.default,getDefaultViewport:M.default,requestAnimationFrame:$.default,storedPixelDataToCanvasImageData:oe.default,storedColorPixelDataToCanvasImageData:re.default,storedPixelDataToCanvasImageDataColorLUT:ie.default,storedPixelDataToCanvasImageDataPseudocolorLUT:se.default,internal:B.default,renderLabelMapImage:Y.renderLabelMapImage,renderPseudoColorImage:X.renderPseudoColorImage,renderColorImage:W.renderColorImage,renderGrayscaleImage:G.renderGrayscaleImage,renderWebImage:K.renderWebImage,renderToCanvas:Z.default,canvasToPixel:y.default,disable:j.default,displayImage:w.default,draw:T.default,drawInvalidated:O.default,enable:C.default,getElementData:d.getElementData,removeElementData:d.removeElementData,getEnabledElement:o.getEnabledElement,addEnabledElement:o.addEnabledElement,getEnabledElementsByImageId:o.getEnabledElementsByImageId,getEnabledElements:o.getEnabledElements,addLayer:l.addLayer,removeLayer:l.removeLayer,getLayer:l.getLayer,getLayers:l.getLayers,getVisibleLayers:l.getVisibleLayers,setActiveLayer:l.setActiveLayer,getActiveLayer:l.getActiveLayer,purgeLayers:l.purgeLayers,setLayerImage:l.setLayerImage,fitToWindow:S.default,getDefaultViewportForImage:P.default,getDisplayedArea:_.default,setDefaultViewport:te.default,getImage:D.default,getPixels:k.default,getStoredPixels:L.default,getViewport:A.default,loadImage:f.loadImage,loadAndCacheImage:f.loadAndCacheImage,registerImageLoader:f.registerImageLoader,registerUnknownImageLoader:f.registerUnknownImageLoader,invalidate:U.default,invalidateImageId:F.default,pageToPixel:N.default,pixelToCanvas:V.default,reset:Q.default,resize:ee.default,setToPixelCoordinateSystem:ne.default,setViewport:ae.default,updateImage:ue.default,pixelDataToFalseColorData:z.default,rendering:J.default,imageCache:R.default,metaData:H.default,webGL:ce.default,colors:x.default,convertImageToFalseColorImage:c.convertImageToFalseColorImage,convertToFalseColorImage:c.convertToFalseColorImage,restoreImage:c.restoreImage,EVENTS:r.default,events:r.events,triggerEvent:le.default,imageLoadPoolManager:h.default,imageRetrievalPoolManager:m.default,RequestPoolManager:v.RequestPoolManager};t.default=de},"./internal/calculateTransform.js":function(e,t,n){"use strict";n.r(t);var r=n("./internal/transform.js"),o=n("./internal/getDisplayedArea.js");t.default=function(e,t){var n=new r.Transform;n.translate(e.canvas.width/2,e.canvas.height/2);var l=e.viewport.rotation;0!==l&&n.rotate(l*Math.PI/180);var c=e.viewport.scale,d=e.viewport.scale,f=Object(o.default)(e.image,e.viewport),h=f.tlhc.x-1,m=f.tlhc.y-1,v=f.brhc.x-h,y=f.brhc.y-m;if("NONE"===f.presentationSizeMode)e.image.rowPixelSpacing<e.image.columnPixelSpacing?c*=e.image.columnPixelSpacing/e.image.rowPixelSpacing:e.image.columnPixelSpacing<e.image.rowPixelSpacing&&(d*=e.image.rowPixelSpacing/e.image.columnPixelSpacing);else if(c=f.columnPixelSpacing,d=f.rowPixelSpacing,"SCALE TO FIT"===f.presentationSizeMode){var x=e.canvas.height/(y*d),j=e.canvas.width/(v*c);c=d=Math.min(j,x),f.rowPixelSpacing<f.columnPixelSpacing?c*=f.columnPixelSpacing/f.rowPixelSpacing:f.columnPixelSpacing<f.rowPixelSpacing&&(d*=f.rowPixelSpacing/f.columnPixelSpacing)}return n.scale(c,d),0!==l&&n.rotate(-l*Math.PI/180),n.translate(e.viewport.translation.x,e.viewport.translation.y),0!==l&&n.rotate(l*Math.PI/180),void 0!==t&&n.scale(t,t),e.viewport.hflip&&n.scale(-1,1),e.viewport.vflip&&n.scale(1,-1),n.translate(-v/2,-y/2),n.translate(-h,-m),n}},"./internal/computeAutoVoi.js":function(e,t,n){"use strict";function r(e,image){if(!function(e){return e.voiLUT&&e.voiLUT.lut&&e.voiLUT.lut.length>0||void 0!==e.voi.windowWidth&&void 0!==e.voi.windowCenter}(e)){var t=image.maxPixelValue*image.slope+image.intercept,n=image.minPixelValue*image.slope+image.intercept,r=t-n,o=(t+n)/2;void 0===e.voi?e.voi={windowWidth:r,windowCenter:o}:(e.voi.windowWidth=r,e.voi.windowCenter=o)}}n.r(t),n.d(t,"default",(function(){return r}))},"./internal/createViewport.js":function(e,t,n){"use strict";n.r(t);var r=n("./internal/setDefaultViewport.js");t.default=function(){var e={scale:1,translation:{x:0,y:0},voi:{windowWidth:void 0,windowCenter:void 0},invert:!1,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:void 0,voiLUT:void 0,colormap:void 0,labelmap:!1,displayedArea:void 0};return Object.assign({},e,r.state.viewport)}},"./internal/drawCompositeImage.js":function(e,t,n){"use strict";n.r(t);var r=n("./layers.js"),o=n("./rendering/renderGrayscaleImage.js"),l=n("./rendering/renderColorImage.js"),c=n("./rendering/renderPseudoColorImage.js"),d=n("./rendering/renderLabelMapImage.js"),f=n("./setToPixelCoordinateSystem.js"),h=n("./internal/getDisplayedArea.js");function m(e){var t=e.syncProps||{};t.originalScale=e.viewport.scale,e.syncProps=t}function v(e,t){e.forEach((function(e){if(e!==t&&e.viewport&&t.viewport){e.syncProps||m(e);var n,r,o=(r=e,(n=t).syncProps||m(n),r.syncProps||m(r),r.syncProps.originalScale/n.syncProps.originalScale);e.viewport.scale=t.viewport.scale*o,e.viewport.rotation=t.viewport.rotation,e.viewport.translation={x:t.viewport.translation.x/o,y:t.viewport.translation.y/o},e.viewport.hflip=t.viewport.hflip,e.viewport.vflip=t.viewport.vflip}}))}t.default=function(e,t){var element=e.element,n=Object(r.getLayers)(element),y=Object(r.getActiveLayer)(element),x=Object(r.getVisibleLayers)(element),j=!e.lastSyncViewportsState&&e.syncViewports;e.lastSyncViewportsState=e.syncViewports,j&&n.forEach((function(e){e.viewport&&m(e)})),!0===e.syncViewports&&v(x,y);var w=e.canvas.getContext("2d",{desynchronized:!0});w.setTransform(1,0,0,1,0,0),w.fillStyle="black",w.fillRect(0,0,e.canvas.width,e.canvas.height),function(e,t,n){t.forEach((function(t,r){if(t.image){e.save(),t.canvas=e.canvas,Object(f.default)(t,e);var m=t.viewport.colormap||t.options.colormap,v=t.viewport.labelmap,y=t.invalid||n;if(m&&""!==m&&!0===v)Object(d.addLabelMapLayer)(t,y);else if(m&&""!==m)Object(c.addPseudoColorLayer)(t,y);else if(!0===t.image.color)Object(l.addColorLayer)(t,y);else{var x=0===r;Object(o.addGrayscaleLayer)(t,y,x)}t.options&&t.options.opacity?e.globalAlpha=t.options.opacity:e.globalAlpha=1,t.options&&t.options.fillStyle&&(e.fillStyle=t.options.fillStyle),e.imageSmoothingEnabled=!t.viewport.pixelReplication,e.mozImageSmoothingEnabled=e.imageSmoothingEnabled;var j=Object(h.default)(t.image,t.viewport),w=j.tlhc.x-1,T=j.tlhc.y-1,E=j.brhc.x-w,O=j.brhc.y-T;e.drawImage(t.canvas,w,T,E,O,w,T,E,O),e.restore(),t.invalid=!1}}))}(w,x,t)}},"./internal/drawImage.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.needsRedraw=!0,t&&(e.invalid=!0)}},"./internal/drawImageSync.js":function(e,t,n){"use strict";n.r(t);var r=n("./internal/now.js"),o=n("./internal/drawCompositeImage.js"),l=n("./rendering/renderColorImage.js"),c=n("./rendering/renderGrayscaleImage.js"),d=n("./rendering/renderPseudoColorImage.js"),f=n("./rendering/renderLabelMapImage.js"),h=n("./triggerEvent.js"),m=n("./events.js");t.default=function(e,t){var image=e.image,element=e.element,n=e.layers||[];if(e.canvas&&e.image){var v=Object(r.default)();if(image.stats={lastGetPixelDataTime:-1,lastStoredPixelDataToCanvasImageDataTime:-1,lastPutImageDataTime:-1,lastRenderTime:-1,lastLutGenerateTime:-1},n&&n.length)Object(o.default)(e,t);else if(image){var y=image.render;y||(y=e.viewport.colormap&&""!==e.viewport.colormap&&!0===e.image.labelmap?f.renderLabelMapImage:e.viewport.colormap&&""!==e.viewport.colormap?d.renderPseudoColorImage:image.color?l.renderColorImage:c.renderGrayscaleImage),y(e,t)}var x=Object(r.default)()-v,j={viewport:e.viewport,element:element,image:image,enabledElement:e,canvasContext:e.canvas.getContext("2d",{desynchronized:!0}),renderTimeInMs:x};image.stats.lastRenderTime=x,e.invalid=!1,e.needsRedraw=!1,Object(h.default)(element,m.default.IMAGE_RENDERED,j)}}},"./internal/generateColorLut.js":function(e,t,n){"use strict";n.r(t);var r=n("./internal/getVOILut.js");t.default=function(image,e,t,n,o){var l=image.maxPixelValue,c=image.minPixelValue,d=Math.min(c,0);if(void 0===image.cachedLut){var f=l-d+1;image.cachedLut={},image.cachedLut.lutArray=new Uint8ClampedArray(f)}var h=image.cachedLut.lutArray,m=Object(r.default)(e,t,o);if(!0===n)for(var v=c;v<=l;v++)h[v+-d]=255-m(v);else for(var y=c;y<=l;y++)h[y+-d]=m(y);return h}},"./internal/generateLut.js":function(e,t,n){"use strict";n.r(t);var r=n("./internal/getModalityLUT.js"),o=n("./internal/getVOILut.js");t.default=function(image,e,t,n,l,c){var d=image.maxPixelValue,f=image.minPixelValue,h=Math.min(f,0);if(void 0===image.cachedLut){var m=d-h+1;image.cachedLut={},image.cachedLut.lutArray=new Uint8ClampedArray(m)}var v=image.cachedLut.lutArray,y=Boolean(image.slope%1)||Boolean(image.intercept%1),x=Object(r.default)(image.slope,image.intercept,l),j=Object(o.default)(e,t,c,y);if(!0===n)for(var w=f;w<=d;w++)v[w+-h]=255-j(x(w));else for(var T=f;T<=d;T++)v[T+-h]=j(x(T));return v}},"./internal/getCanvas.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r="cornerstone-canvas";function o(element){var e="canvas.".concat(r);return element.querySelector(e)||function(element){var canvas=document.createElement("canvas");return canvas.style.display="block",canvas.classList.add(r),element.appendChild(canvas),canvas}(element)}},"./internal/getDefaultViewport.js":function(e,t,n){"use strict";n.r(t);var r=n("./internal/createViewport.js"),o=n("./internal/getImageFitScale.js");t.default=function(canvas,image){if(void 0===canvas)throw new Error("getDefaultViewport: parameter canvas must not be undefined");return void 0===image?Object(r.default)():{scale:Object(o.default)(canvas,image,0).scaleFactor,translation:{x:0,y:0},voi:{windowWidth:image.windowWidth,windowCenter:image.windowCenter},invert:image.invert,pixelReplication:!1,rotation:0,hflip:!1,vflip:!1,modalityLUT:image.modalityLUT,voiLUT:image.voiLUT,colormap:image.colormap,labelmap:Boolean(image.labelmap),displayedArea:void 0}}},"./internal/getDisplayedArea.js":function(e,t,n){"use strict";n.r(t),t.default=function(image){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e&&e.displayedArea)return e.displayedArea;if(void 0===image)throw new Error("getDisplayedArea: parameter image must not be undefined");return{tlhc:{x:1,y:1},brhc:{x:image.columns,y:image.rows},rowPixelSpacing:void 0===image.rowPixelSpacing?1:image.rowPixelSpacing,columnPixelSpacing:void 0===image.columnPixelSpacing?1:image.columnPixelSpacing,presentationSizeMode:"NONE"}}},"./internal/getFillStyle.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=(e.viewport||{}).invert,n=(e.options||{}).fillStyle;return-1!==["black","white"].indexOf(n)&&t?"white":"black"}},"./internal/getImageFitScale.js":function(e,t,n){"use strict";n.r(t);var r=n("./internal/validator.js"),o=n("./internal/getImageSize.js");t.default=function(e,image){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(r.validateParameterUndefinedOrNull)(e,"getImageScale: parameter windowSize must not be undefined"),Object(r.validateParameterUndefinedOrNull)(image,"getImageScale: parameter image must not be undefined");var n=Object(o.default)(image,t),l=image.rowPixelSpacing||1,c=image.columnPixelSpacing||1,d=1,f=1;l<c?f=c/l:d=l/c;var h=e.height/n.height/d,m=e.width/n.width/f;return{verticalScale:h,horizontalScale:m,scaleFactor:Math.min(m,h)}}},"./internal/getImageSize.js":function(e,t,n){"use strict";n.r(t);var r=n("./internal/validator.js");function o(e){return!(null==e||0===e||180===e)}t.default=function(image){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(r.validateParameterUndefinedOrNull)(image,"getImageSize: parameter image must not be undefined"),Object(r.validateParameterUndefinedOrNull)(image.width,"getImageSize: parameter image must have width"),Object(r.validateParameterUndefinedOrNull)(image.height,"getImageSize: parameter image must have height"),o(e)?{height:image.width,width:image.height}:{width:image.width,height:image.height}}},"./internal/getModalityLUT.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){return n?function(e){var t=e.lut[0],n=e.lut[e.lut.length-1],r=e.firstValueMapped+e.lut.length;return function(o){return o<e.firstValueMapped?t:o>=r?n:e.lut[o]}}(n):function(e,t){return function(n){return n*e+t}}(e,t)}},"./internal/getTransform.js":function(e,t,n){"use strict";n.r(t);var r=n("./internal/calculateTransform.js");t.default=function(e){return Object(r.default)(e)}},"./internal/getVOILut.js":function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}n.r(t),t.default=function(e,t,n,o){return n?function(e,t){var n=Math.max.apply(Math,r(e.lut)).toString(2).length-8,o=e.lut[0]>>n,l=e.lut[e.lut.length-1]>>n,c=e.firstValueMapped+e.lut.length-1;return function(r){return r<e.firstValueMapped?o:r>=c?l:t?e.lut[Math.round(r)-e.firstValueMapped]>>n:e.lut[r-e.firstValueMapped]>>n}}(n,o):function(e,t){return function(n){return 255*((n-t)/e+.5)}}(e,t)}},"./internal/guid.js":function(e,t,n){"use strict";function r(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}n.r(t),t.default=function(){return"".concat(r()+r(),"-").concat(r(),"-").concat(r(),"-").concat(r(),"-").concat(r()).concat(r()).concat(r())}},"./internal/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./internal/transform.js"),o=n("./internal/calculateTransform.js"),l=n("./internal/drawImage.js"),c=n("./internal/generateLut.js"),d=n("./internal/getDefaultViewport.js"),f=n("./internal/getTransform.js"),h=n("./internal/requestAnimationFrame.js"),m=n("./internal/setDefaultViewport.js"),v=n("./internal/storedColorPixelDataToCanvasImageData.js"),y=n("./internal/storedPixelDataToCanvasImageData.js"),x=n("./internal/storedPixelDataToCanvasImageDataColorLUT.js"),j=n("./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js"),w=n("./internal/storedPixelDataToCanvasImageDataRGBA.js");t.default={drawImage:l.default,generateLut:c.default,getDefaultViewport:d.default,requestAnimationFrame:h.default,setDefaultViewport:m.default,storedPixelDataToCanvasImageData:y.default,storedPixelDataToCanvasImageDataRGBA:w.default,storedPixelDataToCanvasImageDataColorLUT:x.default,storedPixelDataToCanvasImageDataPseudocolorLUT:j.default,storedColorPixelDataToCanvasImageData:v.default,getTransform:f.default,calculateTransform:o.default,Transform:r.Transform}},"./internal/now.js":function(e,t,n){"use strict";n.r(t),t.default=function(){return window.performance?performance.now():Date.now()}},"./internal/requestAnimationFrame.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){return window.requestAnimationFrame(e)||window.webkitRequestAnimationFrame(e)||window.mozRequestAnimationFrame(e)||window.oRequestAnimationFrame(e)||window.msRequestAnimationFrame(e)||function(e){window.setTimeout(e,1e3/60)}(e)}},"./internal/setDefaultViewport.js":function(e,t,n){"use strict";n.r(t),n.d(t,"state",(function(){return r}));var r={viewport:{}};t.default=function(e){r.viewport=e||{}}},"./internal/storedColorPixelDataToCanvasImageData.js":function(e,t,n){"use strict";n.r(t);var r=n("./internal/now.js");t.default=function(image,e,t){var n=Object(r.default)(),o=image.getPixelData();image.stats.lastGetPixelDataTime=Object(r.default)()-n;var l=image.minPixelValue,c=0,d=0,f=o.length;if(n=Object(r.default)(),l<0)for(;d<f;)t[c++]=e[o[d++]+-l],t[c++]=e[o[d++]+-l],t[c]=e[o[d]+-l],d+=2,c+=2;else for(;d<f;)t[c++]=e[o[d++]],t[c++]=e[o[d++]],t[c]=e[o[d]],d+=2,c+=2;image.stats.lastStoredPixelDataToCanvasImageDataTime=Object(r.default)()-n}},"./internal/storedPixelDataToCanvasImageData.js":function(e,t,n){"use strict";n.r(t);var r=n("./internal/now.js");t.default=function(image,e,t){var n=Object(r.default)(),o=image.getPixelData();image.stats.lastGetPixelDataTime=Object(r.default)()-n;var l=o.length,c=image.minPixelValue,d=3,f=0;if(n=Object(r.default)(),o instanceof Int16Array)if(c<0)for(;f<l;)t[d]=e[o[f++]+-c],d+=4;else for(;f<l;)t[d]=e[o[f++]],d+=4;else if(o instanceof Uint16Array)for(;f<l;)t[d]=e[o[f++]],d+=4;else if(c<0)for(;f<l;)t[d]=e[o[f++]+-c],d+=4;else for(;f<l;)t[d]=e[o[f++]],d+=4;image.stats.lastStoredPixelDataToCanvasImageDataTime=Object(r.default)()-n}},"./internal/storedPixelDataToCanvasImageDataColorLUT.js":function(e,t,n){"use strict";n.r(t);var r=n("./colors/index.js"),o=n("./internal/now.js");t.default=function(image,e,t){var n=Object(o.default)(),l=image.getPixelData();image.stats.lastGetPixelDataTime=Object(o.default)()-n;var c,d,f=l.length,h=image.minPixelValue,m=0,v=0;if(n=Object(o.default)(),d=e instanceof r.default.LookupTable?e.Table:e,h<0)for(;v<f;)c=d[l[v++]+-h],t[m++]=c[0],t[m++]=c[1],t[m++]=c[2],t[m++]=c[3];else for(;v<f;)c=d[l[v++]],t[m++]=c[0],t[m++]=c[1],t[m++]=c[2],t[m++]=c[3];image.stats.lastStoredPixelDataToCanvasImageDataTime=Object(o.default)()-n}},"./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js":function(e,t,n){"use strict";n.r(t);var r=n("./colors/index.js"),o=n("./internal/now.js");t.default=function(image,e,t,n){var l=Object(o.default)(),c=image.getPixelData();image.stats.lastGetPixelDataTime=Object(o.default)()-l;var d,f,h=c.length,m=image.minPixelValue,v=0,y=0;if(l=Object(o.default)(),f=t instanceof r.default.LookupTable?t.Table:t,m<0)for(;y<h;)d=f[e[c[y++]+-m]],n[v++]=d[0],n[v++]=d[1],n[v++]=d[2],n[v++]=d[3];else for(;y<h;)d=f[e[c[y++]]],n[v++]=d[0],n[v++]=d[1],n[v++]=d[2],n[v++]=d[3];image.stats.lastStoredPixelDataToCanvasImageDataTime=Object(o.default)()-l}},"./internal/storedPixelDataToCanvasImageDataRGBA.js":function(e,t,n){"use strict";n.r(t);var r=n("./internal/now.js");t.default=function(image,e,t){var n=Object(r.default)(),o=image.getPixelData();image.stats.lastGetPixelDataTime=Object(r.default)()-n;var l,c=o.length,d=image.minPixelValue,f=0,h=0;if(n=Object(r.default)(),o instanceof Int16Array)if(d<0)for(;h<c;)l=e[o[h++]+-d],t[f++]=l,t[f++]=l,t[f++]=l,t[f++]=255;else for(;h<c;)l=e[o[h++]],t[f++]=l,t[f++]=l,t[f++]=l,t[f++]=255;else if(o instanceof Uint16Array)for(;h<c;)l=e[o[h++]],t[f++]=l,t[f++]=l,t[f++]=l,t[f++]=255;else if(d<0)for(;h<c;)l=e[o[h++]+-d],t[f++]=l,t[f++]=l,t[f++]=l,t[f++]=255;else for(;h<c;)l=e[o[h++]],t[f++]=l,t[f++]=l,t[f++]=l,t[f++]=255;image.stats.lastStoredPixelDataToCanvasImageDataTime=Object(r.default)()-n}},"./internal/storedRGBAPixelDataToCanvasImageData.js":function(e,t,n){"use strict";n.r(t);var r=n("./internal/now.js");t.default=function(image,e,t){var n=Object(r.default)(),o=image.getPixelData();image.stats.lastGetPixelDataTime=Object(r.default)()-n;var l=image.minPixelValue,c=0,d=0,f=o.length;if(n=Object(r.default)(),l<0)for(;d<f;)t[c++]=e[o[d++]+-l],t[c++]=e[o[d++]+-l],t[c++]=e[o[d++]+-l],t[c++]=o[d++];else for(;d<f;)t[c++]=e[o[d++]],t[c++]=e[o[d++]],t[c++]=e[o[d++]],t[c++]=o[d++];image.stats.lastStoredPixelDataToCanvasImageDataTime=Object(r.default)()-n}},"./internal/transform.js":function(e,t,n){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}n.r(t),n.d(t,"Transform",(function(){return o}));var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reset()}var t,n,o;return t=e,(n=[{key:"reset",value:function(){this.m=[1,0,0,1,0,0]}},{key:"clone",value:function(){var t=new e;return t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5],t}},{key:"multiply",value:function(e){var t=this.m[0]*e.m[0]+this.m[2]*e.m[1],n=this.m[1]*e.m[0]+this.m[3]*e.m[1],r=this.m[0]*e.m[2]+this.m[2]*e.m[3],o=this.m[1]*e.m[2]+this.m[3]*e.m[3],l=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],c=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];this.m[0]=t,this.m[1]=n,this.m[2]=r,this.m[3]=o,this.m[4]=l,this.m[5]=c}},{key:"invert",value:function(){var e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),t=this.m[3]*e,n=-this.m[1]*e,r=-this.m[2]*e,o=this.m[0]*e,l=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),c=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=t,this.m[1]=n,this.m[2]=r,this.m[3]=o,this.m[4]=l,this.m[5]=c}},{key:"rotate",value:function(e){var t=Math.cos(e),s=Math.sin(e),n=this.m[0]*t+this.m[2]*s,r=this.m[1]*t+this.m[3]*s,o=this.m[0]*-s+this.m[2]*t,l=this.m[1]*-s+this.m[3]*t;this.m[0]=n,this.m[1]=r,this.m[2]=o,this.m[3]=l}},{key:"translate",value:function(e,t){this.m[4]+=this.m[0]*e+this.m[2]*t,this.m[5]+=this.m[1]*e+this.m[3]*t}},{key:"scale",value:function(e,t){this.m[0]*=e,this.m[1]*=e,this.m[2]*=t,this.m[3]*=t}},{key:"transformPoint",value:function(e,t){var n=e,r=t;return{x:e=n*this.m[0]+r*this.m[2]+this.m[4],y:t=n*this.m[1]+r*this.m[3]+this.m[5]}}}])&&r(t.prototype,n),o&&r(t,o),e}()},"./internal/tryEnableWebgl.js":function(e,t,n){"use strict";n.r(t);var r=n("./webgl/index.js");t.default=function(e){return r.default.renderer.isWebGLAvailable()?(r.default.renderer.initRenderer(),e.renderer="webgl",e.desynchronized=!0,e.preserveDrawingBuffer=!0,!0):(console.error("WebGL not available, falling back to Canvas renderer"),delete e.renderer,delete e.preserveDrawingBuffer,!1)}},"./internal/validator.js":function(e,t,n){"use strict";function r(e,t){if(void 0===e)throw new Error(t)}function o(e,t){if(null==e)throw new Error(t)}n.r(t),n.d(t,"validateParameterUndefined",(function(){return r})),n.d(t,"validateParameterUndefinedOrNull",(function(){return o}))},"./invalidate.js":function(e,t,n){"use strict";n.r(t);var r=n("./enabledElements.js"),o=n("./triggerEvent.js"),l=n("./events.js");t.default=function(element){var e=Object(r.getEnabledElement)(element);e.invalid=!0,e.needsRedraw=!0;var t={element:element};Object(o.default)(element,l.default.INVALIDATED,t)}},"./invalidateImageId.js":function(e,t,n){"use strict";n.r(t);var r=n("./enabledElements.js"),o=n("./internal/drawImage.js");t.default=function(e){Object(r.getEnabledElementsByImageId)(e).forEach((function(e){Object(o.default)(e,!0)}))}},"./layers.js":function(e,t,n){"use strict";n.r(t),n.d(t,"rescaleImage",(function(){return v})),n.d(t,"addLayer",(function(){return y})),n.d(t,"removeLayer",(function(){return x})),n.d(t,"getLayer",(function(){return j})),n.d(t,"getLayers",(function(){return w})),n.d(t,"getVisibleLayers",(function(){return T})),n.d(t,"setActiveLayer",(function(){return E})),n.d(t,"setLayerImage",(function(){return O})),n.d(t,"getActiveLayer",(function(){return C})),n.d(t,"purgeLayers",(function(){return S}));var r=n("./internal/guid.js"),o=n("./enabledElements.js"),l=n("./internal/getDefaultViewport.js"),c=n("./internal/getDisplayedArea.js"),d=n("./updateImage.js"),f=n("./triggerEvent.js"),h=n("./events.js");function m(e,t,n){var element=t.element,r={viewport:t.viewport,element:t.element,image:t.image,enabledElement:t,layerId:n};Object(f.default)(element,e,r)}function v(e,t){if(e.layerId===t.layerId)throw new Error("rescaleImage: both arguments represent the same layer");var n=e.image,r=t.image;if(n.imageId&&r.imageId){var o=Object(c.default)(r,t.viewport),l=Object(c.default)(n,e.viewport),d=o.columnPixelSpacing*r.width/(l.columnPixelSpacing*n.width),f=t.viewport.scale/e.viewport.scale*d;t.viewport.scale=e.viewport.scale*f}}function y(element,image,e){var t,n=Object(r.default)(),c=Object(o.getEnabledElement)(element),d=c.layers;image&&(t=Object(l.default)(c.canvas,image),e&&e.viewport&&(t=Object.assign(t,e.viewport))),!1!==c.syncViewports&&(c.syncViewports=!0);var f={image:image,layerId:n,viewport:t,options:e||{},renderingTools:{}};return d.length&&image&&v(d[0],f),d.push(f),m(h.default.LAYER_ADDED,c,n),1===d.length&&image&&E(element,n),n}function x(element,e){var t=Object(o.getEnabledElement)(element),n=t.layers,r=t.layers.findIndex((function(t){return t.layerId===e}));-1!==r&&(n.splice(r,1),e===t.activeLayerId&&n.length&&E(element,n[0].layerId),m(h.default.LAYER_REMOVED,t,e))}function j(element,e){return Object(o.getEnabledElement)(element).layers.find((function(t){return t.layerId===e}))}function w(element){return Object(o.getEnabledElement)(element).layers}function T(element){return Object(o.getEnabledElement)(element).layers.filter((function(e){return e.options&&!1!==e.options.visible&&0!==e.options.opacity}))}function E(element,e){var t=Object(o.getEnabledElement)(element);if(t.activeLayerId!==e){var n=t.layers.findIndex((function(t){return t.layerId===e}));if(-1===n)throw new Error("setActiveLayer: layer not found in layers array");var r=t.layers[n];if(!r.image)throw new Error("setActiveLayer: layer with undefined image cannot be set as active.");t.activeLayerId=e,t.image=r.image,t.viewport=r.viewport,Object(d.default)(element),m(h.default.ACTIVE_LAYER_CHANGED,t,e)}}function O(element,image,e){var t,n=Object(o.getEnabledElement)(element),r=n.layers[0];if(!(t=e?j(element,e):C(element)))throw new Error("setLayerImage: Layer not found");if(t.image=image,image){if(!t.viewport){var c=Object(l.default)(n.canvas,image);t.options&&t.options.viewport&&(t.viewport=Object.assign(c,t.options.viewport)),r.layerId!==e&&v(r,t)}}else t.viewport=void 0}function C(element){var e=Object(o.getEnabledElement)(element);return e.layers.find((function(t){return t.layerId===e.activeLayerId}))}function S(element){var e=Object(o.getEnabledElement)(element);e.layers=[],delete e.activeLayerId,delete e.lastSyncViewportsState}},"./metaData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"addProvider",(function(){return o})),n.d(t,"removeProvider",(function(){return l}));var r=[];function o(e){var i,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(i=0;i<r.length&&!(r[i].priority<=t);i++);r.splice(i,0,{priority:t,provider:e})}function l(e){for(var i=0;i<r.length;i++)if(r[i].provider===e){r.splice(i,1);break}}t.default={addProvider:o,removeProvider:l,get:function(e,t){for(var i=0;i<r.length;i++){var n=r[i].provider(e,t);if(void 0!==n)return n}}}},"./pageToPixel.js":function(e,t,n){"use strict";n.r(t);var r=n("./enabledElements.js"),o=n("./internal/getTransform.js");t.default=function(element,e,t){var n=Object(r.getEnabledElement)(element);if(void 0===n.image)throw new Error("image has not been loaded yet");var rect=element.getBoundingClientRect(),l={x:e-rect.left-window.pageXOffset,y:t-rect.top-window.pageYOffset},c=Object(o.default)(n);return c.invert(),c.transformPoint(l.x,l.y)}},"./pixelDataToFalseColorData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n("./colors/index.js");function o(image,e){if(image.color&&!image.falseColor)throw new Error("Color transforms are not implemented yet");var t,n,o=image.minPixelValue,l=0,c=0,d=image.width*image.height,f=image.origPixelData||image.getPixelData(),h=new Uint8Array(4*d);if(image.color=!0,image.falseColor=!0,image.origPixelData=f,e instanceof r.default.LookupTable)for(e.build();c<d;)t=f[c++],n=e.mapValue(t),h[l++]=n[0],h[l++]=n[1],h[l++]=n[2],h[l++]=n[3];else if(o<0)for(;c<d;)t=f[c++],h[l++]=e[t+-o][0],h[l++]=e[t+-o][1],h[l++]=e[t+-o][2],h[l++]=e[t+-o][3];else for(;c<d;)t=f[c++],h[l++]=e[t][0],h[l++]=e[t][1],h[l++]=e[t][2],h[l++]=e[t][3];image.rgba=!0,image.cachedLut=void 0,image.render=void 0,image.slope=1,image.intercept=0,image.minPixelValue=0,image.maxPixelValue=255,image.windowWidth=255,image.windowCenter=128,image.getPixelData=function(){return h}}},"./pixelToCanvas.js":function(e,t,n){"use strict";n.r(t);var r=n("./enabledElements.js"),o=n("./internal/getTransform.js");t.default=function(element,e){var t=Object(r.getEnabledElement)(element);return Object(o.default)(t).transformPoint(e.x,e.y)}},"./rendering/doesImageNeedToBeRendered.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,image){var t=e.renderingTools.lastRenderedImageId,n=e.renderingTools.lastRenderedViewport;return image.imageId!==t||!n||n.windowCenter!==e.viewport.voi.windowCenter||n.windowWidth!==e.viewport.voi.windowWidth||n.invert!==e.viewport.invert||n.rotation!==e.viewport.rotation||n.hflip!==e.viewport.hflip||n.vflip!==e.viewport.vflip||n.modalityLUT!==e.viewport.modalityLUT||n.voiLUT!==e.viewport.voiLUT||n.colormap!==e.viewport.colormap}},"./rendering/getLut.js":function(e,t,n){"use strict";n.r(t);var r=n("./internal/computeAutoVoi.js"),o=n("./rendering/lutMatches.js"),l=n("./internal/generateLut.js");t.default=function(image,e,t){return void 0!==image.cachedLut&&image.cachedLut.windowCenter===e.voi.windowCenter&&image.cachedLut.windowWidth===e.voi.windowWidth&&Object(o.default)(image.cachedLut.modalityLUT,e.modalityLUT)&&Object(o.default)(image.cachedLut.voiLUT,e.voiLUT)&&image.cachedLut.invert===e.invert&&!0!==t||(Object(r.default)(e,image),Object(l.default)(image,e.voi.windowWidth,e.voi.windowCenter,e.invert,e.modalityLUT,e.voiLUT),image.cachedLut.windowWidth=e.voi.windowWidth,image.cachedLut.windowCenter=e.voi.windowCenter,image.cachedLut.invert=e.invert,image.cachedLut.voiLUT=e.voiLUT,image.cachedLut.modalityLUT=e.modalityLUT),image.cachedLut.lutArray}},"./rendering/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./rendering/renderColorImage.js"),o=n("./rendering/renderGrayscaleImage.js"),l=n("./rendering/renderWebImage.js"),c=n("./rendering/renderPseudoColorImage.js"),d=n("./rendering/renderLabelMapImage.js"),f=n("./rendering/renderToCanvas.js");t.default={colorImage:r.renderColorImage,grayscaleImage:o.renderGrayscaleImage,webImage:l.renderWebImage,pseudoColorImage:c.renderPseudoColorImage,labelMapImage:d.renderLabelMapImage,toCanvas:f.default}},"./rendering/initializeRenderCanvas.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,image){var t=e.renderingTools.renderCanvas;t.width=image.width,t.height=image.height;var n=t.getContext("2d",{desynchronized:!0});n.fillStyle="white",n.fillRect(0,0,t.width,t.height);var r=n.getImageData(0,0,image.width,image.height);e.renderingTools.renderCanvasContext=n,e.renderingTools.renderCanvasData=r}},"./rendering/lutMatches.js":function(e,t,n){"use strict";n.r(t),t.default=function(a,b){return!a&&!b||!(!a||!b)&&a.id===b.id}},"./rendering/renderColorImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderColorImage",(function(){return w})),n.d(t,"addColorLayer",(function(){return T}));var r=n("./internal/now.js"),o=n("./internal/getFillStyle.js"),l=n("./internal/generateColorLut.js"),c=n("./internal/storedColorPixelDataToCanvasImageData.js"),d=n("./internal/storedRGBAPixelDataToCanvasImageData.js"),f=n("./setToPixelCoordinateSystem.js"),h=n("./webgl/index.js"),m=n("./rendering/doesImageNeedToBeRendered.js"),v=n("./rendering/initializeRenderCanvas.js"),y=n("./rendering/saveLastRendered.js"),x=n("./internal/getDisplayedArea.js");function j(e,image,t){var n=!0===e.renderingTools.lastRenderedIsColor;e.renderingTools.renderCanvas&&n||(e.renderingTools.renderCanvas=document.createElement("canvas"));var o=e.renderingTools.renderCanvas;if(255===e.viewport.voi.windowWidth&&128===e.viewport.voi.windowCenter&&!1===e.viewport.invert&&image.getCanvas&&image.getCanvas())return image.getCanvas();if(!1===Object(m.default)(e,image)&&!0!==t)return o;o.width===image.width&&o.height===image.height||Object(v.default)(e,image);var f=Object(r.default)(),h=function(image,e){return void 0!==image.cachedLut&&image.cachedLut.windowCenter===e.voi.windowCenter&&image.cachedLut.windowWidth===e.voi.windowWidth&&image.cachedLut.invert===e.invert||(Object(l.default)(image,e.voi.windowWidth,e.voi.windowCenter,e.invert),image.cachedLut.windowWidth=e.voi.windowWidth,image.cachedLut.windowCenter=e.voi.windowCenter,image.cachedLut.invert=e.invert),image.cachedLut.lutArray}(image,e.viewport);image.stats=image.stats||{},image.stats.lastLutGenerateTime=Object(r.default)()-f;var y=e.renderingTools.renderCanvasData,x=e.renderingTools.renderCanvasContext;return image.rgba?Object(d.default)(image,h,y.data):Object(c.default)(image,h,y.data),f=Object(r.default)(),x.putImageData(y,0,0),image.stats.lastPutImageDataTime=Object(r.default)()-f,o}function w(e,t){if(void 0===e)throw new Error("renderColorImage: enabledElement parameter must not be undefined");var image=e.image;if(void 0===image)throw new Error("renderColorImage: image must be loaded before it can be drawn");var n,r=e.canvas.getContext("2d",{desynchronized:!0});r.setTransform(1,0,0,1,0,0),r.fillStyle=Object(o.default)(e),r.fillRect(0,0,e.canvas.width,e.canvas.height),r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,Object(f.default)(e,r),n=e.options&&e.options.renderer&&"webgl"===e.options.renderer.toLowerCase()?h.default.renderer.render(e):j(e,image,t);var l=Object(x.default)(e.image,e.viewport),c=l.tlhc.x-1,d=l.tlhc.y-1,m=l.brhc.x-c,v=l.brhc.y-d;r.drawImage(n,c,d,m,v,c,d,m,v),e.renderingTools=Object(y.default)(e)}function T(e,t){if(void 0===e)throw new Error("addColorLayer: layer parameter must not be undefined");var image=e.image;if(void 0===image)throw new Error("addColorLayer: image must be loaded before it can be drawn");image.rgba=!0,e.canvas=j(e,image,t);var n=e.canvas.getContext("2d",{desynchronized:!0});n.imageSmoothingEnabled=!e.viewport.pixelReplication,n.mozImageSmoothingEnabled=n.imageSmoothingEnabled,e.renderingTools=Object(y.default)(e)}},"./rendering/renderGrayscaleImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderGrayscaleImage",(function(){return w})),n.d(t,"addGrayscaleLayer",(function(){return T}));var r=n("./internal/getFillStyle.js"),o=n("./internal/storedPixelDataToCanvasImageData.js"),l=n("./internal/storedPixelDataToCanvasImageDataRGBA.js"),c=n("./setToPixelCoordinateSystem.js"),d=n("./internal/now.js"),f=n("./webgl/index.js"),h=n("./rendering/getLut.js"),m=n("./rendering/doesImageNeedToBeRendered.js"),v=n("./rendering/initializeRenderCanvas.js"),y=n("./rendering/saveLastRendered.js"),x=n("./internal/getDisplayedArea.js");function j(e,image,t){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=!0===e.renderingTools.lastRenderedIsColor;e.renderingTools.renderCanvas&&!r||(e.renderingTools.renderCanvas=document.createElement("canvas"),Object(v.default)(e,image));var c=e.renderingTools.renderCanvas;if(!1===Object(m.default)(e,image)&&!0!==t)return c;c.width===image.width&&c.height===image.height||Object(v.default)(e,image);var f=Object(d.default)(),y=Object(h.default)(image,e.viewport,t);image.stats=image.stats||{},image.stats.lastLutGenerateTime=Object(d.default)()-f;var x=e.renderingTools.renderCanvasData,j=e.renderingTools.renderCanvasContext;return n?Object(o.default)(image,y,x.data):Object(l.default)(image,y,x.data),f=Object(d.default)(),j.putImageData(x,0,0),image.stats.lastPutImageDataTime=Object(d.default)()-f,c}function w(e,t){if(void 0===e)throw new Error("drawImage: enabledElement parameter must not be undefined");var image=e.image;if(void 0===image)throw new Error("drawImage: image must be loaded before it can be drawn");var n,o=e.canvas.getContext("2d",{desynchronized:!0});o.setTransform(1,0,0,1,0,0),o.fillStyle=Object(r.default)(e),o.fillRect(0,0,e.canvas.width,e.canvas.height),o.imageSmoothingEnabled=!e.viewport.pixelReplication,o.mozImageSmoothingEnabled=o.imageSmoothingEnabled,Object(c.default)(e,o),n=e.options&&e.options.renderer&&"webgl"===e.options.renderer.toLowerCase()?f.default.renderer.render(e):j(e,image,t);var l=Object(x.default)(e.image,e.viewport),d=l.tlhc.x-1,h=l.tlhc.y-1,m=l.brhc.x-d,v=l.brhc.y-h;o.drawImage(n,d,h,m,v,d,h,m,v),e.renderingTools=Object(y.default)(e)}function T(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===e)throw new Error("addGrayscaleLayer: layer parameter must not be undefined");var image=e.image;if(void 0===image)throw new Error("addGrayscaleLayer: image must be loaded before it can be drawn");e.canvas=j(e,image,t,n);var r=e.canvas.getContext("2d",{desynchronized:!0});r.imageSmoothingEnabled=!e.viewport.pixelReplication,r.mozImageSmoothingEnabled=r.imageSmoothingEnabled,e.renderingTools=Object(y.default)(e)}},"./rendering/renderLabelMapImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderLabelMapImage",(function(){return x})),n.d(t,"addLabelMapLayer",(function(){return j}));var r=n("./setToPixelCoordinateSystem.js"),o=n("./internal/now.js"),l=n("./internal/getFillStyle.js"),c=n("./rendering/initializeRenderCanvas.js"),d=n("./rendering/saveLastRendered.js"),f=n("./rendering/doesImageNeedToBeRendered.js"),h=n("./internal/storedPixelDataToCanvasImageDataColorLUT.js"),m=n("./colors/index.js"),v=n("./internal/getDisplayedArea.js");function y(e,image,t){e.renderingTools.renderCanvas||(e.renderingTools.renderCanvas=document.createElement("canvas"));var n=e.renderingTools.renderCanvas,r=e.viewport.colormap||e.options.colormap;if(e.options.colormap&&console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"),r&&"string"==typeof r&&(r=m.default.getColormap(r)),!r)throw new Error("renderLabelMapImage: colormap not found.");var l=r.getId();if(!1===Object(f.default)(e,image)&&!0!==t&&e.renderingTools.colormapId===l)return n;n.width===image.width&&n.height===image.height||Object(c.default)(e,image);var d=Object(o.default)();e.renderingTools.colorLut&&!t&&e.renderingTools.colormapId===l||(e.renderingTools.colorLut=r.createLookupTable(),e.renderingTools.colormapId=l),image.stats=image.stats||{},image.stats.lastLutGenerateTime=Object(o.default)()-d;var v=e.renderingTools.colorLut,y=e.renderingTools.renderCanvasData,x=e.renderingTools.renderCanvasContext;return Object(h.default)(image,v,y.data),d=Object(o.default)(),x.putImageData(y,0,0),image.stats.lastPutImageDataTime=Object(o.default)()-d,n}function x(e,t){if(void 0===e)throw new Error("renderLabelMapImage: enabledElement parameter must not be undefined");var image=e.image;if(void 0===image)throw new Error("renderLabelMapImage: image must be loaded before it can be drawn");var n=e.canvas.getContext("2d",{desynchronized:!0});n.setTransform(1,0,0,1,0,0),n.fillStyle=Object(l.default)(e),n.fillRect(0,0,e.canvas.width,e.canvas.height),n.imageSmoothingEnabled=!e.viewport.pixelReplication,n.mozImageSmoothingEnabled=n.imageSmoothingEnabled,Object(r.default)(e,n);var o=y(e,image,t),c=Object(v.default)(e.image,e.viewport),f=c.tlhc.x-1,h=c.tlhc.y-1,m=c.brhc.x-f,x=c.brhc.y-h;n.drawImage(o,f,h,m,x,f,h,m,x),e.renderingTools=Object(d.default)(e)}function j(e,t){if(void 0===e)throw new Error("addLabelMapLayer: layer parameter must not be undefined");var image=e.image;if(void 0===image)throw new Error("addLabelMapLayer: image must be loaded before it can be drawn");e.canvas=y(e,image,t);var n=e.canvas.getContext("2d",{desynchronized:!0});n.imageSmoothingEnabled=!e.viewport.pixelReplication,n.mozImageSmoothingEnabled=n.imageSmoothingEnabled,e.renderingTools=Object(d.default)(e)}},"./rendering/renderPseudoColorImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderPseudoColorImage",(function(){return j})),n.d(t,"addPseudoColorLayer",(function(){return w}));var r=n("./setToPixelCoordinateSystem.js"),o=n("./internal/now.js"),l=n("./internal/getFillStyle.js"),c=n("./rendering/initializeRenderCanvas.js"),d=n("./rendering/getLut.js"),f=n("./rendering/saveLastRendered.js"),h=n("./rendering/doesImageNeedToBeRendered.js"),m=n("./internal/storedPixelDataToCanvasImageDataPseudocolorLUT.js"),v=n("./colors/index.js"),y=n("./internal/getDisplayedArea.js");function x(e,image,t){e.renderingTools.renderCanvas||(e.renderingTools.renderCanvas=document.createElement("canvas"));var n=e.renderingTools.renderCanvas,r=e.viewport.colormap||e.options.colormap;if(e.options&&e.options.colormap&&console.warn("enabledElement.options.colormap is deprecated. Use enabledElement.viewport.colormap instead"),r&&"string"==typeof r&&(r=v.default.getColormap(r)),!r)throw new Error("renderPseudoColorImage: colormap not found.");var l=r.getId();if(!1===Object(h.default)(e,image)&&!0!==t&&e.renderingTools.colormapId===l)return n;n.width===image.width&&n.height===image.height||Object(c.default)(e,image);var f=Object(o.default)();e.renderingTools.colorLut&&!t&&e.renderingTools.colormapId===l||(r.setNumberOfColors(256),e.renderingTools.colorLut=r.createLookupTable(),e.renderingTools.colormapId=l);var y=Object(d.default)(image,e.viewport,t);image.stats=image.stats||{},image.stats.lastLutGenerateTime=Object(o.default)()-f;var x=e.renderingTools.colorLut,j=e.renderingTools.renderCanvasData,w=e.renderingTools.renderCanvasContext;return Object(m.default)(image,y,x,j.data),f=Object(o.default)(),w.putImageData(j,0,0),image.stats.lastPutImageDataTime=Object(o.default)()-f,n}function j(e,t){if(void 0===e)throw new Error("drawImage: enabledElement parameter must not be undefined");var image=e.image;if(void 0===image)throw new Error("drawImage: image must be loaded before it can be drawn");var n=e.canvas.getContext("2d",{desynchronized:!0});n.setTransform(1,0,0,1,0,0),n.fillStyle=Object(l.default)(e),n.fillRect(0,0,e.canvas.width,e.canvas.height),n.imageSmoothingEnabled=!e.viewport.pixelReplication,n.mozImageSmoothingEnabled=n.imageSmoothingEnabled,Object(r.default)(e,n);var o=x(e,image,t),c=Object(y.default)(e.image,e.viewport),d=c.tlhc.x-1,h=c.tlhc.y-1,m=c.brhc.x-d,v=c.brhc.y-h;n.drawImage(o,d,h,m,v,d,h,m,v),e.renderingTools=Object(f.default)(e)}function w(e,t){if(void 0===e)throw new Error("addPseudoColorLayer: layer parameter must not be undefined");var image=e.image;if(void 0===image)throw new Error("addPseudoColorLayer: image must be loaded before it can be drawn");e.canvas=x(e,image,t);var n=e.canvas.getContext("2d",{desynchronized:!0});n.imageSmoothingEnabled=!e.viewport.pixelReplication,n.mozImageSmoothingEnabled=n.imageSmoothingEnabled,e.renderingTools=Object(f.default)(e)}},"./rendering/renderToCanvas.js":function(e,t,n){"use strict";n.r(t);var r=n("./triggerEvent.js"),o=n("./events.js"),l=n("./internal/drawImageSync.js"),c=n("./internal/getDefaultViewport.js"),d=n("./internal/tryEnableWebgl.js");function f(canvas,image,e,t){return{element:canvas,canvas:canvas,image:image,invalid:!0,needsRedraw:!0,options:e,layers:[],data:{},renderingTools:{},viewport:t}}t.default=function(canvas,image){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(void 0===canvas)throw new Error("renderToCanvas: parameter canvas cannot be undefined");t&&t.renderer&&"webgl"===t.renderer.toLowerCase()&&Object(d.default)(t);var n=Object(c.default)(canvas,image);e&&Object.assign(n,e);var h=f(canvas,image,t,n),m={enabledElement:h,timestamp:Date.now()};Object(r.default)(h.element,o.default.PRE_RENDER,m),Object(l.default)(h,h.invalid)}},"./rendering/renderWebImage.js":function(e,t,n){"use strict";n.r(t),n.d(t,"renderWebImage",(function(){return c}));var r=n("./setToPixelCoordinateSystem.js"),o=n("./rendering/renderColorImage.js"),l=n("./internal/getDisplayedArea.js");function c(e,t){if(void 0===e)throw new Error("renderWebImage: enabledElement parameter must not be undefined");var image=e.image;if(void 0===image)throw new Error("renderWebImage: image must be loaded before it can be drawn");if(e.viewport.voi.windowWidth===e.image.windowWidth&&e.viewport.voi.windowCenter===e.image.windowCenter&&!1===e.viewport.invert){var n=e.canvas.getContext("2d",{desynchronized:!0});n.setTransform(1,0,0,1,0,0),n.fillStyle="black",n.fillRect(0,0,e.canvas.width,e.canvas.height),n.imageSmoothingEnabled=!e.viewport.pixelReplication,n.mozImageSmoothingEnabled=n.imageSmoothingEnabled,Object(r.default)(e,n);var c=Object(l.default)(e.image,e.viewport),d=c.tlhc.x-1,f=c.tlhc.y-1,h=c.brhc.x-d,m=c.brhc.y-f;n.drawImage(image.getImage(),d,f,h,m,d,f,h,m)}else Object(o.renderColorImage)(e,t)}},"./rendering/saveLastRendered.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.image.imageId,n=e.viewport,r=e.image.color;return e.renderingTools.lastRenderedImageId=t,e.renderingTools.lastRenderedIsColor=r,e.renderingTools.lastRenderedViewport={windowCenter:n.voi.windowCenter,windowWidth:n.voi.windowWidth,invert:n.invert,rotation:n.rotation,hflip:n.hflip,vflip:n.vflip,modalityLUT:n.modalityLUT,voiLUT:n.voiLUT,colormap:n.colormap},e.renderingTools}},"./requestPool/RequestPoolManager.ts":function(e,t,n){"use strict";function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,c=!0,d=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){d=!0,l=e},f:function(){try{c||null==n.return||n.return()}finally{if(d)throw l}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.r(t),n.d(t,"RequestPoolManager",(function(){return d}));var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),c(this,"requestPool",void 0),c(this,"awake",void 0),c(this,"numRequests",void 0),c(this,"maxNumRequests",void 0),c(this,"grabDelay",void 0),c(this,"timeoutHandle",void 0),this.requestPool={interaction:{0:[]},thumbnail:{0:[]},prefetch:{0:[]}},this.awake=!1,this.grabDelay=5,this.numRequests={interaction:0,thumbnail:0,prefetch:0},this.maxNumRequests={interaction:6,thumbnail:6,prefetch:5}}var t,n,o;return t=e,n=[{key:"destroy",value:function(){this.timeoutHandle&&window.clearTimeout(this.timeoutHandle)}},{key:"addRequest",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l={requestFn:e,type:t,additionalDetails:n};void 0===this.requestPool[t][r]&&(this.requestPool[t][r]=[]),o?this.requestPool[t][r].unshift(l):this.requestPool[t][r].push(l),this.awake||(this.awake=!0,this.startGrabbing())}},{key:"filterRequests",value:function(e){var t=this;Object.keys(this.requestPool).forEach((function(n){var r=t.requestPool[n];Object.keys(r).forEach((function(t){r[t]=r[t].filter((function(t){return e(t)}))}))}))}},{key:"clearRequestStack",value:function(e){if(!this.requestPool[e])throw new Error("No category for the type ".concat(e," found"));this.requestPool[e]={0:[]}}},{key:"sendRequest",value:function(e){var t=this,n=e.requestFn,r=e.type;this.numRequests[r]++,this.awake=!0,n().finally((function(){t.numRequests[r]--,t.startAgain()}))}},{key:"startGrabbing",value:function(){for(var e=this.maxNumRequests.interaction+this.maxNumRequests.thumbnail+this.maxNumRequests.prefetch-(this.numRequests.interaction+this.numRequests.thumbnail+this.numRequests.prefetch),i=0;i<e;i++){var t=this.getNextRequest();if(!1===t)break;t&&this.sendRequest(t)}}},{key:"startAgain",value:function(){var e=this;this.awake&&(this.grabDelay?this.timeoutHandle=window.setTimeout((function(){e.startGrabbing()}),this.grabDelay):this.startGrabbing())}},{key:"getSortedPriorityGroups",value:function(e){var t=this;return Object.keys(this.requestPool[e]).map(Number).filter((function(n){return t.requestPool[e][n].length})).sort()}},{key:"getNextRequest",value:function(){var e,t=this.getSortedPriorityGroups("interaction"),n=r(t);try{for(n.s();!(e=n.n()).done;){var o=e.value;if(this.requestPool.interaction[o].length&&this.numRequests.interaction<this.maxNumRequests.interaction)return this.requestPool.interaction[o].shift()}}catch(e){n.e(e)}finally{n.f()}var l,c=this.getSortedPriorityGroups("thumbnail"),d=r(c);try{for(d.s();!(l=d.n()).done;){var f=l.value;if(this.requestPool.thumbnail[f].length&&this.numRequests.thumbnail<this.maxNumRequests.thumbnail)return this.requestPool.thumbnail[f].shift()}}catch(e){d.e(e)}finally{d.f()}var h,m=this.getSortedPriorityGroups("prefetch"),v=r(m);try{for(v.s();!(h=v.n()).done;){var y=h.value;if(this.requestPool.prefetch[y].length&&this.numRequests.prefetch<this.maxNumRequests.prefetch)return this.requestPool.prefetch[y].shift()}}catch(e){v.e(e)}finally{v.f()}return t.length||c.length||m.length||(this.awake=!1),!1}},{key:"getRequestPool",value:function(){return this.requestPool}}],n&&l(t.prototype,n),o&&l(t,o),e}()},"./requestPool/imageLoadPoolManager.ts":function(e,t,n){"use strict";n.r(t);var r=new(n("./requestPool/RequestPoolManager.ts").RequestPoolManager);r.maxNumRequests={interaction:1e3,thumbnail:1e3,prefetch:1e3},r.grabDelay=0,t.default=r},"./requestPool/imageRetrievalPoolManager.ts":function(e,t,n){"use strict";n.r(t);var r=new(n("./requestPool/RequestPoolManager.ts").RequestPoolManager);r.maxNumRequests={interaction:20,thumbnail:20,prefetch:20},r.grabDelay=0,t.default=r},"./reset.js":function(e,t,n){"use strict";n.r(t);var r=n("./internal/getDefaultViewport.js"),o=n("./enabledElements.js"),l=n("./updateImage.js");t.default=function(element){var e=Object(o.getEnabledElement)(element);e.viewport=Object(r.default)(e.canvas,e.image),Object(l.default)(element)}},"./resize.js":function(e,t,n){"use strict";n.r(t);var r=n("./enabledElements.js"),o=n("./fitToWindow.js"),l=n("./updateImage.js"),c=n("./triggerEvent.js"),d=n("./internal/getImageSize.js"),f=n("./events.js");t.default=function(element,e){var t=Object(r.getEnabledElement)(element),n=t.canvas.width,h=t.canvas.height;!function(element,canvas){canvas.width!==element.clientWidth&&(canvas.width=element.clientWidth,canvas.style.width="".concat(element.clientWidth,"px")),canvas.height!==element.clientHeight&&(canvas.height=element.clientHeight,canvas.style.height="".concat(element.clientHeight,"px"))}(element,t.canvas);var m={element:element};Object(c.default)(element,f.default.ELEMENT_RESIZED,m),void 0!==t.image&&(e||function(e,t,n){var r=e.viewport.scale,o=Object(d.default)(e.image,e.viewport.rotation),l=Math.round(o.width*r),c=Math.round(o.height*r),f=e.viewport.translation.x,h=e.viewport.translation.y;return l===t&&c<=n||l<=t&&c===n&&0===f&&0===h}(t,n,h)?Object(o.default)(element):(function(e,t,n){var r=e.viewport.scale,o=e.canvas.width/t,l=e.canvas.height/n,c=Math.sqrt(o*l);e.viewport.scale=c*r}(t,n,h),Object(l.default)(element)))}},"./setToPixelCoordinateSystem.js":function(e,t,n){"use strict";n.r(t);var r=n("./internal/calculateTransform.js");t.default=function(e,t,n){if(void 0===e)throw new Error("setToPixelCoordinateSystem: parameter enabledElement must not be undefined");if(void 0===t)throw new Error("setToPixelCoordinateSystem: parameter context must not be undefined");var o=Object(r.default)(e,n);t.setTransform(o.m[0],o.m[1],o.m[2],o.m[3],o.m[4],o.m[5])}},"./setViewport.js":function(e,t,n){"use strict";n.r(t);var r=n("./internal/getDefaultViewport.js"),o=n("./enabledElements.js"),l=n("./updateImage.js");t.default=function(element,e){var t=Object(o.getEnabledElement)(element);if(void 0===t.viewport&&(t.viewport=Object(r.default)(t.canvas)),e)for(var n in e)null!==e[n]&&(t.viewport[n]=e[n]);t.viewport.voi.windowWidth&&(t.viewport.voi.windowWidth=Math.max(t.viewport.voi.windowWidth,1e-6)),t.viewport.scale&&(t.viewport.scale=Math.max(t.viewport.scale,1e-4)),t.viewport.rotation%=360,t.viewport.rotation<0&&(t.viewport.rotation+=360),t.image&&Object(l.default)(element)}},"./triggerEvent.js":function(e,t,n){"use strict";function r(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"function"==typeof window.CustomEvent?n=new CustomEvent(t,{detail:r,cancelable:!0}):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,r),e.dispatchEvent(n)}n.r(t),n.d(t,"default",(function(){return r}))},"./updateImage.js":function(e,t,n){"use strict";n.r(t);var r=n("./enabledElements.js"),o=n("./internal/drawImage.js");t.default=function(element){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=Object(r.getEnabledElement)(element);Object(o.default)(t,e)}},"./webgl/createProgramFromString.js":function(e,t,n){"use strict";function r(e,t,n){var r=e.createShader(n);if(e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)&&!e.isContextLost()){var o=e.getShaderInfoLog(r);console.error("Could not compile shader:\n".concat(o))}return r}n.r(t),t.default=function(e,t,n){return function(e,t,n){var r=e.createProgram();if(e.attachShader(r,t),e.attachShader(r,n),e.linkProgram(r),!e.getProgramParameter(r,e.LINK_STATUS)&&!e.isContextLost()){var o=e.getProgramInfoLog(r);console.error("WebGL program filed to link:\n".concat(o))}return r}(e,r(e,t,e.VERTEX_SHADER),r(e,n,e.FRAGMENT_SHADER))}},"./webgl/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./webgl/renderer.js"),o=n("./webgl/createProgramFromString.js"),l=n("./webgl/textureCache.js"),c={createProgramFromString:o.default,renderer:{render:r.render,initRenderer:r.initRenderer,getRenderCanvas:r.getRenderCanvas,isWebGLAvailable:r.isWebGLAvailable},textureCache:l.default};Object.defineProperty(c,"isWebGLInitialized",{enumerable:!0,configurable:!1,get:function(){return r.isWebGLInitialized}}),t.default=c},"./webgl/renderer.js":function(e,t,n){"use strict";n.r(t),n.d(t,"isWebGLInitialized",(function(){return v})),n.d(t,"getRenderCanvas",(function(){return y})),n.d(t,"initRenderer",(function(){return x})),n.d(t,"render",(function(){return C})),n.d(t,"isWebGLAvailable",(function(){return S}));var r,o,l,c=n("./webgl/shaders/index.js"),d=n("./webgl/vertexShader.js"),f=n("./webgl/textureCache.js"),h=n("./webgl/createProgramFromString.js"),m=document.createElement("canvas"),v=!1;function y(){return m}function x(){!0!==v&&function(canvas){r=null;try{var e={desynchronized:!0,preserveDrawingBuffer:!0};r=canvas.getContext("webgl",e)||canvas.getContext("experimental-webgl",e),canvas.removeEventListener("webglcontextlost",j,!1),canvas.addEventListener("webglcontextlost",j,!1),canvas.removeEventListener("webglcontextrestored",w,!1),canvas.addEventListener("webglcontextrestored",w,!1)}catch(e){throw new Error("Error creating WebGL context")}return r||(console.error("Unable to initialize WebGL. Your browser may not support it."),r=null),r}(m)&&(l=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,l),r.bufferData(r.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),r.STATIC_DRAW),o=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,o),r.bufferData(r.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,0,0]),r.STATIC_DRAW),function(){for(var e in c.shaders){var t=c.shaders[e];t.attributes={},t.uniforms={},t.vert=d.vertexShader,t.program=Object(h.default)(r,t.vert,t.frag),t.attributes.texCoordLocation=r.getAttribLocation(t.program,"a_texCoord"),r.enableVertexAttribArray(t.attributes.texCoordLocation),t.attributes.positionLocation=r.getAttribLocation(t.program,"a_position"),r.enableVertexAttribArray(t.attributes.positionLocation),t.uniforms.resolutionLocation=r.getUniformLocation(t.program,"u_resolution")}}(),v=!0)}function j(e){e.preventDefault(),console.warn("WebGL Context Lost!")}function w(e){e.preventDefault(),v=!1,f.default.purgeCache(),x()}function T(image){if(image.color)return"rgb";var e=image.getPixelData();return e instanceof Int16Array?"int16":e instanceof Uint16Array?"uint16":e instanceof Int8Array?"int8":"uint8"}function E(image){var e=f.default.getImageTexture(image.imageId);return e||(e=function(image){var e={uint8:r.LUMINANCE,int8:r.LUMINANCE_ALPHA,uint16:r.LUMINANCE_ALPHA,int16:r.RGB,rgb:r.RGB},t=T(image),n=e[t],o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.pixelStorei(r.UNPACK_ALIGNMENT,1);var l=c.dataUtilities[t].storedPixelDataToImageData(image,image.width,image.height);return r.texImage2D(r.TEXTURE_2D,0,n,image.width,image.height,0,n,r.UNSIGNED_BYTE,l),{texture:o,sizeInBytes:image.width*image.height*{int8:1,uint16:2,int16:3,rgb:3}[t]}}(image),f.default.putImageTexture(image,e)),e.texture}function O(e,t,n,c,d){for(var f in r.clearColor(1,0,0,1),r.viewport(0,0,c,d),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.useProgram(e.program),r.bindBuffer(r.ARRAY_BUFFER,o),r.vertexAttribPointer(e.attributes.texCoordLocation,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,l),r.vertexAttribPointer(e.attributes.positionLocation,2,r.FLOAT,!1,0,0),t){var h=r.getUniformLocation(e.program,f);if(h){var m=t[f],v=m.type,y=m.value;"i"===v?r.uniform1i(h,y):"f"===v?r.uniform1f(h,y):"2f"===v&&r.uniform2f(h,y[0],y[1])}}!function(e,t,n){e.bufferData(e.ARRAY_BUFFER,new Float32Array([t,n,0,n,t,0,0,0]),e.STATIC_DRAW)}(r,c,d),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,n),r.drawArrays(r.TRIANGLE_STRIP,0,4)}function C(e){var image=e.image;m.width=image.width,m.height=image.height;var t=e.viewport,n=function(image){var e=T(image);return c.shaders.hasOwnProperty(e)?c.shaders[e]:c.shaders.rgb}(image),r=E(image);return O(n,{u_resolution:{type:"2f",value:[image.width,image.height]},wc:{type:"f",value:t.voi.windowCenter},ww:{type:"f",value:t.voi.windowWidth},slope:{type:"f",value:image.slope},intercept:{type:"f",value:image.intercept},minPixelValue:{type:"f",value:image.minPixelValue},invert:{type:"i",value:t.invert?1:0}},r,image.width,image.height),m}function S(){var e={failIfMajorPerformanceCaveat:!0};try{var canvas=document.createElement("canvas");return Boolean(window.WebGLRenderingContext)&&(canvas.getContext("webgl",e)||canvas.getContext("experimental-webgl",e))}catch(e){return!1}}},"./webgl/shaders/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"shaders",(function(){return f})),n.d(t,"dataUtilities",(function(){return h}));var r=n("./webgl/shaders/int16.js"),o=n("./webgl/shaders/int8.js"),l=n("./webgl/shaders/rgb.js"),c=n("./webgl/shaders/uint16.js"),d=n("./webgl/shaders/uint8.js"),f={int16:r.int16Shader,int8:o.int8Shader,rgb:l.rgbShader,uint16:c.uint16Shader,uint8:d.uint8Shader},h={int16:r.int16DataUtilities,int8:o.int8DataUtilities,rgb:l.rgbDataUtilities,uint16:c.uint16DataUtilities,uint8:d.uint8DataUtilities}},"./webgl/shaders/int16.js":function(e,t,n){"use strict";n.r(t),n.d(t,"int16DataUtilities",(function(){return o})),n.d(t,"int16Shader",(function(){return r}));var r={},o={storedPixelDataToImageData:function(image){for(var e=image.getPixelData(),data=new Uint8Array(image.width*image.height*3),t=0,i=0;i<e.length;i++){var n=Math.abs(e[i]);data[t++]=255&n,data[t++]=n>>8,data[t++]=e[i]<0?0:1}return data}};r.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.g*65536.0;if (color.b == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/int8.js":function(e,t,n){"use strict";n.r(t),n.d(t,"int8DataUtilities",(function(){return o})),n.d(t,"int8Shader",(function(){return r}));var r={},o={storedPixelDataToImageData:function(image){for(var e=image.getPixelData(),data=new Uint8Array(image.width*image.height*2),t=0,i=0;i<e.length;i++)data[t++]=e[i],data[t++]=e[i]<0?0:1;return data}};r.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.;if (color.a == 0.0)intensity = -intensity;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/rgb.js":function(e,t,n){"use strict";n.r(t),n.d(t,"rgbDataUtilities",(function(){return o})),n.d(t,"rgbShader",(function(){return r}));var r={},o={storedPixelDataToImageData:function(image){var e=image.minPixelValue,t=0,n=0,r=image.width*image.height*4,o=image.width*image.height*3,l=image.getPixelData(),data=new Uint8Array(o);if(e<0)for(;n<r;)data[t++]=l[n++]+-e,data[t++]=l[n++]+-e,data[t++]=l[n++]+-e,n+=1;else for(;n<r;)data[t++]=l[n++],data[t++]=l[n++],data[t++]=l[n++],n+=1;return data}};r.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform float minPixelValue;uniform int invert;varying vec2 v_texCoord;void main() {vec3 color = texture2D(u_image, v_texCoord).xyz;color = color * 256.0 * slope + intercept;float center0 = wc - 0.5 - minPixelValue;float width0 = max(ww, 1.0);color = (color - center0) / width0 + 0.5;gl_FragColor = vec4(color, 1);if (invert == 1)gl_FragColor.rgb = 1. - gl_FragColor.rgb;}"},"./webgl/shaders/uint16.js":function(e,t,n){"use strict";n.r(t),n.d(t,"uint16DataUtilities",(function(){return o})),n.d(t,"uint16Shader",(function(){return r}));var r={},o={storedPixelDataToImageData:function(image){for(var e=image.getPixelData(),data=new Uint8Array(image.width*image.height*2),t=0,i=0;i<e.length;i++){var n=e[i];data[t++]=255&n,data[t++]=n>>8}return data}};r.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0 + color.a*65536.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/shaders/uint8.js":function(e,t,n){"use strict";n.r(t),n.d(t,"uint8DataUtilities",(function(){return o})),n.d(t,"uint8Shader",(function(){return r}));var r={},o={storedPixelDataToImageData:function(image){return image.getPixelData()}};r.frag="precision mediump float;uniform sampler2D u_image;uniform float ww;uniform float wc;uniform float slope;uniform float intercept;uniform int invert;varying vec2 v_texCoord;void main() {vec4 color = texture2D(u_image, v_texCoord);float intensity = color.r*256.0;intensity = intensity * slope + intercept;float center0 = wc - 0.5;float width0 = max(ww, 1.0);intensity = (intensity - center0) / width0 + 0.5;intensity = clamp(intensity, 0.0, 1.0);gl_FragColor = vec4(intensity, intensity, intensity, 1.0);if (invert == 1)gl_FragColor.rgb = 1.0 - gl_FragColor.rgb;}"},"./webgl/textureCache.js":function(e,t,n){"use strict";n.r(t);var r=n("./events.js"),o=n("./triggerEvent.js"),l={},c=[],d=268435456,f=0;function h(){if(!(f<=d)){for(c.sort((function(a,b){return a.timeStamp>b.timeStamp?-1:a.timeStamp<b.timeStamp?1:0}));f>d;){var e=c[c.length-1];f-=e.sizeInBytes,delete l[e.imageId],c.pop(),Object(o.default)(r.events,r.default.WEBGL_TEXTURE_REMOVED,{imageId:e.imageId})}var t={maximumSizeInBytes:d,cacheSizeInBytes:f,numberOfImagesCached:c.length};Object(o.default)(r.events,r.default.WEBGL_TEXTURE_CACHE_FULL,t)}}t.default={purgeCache:function(){for(;c.length>0;){var e=c.pop();delete l[e.imageId]}f=0},getImageTexture:function(e){if(void 0===e)throw new Error("getImageTexture: imageId must not be undefined");var t=l[e];if(void 0!==t)return t.timeStamp=new Date,t.imageTexture},putImageTexture:function(image,e){var t=image.imageId;if(void 0===image)throw new Error("putImageTexture: image must not be undefined");if(void 0===t)throw new Error("putImageTexture: imageId must not be undefined");if(void 0===e)throw new Error("putImageTexture: imageTexture must not be undefined");if(!0===Object.prototype.hasOwnProperty.call(l,t))throw new Error("putImageTexture: imageId already in cache");var n={imageId:t,imageTexture:e,timeStamp:new Date,sizeInBytes:e.sizeInBytes};if(l[t]=n,c.push(n),void 0===e.sizeInBytes)throw new Error("putImageTexture: imageTexture.sizeInBytes must not be undefined");if(void 0===e.sizeInBytes.toFixed)throw new Error("putImageTexture: imageTexture.sizeInBytes is not a number");f+=n.sizeInBytes,h()},removeImageTexture:function(e){if(void 0===e)throw new Error("removeImageTexture: imageId must not be undefined");var t=l[e];if(void 0===t)throw new Error("removeImageTexture: imageId must not be undefined");return c.splice(c.indexOf(t),1),f-=t.sizeInBytes,delete l[e],t.imageTexture},setMaximumSizeBytes:function(e){if(void 0===e)throw new Error("setMaximumSizeBytes: parameter numBytes must not be undefined");if(void 0===e.toFixed)throw new Error("setMaximumSizeBytes: parameter numBytes must be a number");d=e,h()}}},"./webgl/vertexShader.js":function(e,t,n){"use strict";n.r(t),n.d(t,"vertexShader",(function(){return r}));var r="attribute vec2 a_position;attribute vec2 a_texCoord;uniform vec2 u_resolution;varying vec2 v_texCoord;void main() {vec2 zeroToOne = a_position / u_resolution;vec2 zeroToTwo = zeroToOne * 2.0;vec2 clipSpace = zeroToTwo - 1.0;gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);v_texCoord = a_texCoord;}"}})},e.exports=r()},579:function(e,t,n){window,e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),o=n(1),s=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t||0,this.y=n||0,this.z=i||0}return i(e,[{key:"set",value:function(e,t,n){return this.x=e,this.y=t,this.z=n,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"multiplyVectors",value:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i+r[12],this.y=r[1]*t+r[5]*n+r[9]*i+r[13],this.z=r[2]*t+r[6]*n+r[10]*i+r[14],this}},{key:"applyProjection",value:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements,o=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*o,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*o,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*o,this}},{key:"applyQuaternion",value:function(e){var t=this.x,n=this.y,i=this.z,r=e.x,o=e.y,s=e.z,a=e.w,u=a*t+o*i-s*n,l=a*n+s*t-r*i,c=a*i+r*n-o*t,d=-r*t-o*n-s*i;return this.x=u*a+d*-r+l*-s-c*-o,this.y=l*a+d*-o+c*-r-u*-s,this.z=c*a+d*-s+u*-o-l*-r,this}},{key:"transformDirection",value:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize(),this}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}},{key:"divideScalar",value:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return this}},{key:"min",value:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this}},{key:"max",value:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this}},{key:"clamp",value:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.multiplyScalar(-1)}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"lengthManhattan",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length())}},{key:"setLength",value:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}},{key:"cross",value:function(e,t){if(void 0!==t)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var n=this.x,i=this.y,r=this.z;return this.x=i*e.z-r*e.y,this.y=r*e.x-n*e.z,this.z=n*e.y-i*e.x,this}},{key:"crossVectors",value:function(e,t){var n=e.x,i=e.y,r=e.z,o=t.x,s=t.y,a=t.z;return this.x=i*a-r*s,this.y=r*o-n*a,this.z=n*s-i*o,this}},{key:"angleTo",value:function(e){var t=this.dot(e)/(this.length()*e.length());return Math.acos((0,o.clamp)(t,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}},{key:"setFromMatrixPosition",value:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this}},{key:"setFromMatrixScale",value:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),n=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),i=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=n,this.z=i,this}},{key:"setFromMatrixColumn",value:function(e,t){var n=4*e,i=t.elements;return this.x=i[n],this.y=i[n+1],this.z=i[n+2],this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"fromArray",value:function(e){return this.x=e[0],this.y=e[1],this.z=e[2],this}},{key:"toArray",value:function(){return[this.x,this.y,this.z]}},{key:"clone",value:function(){return new e(this.x,this.y,this.z)}}]),e}();s.prototype.projectOnVector=function(){var e=void 0,t=void 0;return function(n){return void 0===e&&(e=new s),e.copy(n).normalize(),t=this.dot(e),this.copy(e).multiplyScalar(t)}}(),s.prototype.projectOnPlane=function(){var e=void 0;return function(t){return void 0===e&&(e=new s),e.copy(this).projectOnVector(t),this.sub(e)}}(),s.prototype.reflect=function(){var e=void 0;return function(t){return void 0===e&&(e=new s),this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),s.prototype.clampScalar=function(){var e=void 0,t=void 0;return function(n,i){return void 0===e&&(e=new s,t=new s),e.set(n,n,n),t.set(i,i,i),this.clamp(e,t)}}(),s.prototype.applyAxisAngle=function(){var e=void 0;return function(t,n){return void 0===e&&(e=new r.default),this.applyQuaternion(e.setFromAxisAngle(t.normalize(),n)),this}}(),t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=1e-4;t.clamp=function(e,t,n){return e<t?t:e>n?n:e},t.degToRad=function(e){return e*(Math.PI/180)},t.approximatelyEquals=function(e,t,n){var r=n||i;return Math.abs(e-t)<=r*Math.max(1,Math.abs(e),Math.abs(t))},t.radToDeg=function(e){return e*(180/Math.PI)},t.sign=function(e){return"number"==typeof e?e?e<0?-1:1:e==e?0:NaN:NaN}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t,n,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t||0,this.y=n||0,this.z=i||0,this.w=void 0!==r?r:1}return i(e,[{key:"setFromAxisAngle",value:function(e,t){var n=t/2,i=Math.sin(n);return this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(n),this}},{key:"multiplyQuaternions",value:function(e,t){var n=e.x,i=e.y,r=e.z,o=e.w,s=t.x,a=t.y,u=t.z,l=t.w;return this.x=n*l+o*s+i*u-r*a,this.y=i*l+o*a+r*s-n*u,this.z=r*l+o*u+n*a-i*s,this.w=o*l-n*s-i*a-r*u,this}},{key:"setFromRotationMatrix",value:function(e){var t=e.elements,n=t[0],i=t[4],r=t[8],o=t[1],s=t[5],a=t[9],u=t[2],l=t[6],c=t[10],d=n+s+c,f=void 0;return d>0?(f=.5/Math.sqrt(d+1),this.w=.25/f,this.x=(l-a)*f,this.y=(r-u)*f,this.z=(o-i)*f):n>s&&n>c?(f=2*Math.sqrt(1+n-s-c),this.w=(l-a)/f,this.x=.25*f,this.y=(i+o)/f,this.z=(r+u)/f):s>c?(f=2*Math.sqrt(1+s-n-c),this.w=(r-u)/f,this.x=(i+o)/f,this.y=.25*f,this.z=(a+l)/f):(f=2*Math.sqrt(1+c-n-s),this.w=(o-i)/f,this.x=(r+u)/f,this.y=(a+l)/f,this.z=.25*f),this}}]),e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1);function r(e){return e*e}function o(e,t){return r(e.x-t.x)+r(e.y-t.y)}var s={distanceToPoint:function(e,t){return Math.sqrt(function(e,t){var n=o(e.start,e.end);if(0===n)return o(t,e.start);var i=((t.x-e.start.x)*(e.end.x-e.start.x)+(t.y-e.start.y)*(e.end.y-e.start.y))/n;return o(t,i<0?e.start:i>1?e.end:{x:e.start.x+i*(e.end.x-e.start.x),y:e.start.y+i*(e.end.y-e.start.y)})}(e,t))},intersectLine:function(e,t){var n,r,o,s,a,u,l,c,d,f,h,m={},v=e.start.x,p=e.start.y,y=e.end.x,x=e.end.y,g=t.start.x,b=t.start.y,j=t.end.x,w=t.end.y,T=void 0;if(f=(n=x-p)*j+(o=v-y)*w+(a=y*p-v*x),(0===(d=n*g+o*b+a)||0===f||(0,i.sign)(d)!==(0,i.sign)(f))&&(c=(r=w-b)*y+(s=g-j)*x+(u=j*b-g*w),0===(l=r*v+s*p+u)||0===c||(0,i.sign)(l)!==(0,i.sign)(c))){h=n*s-r*o,T=o*u-s*a;var E=parseFloat(T/h);T=r*a-n*u;var O=parseFloat(T/h);return m.x=E,m.y=O,m}}};t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Vector3=t.rect=t.quaternion=t.point=t.Plane=t.Matrix4=t.sign=t.radToDeg=t.degToRad=t.clamp=t.lineSegment=t.Line3=void 0;var i=f(n(5)),r=f(n(3)),o=n(1),s=f(n(6)),a=f(n(7)),u=f(n(8)),l=f(n(2)),c=f(n(9)),d=f(n(0));function f(e){return e&&e.__esModule?e:{default:e}}var h={Line3:i.default,lineSegment:r.default,clamp:o.clamp,degToRad:o.degToRad,radToDeg:o.radToDeg,sign:o.sign,Matrix4:s.default,Plane:a.default,point:u.default,quaternion:l.default,rect:c.default,Vector3:d.default};t.Line3=i.default,t.lineSegment=r.default,t.clamp=o.clamp,t.degToRad=o.degToRad,t.radToDeg=o.radToDeg,t.sign=o.sign,t.Matrix4=s.default,t.Plane=a.default,t.point=u.default,t.quaternion=l.default,t.rect=c.default,t.Vector3=d.default,t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),o=n(1),s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.start=void 0!==t?t:new r.default,this.end=void 0!==n?n:new r.default}return i(e,[{key:"set",value:function(e,t){return this.start.copy(e),this.end.copy(t),this}},{key:"copy",value:function(e){return this.start.copy(e.start),this.end.copy(e.end),this}},{key:"center",value:function(e){return(e||new r.default).addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(e){return(e||new r.default).subVectors(this.end,this.start)}},{key:"distanceSq",value:function(){return this.start.distanceToSquared(this.end)}},{key:"distance",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(e,t){var n=t||new r.default;return this.delta(n).multiplyScalar(e).add(this.start)}},{key:"closestPointToPointParameter",value:function(e,t){var n=new r.default,i=new r.default;n.subVectors(e,this.start),i.subVectors(this.end,this.start);var s=i.dot(i),a=i.dot(n)/s;return t&&(a=(0,o.clamp)(a,0,1)),a}},{key:"closestPointToPoint",value:function(e,t,n){var i=this.closestPointToPointParameter(e,t),o=n||new r.default;return this.delta(o).multiplyScalar(i).add(this.start)}},{key:"applyMatrix4",value:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}},{key:"equals",value:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}},{key:"clone",value:function(){return(new e).copy(this)}},{key:"intersectLine",value:function(e){var t=this.end.clone().sub(this.start),n=e.end.clone().sub(e.start),i=e.start.clone().sub(this.start),r=t.clone().cross(n),s=i.clone().cross(n),a=i.dot(r)/(i.lengthSq()*r.lengthSq());if((0,o.approximatelyEquals)(a,0)){var u=s.dot(r)/r.lengthSq();if(!(u>1||isNaN(u))){var l=this.start.clone().add(t.clone().multiplyScalar(u));return l.clone().sub(e.start).lengthSq()+l.clone().sub(e.end).lengthSq()<=e.distanceSq()?l:void 0}}}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),o=function(){function e(t,n,i,r,o,s,a,u,l,c,d,f,h,m,v,p){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elements=new Float32Array(16);var y=this.elements;y[0]=void 0!==t?t:1,y[4]=n||0,y[8]=i||0,y[12]=r||0,y[1]=o||0,y[5]=void 0!==s?s:1,y[9]=a||0,y[13]=u||0,y[2]=l||0,y[6]=c||0,y[10]=void 0!==d?d:1,y[14]=f||0,y[3]=h||0,y[7]=m||0,y[11]=v||0,y[15]=void 0!==p?p:1}return i(e,[{key:"makeRotationFromQuaternion",value:function(e){var t=this.elements,n=e.x,i=e.y,r=e.z,o=e.w,s=n+n,a=i+i,u=r+r,l=n*s,c=n*a,d=n*u,f=i*a,h=i*u,m=r*u,v=o*s,p=o*a,y=o*u;return t[0]=1-(f+m),t[4]=c-y,t[8]=d+p,t[1]=c+y,t[5]=1-(l+m),t[9]=h-v,t[2]=d-p,t[6]=h+v,t[10]=1-(l+f),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,i=t.elements,r=this.elements,o=n[0],s=n[4],a=n[8],u=n[12],l=n[1],c=n[5],d=n[9],f=n[13],h=n[2],m=n[6],v=n[10],p=n[14],y=n[3],x=n[7],g=n[11],b=n[15],j=i[0],w=i[4],T=i[8],E=i[12],O=i[1],C=i[5],S=i[9],I=i[13],M=i[2],P=i[6],q=i[10],_=i[14],D=i[3],k=i[7],L=i[11],A=i[15];return r[0]=o*j+s*O+a*M+u*D,r[4]=o*w+s*C+a*P+u*k,r[8]=o*T+s*S+a*q+u*L,r[12]=o*E+s*I+a*_+u*A,r[1]=l*j+c*O+d*M+f*D,r[5]=l*w+c*C+d*P+f*k,r[9]=l*T+c*S+d*q+f*L,r[13]=l*E+c*I+d*_+f*A,r[2]=h*j+m*O+v*M+p*D,r[6]=h*w+m*C+v*P+p*k,r[10]=h*T+m*S+v*q+p*L,r[14]=h*E+m*I+v*_+p*A,r[3]=y*j+x*O+g*M+b*D,r[7]=y*w+x*C+g*P+b*k,r[11]=y*T+x*S+g*q+b*L,r[15]=y*E+x*I+g*_+b*A,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}},{key:"getInverse",value:function(e,t){var n=this.elements,i=e.elements,r=i[0],o=i[4],s=i[8],a=i[12],u=i[1],l=i[5],c=i[9],d=i[13],f=i[2],h=i[6],m=i[10],v=i[14],p=i[3],y=i[7],x=i[11],g=i[15];n[0]=c*v*y-d*m*y+d*h*x-l*v*x-c*h*g+l*m*g,n[4]=a*m*y-s*v*y-a*h*x+o*v*x+s*h*g-o*m*g,n[8]=s*d*y-a*c*y+a*l*x-o*d*x-s*l*g+o*c*g,n[12]=a*c*h-s*d*h-a*l*m+o*d*m+s*l*v-o*c*v,n[1]=d*m*p-c*v*p-d*f*x+u*v*x+c*f*g-u*m*g,n[5]=s*v*p-a*m*p+a*f*x-r*v*x-s*f*g+r*m*g,n[9]=a*c*p-s*d*p-a*u*x+r*d*x+s*u*g-r*c*g,n[13]=s*d*f-a*c*f+a*u*m-r*d*m-s*u*v+r*c*v,n[2]=l*v*p-d*h*p+d*f*y-u*v*y-l*f*g+u*h*g,n[6]=a*h*p-o*v*p-a*f*y+r*v*y+o*f*g-r*h*g,n[10]=o*d*p-a*l*p+a*u*y-r*d*y-o*u*g+r*l*g,n[14]=a*l*f-o*d*f-a*u*h+r*d*h+o*u*v-r*l*v,n[3]=c*h*p-l*m*p-c*f*y+u*m*y+l*f*x-u*h*x,n[7]=o*m*p-s*h*p+s*f*y-r*m*y-o*f*x+r*h*x,n[11]=s*l*p-o*c*p-s*u*y+r*c*y+o*u*x-r*l*x,n[15]=o*c*f-s*l*f+s*u*h-r*c*h-o*u*m+r*l*m;var b=r*n[0]+u*n[4]+f*n[8]+p*n[12];if(0===b){var j="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(j);return console.warn(j),this.identity(),this}return this.multiplyScalar(1/b),this}},{key:"applyToVector3Array",value:function(){var e=new r.default;return function(t,n,i){void 0===n&&(n=0),void 0===i&&(i=t.length);for(var r=0,o=n;r<i;r+=3,o+=3)e.x=t[o],e.y=t[o+1],e.z=t[o+2],e.applyMatrix4(this),t[o]=e.x,t[o+1]=e.y,t[o+2]=e.z;return t}}},{key:"makeTranslation",value:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}},{key:"set",value:function(e,t,n,i,r,o,s,a,u,l,c,d,f,h,m,v){var p=this.elements;return p[0]=e,p[4]=t,p[8]=n,p[12]=i,p[1]=r,p[5]=o,p[9]=s,p[13]=a,p[2]=u,p[6]=l,p[10]=c,p[14]=d,p[3]=f,p[7]=h,p[11]=m,p[15]=v,this}},{key:"makeScale",value:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.normal=void 0!==t?t:new r.default(1,0,0),this.constant=void 0!==n?n:0}return i(e,[{key:"set",value:function(e,t){return this.normal.copy(e),this.constant=t,this}},{key:"setComponents",value:function(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}},{key:"setFromNormalAndCoplanarPoint",value:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}},{key:"copy",value:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this}},{key:"normalize",value:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}},{key:"negate",value:function(){return this.constant*=-1,this.normal.negate(),this}},{key:"distanceToPoint",value:function(e){return this.normal.dot(e)+this.constant}},{key:"distanceToSphere",value:function(e){return this.distanceToPoint(e.center)-e.radius}},{key:"projectPoint",value:function(e,t){return this.orthoPoint(e,t).sub(e).negate()}},{key:"orthoPoint",value:function(e,t){var n=this.distanceToPoint(e);return(t||new r.default).copy(this.normal).multiplyScalar(n)}},{key:"isIntersectionLine",value:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}},{key:"intersectPlane",value:function(e){var t=this.normal.clone().cross(e.normal),n={origin:new r.default,direction:t};if(this.normal.clone().cross(e.normal).length<1e-10)return n.direction=new r.default,n;var i=this.constant,o=e.constant,s=this.normal.clone().dot(e.normal),a=-(i-o*s)/(1-s*s),u=-(o-i*s)/(1-s*s);return n.origin=this.normal.clone().multiplyScalar(a).add(e.normal.clone().multiplyScalar(u)),n}},{key:"coplanarPoint",value:function(e){return(e||new r.default).copy(this.normal).multiplyScalar(-this.constant)}},{key:"translate",value:function(e){return this.constant=this.constant-e.dot(this.normal),this}},{key:"equals",value:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}},{key:"clone",value:function(){return(new e).copy(this)}}]),e}();o.prototype.setFromCoplanarPoints=function(){var e=new r.default,t=new r.default;return function(n,i,r){var o=e.subVectors(r,i).cross(t.subVectors(n,i)).normalize();return this.setFromNormalAndCoplanarPoint(o,n),this}}(),o.prototype.intersectLine=function(){var e=new r.default;return function(t,n){var i=n||new r.default,o=t.delta(e),s=this.normal.dot(o);if(0===s)return 0===this.distanceToPoint(t.start)?i.copy(t.start):void 0;var a=-(t.start.dot(this.normal)+this.constant)/s;return a<0||a>1?void 0:i.copy(o).multiplyScalar(a).add(t.start)}}(),t.default=o},function(e,t,n){"use strict";function i(e,t){return{x:e.x-t.x,y:e.y-t.y}}function r(e,t){return Math.sqrt(o(e,t))}function o(e,t){var n=i(e,t);return n.x*n.x+n.y*n.y}Object.defineProperty(t,"__esModule",{value:!0});var s={subtract:i,copy:function(e){return{x:e.x,y:e.y}},pageToPoint:function(e){return{x:e.pageX,y:e.pageY}},distance:r,distanceSquared:o,insideRect:function(e,t){return!(e.x<t.left||e.x>t.left+t.width||e.y<t.top||e.y>t.top+t.height)},findClosestPoint:function(e,t){var n=[],i=void 0;return e.forEach((function(e,o){var s=r(e,t);n.push(s),i=0===o?s:Math.min(s,i)})),e[n.indexOf(i)]}};t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return e&&e.__esModule?e:{default:e}}(n(3));function r(e){return{topLeft:{x:e.left,y:e.top},bottomRight:{x:e.left+e.width,y:e.top+e.height}}}var o={distanceToPoint:function(e,t){var n=655535;return function(e){return[{start:{x:e.left,y:e.top},end:{x:e.left+e.width,y:e.top}},{start:{x:e.left+e.width,y:e.top},end:{x:e.left+e.width,y:e.top+e.height}},{start:{x:e.left+e.width,y:e.top+e.height},end:{x:e.left,y:e.top+e.height}},{start:{x:e.left,y:e.top+e.height},end:{x:e.left,y:e.top}}]}(e).forEach((function(e){var r=i.default.distanceToPoint(e,t);r<n&&(n=r)})),n},getIntersectionRect:function(e,t){var n={topLeft:{},bottomRight:{}};if(function(e,t){var n=void 0,i=void 0,o=r(e),s=r(t);return n=e.width>=0?t.width>=0?!(o.bottomRight.x<=s.topLeft.x||s.bottomRight.x<=o.topLeft.x):!(o.bottomRight.x<=s.bottomRight.x||s.topLeft.x<=o.topLeft.x):t.width>=0?!(o.topLeft.x<=s.topLeft.x||s.bottomRight.x<=o.bottomRight.x):!(o.topLeft.x<=s.bottomRight.x||s.topLeft.x<=o.bottomRight.x),i=e.height>=0?t.height>=0?!(o.bottomRight.y<=s.topLeft.y||s.bottomRight.y<=o.topLeft.y):!(o.bottomRight.y<=s.bottomRight.y||s.topLeft.y<=o.topLeft.y):t.height>=0?!(o.topLeft.y<=s.topLeft.y||s.bottomRight.y<=o.bottomRight.y):!(o.topLeft.y<=s.bottomRight.y||s.top<=o.bottomRight.y),n&&i}(e,t)){var i=r(e),o=r(t);return e.width>=0?t.width>=0?(n.topLeft.x=Math.max(i.topLeft.x,o.topLeft.x),n.bottomRight.x=Math.min(i.bottomRight.x,o.bottomRight.x)):(n.topLeft.x=Math.max(i.topLeft.x,o.bottomRight.x),n.bottomRight.x=Math.min(i.bottomRight.x,o.topLeft.x)):t.width>=0?(n.topLeft.x=Math.min(i.topLeft.x,o.bottomRight.x),n.bottomRight.x=Math.max(i.bottomRight.x,o.topLeft.x)):(n.topLeft.x=Math.min(i.topLeft.x,o.topLeft.x),n.bottomRight.x=Math.max(i.bottomRight.x,o.bottomRight.x)),e.height>=0?t.height>=0?(n.topLeft.y=Math.max(i.topLeft.y,o.topLeft.y),n.bottomRight.y=Math.min(i.bottomRight.y,o.bottomRight.y)):(n.topLeft.y=Math.max(i.topLeft.y,o.bottomRight.y),n.bottomRight.y=Math.min(i.bottomRight.y,o.topLeft.y)):t.height>=0?(n.topLeft.y=Math.min(i.topLeft.y,o.bottomRight.y),n.bottomRight.y=Math.max(i.bottomRight.y,o.topLeft.y)):(n.topLeft.y=Math.min(i.topLeft.y,o.topLeft.y),n.bottomRight.y=Math.max(i.bottomRight.y,o.bottomRight.y)),n}}};t.default=o}])},580:function(e,t,n){e.exports=(()=>{var e={7647:(e,t,n)=>{e.exports=n(3798)},6028:(e,t,n)=>{e.exports=n(671)},187:(e,t,n)=>{e.exports=n(7283)},1655:(e,t,n)=>{e.exports=n(2882)},1246:(e,t,n)=>{e.exports=n(8730)},337:(e,t,n)=>{e.exports=n(3751)},2770:(e,t,n)=>{e.exports=n(1380)},1882:(e,t,n)=>{e.exports=n(6601)},7878:(e,t,n)=>{e.exports=n(8783)},2204:(e,t,n)=>{e.exports=n(4731)},1082:(e,t,n)=>{e.exports=n(5723)},646:(e,t,n)=>{n(8345);var r=n(2018);e.exports=r("Array").filter},1001:(e,t,n)=>{n(5313);var r=n(2018);e.exports=r("Array").slice},5587:(e,t,n)=>{n(4596);var r=n(2018);e.exports=r("Array").splice},4388:(e,t,n)=>{var r=n(646),o=Array.prototype;e.exports=function(e){var t=e.filter;return e===o||e instanceof Array&&t===o.filter?r:t}},1285:(e,t,n)=>{var r=n(1001),o=Array.prototype;e.exports=function(e){var t=e.slice;return e===o||e instanceof Array&&t===o.slice?r:t}},7681:(e,t,n)=>{var r=n(5587),o=Array.prototype;e.exports=function(e){var t=e.splice;return e===o||e instanceof Array&&t===o.splice?r:t}},8949:(e,t,n)=>{var r=n(9119),o=String.prototype;e.exports=function(e){var t=e.trim;return"string"==typeof e||e===o||e instanceof String&&t===o.trim?r:t}},2529:(e,t,n)=>{n(8524);var r=n(9081);e.exports=r.Object.assign},6854:(e,t,n)=>{n(6764);var r=n(9081).Object,o=e.exports=function(e,t,n){return r.defineProperty(e,t,n)};r.defineProperty.sham&&(o.sham=!0)},2744:(e,t,n)=>{n(554);var r=n(9081).Object,o=e.exports=function(e,t){return r.getOwnPropertyDescriptor(e,t)};r.getOwnPropertyDescriptor.sham&&(o.sham=!0)},6018:(e,t,n)=>{n(4267);var r=n(9081);e.exports=r.Object.getOwnPropertyDescriptors},5350:(e,t,n)=>{n(8318);var r=n(9081);e.exports=r.Object.getOwnPropertySymbols},8116:(e,t,n)=>{n(8390);var r=n(9081);e.exports=r.Object.keys},7281:(e,t,n)=>{n(6454),n(2228),n(2575),n(3658),n(4465),n(8359),n(5203),n(8109);var r=n(9081);e.exports=r.Promise},9119:(e,t,n)=>{n(8217);var r=n(2018);e.exports=r("String").trim},5723:(e,t,n)=>{var r=n(8531);e.exports=r},9077:e=>{e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},9154:(e,t,n)=>{var r=n(3359);e.exports=function(e){if(!r(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},7710:e=>{e.exports=function(){}},8792:e=>{e.exports=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e}},1912:(e,t,n)=>{var r=n(3359);e.exports=function(e){if(!r(e))throw TypeError(String(e)+" is not an object");return e}},7075:(e,t,n)=>{var r=n(3861),o=n(3746),a=n(3055),i=function(e){return function(t,n,i){var s,l=r(t),c=o(l.length),u=a(i,c);if(e&&n!=n){for(;c>u;)if((s=l[u++])!=s)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:i(!0),indexOf:i(!1)}},4206:(e,t,n)=>{var r=n(7673),o=n(1251),a=n(2058),i=n(3746),s=n(8136),l=[].push,c=function(e){var t=1==e,n=2==e,c=3==e,u=4==e,d=6==e,f=7==e,p=5==e||d;return function(h,m,g,v){for(var y,x,b=a(h),j=o(b),w=r(m,g,3),T=i(j.length),E=0,O=v||s,C=t?O(h,T):n||f?O(h,0):void 0;T>E;E++)if((p||E in j)&&(x=w(y=j[E],E,b),e))if(t)C[E]=x;else if(x)switch(e){case 3:return!0;case 5:return y;case 6:return E;case 2:l.call(C,y)}else switch(e){case 4:return!1;case 7:l.call(C,y)}return d?-1:c||u?u:C}};e.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterReject:c(7)}},2143:(e,t,n)=>{var r=n(6530),o=n(5712),a=n(8233),i=o("species");e.exports=function(e){return a>=51||!r((function(){var t=[];return(t.constructor={})[i]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},3400:(e,t,n)=>{var r=n(3359),o=n(1054),a=n(5712)("species");e.exports=function(e){var t;return o(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!o(t.prototype)?r(t)&&null===(t=t[a])&&(t=void 0):t=void 0),void 0===t?Array:t}},8136:(e,t,n)=>{var r=n(3400);e.exports=function(e,t){return new(r(e))(0===t?0:t)}},8908:(e,t,n)=>{var r=n(5712)("iterator"),o=!1;try{var a=0,i={next:function(){return{done:!!a++}},return:function(){o=!0}};i[r]=function(){return this},Array.from(i,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var a={};a[r]=function(){return{next:function(){return{done:n=!0}}}},e(a)}catch(e){}return n}},1570:e=>{var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},7499:(e,t,n)=>{var r=n(8889),o=n(1570),a=n(5712)("toStringTag"),i="Arguments"==o(function(){return arguments}());e.exports=r?o:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),a))?n:i?o(t):"Object"==(r=o(t))&&"function"==typeof t.callee?"Arguments":r}},872:(e,t,n)=>{var r=n(6530);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},8611:(e,t,n)=>{"use strict";var r=n(7300).IteratorPrototype,o=n(2491),a=n(5595),i=n(6738),s=n(9418),l=function(){return this};e.exports=function(e,t,n){var c=t+" Iterator";return e.prototype=o(r,{next:a(1,n)}),i(e,c,!1,!0),s[c]=l,e}},8518:(e,t,n)=>{var r=n(7001),o=n(7550),a=n(5595);e.exports=r?function(e,t,n){return o.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}},5595:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},409:(e,t,n)=>{"use strict";var r=n(5623),o=n(7550),a=n(5595);e.exports=function(e,t,n){var i=r(t);i in e?o.f(e,i,a(0,n)):e[i]=n}},8277:(e,t,n)=>{"use strict";var r=n(390),o=n(8611),a=n(2629),i=n(5255),s=n(6738),l=n(8518),c=n(9791),u=n(5712),d=n(8367),f=n(9418),p=n(7300),h=p.IteratorPrototype,m=p.BUGGY_SAFARI_ITERATORS,g=u("iterator"),v="keys",y="values",x="entries",b=function(){return this};e.exports=function(e,t,n,u,p,j,w){o(n,t,u);var T,E,O,C=function(e){if(e===p&&_)return _;if(!m&&e in M)return M[e];switch(e){case v:case y:case x:return function(){return new n(this,e)}}return function(){return new n(this)}},S=t+" Iterator",I=!1,M=e.prototype,P=M[g]||M["@@iterator"]||p&&M[p],_=!m&&P||C(p),D="Array"==t&&M.entries||P;if(D&&(T=a(D.call(new e)),h!==Object.prototype&&T.next&&(d||a(T)===h||(i?i(T,h):"function"!=typeof T[g]&&l(T,g,b)),s(T,S,!0,!0),d&&(f[S]=b))),p==y&&P&&P.name!==y&&(I=!0,_=function(){return P.call(this)}),d&&!w||M[g]===_||l(M,g,_),f[t]=_,p)if(E={values:C(y),keys:j?_:C(v),entries:C(x)},w)for(O in E)(m||I||!(O in M))&&c(M,O,E[O]);else r({target:t,proto:!0,forced:m||I},E);return E}},1412:(e,t,n)=>{var r=n(9081),o=n(6690),a=n(3379),i=n(7550).f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});o(t,e)||i(t,e,{value:a.f(e)})}},7001:(e,t,n)=>{var r=n(6530);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},231:(e,t,n)=>{var r=n(2868),o=n(3359),a=r.document,i=o(a)&&o(a.createElement);e.exports=function(e){return i?a.createElement(e):{}}},315:e=>{e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},6610:e=>{e.exports="object"==typeof window},6405:(e,t,n)=>{var r=n(6900),o=n(2868);e.exports=/ipad|iphone|ipod/i.test(r)&&void 0!==o.Pebble},6540:(e,t,n)=>{var r=n(6900);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},6521:(e,t,n)=>{var r=n(1570),o=n(2868);e.exports="process"==r(o.process)},4010:(e,t,n)=>{var r=n(6900);e.exports=/web0s(?!.*chrome)/i.test(r)},6900:(e,t,n)=>{var r=n(8104);e.exports=r("navigator","userAgent")||""},8233:(e,t,n)=>{var r,o,a=n(2868),i=n(6900),s=a.process,l=a.Deno,c=s&&s.versions||l&&l.version,u=c&&c.v8;u?o=(r=u.split("."))[0]<4?1:r[0]+r[1]:i&&(!(r=i.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=i.match(/Chrome\/(\d+)/))&&(o=r[1]),e.exports=o&&+o},2018:(e,t,n)=>{var r=n(9081);e.exports=function(e){return r[e+"Prototype"]}},2712:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},390:(e,t,n)=>{"use strict";var r=n(2868),o=n(5904).f,a=n(1011),i=n(9081),s=n(7673),l=n(8518),c=n(6690),u=function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t};e.exports=function(e,t){var n,d,f,p,h,m,g,v,y=e.target,x=e.global,b=e.stat,j=e.proto,w=x?r:b?r[y]:(r[y]||{}).prototype,T=x?i:i[y]||l(i,y,{})[y],E=T.prototype;for(f in t)n=!a(x?f:y+(b?".":"#")+f,e.forced)&&w&&c(w,f),h=T[f],n&&(m=e.noTargetGet?(v=o(w,f))&&v.value:w[f]),p=n&&m?m:t[f],n&&typeof h==typeof p||(g=e.bind&&n?s(p,r):e.wrap&&n?u(p):j&&"function"==typeof p?s(Function.call,p):p,(e.sham||p&&p.sham||h&&h.sham)&&l(g,"sham",!0),l(T,f,g),j&&(c(i,d=y+"Prototype")||l(i,d,{}),l(i[d],f,p),e.real&&E&&!E[f]&&l(E,f,p)))}},6530:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},7673:(e,t,n)=>{var r=n(9077);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},8104:(e,t,n)=>{var r=n(9081),o=n(2868),a=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?a(r[e])||a(o[e]):r[e]&&r[e][t]||o[e]&&o[e][t]}},5018:(e,t,n)=>{var r=n(7499),o=n(9418),a=n(5712)("iterator");e.exports=function(e){if(null!=e)return e[a]||e["@@iterator"]||o[r(e)]}},5945:(e,t,n)=>{var r=n(1912),o=n(5018);e.exports=function(e,t){var n=arguments.length<2?o(e):t;if("function"!=typeof n)throw TypeError(String(e)+" is not iterable");return r(n.call(e))}},2868:(e,t,n)=>{var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},6690:(e,t,n)=>{var r=n(2058),o={}.hasOwnProperty;e.exports=Object.hasOwn||function(e,t){return o.call(r(e),t)}},7048:e=>{e.exports={}},8471:(e,t,n)=>{var r=n(2868);e.exports=function(e,t){var n=r.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}},5644:(e,t,n)=>{var r=n(8104);e.exports=r("document","documentElement")},640:(e,t,n)=>{var r=n(7001),o=n(6530),a=n(231);e.exports=!r&&!o((function(){return 7!=Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},1251:(e,t,n)=>{var r=n(6530),o=n(1570),a="".split;e.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==o(e)?a.call(e,""):Object(e)}:Object},1494:(e,t,n)=>{var r=n(2656),o=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(e){return o.call(e)}),e.exports=r.inspectSource},5875:(e,t,n)=>{var r,o,a,i=n(2297),s=n(2868),l=n(3359),c=n(8518),u=n(6690),d=n(2656),f=n(5039),p=n(7048),h="Object already initialized",m=s.WeakMap;if(i||d.state){var g=d.state||(d.state=new m),v=g.get,y=g.has,x=g.set;r=function(e,t){if(y.call(g,e))throw new TypeError(h);return t.facade=e,x.call(g,e,t),t},o=function(e){return v.call(g,e)||{}},a=function(e){return y.call(g,e)}}else{var b=f("state");p[b]=!0,r=function(e,t){if(u(e,b))throw new TypeError(h);return t.facade=e,c(e,b,t),t},o=function(e){return u(e,b)?e[b]:{}},a=function(e){return u(e,b)}}e.exports={set:r,get:o,has:a,enforce:function(e){return a(e)?o(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!l(t)||(n=o(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}}},6475:(e,t,n)=>{var r=n(5712),o=n(9418),a=r("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(o.Array===e||i[a]===e)}},1054:(e,t,n)=>{var r=n(1570);e.exports=Array.isArray||function(e){return"Array"==r(e)}},1011:(e,t,n)=>{var r=n(6530),o=/#|\.prototype\./,a=function(e,t){var n=s[i(e)];return n==c||n!=l&&("function"==typeof t?r(t):!!t)},i=a.normalize=function(e){return String(e).replace(o,".").toLowerCase()},s=a.data={},l=a.NATIVE="N",c=a.POLYFILL="P";e.exports=a},3359:e=>{e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},8367:e=>{e.exports=!0},1149:(e,t,n)=>{var r=n(8104),o=n(6046);e.exports=o?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return"function"==typeof t&&Object(e)instanceof t}},3906:(e,t,n)=>{var r=n(1912),o=n(6475),a=n(3746),i=n(7673),s=n(5945),l=n(5018),c=n(309),u=function(e,t){this.stopped=e,this.result=t};e.exports=function(e,t,n){var d,f,p,h,m,g,v,y=n&&n.that,x=!(!n||!n.AS_ENTRIES),b=!(!n||!n.IS_ITERATOR),j=!(!n||!n.INTERRUPTED),w=i(t,y,1+x+j),T=function(e){return d&&c(d,"normal",e),new u(!0,e)},E=function(e){return x?(r(e),j?w(e[0],e[1],T):w(e[0],e[1])):j?w(e,T):w(e)};if(b)d=e;else{if("function"!=typeof(f=l(e)))throw TypeError("Target is not iterable");if(o(f)){for(p=0,h=a(e.length);h>p;p++)if((m=E(e[p]))&&m instanceof u)return m;return new u(!1)}d=s(e,f)}for(g=d.next;!(v=g.call(d)).done;){try{m=E(v.value)}catch(e){c(d,"throw",e)}if("object"==typeof m&&m&&m instanceof u)return m}return new u(!1)}},309:(e,t,n)=>{var r=n(1912);e.exports=function(e,t,n){var o,a;r(e);try{if(void 0===(o=e.return)){if("throw"===t)throw n;return n}o=o.call(e)}catch(e){a=!0,o=e}if("throw"===t)throw n;if(a)throw o;return r(o),n}},7300:(e,t,n)=>{"use strict";var r,o,a,i=n(6530),s=n(2629),l=n(8518),c=n(6690),u=n(5712),d=n(8367),f=u("iterator"),p=!1;[].keys&&("next"in(a=[].keys())?(o=s(s(a)))!==Object.prototype&&(r=o):p=!0);var h=null==r||i((function(){var e={};return r[f].call(e)!==e}));h&&(r={}),d&&!h||c(r,f)||l(r,f,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:p}},9418:e=>{e.exports={}},8054:(e,t,n)=>{var r,o,a,i,s,l,c,u,d=n(2868),f=n(5904).f,p=n(6569).set,h=n(6540),m=n(6405),g=n(4010),v=n(6521),y=d.MutationObserver||d.WebKitMutationObserver,x=d.document,b=d.process,j=d.Promise,w=f(d,"queueMicrotask"),T=w&&w.value;T||(r=function(){var e,t;for(v&&(e=b.domain)&&e.exit();o;){t=o.fn,o=o.next;try{t()}catch(e){throw o?i():a=void 0,e}}a=void 0,e&&e.enter()},h||v||g||!y||!x?!m&&j&&j.resolve?((c=j.resolve(void 0)).constructor=j,u=c.then,i=function(){u.call(c,r)}):i=v?function(){b.nextTick(r)}:function(){p.call(d,r)}:(s=!0,l=x.createTextNode(""),new y(r).observe(l,{characterData:!0}),i=function(){l.data=s=!s})),e.exports=T||function(e){var t={fn:e,next:void 0};a&&(a.next=t),o||(o=t,i()),a=t}},3104:(e,t,n)=>{var r=n(2868);e.exports=r.Promise},3216:(e,t,n)=>{var r=n(8233),o=n(6530);e.exports=!!Object.getOwnPropertySymbols&&!o((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},2297:(e,t,n)=>{var r=n(2868),o=n(1494),a=r.WeakMap;e.exports="function"==typeof a&&/native code/.test(o(a))},4130:(e,t,n)=>{"use strict";var r=n(9077),o=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)};e.exports.f=function(e){return new o(e)}},3210:(e,t,n)=>{"use strict";var r=n(7001),o=n(6530),a=n(461),i=n(3764),s=n(1156),l=n(2058),c=n(1251),u=Object.assign,d=Object.defineProperty;e.exports=!u||o((function(){if(r&&1!==u({b:1},u(d({},"a",{enumerable:!0,get:function(){d(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),o="abcdefghijklmnopqrst";return e[n]=7,o.split("").forEach((function(e){t[e]=e})),7!=u({},e)[n]||a(u({},t)).join("")!=o}))?function(e,t){for(var n=l(e),o=arguments.length,u=1,d=i.f,f=s.f;o>u;)for(var p,h=c(arguments[u++]),m=d?a(h).concat(d(h)):a(h),g=m.length,v=0;g>v;)p=m[v++],r&&!f.call(h,p)||(n[p]=h[p]);return n}:u},2491:(e,t,n)=>{var r,o=n(1912),a=n(4686),i=n(2712),s=n(7048),l=n(5644),c=n(231),d=n(5039)("IE_PROTO"),f=function(){},p=function(e){return"<script>"+e+"<\/script>"},h=function(e){e.write(p("")),e.close();var t=e.parentWindow.Object;return e=null,t},m=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t;m="undefined"!=typeof document?document.domain&&r?h(r):((t=c("iframe")).style.display="none",l.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(p("document.F=Object")),e.close(),e.F):h(r);for(var n=i.length;n--;)delete m.prototype[i[n]];return m()};s[d]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(f.prototype=o(e),n=new f,f.prototype=null,n[d]=e):n=m(),void 0===t?n:a(n,t)}},4686:(e,t,n)=>{var r=n(7001),o=n(7550),a=n(1912),i=n(461);e.exports=r?Object.defineProperties:function(e,t){a(e);for(var n,r=i(t),s=r.length,l=0;s>l;)o.f(e,n=r[l++],t[n]);return e}},7550:(e,t,n)=>{var r=n(7001),o=n(640),a=n(1912),i=n(5623),s=Object.defineProperty;t.f=r?s:function(e,t,n){if(a(e),t=i(t),a(n),o)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},5904:(e,t,n)=>{var r=n(7001),o=n(1156),a=n(5595),i=n(3861),s=n(5623),l=n(6690),c=n(640),u=Object.getOwnPropertyDescriptor;t.f=r?u:function(e,t){if(e=i(e),t=s(t),c)try{return u(e,t)}catch(e){}if(l(e,t))return a(!o.f.call(e,t),e[t])}},6159:(e,t,n)=>{var r=n(3861),o=n(9035).f,a={}.toString,i="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return i&&"[object Window]"==a.call(e)?function(e){try{return o(e)}catch(e){return i.slice()}}(e):o(r(e))}},9035:(e,t,n)=>{var r=n(1247),o=n(2712).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},3764:(e,t)=>{t.f=Object.getOwnPropertySymbols},2629:(e,t,n)=>{var r=n(6690),o=n(2058),a=n(5039),i=n(872),s=a("IE_PROTO"),l=Object.prototype;e.exports=i?Object.getPrototypeOf:function(e){return e=o(e),r(e,s)?e[s]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?l:null}},1247:(e,t,n)=>{var r=n(6690),o=n(3861),a=n(7075).indexOf,i=n(7048);e.exports=function(e,t){var n,s=o(e),l=0,c=[];for(n in s)!r(i,n)&&r(s,n)&&c.push(n);for(;t.length>l;)r(s,n=t[l++])&&(~a(c,n)||c.push(n));return c}},461:(e,t,n)=>{var r=n(1247),o=n(2712);e.exports=Object.keys||function(e){return r(e,o)}},1156:(e,t)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!n.call({1:2},1);t.f=o?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},5255:(e,t,n)=>{var r=n(1912),o=n(9154);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,a){return r(n),o(a),t?e.call(n,a):n.__proto__=a,n}}():void 0)},4822:(e,t,n)=>{"use strict";var r=n(8889),o=n(7499);e.exports=r?{}.toString:function(){return"[object "+o(this)+"]"}},9466:(e,t,n)=>{var r=n(3359);e.exports=function(e,t){var n,o;if("string"===t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if("string"!==t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},5340:(e,t,n)=>{var r=n(8104),o=n(9035),a=n(3764),i=n(1912);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(i(e)),n=a.f;return n?t.concat(n(e)):t}},9081:e=>{e.exports={}},4618:e=>{e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},4567:(e,t,n)=>{var r=n(1912),o=n(3359),a=n(4130);e.exports=function(e,t){if(r(e),o(t)&&t.constructor===e)return t;var n=a.f(e);return(0,n.resolve)(t),n.promise}},9248:(e,t,n)=>{var r=n(9791);e.exports=function(e,t,n){for(var o in t)n&&n.unsafe&&e[o]?e[o]=t[o]:r(e,o,t[o],n);return e}},9791:(e,t,n)=>{var r=n(8518);e.exports=function(e,t,n,o){o&&o.enumerable?e[t]=n:r(e,t,n)}},3604:e=>{e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},2643:(e,t,n)=>{var r=n(2868);e.exports=function(e,t){try{Object.defineProperty(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},3918:(e,t,n)=>{"use strict";var r=n(8104),o=n(7550),a=n(5712),i=n(7001),s=a("species");e.exports=function(e){var t=r(e),n=o.f;i&&t&&!t[s]&&n(t,s,{configurable:!0,get:function(){return this}})}},6738:(e,t,n)=>{var r=n(8889),o=n(7550).f,a=n(8518),i=n(6690),s=n(4822),l=n(5712)("toStringTag");e.exports=function(e,t,n,c){if(e){var u=n?e:e.prototype;i(u,l)||o(u,l,{configurable:!0,value:t}),c&&!r&&a(u,"toString",s)}}},5039:(e,t,n)=>{var r=n(6315),o=n(9),a=r("keys");e.exports=function(e){return a[e]||(a[e]=o(e))}},2656:(e,t,n)=>{var r=n(2868),o=n(2643),a="__core-js_shared__",i=r[a]||o(a,{});e.exports=i},6315:(e,t,n)=>{var r=n(8367),o=n(2656);(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.17.2",mode:r?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},5462:(e,t,n)=>{var r=n(1912),o=n(9077),a=n(5712)("species");e.exports=function(e,t){var n,i=r(e).constructor;return void 0===i||null==(n=r(i)[a])?t:o(n)}},1420:(e,t,n)=>{var r=n(1470),o=n(5264),a=n(3604),i=function(e){return function(t,n){var i,s,l=o(a(t)),c=r(n),u=l.length;return c<0||c>=u?e?"":void 0:(i=l.charCodeAt(c))<55296||i>56319||c+1===u||(s=l.charCodeAt(c+1))<56320||s>57343?e?l.charAt(c):i:e?l.slice(c,c+2):s-56320+(i-55296<<10)+65536}};e.exports={codeAt:i(!1),charAt:i(!0)}},9787:(e,t,n)=>{var r=n(6530),o=n(3781);e.exports=function(e){return r((function(){return!!o[e]()||"​᠎"!="​᠎"[e]()||o[e].name!==e}))}},774:(e,t,n)=>{var r=n(3604),o=n(5264),a="["+n(3781)+"]",i=RegExp("^"+a+a+"*"),s=RegExp(a+a+"*$"),l=function(e){return function(t){var n=o(r(t));return 1&e&&(n=n.replace(i,"")),2&e&&(n=n.replace(s,"")),n}};e.exports={start:l(1),end:l(2),trim:l(3)}},6569:(e,t,n)=>{var r,o,a,i,s=n(2868),l=n(6530),c=n(7673),u=n(5644),d=n(231),f=n(6540),p=n(6521),h=s.setImmediate,m=s.clearImmediate,g=s.process,v=s.MessageChannel,y=s.Dispatch,x=0,b={},j="onreadystatechange";try{r=s.location}catch(e){}var w=function(e){if(b.hasOwnProperty(e)){var t=b[e];delete b[e],t()}},T=function(e){return function(){w(e)}},E=function(e){w(e.data)},O=function(e){s.postMessage(String(e),r.protocol+"//"+r.host)};h&&m||(h=function(e){for(var t=[],n=arguments.length,r=1;n>r;)t.push(arguments[r++]);return b[++x]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},o(x),x},m=function(e){delete b[e]},p?o=function(e){g.nextTick(T(e))}:y&&y.now?o=function(e){y.now(T(e))}:v&&!f?(i=(a=new v).port2,a.port1.onmessage=E,o=c(i.postMessage,i,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts&&r&&"file:"!==r.protocol&&!l(O)?(o=O,s.addEventListener("message",E,!1)):o=j in d("script")?function(e){u.appendChild(d("script")).onreadystatechange=function(){u.removeChild(this),w(e)}}:function(e){setTimeout(T(e),0)}),e.exports={set:h,clear:m}},3055:(e,t,n)=>{var r=n(1470),o=Math.max,a=Math.min;e.exports=function(e,t){var n=r(e);return n<0?o(n+t,0):a(n,t)}},3861:(e,t,n)=>{var r=n(1251),o=n(3604);e.exports=function(e){return r(o(e))}},1470:e=>{var t=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:t)(e)}},3746:(e,t,n)=>{var r=n(1470),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},2058:(e,t,n)=>{var r=n(3604);e.exports=function(e){return Object(r(e))}},3957:(e,t,n)=>{var r=n(3359),o=n(1149),a=n(9466),i=n(5712)("toPrimitive");e.exports=function(e,t){if(!r(e)||o(e))return e;var n,s=e[i];if(void 0!==s){if(void 0===t&&(t="default"),n=s.call(e,t),!r(n)||o(n))return n;throw TypeError("Can't convert object to primitive value")}return void 0===t&&(t="number"),a(e,t)}},5623:(e,t,n)=>{var r=n(3957),o=n(1149);e.exports=function(e){var t=r(e,"string");return o(t)?t:String(t)}},8889:(e,t,n)=>{var r={};r[n(5712)("toStringTag")]="z",e.exports="[object z]"===String(r)},5264:(e,t,n)=>{var r=n(1149);e.exports=function(e){if(r(e))throw TypeError("Cannot convert a Symbol value to a string");return String(e)}},9:e=>{var t=0,n=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++t+n).toString(36)}},6046:(e,t,n)=>{var r=n(3216);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3379:(e,t,n)=>{var r=n(5712);t.f=r},5712:(e,t,n)=>{var r=n(2868),o=n(6315),a=n(6690),i=n(9),s=n(3216),l=n(6046),c=o("wks"),u=r.Symbol,d=l?u:u&&u.withoutSetter||i;e.exports=function(e){return a(c,e)&&(s||"string"==typeof c[e])||(s&&a(u,e)?c[e]=u[e]:c[e]=d("Symbol."+e)),c[e]}},3781:e=>{e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},6454:(e,t,n)=>{"use strict";var r=n(390),o=n(2629),a=n(5255),i=n(2491),s=n(8518),l=n(5595),c=n(3906),u=n(5264),d=function(e,t){var n=this;if(!(n instanceof d))return new d(e,t);a&&(n=a(new Error(void 0),o(n))),void 0!==t&&s(n,"message",u(t));var r=[];return c(e,r.push,{that:r}),s(n,"errors",r),n};d.prototype=i(Error.prototype,{constructor:l(5,d),message:l(5,""),name:l(5,"AggregateError")}),r({global:!0},{AggregateError:d})},8345:(e,t,n)=>{"use strict";var r=n(390),o=n(4206).filter;r({target:"Array",proto:!0,forced:!n(2143)("filter")},{filter:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},2228:(e,t,n)=>{"use strict";var r=n(3861),o=n(7710),a=n(9418),i=n(5875),s=n(8277),l="Array Iterator",c=i.set,u=i.getterFor(l);e.exports=s(Array,"Array",(function(e,t){c(this,{type:l,target:r(e),index:0,kind:t})}),(function(){var e=u(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values"),a.Arguments=a.Array,o("keys"),o("values"),o("entries")},5313:(e,t,n)=>{"use strict";var r=n(390),o=n(3359),a=n(1054),i=n(3055),s=n(3746),l=n(3861),c=n(409),u=n(5712),d=n(2143)("slice"),f=u("species"),p=[].slice,h=Math.max;r({target:"Array",proto:!0,forced:!d},{slice:function(e,t){var n,r,u,d=l(this),m=s(d.length),g=i(e,m),v=i(void 0===t?m:t,m);if(a(d)&&("function"!=typeof(n=d.constructor)||n!==Array&&!a(n.prototype)?o(n)&&null===(n=n[f])&&(n=void 0):n=void 0,n===Array||void 0===n))return p.call(d,g,v);for(r=new(void 0===n?Array:n)(h(v-g,0)),u=0;g<v;g++,u++)g in d&&c(r,u,d[g]);return r.length=u,r}})},4596:(e,t,n)=>{"use strict";var r=n(390),o=n(3055),a=n(1470),i=n(3746),s=n(2058),l=n(8136),c=n(409),u=n(2143)("splice"),d=Math.max,f=Math.min,p=9007199254740991,h="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!u},{splice:function(e,t){var n,r,u,m,g,v,y=s(this),x=i(y.length),b=o(e,x),j=arguments.length;if(0===j?n=r=0:1===j?(n=0,r=x-b):(n=j-2,r=f(d(a(t),0),x-b)),x+n-r>p)throw TypeError(h);for(u=l(y,r),m=0;m<r;m++)(g=b+m)in y&&c(u,m,y[g]);if(u.length=r,n<r){for(m=b;m<x-r;m++)v=m+n,(g=m+r)in y?y[v]=y[g]:delete y[v];for(m=x;m>x-r+n;m--)delete y[m-1]}else if(n>r)for(m=x-r;m>b;m--)v=m+n-1,(g=m+r-1)in y?y[v]=y[g]:delete y[v];for(m=0;m<n;m++)y[m+b]=arguments[m+2];return y.length=x-r+n,u}})},8524:(e,t,n)=>{var r=n(390),o=n(3210);r({target:"Object",stat:!0,forced:Object.assign!==o},{assign:o})},6764:(e,t,n)=>{var r=n(390),o=n(7001);r({target:"Object",stat:!0,forced:!o,sham:!o},{defineProperty:n(7550).f})},554:(e,t,n)=>{var r=n(390),o=n(6530),a=n(3861),i=n(5904).f,s=n(7001),l=o((function(){i(1)}));r({target:"Object",stat:!0,forced:!s||l,sham:!s},{getOwnPropertyDescriptor:function(e,t){return i(a(e),t)}})},4267:(e,t,n)=>{var r=n(390),o=n(7001),a=n(5340),i=n(3861),s=n(5904),l=n(409);r({target:"Object",stat:!0,sham:!o},{getOwnPropertyDescriptors:function(e){for(var t,n,r=i(e),o=s.f,c=a(r),u={},d=0;c.length>d;)void 0!==(n=o(r,t=c[d++]))&&l(u,t,n);return u}})},8390:(e,t,n)=>{var r=n(390),o=n(2058),a=n(461);r({target:"Object",stat:!0,forced:n(6530)((function(){a(1)}))},{keys:function(e){return a(o(e))}})},2575:()=>{},4465:(e,t,n)=>{"use strict";var r=n(390),o=n(9077),a=n(4130),i=n(4618),s=n(3906);r({target:"Promise",stat:!0},{allSettled:function(e){var t=this,n=a.f(t),r=n.resolve,l=n.reject,c=i((function(){var n=o(t.resolve),a=[],i=0,l=1;s(e,(function(e){var o=i++,s=!1;a.push(void 0),l++,n.call(t,e).then((function(e){s||(s=!0,a[o]={status:"fulfilled",value:e},--l||r(a))}),(function(e){s||(s=!0,a[o]={status:"rejected",reason:e},--l||r(a))}))})),--l||r(a)}));return c.error&&l(c.value),n.promise}})},8359:(e,t,n)=>{"use strict";var r=n(390),o=n(9077),a=n(8104),i=n(4130),s=n(4618),l=n(3906),c="No one promise resolved";r({target:"Promise",stat:!0},{any:function(e){var t=this,n=i.f(t),r=n.resolve,u=n.reject,d=s((function(){var n=o(t.resolve),i=[],s=0,d=1,f=!1;l(e,(function(e){var o=s++,l=!1;i.push(void 0),d++,n.call(t,e).then((function(e){l||f||(f=!0,r(e))}),(function(e){l||f||(l=!0,i[o]=e,--d||u(new(a("AggregateError"))(i,c)))}))})),--d||u(new(a("AggregateError"))(i,c))}));return d.error&&u(d.value),n.promise}})},5203:(e,t,n)=>{"use strict";var r=n(390),o=n(8367),a=n(3104),i=n(6530),s=n(8104),l=n(5462),c=n(4567),u=n(9791);if(r({target:"Promise",proto:!0,real:!0,forced:!!a&&i((function(){a.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=l(this,s("Promise")),n="function"==typeof e;return this.then(n?function(n){return c(t,e()).then((function(){return n}))}:e,n?function(n){return c(t,e()).then((function(){throw n}))}:e)}}),!o&&"function"==typeof a){var d=s("Promise").prototype.finally;a.prototype.finally!==d&&u(a.prototype,"finally",d,{unsafe:!0})}},3658:(e,t,n)=>{"use strict";var r,o,a,i,s=n(390),l=n(8367),c=n(2868),u=n(8104),d=n(3104),f=n(9791),p=n(9248),h=n(5255),m=n(6738),g=n(3918),v=n(3359),y=n(9077),x=n(8792),b=n(1494),j=n(3906),w=n(8908),T=n(5462),E=n(6569).set,O=n(8054),C=n(4567),S=n(8471),I=n(4130),M=n(4618),P=n(5875),_=n(1011),D=n(5712),k=n(6610),L=n(6521),A=n(8233),R=D("species"),B="Promise",U=P.get,F=P.set,H=P.getterFor(B),N=d&&d.prototype,z=d,V=N,W=c.TypeError,G=c.document,q=c.process,Y=I.f,X=Y,Z=!!(G&&G.createEvent&&c.dispatchEvent),K="function"==typeof PromiseRejectionEvent,J="unhandledrejection",$=!1,Q=_(B,(function(){var e=b(z),t=e!==String(z);if(!t&&66===A)return!0;if(l&&!V.finally)return!0;if(A>=51&&/native code/.test(e))return!1;var n=new z((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};return(n.constructor={})[R]=r,!($=n.then((function(){}))instanceof r)||!t&&k&&!K})),ee=Q||!w((function(e){z.all(e).catch((function(){}))})),te=function(e){var t;return!(!v(e)||"function"!=typeof(t=e.then))&&t},ne=function(e,t){if(!e.notified){e.notified=!0;var n=e.reactions;O((function(){for(var r=e.value,o=1==e.state,a=0;n.length>a;){var i,s,l,c=n[a++],u=o?c.ok:c.fail,d=c.resolve,f=c.reject,p=c.domain;try{u?(o||(2===e.rejection&&ie(e),e.rejection=1),!0===u?i=r:(p&&p.enter(),i=u(r),p&&(p.exit(),l=!0)),i===c.promise?f(W("Promise-chain cycle")):(s=te(i))?s.call(i,d,f):d(i)):f(r)}catch(e){p&&!l&&p.exit(),f(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&re(e)}))}},ae=function(e,t,n){var r,o;Z?((r=G.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),c.dispatchEvent(r)):r={promise:t,reason:n},!K&&(o=c["on"+e])?o(r):e===J&&S("Unhandled promise rejection",n)},re=function(e){E.call(c,(function(){var t,n=e.facade,r=e.value;if(oe(e)&&(t=M((function(){L?q.emit("unhandledRejection",r,n):ae(J,n,r)})),e.rejection=L||oe(e)?2:1,t.error))throw t.value}))},oe=function(e){return 1!==e.rejection&&!e.parent},ie=function(e){E.call(c,(function(){var t=e.facade;L?q.emit("rejectionHandled",t):ae("rejectionhandled",t,e.value)}))},se=function(e,t,n){return function(r){e(t,r,n)}},le=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,ne(e,!0))},ue=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw W("Promise can't be resolved itself");var r=te(t);r?O((function(){var n={done:!1};try{r.call(t,se(ue,n,e),se(le,n,e))}catch(t){le(n,t,e)}})):(e.value=t,e.state=1,ne(e,!1))}catch(t){le({done:!1},t,e)}}};if(Q&&(V=(z=function(e){x(this,z,B),y(e),r.call(this);var t=U(this);try{e(se(ue,t),se(le,t))}catch(e){le(t,e)}}).prototype,(r=function(e){F(this,{type:B,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=p(V,{then:function(e,t){var n=H(this),r=Y(T(this,z));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=L?q.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&ne(n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new r,t=U(e);this.promise=e,this.resolve=se(ue,t),this.reject=se(le,t)},I.f=Y=function(e){return e===z||e===a?new o(e):X(e)},!l&&"function"==typeof d&&N!==Object.prototype)){i=N.then,$||(f(N,"then",(function(e,t){var n=this;return new z((function(e,t){i.call(n,e,t)})).then(e,t)}),{unsafe:!0}),f(N,"catch",V.catch,{unsafe:!0}));try{delete N.constructor}catch(e){}h&&h(N,V)}s({global:!0,wrap:!0,forced:Q},{Promise:z}),m(z,B,!1,!0),g(B),a=u(B),s({target:B,stat:!0,forced:Q},{reject:function(e){var t=Y(this);return t.reject.call(void 0,e),t.promise}}),s({target:B,stat:!0,forced:l||Q},{resolve:function(e){return C(l&&this===a?z:this,e)}}),s({target:B,stat:!0,forced:ee},{all:function(e){var t=this,n=Y(t),r=n.resolve,o=n.reject,a=M((function(){var n=y(t.resolve),a=[],i=0,s=1;j(e,(function(e){var l=i++,c=!1;a.push(void 0),s++,n.call(t,e).then((function(e){c||(c=!0,a[l]=e,--s||r(a))}),o)})),--s||r(a)}));return a.error&&o(a.value),n.promise},race:function(e){var t=this,n=Y(t),r=n.reject,o=M((function(){var o=y(t.resolve);j(e,(function(e){o.call(t,e).then(n.resolve,r)}))}));return o.error&&r(o.value),n.promise}})},8109:(e,t,n)=>{"use strict";var r=n(1420).charAt,o=n(5264),a=n(5875),i=n(8277),s="String Iterator",l=a.set,c=a.getterFor(s);i(String,"String",(function(e){l(this,{type:s,string:o(e),index:0})}),(function(){var e,t=c(this),n=t.string,o=t.index;return o>=n.length?{value:void 0,done:!0}:(e=r(n,o),t.index+=e.length,{value:e,done:!1})}))},8217:(e,t,n)=>{"use strict";var r=n(390),o=n(774).trim;r({target:"String",proto:!0,forced:n(9787)("trim")},{trim:function(){return o(this)}})},8318:(e,t,n)=>{"use strict";var r=n(390),o=n(2868),a=n(8104),i=n(8367),s=n(7001),l=n(3216),c=n(6530),u=n(6690),d=n(1054),f=n(3359),p=n(1149),h=n(1912),m=n(2058),g=n(3861),v=n(5623),y=n(5264),x=n(5595),b=n(2491),j=n(461),w=n(9035),T=n(6159),E=n(3764),O=n(5904),C=n(7550),S=n(1156),I=n(8518),M=n(9791),P=n(6315),_=n(5039),D=n(7048),k=n(9),L=n(5712),A=n(3379),R=n(1412),B=n(6738),U=n(5875),F=n(4206).forEach,H=_("hidden"),N="Symbol",z=L("toPrimitive"),V=U.set,W=U.getterFor(N),G=Object.prototype,q=o.Symbol,Y=a("JSON","stringify"),X=O.f,Z=C.f,K=T.f,J=S.f,$=P("symbols"),Q=P("op-symbols"),ee=P("string-to-symbol-registry"),te=P("symbol-to-string-registry"),ne=P("wks"),ae=o.QObject,re=!ae||!ae.prototype||!ae.prototype.findChild,oe=s&&c((function(){return 7!=b(Z({},"a",{get:function(){return Z(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=X(G,t);r&&delete G[t],Z(e,t,n),r&&e!==G&&Z(G,t,r)}:Z,ie=function(e,t){var n=$[e]=b(q.prototype);return V(n,{type:N,tag:e,description:t}),s||(n.description=t),n},se=function(e,t,n){e===G&&se(Q,t,n),h(e);var r=v(t);return h(n),u($,r)?(n.enumerable?(u(e,H)&&e[H][r]&&(e[H][r]=!1),n=b(n,{enumerable:x(0,!1)})):(u(e,H)||Z(e,H,x(1,{})),e[H][r]=!0),oe(e,r,n)):Z(e,r,n)},le=function(e,t){h(e);var n=g(t),r=j(n).concat(fe(n));return F(r,(function(t){s&&!ue.call(n,t)||se(e,t,n[t])})),e},ue=function(e){var t=v(e),n=J.call(this,t);return!(this===G&&u($,t)&&!u(Q,t))&&(!(n||!u(this,t)||!u($,t)||u(this,H)&&this[H][t])||n)},ce=function(e,t){var n=g(e),r=v(t);if(n!==G||!u($,r)||u(Q,r)){var o=X(n,r);return!o||!u($,r)||u(n,H)&&n[H][r]||(o.enumerable=!0),o}},de=function(e){var t=K(g(e)),n=[];return F(t,(function(e){u($,e)||u(D,e)||n.push(e)})),n},fe=function(e){var t=e===G,n=K(t?Q:g(e)),r=[];return F(n,(function(e){!u($,e)||t&&!u(G,e)||r.push($[e])})),r};l||(M((q=function(){if(this instanceof q)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?y(arguments[0]):void 0,t=k(e),n=function(e){this===G&&n.call(Q,e),u(this,H)&&u(this[H],t)&&(this[H][t]=!1),oe(this,t,x(1,e))};return s&&re&&oe(G,t,{configurable:!0,set:n}),ie(t,e)}).prototype,"toString",(function(){return W(this).tag})),M(q,"withoutSetter",(function(e){return ie(k(e),e)})),S.f=ue,C.f=se,O.f=ce,w.f=T.f=de,E.f=fe,A.f=function(e){return ie(L(e),e)},s&&(Z(q.prototype,"description",{configurable:!0,get:function(){return W(this).description}}),i||M(G,"propertyIsEnumerable",ue,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!l,sham:!l},{Symbol:q}),F(j(ne),(function(e){R(e)})),r({target:N,stat:!0,forced:!l},{for:function(e){var t=y(e);if(u(ee,t))return ee[t];var n=q(t);return ee[t]=n,te[n]=t,n},keyFor:function(e){if(!p(e))throw TypeError(e+" is not a symbol");if(u(te,e))return te[e]},useSetter:function(){re=!0},useSimple:function(){re=!1}}),r({target:"Object",stat:!0,forced:!l,sham:!s},{create:function(e,t){return void 0===t?b(e):le(b(e),t)},defineProperty:se,defineProperties:le,getOwnPropertyDescriptor:ce}),r({target:"Object",stat:!0,forced:!l},{getOwnPropertyNames:de,getOwnPropertySymbols:fe}),r({target:"Object",stat:!0,forced:c((function(){E.f(1)}))},{getOwnPropertySymbols:function(e){return E.f(m(e))}}),Y&&r({target:"JSON",stat:!0,forced:!l||c((function(){var e=q();return"[null]"!=Y([e])||"{}"!=Y({a:e})||"{}"!=Y(Object(e))}))},{stringify:function(e,t,n){for(var r,o=[e],a=1;arguments.length>a;)o.push(arguments[a++]);if(r=t,(f(t)||void 0!==e)&&!p(e))return d(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!p(t))return t}),o[1]=t,Y.apply(null,o)}}),q.prototype[z]||I(q.prototype,z,q.prototype.valueOf),B(q,N),D[H]=!0},9702:(e,t,n)=>{n(2228);var r=n(315),o=n(2868),a=n(7499),i=n(8518),s=n(9418),l=n(5712)("toStringTag");for(var c in r){var u=o[c],d=u&&u.prototype;d&&a(d)!==l&&i(d,l,c),s[c]=s.Array}},3798:(e,t,n)=>{var r=n(4388);e.exports=r},671:(e,t,n)=>{var r=n(1285);e.exports=r},7283:(e,t,n)=>{var r=n(7681);e.exports=r},2882:(e,t,n)=>{var r=n(8949);e.exports=r},8730:(e,t,n)=>{var r=n(2529);e.exports=r},8531:(e,t,n)=>{var r=n(6854);e.exports=r},3751:(e,t,n)=>{var r=n(2744);e.exports=r},1380:(e,t,n)=>{var r=n(6018);e.exports=r},6601:(e,t,n)=>{var r=n(5350);e.exports=r},8783:(e,t,n)=>{var r=n(8116);e.exports=r},4731:(e,t,n)=>{var r=n(7281);n(9702),e.exports=r},5613:(e,t,n)=>{"use strict";const r=n(1863),o=n(7609),a=n(9141),i=n(5710),s=n(8894),l=n(8235),c=Object.prototype.toString,{Z_NO_FLUSH:u,Z_FINISH:d,Z_OK:f,Z_STREAM_END:p,Z_NEED_DICT:h,Z_STREAM_ERROR:m,Z_DATA_ERROR:g,Z_MEM_ERROR:v}=n(2436);function y(e){this.options=o.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;let n=r.inflateInit2(this.strm,t.windowBits);if(n!==f)throw new Error(i[n]);if(this.header=new l,r.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=a.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=r.inflateSetDictionary(this.strm,t.dictionary),n!==f)))throw new Error(i[n])}function x(e,t){const n=new y(t);if(n.push(e),n.err)throw n.msg||i[n.err];return n.result}y.prototype.push=function(e,t){const n=this.strm,o=this.options.chunkSize,i=this.options.dictionary;let s,l,y;if(this.ended)return!1;for(l=t===~~t?t:!0===t?d:u,"[object ArrayBuffer]"===c.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(o),n.next_out=0,n.avail_out=o),s=r.inflate(n,l),s===h&&i&&(s=r.inflateSetDictionary(n,i),s===f?s=r.inflate(n,l):s===g&&(s=h));n.avail_in>0&&s===p&&n.state.wrap>0&&0!==e[n.next_in];)r.inflateReset(n),s=r.inflate(n,l);switch(s){case m:case g:case h:case v:return this.onEnd(s),this.ended=!0,!1}if(y=n.avail_out,n.next_out&&(0===n.avail_out||s===p))if("string"===this.options.to){let e=a.utf8border(n.output,n.next_out),t=n.next_out-e,r=a.buf2string(n.output,e);n.next_out=t,n.avail_out=o-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(r)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(s!==f||0!==y){if(s===p)return s=r.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},y.prototype.onData=function(e){this.chunks.push(e)},y.prototype.onEnd=function(e){e===f&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Hq=function(e,t){return(t=t||{}).raw=!0,x(e,t)},n(2436)},7609:e=>{"use strict";const t=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);e.exports.assign=function(e){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const r=n.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(const n in r)t(r,n)&&(e[n]=r[n])}}return e},e.exports.flattenChunks=e=>{let t=0;for(let n=0,r=e.length;n<r;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,r=0,o=e.length;t<o;t++){let o=e[t];n.set(o,r),r+=o.length}return n}},9141:e=>{"use strict";let t=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){t=!1}const n=new Uint8Array(256);for(let e=0;e<256;e++)n[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;n[254]=n[254]=1,e.exports.string2buf=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,o,a,i=e.length,s=0;for(o=0;o<i;o++)n=e.charCodeAt(o),55296==(64512&n)&&o+1<i&&(r=e.charCodeAt(o+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),o++)),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(s),a=0,o=0;a<s;o++)n=e.charCodeAt(o),55296==(64512&n)&&o+1<i&&(r=e.charCodeAt(o+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),o++)),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t},e.exports.buf2string=(e,r)=>{const o=r||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,r));let a,i;const s=new Array(2*o);for(i=0,a=0;a<o;){let t=e[a++];if(t<128){s[i++]=t;continue}let r=n[t];if(r>4)s[i++]=65533,a+=r-1;else{for(t&=2===r?31:3===r?15:7;r>1&&a<o;)t=t<<6|63&e[a++],r--;r>1?s[i++]=65533:t<65536?s[i++]=t:(t-=65536,s[i++]=55296|t>>10&1023,s[i++]=56320|1023&t)}}return((e,n)=>{if(n<65534&&e.subarray&&t)return String.fromCharCode.apply(null,e.length===n?e:e.subarray(0,n));let r="";for(let t=0;t<n;t++)r+=String.fromCharCode(e[t]);return r})(s,i)},e.exports.utf8border=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let r=t-1;for(;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+n[e[r]]>t?r:t}},5530:e=>{"use strict";e.exports=(e,t,n,r)=>{let o=65535&e|0,a=e>>>16&65535|0,i=0;for(;0!==n;){i=n>2e3?2e3:n,n-=i;do{o=o+t[r++]|0,a=a+o|0}while(--i);o%=65521,a%=65521}return o|a<<16|0}},2436:e=>{"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},1383:e=>{"use strict";const t=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());e.exports=(e,n,r,o)=>{const a=t,i=o+r;e^=-1;for(let t=o;t<i;t++)e=e>>>8^a[255&(e^n[t])];return-1^e}},8235:e=>{"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},8121:e=>{"use strict";e.exports=function(e,t){let n,r,o,a,i,s,l,c,u,d,f,p,h,m,g,v,y,x,b,j,w,T,E,O;const C=e.state;n=e.next_in,E=e.input,r=n+(e.avail_in-5),o=e.next_out,O=e.output,a=o-(t-e.avail_out),i=o+(e.avail_out-257),s=C.dmax,l=C.wsize,c=C.whave,u=C.wnext,d=C.window,f=C.hold,p=C.bits,h=C.lencode,m=C.distcode,g=(1<<C.lenbits)-1,v=(1<<C.distbits)-1;e:do{p<15&&(f+=E[n++]<<p,p+=8,f+=E[n++]<<p,p+=8),y=h[f&g];t:for(;;){if(x=y>>>24,f>>>=x,p-=x,x=y>>>16&255,0===x)O[o++]=65535&y;else{if(!(16&x)){if(0==(64&x)){y=h[(65535&y)+(f&(1<<x)-1)];continue t}if(32&x){C.mode=12;break e}e.msg="invalid literal/length code",C.mode=30;break e}b=65535&y,x&=15,x&&(p<x&&(f+=E[n++]<<p,p+=8),b+=f&(1<<x)-1,f>>>=x,p-=x),p<15&&(f+=E[n++]<<p,p+=8,f+=E[n++]<<p,p+=8),y=m[f&v];n:for(;;){if(x=y>>>24,f>>>=x,p-=x,x=y>>>16&255,!(16&x)){if(0==(64&x)){y=m[(65535&y)+(f&(1<<x)-1)];continue n}e.msg="invalid distance code",C.mode=30;break e}if(j=65535&y,x&=15,p<x&&(f+=E[n++]<<p,p+=8,p<x&&(f+=E[n++]<<p,p+=8)),j+=f&(1<<x)-1,j>s){e.msg="invalid distance too far back",C.mode=30;break e}if(f>>>=x,p-=x,x=o-a,j>x){if(x=j-x,x>c&&C.sane){e.msg="invalid distance too far back",C.mode=30;break e}if(w=0,T=d,0===u){if(w+=l-x,x<b){b-=x;do{O[o++]=d[w++]}while(--x);w=o-j,T=O}}else if(u<x){if(w+=l+u-x,x-=u,x<b){b-=x;do{O[o++]=d[w++]}while(--x);if(w=0,u<b){x=u,b-=x;do{O[o++]=d[w++]}while(--x);w=o-j,T=O}}}else if(w+=u-x,x<b){b-=x;do{O[o++]=d[w++]}while(--x);w=o-j,T=O}for(;b>2;)O[o++]=T[w++],O[o++]=T[w++],O[o++]=T[w++],b-=3;b&&(O[o++]=T[w++],b>1&&(O[o++]=T[w++]))}else{w=o-j;do{O[o++]=O[w++],O[o++]=O[w++],O[o++]=O[w++],b-=3}while(b>2);b&&(O[o++]=O[w++],b>1&&(O[o++]=O[w++]))}break}}break}}while(n<r&&o<i);b=p>>3,n-=b,p-=b<<3,f&=(1<<p)-1,e.next_in=n,e.next_out=o,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=o<i?i-o+257:257-(o-i),C.hold=f,C.bits=p}},1863:(e,t,n)=>{"use strict";const r=n(5530),o=n(1383),a=n(8121),i=n(7371),{Z_FINISH:s,Z_BLOCK:l,Z_TREES:c,Z_OK:u,Z_STREAM_END:d,Z_NEED_DICT:f,Z_STREAM_ERROR:p,Z_DATA_ERROR:h,Z_MEM_ERROR:m,Z_BUF_ERROR:g,Z_DEFLATED:v}=n(2436),y=12,x=30,b=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function j(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const w=e=>{if(!e||!e.state)return p;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,u},T=e=>{if(!e||!e.state)return p;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,w(e)},E=(e,t)=>{let n;if(!e||!e.state)return p;const r=e.state;return t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?p:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,T(e))},O=(e,t)=>{if(!e)return p;const n=new j;e.state=n,n.window=null;const r=E(e,t);return r!==u&&(e.state=null),r};let C,S,I=!0;const M=e=>{if(I){C=new Int32Array(512),S=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(i(1,e.lens,0,288,C,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;i(2,e.lens,0,32,S,0,e.work,{bits:5}),I=!1}e.lencode=C,e.lenbits=9,e.distcode=S,e.distbits=5},P=(e,t,n,r)=>{let o;const a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),r>=a.wsize?(a.window.set(t.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):(o=a.wsize-a.wnext,o>r&&(o=r),a.window.set(t.subarray(n-r,n-r+o),a.wnext),(r-=o)?(a.window.set(t.subarray(n-r,n),0),a.wnext=r,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0};e.exports.inflateReset=T,e.exports.inflateReset2=E,e.exports.inflateResetKeep=w,e.exports.inflateInit=e=>O(e,15),e.exports.inflateInit2=O,e.exports.inflate=(e,t)=>{let n,j,w,T,E,O,C,S,I,_,D,k,L,A,R,B,U,F,H,N,z,V,W=0;const G=new Uint8Array(4);let q,Y;const X=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return p;n=e.state,n.mode===y&&(n.mode=13),E=e.next_out,w=e.output,C=e.avail_out,T=e.next_in,j=e.input,O=e.avail_in,S=n.hold,I=n.bits,_=O,D=C,V=u;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;I<16;){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}if(2&n.wrap&&35615===S){n.check=0,G[0]=255&S,G[1]=S>>>8&255,n.check=o(n.check,G,2,0),S=0,I=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&S)<<8)+(S>>8))%31){e.msg="incorrect header check",n.mode=x;break}if((15&S)!==v){e.msg="unknown compression method",n.mode=x;break}if(S>>>=4,I-=4,z=8+(15&S),0===n.wbits)n.wbits=z;else if(z>n.wbits){e.msg="invalid window size",n.mode=x;break}n.dmax=1<<n.wbits,e.adler=n.check=1,n.mode=512&S?10:y,S=0,I=0;break;case 2:for(;I<16;){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}if(n.flags=S,(255&n.flags)!==v){e.msg="unknown compression method",n.mode=x;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=x;break}n.head&&(n.head.text=S>>8&1),512&n.flags&&(G[0]=255&S,G[1]=S>>>8&255,n.check=o(n.check,G,2,0)),S=0,I=0,n.mode=3;case 3:for(;I<32;){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}n.head&&(n.head.time=S),512&n.flags&&(G[0]=255&S,G[1]=S>>>8&255,G[2]=S>>>16&255,G[3]=S>>>24&255,n.check=o(n.check,G,4,0)),S=0,I=0,n.mode=4;case 4:for(;I<16;){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}n.head&&(n.head.xflags=255&S,n.head.os=S>>8),512&n.flags&&(G[0]=255&S,G[1]=S>>>8&255,n.check=o(n.check,G,2,0)),S=0,I=0,n.mode=5;case 5:if(1024&n.flags){for(;I<16;){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}n.length=S,n.head&&(n.head.extra_len=S),512&n.flags&&(G[0]=255&S,G[1]=S>>>8&255,n.check=o(n.check,G,2,0)),S=0,I=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(k=n.length,k>O&&(k=O),k&&(n.head&&(z=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(j.subarray(T,T+k),z)),512&n.flags&&(n.check=o(n.check,j,k,T)),O-=k,T+=k,n.length-=k),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===O)break e;k=0;do{z=j[T+k++],n.head&&z&&n.length<65536&&(n.head.name+=String.fromCharCode(z))}while(z&&k<O);if(512&n.flags&&(n.check=o(n.check,j,k,T)),O-=k,T+=k,z)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===O)break e;k=0;do{z=j[T+k++],n.head&&z&&n.length<65536&&(n.head.comment+=String.fromCharCode(z))}while(z&&k<O);if(512&n.flags&&(n.check=o(n.check,j,k,T)),O-=k,T+=k,z)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;I<16;){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}if(S!==(65535&n.check)){e.msg="header crc mismatch",n.mode=x;break}S=0,I=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=y;break;case 10:for(;I<32;){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}e.adler=n.check=b(S),S=0,I=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=E,e.avail_out=C,e.next_in=T,e.avail_in=O,n.hold=S,n.bits=I,f;e.adler=n.check=1,n.mode=y;case y:if(t===l||t===c)break e;case 13:if(n.last){S>>>=7&I,I-=7&I,n.mode=27;break}for(;I<3;){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}switch(n.last=1&S,S>>>=1,I-=1,3&S){case 0:n.mode=14;break;case 1:if(M(n),n.mode=20,t===c){S>>>=2,I-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=x}S>>>=2,I-=2;break;case 14:for(S>>>=7&I,I-=7&I;I<32;){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}if((65535&S)!=(S>>>16^65535)){e.msg="invalid stored block lengths",n.mode=x;break}if(n.length=65535&S,S=0,I=0,n.mode=15,t===c)break e;case 15:n.mode=16;case 16:if(k=n.length,k){if(k>O&&(k=O),k>C&&(k=C),0===k)break e;w.set(j.subarray(T,T+k),E),O-=k,T+=k,C-=k,E+=k,n.length-=k;break}n.mode=y;break;case 17:for(;I<14;){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}if(n.nlen=257+(31&S),S>>>=5,I-=5,n.ndist=1+(31&S),S>>>=5,I-=5,n.ncode=4+(15&S),S>>>=4,I-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=x;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;I<3;){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}n.lens[X[n.have++]]=7&S,S>>>=3,I-=3}for(;n.have<19;)n.lens[X[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,q={bits:n.lenbits},V=i(0,n.lens,0,19,n.lencode,0,n.work,q),n.lenbits=q.bits,V){e.msg="invalid code lengths set",n.mode=x;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;W=n.lencode[S&(1<<n.lenbits)-1],R=W>>>24,B=W>>>16&255,U=65535&W,!(R<=I);){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}if(U<16)S>>>=R,I-=R,n.lens[n.have++]=U;else{if(16===U){for(Y=R+2;I<Y;){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}if(S>>>=R,I-=R,0===n.have){e.msg="invalid bit length repeat",n.mode=x;break}z=n.lens[n.have-1],k=3+(3&S),S>>>=2,I-=2}else if(17===U){for(Y=R+3;I<Y;){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}S>>>=R,I-=R,z=0,k=3+(7&S),S>>>=3,I-=3}else{for(Y=R+7;I<Y;){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}S>>>=R,I-=R,z=0,k=11+(127&S),S>>>=7,I-=7}if(n.have+k>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=x;break}for(;k--;)n.lens[n.have++]=z}}if(n.mode===x)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=x;break}if(n.lenbits=9,q={bits:n.lenbits},V=i(1,n.lens,0,n.nlen,n.lencode,0,n.work,q),n.lenbits=q.bits,V){e.msg="invalid literal/lengths set",n.mode=x;break}if(n.distbits=6,n.distcode=n.distdyn,q={bits:n.distbits},V=i(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,q),n.distbits=q.bits,V){e.msg="invalid distances set",n.mode=x;break}if(n.mode=20,t===c)break e;case 20:n.mode=21;case 21:if(O>=6&&C>=258){e.next_out=E,e.avail_out=C,e.next_in=T,e.avail_in=O,n.hold=S,n.bits=I,a(e,D),E=e.next_out,w=e.output,C=e.avail_out,T=e.next_in,j=e.input,O=e.avail_in,S=n.hold,I=n.bits,n.mode===y&&(n.back=-1);break}for(n.back=0;W=n.lencode[S&(1<<n.lenbits)-1],R=W>>>24,B=W>>>16&255,U=65535&W,!(R<=I);){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}if(B&&0==(240&B)){for(F=R,H=B,N=U;W=n.lencode[N+((S&(1<<F+H)-1)>>F)],R=W>>>24,B=W>>>16&255,U=65535&W,!(F+R<=I);){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}S>>>=F,I-=F,n.back+=F}if(S>>>=R,I-=R,n.back+=R,n.length=U,0===B){n.mode=26;break}if(32&B){n.back=-1,n.mode=y;break}if(64&B){e.msg="invalid literal/length code",n.mode=x;break}n.extra=15&B,n.mode=22;case 22:if(n.extra){for(Y=n.extra;I<Y;){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}n.length+=S&(1<<n.extra)-1,S>>>=n.extra,I-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;W=n.distcode[S&(1<<n.distbits)-1],R=W>>>24,B=W>>>16&255,U=65535&W,!(R<=I);){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}if(0==(240&B)){for(F=R,H=B,N=U;W=n.distcode[N+((S&(1<<F+H)-1)>>F)],R=W>>>24,B=W>>>16&255,U=65535&W,!(F+R<=I);){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}S>>>=F,I-=F,n.back+=F}if(S>>>=R,I-=R,n.back+=R,64&B){e.msg="invalid distance code",n.mode=x;break}n.offset=U,n.extra=15&B,n.mode=24;case 24:if(n.extra){for(Y=n.extra;I<Y;){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}n.offset+=S&(1<<n.extra)-1,S>>>=n.extra,I-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=x;break}n.mode=25;case 25:if(0===C)break e;if(k=D-C,n.offset>k){if(k=n.offset-k,k>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=x;break}k>n.wnext?(k-=n.wnext,L=n.wsize-k):L=n.wnext-k,k>n.length&&(k=n.length),A=n.window}else A=w,L=E-n.offset,k=n.length;k>C&&(k=C),C-=k,n.length-=k;do{w[E++]=A[L++]}while(--k);0===n.length&&(n.mode=21);break;case 26:if(0===C)break e;w[E++]=n.length,C--,n.mode=21;break;case 27:if(n.wrap){for(;I<32;){if(0===O)break e;O--,S|=j[T++]<<I,I+=8}if(D-=C,e.total_out+=D,n.total+=D,D&&(e.adler=n.check=n.flags?o(n.check,w,D,E-D):r(n.check,w,D,E-D)),D=C,(n.flags?S:b(S))!==n.check){e.msg="incorrect data check",n.mode=x;break}S=0,I=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;I<32;){if(0===O)break e;O--,S+=j[T++]<<I,I+=8}if(S!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=x;break}S=0,I=0}n.mode=29;case 29:V=d;break e;case x:V=h;break e;case 31:return m;default:return p}return e.next_out=E,e.avail_out=C,e.next_in=T,e.avail_in=O,n.hold=S,n.bits=I,(n.wsize||D!==e.avail_out&&n.mode<x&&(n.mode<27||t!==s))&&P(e,e.output,e.next_out,D-e.avail_out)?(n.mode=31,m):(_-=e.avail_in,D-=e.avail_out,e.total_in+=_,e.total_out+=D,n.total+=D,n.wrap&&D&&(e.adler=n.check=n.flags?o(n.check,w,D,e.next_out-D):r(n.check,w,D,e.next_out-D)),e.data_type=n.bits+(n.last?64:0)+(n.mode===y?128:0)+(20===n.mode||15===n.mode?256:0),(0===_&&0===D||t===s)&&V===u&&(V=g),V)},e.exports.inflateEnd=e=>{if(!e||!e.state)return p;let t=e.state;return t.window&&(t.window=null),e.state=null,u},e.exports.inflateGetHeader=(e,t)=>{if(!e||!e.state)return p;const n=e.state;return 0==(2&n.wrap)?p:(n.head=t,t.done=!1,u)},e.exports.inflateSetDictionary=(e,t)=>{const n=t.length;let o,a,i;return e&&e.state?(o=e.state,0!==o.wrap&&11!==o.mode?p:11===o.mode&&(a=1,a=r(a,t,n,0),a!==o.check)?h:(i=P(e,t,n,n),i?(o.mode=31,m):(o.havedict=1,u))):p},e.exports.inflateInfo="pako inflate (from Nodeca project)"},7371:e=>{"use strict";const t=15,n=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),r=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),o=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),a=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);e.exports=(e,i,s,l,c,u,d,f)=>{const p=f.bits;let h,m,g,v,y,x,b=0,j=0,w=0,T=0,E=0,O=0,C=0,S=0,I=0,M=0,P=null,_=0;const D=new Uint16Array(16),k=new Uint16Array(16);let L,A,R,B=null,U=0;for(b=0;b<=t;b++)D[b]=0;for(j=0;j<l;j++)D[i[s+j]]++;for(E=p,T=t;T>=1&&0===D[T];T--);if(E>T&&(E=T),0===T)return c[u++]=20971520,c[u++]=20971520,f.bits=1,0;for(w=1;w<T&&0===D[w];w++);for(E<w&&(E=w),S=1,b=1;b<=t;b++)if(S<<=1,S-=D[b],S<0)return-1;if(S>0&&(0===e||1!==T))return-1;for(k[1]=0,b=1;b<t;b++)k[b+1]=k[b]+D[b];for(j=0;j<l;j++)0!==i[s+j]&&(d[k[i[s+j]]++]=j);if(0===e?(P=B=d,x=19):1===e?(P=n,_-=257,B=r,U-=257,x=256):(P=o,B=a,x=-1),M=0,j=0,b=w,y=u,O=E,C=0,g=-1,I=1<<E,v=I-1,1===e&&I>852||2===e&&I>592)return 1;for(;;){L=b-C,d[j]<x?(A=0,R=d[j]):d[j]>x?(A=B[U+d[j]],R=P[_+d[j]]):(A=96,R=0),h=1<<b-C,m=1<<O,w=m;do{m-=h,c[y+(M>>C)+m]=L<<24|A<<16|R|0}while(0!==m);for(h=1<<b-1;M&h;)h>>=1;if(0!==h?(M&=h-1,M+=h):M=0,j++,0==--D[b]){if(b===T)break;b=i[s+d[j]]}if(b>E&&(M&v)!==g){for(0===C&&(C=E),y+=w,O=b-C,S=1<<O;O+C<T&&(S-=D[O+C],!(S<=0));)O++,S<<=1;if(I+=1<<O,1===e&&I>852||2===e&&I>592)return 1;g=M&v,c[g]=E<<24|O<<16|y-u|0}}return 0!==M&&(c[y+M]=b-C<<24|64<<16|0),f.bits=E,0}},5710:e=>{"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},8894:e=>{"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})();var r={};return(()=>{"use strict";function e(e,t,n){if(void 0===e)throw new Error("decodeRGB: rgbBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: rgbBuffer length must be divisible by 3");var r=e.length/3,o=0,a=0;if(n)for(var i=0;i<r;i++)t[a++]=e[o++],t[a++]=e[o++],t[a++]=e[o++],t[a++]=255;else t.set(e)}function t(e,t,n){if(void 0===e)throw new Error("decodeRGB: rgbBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: rgbBuffer length must be divisible by 3");var r=e.length/3,o=0,a=0,i=r,s=2*r;if(n)for(var l=0;l<r;l++)t[o++]=e[a++],t[o++]=e[i++],t[o++]=e[s++],t[o++]=255;else t.set(e)}function o(e,t,n){if(void 0===e)throw new Error("decodeRGB: ybrBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: ybrBuffer length must be divisble by 3");var r=e.length/3,o=0,a=0;if(n)for(var i=0;i<r;i++){var s=e[o++],l=e[o++],c=e[o++];t[a++]=s+1.402*(c-128),t[a++]=s-.34414*(l-128)-.71414*(c-128),t[a++]=s+1.772*(l-128),t[a++]=255}else for(var u=0;u<r;u++){var d=e[o++],f=e[o++],p=e[o++];t[a++]=d+1.402*(p-128),t[a++]=d-.34414*(f-128)-.71414*(p-128),t[a++]=d+1.772*(f-128)}}function a(e,t,n){if(void 0===e)throw new Error("decodeRGB: ybrBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: ybrBuffer length must be divisble by 3");var r=e.length/3,o=0,a=0,i=r,s=2*r;if(n)for(var l=0;l<r;l++){var c=e[a++],u=e[i++],d=e[s++];t[o++]=c+1.402*(d-128),t[o++]=c-.34414*(u-128)-.71414*(d-128),t[o++]=c+1.772*(u-128),t[o++]=255}else for(var f=0;f<r;f++){var p=e[a++],h=e[i++],m=e[s++];t[o++]=p+1.402*(m-128),t[o++]=p-.34414*(h-128)-.71414*(m-128),t[o++]=p+1.772*(h-128)}}function i(e,t){for(var n=e.length,r=new Uint8ClampedArray(n),o=0;o<n;++o)r[o]=e[o]>>t;return r}function s(e,t,n){var r=e.columns*e.rows,o=e.pixelData,a=e.redPaletteColorLookupTableData,s=e.greenPaletteColorLookupTableData,l=e.bluePaletteColorLookupTableData,c=e.redPaletteColorLookupTableData.length,u=0,d=0,f=e.redPaletteColorLookupTableDescriptor[1],p=8===e.redPaletteColorLookupTableDescriptor[2]?0:8,h=i(a,p),m=i(s,p),g=i(l,p);if(n)for(var v=0;v<r;++v){var y=o[u++];y<f?y=0:y>f+c-1?y=c-1:y-=f,t[d++]=h[y],t[d++]=m[y],t[d++]=g[y],t[d++]=255}else for(var x=0;x<r;++x){var b=o[u++];b<f?b=0:b>f+c-1?b=c-1:b-=f,t[d++]=h[b],t[d++]=m[b],t[d++]=g[b]}}function l(e,t){if(e.elements[t]&&6===e.elements[t].length)return[e.uint16(t,0),e.uint16(t,1),e.uint16(t,2)]}function c(e,t,n){for(var r=[],o=e.elements[t],a=0;a<n[0];a++)16===n[2]?r[a]=e.uint16(t,a):r[a]=e.byteArray[a+o.dataOffset];return r}n.r(r),n.d(r,{configure:()=>ht,convertColorSpace:()=>Ee,convertPALETTECOLOR:()=>s,convertRGBColorByPixel:()=>e,convertRGBColorByPlane:()=>t,convertYBRFullByPixel:()=>o,convertYBRFullByPlane:()=>a,createImage:()=>Re,decodeImageFrame:()=>je,decodeJPEGBaseline8BitColor:()=>be,default:()=>mt,external:()=>We,getImageFrame:()=>$,getMinMax:()=>ve,getPixelData:()=>N,internal:()=>B,isColorImage:()=>we,isJPEGBaseline8BitColor:()=>Oe,version:()=>gt,wadors:()=>He,wadouri:()=>dt,webWorkerManager:()=>he});const u=function(e){var t={samplesPerPixel:e.uint16("x00280002"),photometricInterpretation:e.string("x00280004"),rows:e.uint16("x00280010"),columns:e.uint16("x00280011"),bitsAllocated:e.uint16("x00280100"),bitsStored:e.uint16("x00280101"),highBit:e.uint16("x00280102"),pixelRepresentation:e.uint16("x00280103"),planarConfiguration:e.uint16("x00280006"),pixelAspectRatio:e.string("x00280034")};return function(e,t){0===e.uint16("x00280103")?(t.smallestPixelValue=e.uint16("x00280106"),t.largestPixelValue=e.uint16("x00280107")):(t.smallestPixelValue=e.int16("x00280106"),t.largestPixelValue=e.int16("x00280107"))}(e,t),"PALETTE COLOR"===t.photometricInterpretation&&e.elements.x00281101&&function(e,t){t.redPaletteColorLookupTableDescriptor=l(e,"x00281101"),t.greenPaletteColorLookupTableDescriptor=l(e,"x00281102"),t.bluePaletteColorLookupTableDescriptor=l(e,"x00281103"),0===t.redPaletteColorLookupTableDescriptor[0]&&(t.redPaletteColorLookupTableDescriptor[0]=65536,t.greenPaletteColorLookupTableDescriptor[0]=65536,t.bluePaletteColorLookupTableDescriptor[0]=65536);var n=t.redPaletteColorLookupTableDescriptor[0],r=e.elements.x00281201.length===n?8:16;t.redPaletteColorLookupTableDescriptor[2]!==r&&(t.redPaletteColorLookupTableDescriptor[2]=r,t.greenPaletteColorLookupTableDescriptor[2]=r,t.bluePaletteColorLookupTableDescriptor[2]=r),t.redPaletteColorLookupTableData=c(e,"x00281201",t.redPaletteColorLookupTableDescriptor),t.greenPaletteColorLookupTableData=c(e,"x00281202",t.greenPaletteColorLookupTableDescriptor),t.bluePaletteColorLookupTableData=c(e,"x00281203",t.bluePaletteColorLookupTableDescriptor)}(e,t),t};function d(e,t){var n=t.uint16("x00283002",0);0===n&&(n=65535);for(var r={id:"1",firstValueMapped:0===e?t.uint16("x00283002",1):t.int16("x00283002",1),numBitsPerEntry:t.uint16("x00283002",2),lut:[]},o=0;o<n;o++)r.lut[o]=0===e?t.uint16("x00283006",o):t.int16("x00283006",o);return r}const f=function(e,t){if(t&&t.items&&t.items.length){for(var n=[],r=0;r<t.items.length;r++){var o=d(e,t.items[r].dataSet);o&&n.push(o)}return n}},p=function(e){var t=e.string("x00080016");if("1.2.840.10008.5.1.4.1.1.2"===t||"1.2.840.10008.5.1.4.1.1.2.1"===t)return 1;var n=e.floatString("x00281052"),r=e.floatString("x00281053");return void 0!==n&&void 0!==r?function(e){var t=e.uint16("x00280103"),n=e.uint16("x00280101");return 0===t?0:-1<<n-1}(e)*r+n<0?1:0:e.elements.x00283000&&e.elements.x00283000.length>0?0:e.uint16("x00280103")},h=function(e,t,n){var r=[],o=e.string(t);if(o){var a=o.split("\\");if(!(n&&a.length<n)){for(var i=0;i<a.length;i++)r.push(parseFloat(a[i]));return r}}},m=function(e,t,n){return t=t||0,e&&e.Value?e.Value.length<=t?n:e.Value[t]:n},g=function(e,t,n){var r=m(e,t,n);if(void 0!==r)return parseFloat(r)},v=function(e,t){var n=m(e,t);if(void 0!==n)return parseFloat(n)},y=function(e,t){if(e&&e.Value&&!(t&&e.Value.length<t)){for(var n=[],r=0;r<e.Value.length;r++)n.push(parseFloat(e.Value[r]));return n}};function x(e){var t=e.indexOf(":");return e.substring(t+1)}var b=[];const j={add:function(e,t){var n=x(e);b[n]=t},get:function(e){var t=x(e);return b[t]},remove:function(e){var t=x(e);b[t]=void 0},purge:function(){b=[]}},w=function(e,t){var n=We.dicomParser,r=j.get(t);if(r){if("generalSeriesModule"===e)return{modality:m(r["00080060"]),seriesInstanceUID:m(r["0020000E"]),seriesNumber:v(r["00200011"]),studyInstanceUID:m(r["0020000D"]),seriesDate:n.parseDA(m(r["00080021"])),seriesTime:n.parseTM(m(r["00080031"],0,""))};if("patientStudyModule"===e)return{patientAge:v(r["00101010"]),patientSize:v(r["00101020"]),patientWeight:v(r["00101030"])};if("imagePlaneModule"===e){var o=y(r["00200037"],6),a=y(r["00200032"],3),i=y(r["00280030"],2),s=null,l=null;i&&(l=i[0],s=i[1]);var c=null,u=null;return o&&(c=[parseFloat(o[0]),parseFloat(o[1]),parseFloat(o[2])],u=[parseFloat(o[3]),parseFloat(o[4]),parseFloat(o[5])]),{frameOfReferenceUID:m(r["00200052"]),rows:v(r["00280010"]),columns:v(r["00280011"]),imageOrientationPatient:o,rowCosines:c,columnCosines:u,imagePositionPatient:a,sliceThickness:v(r["00180050"]),sliceLocation:v(r["00201041"]),pixelSpacing:i,rowPixelSpacing:l,columnPixelSpacing:s}}if("imagePixelModule"===e)return{samplesPerPixel:v(r["00280002"]),photometricInterpretation:m(r["00280004"]),rows:v(r["00280010"]),columns:v(r["00280011"]),bitsAllocated:v(r["00280100"]),bitsStored:v(r["00280101"]),highBit:m(r["00280102"]),pixelRepresentation:v(r["00280103"]),planarConfiguration:v(r["00280006"]),pixelAspectRatio:m(r["00280034"]),smallestPixelValue:v(r["00280106"]),largestPixelValue:v(r["00280107"]),redPaletteColorLookupTableDescriptor:y(r["00281101"]),greenPaletteColorLookupTableDescriptor:y(r["00281102"]),bluePaletteColorLookupTableDescriptor:y(r["00281103"]),redPaletteColorLookupTableData:y(r["00281201"]),greenPaletteColorLookupTableData:y(r["00281202"]),bluePaletteColorLookupTableData:y(r["00281203"])};if("voiLutModule"===e)return{windowCenter:y(r["00281050"],1),windowWidth:y(r["00281051"],1)};if("modalityLutModule"===e)return{rescaleIntercept:v(r["00281052"]),rescaleSlope:v(r["00281053"]),rescaleType:m(r["00281054"])};if("sopCommonModule"===e)return{sopClassUID:m(r["00080016"]),sopInstanceUID:m(r["00080018"])};if("petIsotopeModule"===e){var d=m(r["00540016"]);if(void 0===d)return;return{radiopharmaceuticalInfo:{radiopharmaceuticalStartTime:n.parseTM(m(d["00181072"],0,"")),radionuclideTotalDose:v(d["00181074"]),radionuclideHalfLife:v(d["00181075"])}}}return"overlayPlaneModule"===e?function(e){for(var t=[],n=0;n<=30;n+=2){var r="x60".concat(n.toString(16));4===r.length&&(r="x600".concat(n.toString(16)));var o=m(e["".concat(r,"3000")]);if(o){for(var a=[],i=0;i<o.length;i++)for(var s=0;s<8;s++){var l=e.Value[o.dataOffset+i];a[8*i+s]=l>>s&1}t.push({rows:v(e["".concat(r,"0010")]),columns:v(e["".concat(r,"0011")]),type:m(e["".concat(r,"0040")]),x:v(e["".concat(r,"0050")],1)-1,y:v(e["".concat(r,"0050")],0)-1,pixelData:a,description:m(e["".concat(r,"0022")]),label:m(e["".concat(r,"1500")]),roiArea:m(e["".concat(r,"1301")]),roiMean:m(e["".concat(r,"1302")]),roiStandardDeviation:m(e["".concat(r,"1303")])})}}return{overlays:t}}(r):"transferSyntax"===e?{transferSyntaxUID:m(r["00020010"])}:void 0}};function T(e,t,n){if(n+e.length>t.length)return!1;for(var r=n,o=0;o<e.length;o++)if(e[o]!==t[r++])return!1;return!0}const E=function(e,t,n){n=n||0;for(var r=function(e){for(var t=new Uint8Array(e.length),n=0,r=e.length;n<r;n++)t[n]=e.charCodeAt(n);return t}(t),o=n;o<e.length;o++)if(r[0]===e[o]&&T(r,e,o))return o;return-1};var O=n(1655),C=n.n(O),S=n(2204),I=n.n(S),M=n(1246),P=n.n(M),_=n(7878),D=n.n(_),k={beforeSend:function(){},beforeProcessing:function(e){return I().resolve(e.response)},imageCreated:function(){},strict:!1,decodeConfig:{convertFloatPixelDataToInt:!0}};function L(e){k=P()(k,e)}function A(){return k}const R=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=We.cornerstone,a=A(),i=function(e){if("function"==typeof a.errorInterceptor){var t=new Error("request failed");t.request=e,t.response=e.response,t.status=e.status,a.errorInterceptor(t)}};return new(I())((function(s,l){var c=new XMLHttpRequest;c.open("get",e,!0);var u=a.beforeSend(c,t,n,r);c.responseType="arraybuffer";var d=P()({},n,u);D()(d).forEach((function(t){null!==d[t]&&("Accept"===t&&-1!==e.indexOf("accept=")||c.setRequestHeader(t,d[t]))})),r.deferred={resolve:s,reject:l},r.url=e,r.imageId=t,c.onloadstart=function(n){a.onloadstart&&a.onloadstart(n,r);var i={url:e,imageId:t};o.triggerEvent(o.events,"cornerstoneimageloadstart",i)},c.onloadend=function(n){a.onloadend&&a.onloadend(n,r);var i={url:e,imageId:t};o.triggerEvent(o.events,"cornerstoneimageloadend",i)},c.onreadystatechange=function(e){a.onreadystatechange?a.onreadystatechange(e,r):4===c.readyState&&(200===c.status?a.beforeProcessing(c).then(s).catch((function(){i(c),l(c)})):(i(c),l(c)))},c.onprogress=function(n){var i,s,l=n.loaded;n.lengthComputable&&(i=n.total,s=Math.round(l/i*100)),a.onprogress&&a.onprogress(n,r);var c={url:e,imageId:t,loaded:l,total:i,percentComplete:s};o.triggerEvent(o.events,o.EVENTS.IMAGE_LOAD_PROGRESS,c)},c.onerror=function(){i(c),l(c)},c.onabort=function(){i(c),l(c)},c.send()}))};var B={xhrRequest:R,setOptions:L,getOptions:A};function U(e){for(var t=0;t<e.length;t++)if("--"===e[t].substr(0,2))return e[t]}function F(e){for(var t=0;t<e.length;t++){var n;if("Content-Type:"===e[t].substr(0,13))return C()(n=e[t].substr(13)).call(n)}}function H(e,t,n){t=t||0,n=n||e.length-t;for(var r="",o=t;o<t+n;o++)r+=String.fromCharCode(e[o]);return r}const N=function(e,t){var n={Accept:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/octet-stream"};return new(I())((function(r,o){R(e,t,n).then((function(e){var t=new Uint8Array(e),n=E(t,"\r\n\r\n");-1===n&&o(new Error("invalid response - no multipart mime header"));var a=H(t,0,n).split("\r\n"),i=U(a);i||o(new Error("invalid response - no boundary marker"));var s=n+4,l=E(t,i,s);-1===l&&o(new Error("invalid response - terminating boundary not found"));var c=l-s-2;r({contentType:F(a),imageFrame:{pixelData:new Uint8Array(e,s,c)}})}),o)}))};var z=n(1882),V=n.n(z),W=n(7647),G=n.n(W),q=n(337),Y=n.n(q),X=n(2770),Z=n.n(X),K=n(1082);function J(e,t,n){return t in e?K(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const $=function(e){var t=We.cornerstone.metaData.get("imagePixelModule",e);return{samplesPerPixel:t.samplesPerPixel,photometricInterpretation:t.photometricInterpretation,planarConfiguration:t.planarConfiguration,rows:t.rows,columns:t.columns,bitsAllocated:t.bitsAllocated,bitsStored:t.bitsStored,pixelRepresentation:t.pixelRepresentation,smallestPixelValue:t.smallestPixelValue,largestPixelValue:t.largestPixelValue,redPaletteColorLookupTableDescriptor:t.redPaletteColorLookupTableDescriptor,greenPaletteColorLookupTableDescriptor:t.greenPaletteColorLookupTableDescriptor,bluePaletteColorLookupTableDescriptor:t.bluePaletteColorLookupTableDescriptor,redPaletteColorLookupTableData:t.redPaletteColorLookupTableData,greenPaletteColorLookupTableData:t.greenPaletteColorLookupTableData,bluePaletteColorLookupTableData:t.bluePaletteColorLookupTableData,pixelData:void 0}};var Q=n(187),ee=n.n(Q);function te(){return new Worker(n.p+"index.worker.min.worker.js")}var ne,ae=0,re=[],oe=[],ie=A(),se={maxWebWorkers:navigator.hardwareConcurrency||1,startWebWorkersOnDemand:!0,webWorkerTaskPaths:[],taskConfiguration:{decodeTask:{initializeCodecsOnStartup:!1,strict:ie.strict}}},le={maxWebWorkers:0,numWebWorkers:0,numTasksQueued:0,numTasksExecuting:0,numTasksCompleted:0,totalTaskTimeInMS:0,totalTimeDelayedInMS:0};function ue(){if(re.length){for(var e=0;e<oe.length;e++)if("ready"===oe[e].status){oe[e].status="busy";var t=re.shift();t.start=(new Date).getTime();var n=(new Date).getTime();return le.totalTimeDelayedInMS+=n-t.added,oe[e].task=t,oe[e].worker.postMessage({taskType:t.taskType,workerIndex:e,data:t.data},t.transferList),void le.numTasksExecuting++}oe.length<ne.maxWebWorkers&&de()}}function ce(e){if("initialize"===e.data.taskType)oe[e.data.workerIndex].status="ready",ue();else{var t=oe[e.data.workerIndex].task.start,n="success"===e.data.status?"resolve":"reject";oe[e.data.workerIndex].task.deferred[n](e.data.result),oe[e.data.workerIndex].task=void 0,le.numTasksExecuting--,oe[e.data.workerIndex].status="ready",le.numTasksCompleted++;var r=(new Date).getTime();le.totalTaskTimeInMS+=r-t,ue()}}function de(){if(!(oe.length>=ne.maxWebWorkers)){var e=new te;oe.push({worker:e,status:"initializing"}),e.addEventListener("message",ce),e.postMessage({taskType:"initialize",workerIndex:oe.length-1,config:ne})}}function fe(e){if((ne=e=e||se).maxWebWorkers=ne.maxWebWorkers||navigator.hardwareConcurrency||1,!ne.startWebWorkersOnDemand)for(var t=0;t<ne.maxWebWorkers;t++)de()}const he={initialize:fe,loadWebWorkerTask:function(e,t){ne.webWorkerTaskPaths.push(e),t&&(ne.taskConfiguration=P()(ne.taskConfiguration,t));for(var n=0;n<oe.length;n++)oe[n].worker.postMessage({taskType:"loadWebWorkerTask",workerIndex:oe.length-1,sourcePath:e,config:ne})},addTask:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;ne||fe();var o,a={},i=new(I())((function(e,t){a={resolve:e,reject:t}}));for(o=0;o<re.length&&!(re[o].priority<n);o++);var s=ae++;return ee()(re).call(re,o,0,{taskId:s,taskType:e,status:"ready",added:(new Date).getTime(),data:t,deferred:a,priority:n,transferList:r}),ue(),{taskId:s,promise:i}},getStatistics:function(){return le.maxWebWorkers=ne.maxWebWorkers,le.numWebWorkers=oe.length,le.numTasksQueued=re.length,le},setTaskPriority:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<re.length;n++)if(re[n].taskId===e){var r=ee()(re).call(re,n,1)[0];for(r.priority=t,n=0;n<re.length&&!(re[n].priority<t);n++);return ee()(re).call(re,n,0,r),!0}return!1},cancelTask:function(e,t){for(var n=0;n<re.length;n++)if(re[n].taskId===e)return ee()(re).call(re,n,1).deferred.reject(t),!0;return!1},webWorkers:oe,terminate:function(){for(var e=0;e<oe.length;e++)oe[e].worker.terminate();oe.length=0,ne=void 0}};var ge=n(6028),me=n.n(ge);const ve=function(e){for(var t,n=e[0],r=e[0],o=e.length,a=1;a<o;a++)t=e[a],n=Math.min(n,t),r=Math.max(r,t);return{min:n,max:r}};function pe(e){return function(e){var t;try{return decodeURIComponent(escape(e))}catch(n){if((t=n)instanceof URIError)return e;throw t}}(String.fromCharCode.apply(null,me()(Array.prototype).apply(new Uint8Array(e))))}const be=function(e,t,n){var r=(new Date).getTime(),o=new Blob([t],{type:"image/jpeg"});return new(I())((function(t,a){var i=new FileReader;void 0===i.readAsBinaryString?i.readAsArrayBuffer(o):i.readAsBinaryString(o),i.onload=function(){var o=new Image;o.onload=function(){n.height=o.height,n.width=o.width,e.rows=o.height,e.columns=o.width;var a=n.getContext("2d");a.drawImage(this,0,0);var i=a.getImageData(0,0,o.width,o.height),s=(new Date).getTime();e.pixelData=i.data,e.imageData=i,e.decodeTimeInMS=s-r;var l=ve(e.pixelData);e.smallestPixelValue=l.min,e.largestPixelValue=l.max,t(e)},o.onerror=function(e){a(e)},void 0===i.readAsBinaryString?o.src="data:image/jpeg;base64,".concat(window.btoa(pe(i.result))):o.src="data:image/jpeg;base64,".concat(window.btoa(i.result))},i.onerror=function(e){a(e)}}))};var ye=n(5613);function xe(e,t,n,r){var o=r.priority||void 0,a=r.transferPixelData?[n.buffer]:void 0;return he.addTask("decodeTask",{imageFrame:e,transferSyntax:t,pixelData:n,options:r},o,a).promise}window.pako={inflateRaw:ye.Hq};const je=function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};switch(t){case"1.2.840.10008.1.2":case"1.2.840.10008.1.2.1":case"1.2.840.10008.1.2.2":case"1.2.840.10008.1.2.1.99":case"1.2.840.10008.1.2.5":case"1.2.840.10008.1.2.4.51":case"1.2.840.10008.1.2.4.57":case"1.2.840.10008.1.2.4.70":case"1.2.840.10008.1.2.4.80":case"1.2.840.10008.1.2.4.81":case"1.2.840.10008.1.2.4.90":case"1.2.840.10008.1.2.4.91":return xe(e,t,n,o);case"1.2.840.10008.1.2.4.50":return 8!==e.bitsAllocated||3!==e.samplesPerPixel&&4!==e.samplesPerPixel?xe(e,t,n,o):be(e,n,r)}return I().reject(new Error("No decoder for transfer syntax ".concat(t)))};function we(e){return"RGB"===e||"PALETTE COLOR"===e||"YBR_FULL"===e||"YBR_FULL_422"===e||"YBR_PARTIAL_422"===e||"YBR_PARTIAL_420"===e||"YBR_RCT"===e||"YBR_ICT"===e}function Te(n,r,o){0===n.planarConfiguration?e(n.pixelData,r,o):t(n.pixelData,r,o)}function Ee(e,t,n){if("RGB"===e.photometricInterpretation)Te(e,t,n);else if("YBR_RCT"===e.photometricInterpretation)Te(e,t,n);else if("YBR_ICT"===e.photometricInterpretation)Te(e,t,n);else if("PALETTE COLOR"===e.photometricInterpretation)s(e,t,n);else if("YBR_FULL_422"===e.photometricInterpretation)!function(e,t,n){if(void 0===e)throw new Error("decodeRGB: ybrBuffer must not be undefined");if(e.length%2!=0)throw new Error("decodeRGB: ybrBuffer length must be divisble by 3");var r=e.length/2,o=0,a=0;if(n)for(var i=0;i<r;i+=2){var s=e[o++],l=e[o++],c=e[o++],u=e[o++];t[a++]=s+1.402*(u-128),t[a++]=s-.34414*(c-128)-.71414*(u-128),t[a++]=s+1.772*(c-128),t[a++]=255,t[a++]=l+1.402*(u-128),t[a++]=l-.34414*(c-128)-.71414*(u-128),t[a++]=l+1.772*(c-128),t[a++]=255}else for(var d=0;d<r;d+=2){var f=e[o++],p=e[o++],h=e[o++],m=e[o++];t[a++]=f+1.402*(m-128),t[a++]=f-.34414*(h-128)-.71414*(m-128),t[a++]=f+1.772*(h-128),t[a++]=p+1.402*(m-128),t[a++]=p-.34414*(h-128)-.71414*(m-128),t[a++]=p+1.772*(h-128)}}(e.pixelData,t,n);else{if("YBR_FULL"!==e.photometricInterpretation)throw new Error("No color space conversion for photometric interpretation ".concat(e.photometricInterpretation));!function(e,t,n){0===e.planarConfiguration?o(e.pixelData,t,n):a(e.pixelData,t,n)}(e,t,n)}}const Oe=function(e,t){if(t=t||e.transferSyntax,8===e.bitsAllocated&&"1.2.840.10008.1.2.4.50"===t&&(3===e.samplesPerPixel||4===e.samplesPerPixel))return!0};function Ce(e,t){var n=D()(e);if(V()){var r=V()(e);t&&(r=G()(r).call(r,(function(t){return Y()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){J(e,t,n[t])})):Z()?Object.defineProperties(e,Z()(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Y()(n,t))}))}return e}function Ie(e,t){var n=e.get("modalityLutModule",t)||{},r=(e.get("generalSeriesModule",t)||{}).modality,o={rescaleSlope:n.rescaleSlope,rescaleIntercept:n.rescaleIntercept,modality:r},a=e.get("scalingModule",t)||{};return Se(Se({},o),"PT"===r&&{suvbw:a.suvbw})}function Me(e,t){var n=D()(e);if(V()){var r=V()(e);t&&(r=G()(r).call(r,(function(t){return Y()(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(n),!0).forEach((function(t){J(e,t,n[t])})):Z()?Object.defineProperties(e,Z()(n)):Me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Y()(n,t))}))}return e}var _e="";function De(e){return"1.2.840.10008.5.1.4.1.1.12.1"!==e&&"1.2.840.10008.5.1.4.1.1.12.2.1"!==e}function ke(e){for(var t=ve(e),n=Math.abs(t.max-t.min)/65535,r=t.min,o=e.length,a=new Uint16Array(o),i=65535,s=0,l=0;l<o;l++){var c=Math.floor((e[l]-r)/n);a[l]=c,i=Math.min(i,c),s=Math.max(s,c)}return{min:i,max:s,intPixelData:a,slope:n,intercept:r}}function Le(e){32===e.bitsAllocated?e.pixelData=new Float32Array(e.pixelData):16===e.bitsAllocated?0===e.pixelRepresentation?e.pixelData=new Uint16Array(e.pixelData):e.pixelData=new Int16Array(e.pixelData):e.pixelData=new Uint8Array(e.pixelData)}function Ae(e,t){for(var n=e.length/4,r=0,o=0,a=0;a<n;a++)t[o++]=e[r++],t[o++]=e[r++],t[o++]=e[r++],r++;return t}const Re=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=!0;if(void 0!==r.useRGBA&&(o=r.useRGBA),r.preScale={enabled:!(!r.preScale||void 0===r.preScale.enabled)&&r.preScale.enabled},!t||!t.length)return I().reject(new Error("The file does not contain image data."));var a=We.cornerstone,i=document.createElement("canvas"),s=$(e);if(r.preScale.enabled){var l=Ie(a.metaData,e);l&&(r.preScale=Pe(Pe({},r.preScale),{},{scalingParameters:l}))}var c=je(s,n,t,i,r),d=A().decodeConfig.convertFloatPixelDataToInt;return new(I())((function(t,s){c.then((function(s){var l=!1;if(r.targetBuffer){var c,u,f=r.targetBuffer;c=f.offset,u=f.length;var p,h,m=r.targetBuffer,g=m.arrayBuffer,v=m.type;switch(null==u&&(u=s.pixelDataLength),null==c&&(c=0),v){case"Uint8Array":p=Uint8Array;break;case"Uint16Array":p=Uint16Array;break;case"Float32Array":p=Float32Array;break;default:throw new Error("target array for image does not have a valid type.")}if(u!==s.pixelDataLength)throw new Error("target array for image does not have the same length as the decoded image length.");h=g?new p(g,c,u):new p(s.pixelData),s.pixelData=h,l=!0}l||Le(s);var y=a.metaData.get("imagePlaneModule",e)||{},x=a.metaData.get("voiLutModule",e)||{},b=a.metaData.get("modalityLutModule",e)||{},j=a.metaData.get("sopCommonModule",e)||{},w=we(s.photometricInterpretation);if(w){if(o){if(!Oe(s,n)){i.height=s.rows,i.width=s.columns;var T=i.getContext("2d").createImageData(s.columns,s.rows);Ee(s,T.data,o),s.imageData=T,s.pixelData=T.data}}else if(Oe(s,n)){var E=new Uint8ClampedArray(s.pixelData.length/4*3);s.pixelData=Ae(s.pixelData,E)}else if("PALETTE COLOR"===s.photometricInterpretation){i.height=s.rows,i.width=s.columns;var O=i.getContext("2d").createImageData(s.columns,s.rows);Ee(s,O.data,!0);var C=new O.data.constructor(O.data.length/4*3);s.pixelData=Ae(O.data,C)}var S=ve(s.pixelData);s.smallestPixelValue=S.min,s.largestPixelValue=S.max}var I={imageId:e,color:w,columnPixelSpacing:y.columnPixelSpacing,columns:s.columns,height:s.rows,preScale:s.preScale,intercept:b.rescaleIntercept?b.rescaleIntercept:0,slope:b.rescaleSlope?b.rescaleSlope:1,invert:"MONOCHROME1"===s.photometricInterpretation,minPixelValue:s.smallestPixelValue,maxPixelValue:s.largestPixelValue,rowPixelSpacing:y.rowPixelSpacing,rows:s.rows,sizeInBytes:s.pixelData.byteLength,width:s.columns,windowCenter:x.windowCenter?x.windowCenter[0]:void 0,windowWidth:x.windowWidth?x.windowWidth[0]:void 0,decodeTimeInMS:s.decodeTimeInMS,floatPixelData:void 0,imageFrame:s,rgba:w&&o};if(s.pixelData instanceof Float32Array&&d){var M=s.pixelData,P=ke(M);I.minPixelValue=P.min,I.maxPixelValue=P.max,I.slope=P.slope,I.intercept=P.intercept,I.floatPixelData=M,I.getPixelData=function(){return P.intPixelData}}else I.getPixelData=function(){return s.pixelData};if(I.color&&(I.getCanvas=function(){return _e===e||(i.height=I.rows,i.width=I.columns,i.getContext("2d").putImageData(s.imageData,0,0),_e=e),i}),b.modalityLUTSequence&&b.modalityLUTSequence.length>0&&De(j.sopClassUID)&&(I.modalityLUT=b.modalityLUTSequence[0]),x.voiLUTSequence&&x.voiLUTSequence.length>0&&(I.voiLUT=x.voiLUTSequence[0]),I.color&&(I.windowWidth=255,I.windowCenter=127),void 0===I.windowCenter||void 0===I.windowWidth){var _=I.maxPixelValue*I.slope+I.intercept,D=I.minPixelValue*I.slope+I.intercept;I.windowWidth=_-D,I.windowCenter=(_+D)/2}t(I)}),s)}))};function Be(e){var t="1.2.840.10008.1.2";if(!e)return t;var n=e.split(";"),r={};n.forEach((function(e){var t,n,o=e.split("=");if(2===o.length){var a=C()(t=o[1]).call(t).replace(/"/g,"");r[C()(n=o[0]).call(n)]=a}}));var o={"image/jpeg":"1.2.840.10008.1.2.4.50","image/x-dicom-rle":"1.2.840.10008.1.2.5","image/x-jls":"1.2.840.10008.1.2.4.80","image/jls":"1.2.840.10008.1.2.4.80","image/jll":"1.2.840.10008.1.2.4.70","image/jp2":"1.2.840.10008.1.2.4.90","image/jpx":"1.2.840.10008.1.2.4.92"};return r["transfer-syntax"]?r["transfer-syntax"]:e&&!D()(r).length&&o[e]?o[e]:r.type&&o[r.type]?o[r.type]:t}function Ue(){return We.cornerstone.imageRetrievalPoolManager}const Fe=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Ue(),o=(new Date).getTime(),a=new(I())((function(a,i){var s=n.requestType||"interaction",l=n.additionalDetails||{imageId:e},c=void 0===n.priority?5:n.priority,u=n.addToBeginning||!1,d=e.substring(7);r.addRequest(function(e,t,r){return N(e,t,r).then((function(e){var r=Be(e.contentType),s=e.imageFrame.pixelData;Re(t,s,r,n).then((function(e){var t=(new Date).getTime();e.loadTimeInMS=t-o,a(e)}),i)}),i).catch((function(e){i(e)}))}.bind(t,d,e,"multipart/related; type=application/octet-stream; transfer-syntax=*"),s,l,c,u)}));return{promise:a,cancelFn:void 0}},He={metaData:{getNumberString:g,getNumberValue:v,getNumberValues:y,getValue:m,metaDataProvider:w},findIndexOfString:E,getPixelData:N,loadImage:Fe,metaDataManager:j,register:function(e){e.registerImageLoader("wadors",Fe),e.metaData.addProvider(w)}},Ne=function(e){He.register(e),dt.register(e)};var ze,Ve,qe={set cornerstone(e){Ne(ze=e)},get cornerstone(){if(!ze){if(!window||!window.cornerstone)throw new Error("cornerstoneWADOImageLoader requires a copy of Cornerstone to work properly. Please add cornerstoneWADOImageLoader.external.cornerstone = cornerstone; to your application.");ze=window.cornerstone,Ne(ze)}return ze},set dicomParser(e){Ve=e},get dicomParser(){if(!Ve){if(!window||!window.dicomParser)throw new Error("cornerstoneWADOImageLoader requires a copy of dicomParser to work properly. Please add cornerstoneWADOImageLoader.external.dicomParser = dicomParser; to your application.");Ve=window.dicomParser}return Ve}};const We=qe,Ge=function(e){var t,n=e.indexOf(":"),r=e.substring(n+1),o=r.indexOf("frame=");if(-1!==o){var a=r.substr(o+6);t=parseInt(a,10),r=r.substr(0,o-1)}return{scheme:e.substr(0,n),url:r,frame:t}};var Ye=0,Xe={},Ze={};function Ke(){return{cacheSizeInBytes:Ye,numberOfDataSetsCached:D()(Xe).length}}const Je={isLoaded:function(e){return void 0!==Xe[e]},load:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:R,n=arguments.length>2?arguments[2]:void 0,r=We.cornerstone,o=We.dicomParser;if(Xe[e])return new(I())((function(t){Xe[e].cacheCount++,t(Xe[e].dataSet)}));if(Ze[e])return Ze[e].cacheCount++,Ze[e];var a=t(e,n),i=new(I())((function(t,n){a.then((function(a){var s,l=new Uint8Array(a);try{s=o.parseDicom(l)}catch(e){return n(e)}Xe[e]={dataSet:s,cacheCount:i.cacheCount},Ye+=s.byteArray.length,t(s),r.triggerEvent(r.events,"datasetscachechanged",{uri:e,action:"loaded",cacheInfo:Ke()})}),n).then((function(){delete Ze[e]}),(function(){delete Ze[e]}))}));return i.cacheCount=1,Ze[e]=i,i},unload:function(e){var t=We.cornerstone;Xe[e]&&(Xe[e].cacheCount--,0===Xe[e].cacheCount&&(Ye-=Xe[e].dataSet.byteArray.length,delete Xe[e],t.triggerEvent(t.events,"datasetscachechanged",{uri:e,action:"unloaded",cacheInfo:Ke()})))},getInfo:Ke,purge:function(){Xe={},Ze={},Ye=0},get:function(e){if(Xe[e])return Xe[e].dataSet}},$e=function(e,t){var n=We.dicomParser,r=Ge(t),o=Je.get(r.url);if(o){if("generalSeriesModule"===e)return{modality:o.string("x00080060"),seriesInstanceUID:o.string("x0020000e"),seriesNumber:o.intString("x00200011"),studyInstanceUID:o.string("x0020000d"),seriesDate:n.parseDA(o.string("x00080021")),seriesTime:n.parseTM(o.string("x00080031")||"")};if("patientStudyModule"===e)return{patientAge:o.intString("x00101010"),patientSize:o.floatString("x00101020"),patientWeight:o.floatString("x00101030")};if("imagePlaneModule"===e){var a=h(o,"x00200037",6),i=h(o,"x00200032",3),s=h(o,"x00280030",2),l=null,c=null;s&&(c=s[0],l=s[1]);var d=null,m=null;return a&&(d=[parseFloat(a[0]),parseFloat(a[1]),parseFloat(a[2])],m=[parseFloat(a[3]),parseFloat(a[4]),parseFloat(a[5])]),{frameOfReferenceUID:o.string("x00200052"),rows:o.uint16("x00280010"),columns:o.uint16("x00280011"),imageOrientationPatient:a,rowCosines:d,columnCosines:m,imagePositionPatient:i,sliceThickness:o.floatString("x00180050"),sliceLocation:o.floatString("x00201041"),pixelSpacing:s,rowPixelSpacing:c,columnPixelSpacing:l}}if("imagePixelModule"===e)return u(o);if("modalityLutModule"===e)return{rescaleIntercept:o.floatString("x00281052"),rescaleSlope:o.floatString("x00281053"),rescaleType:o.string("x00281054"),modalityLUTSequence:f(o.uint16("x00280103"),o.elements.x00283000)};if("voiLutModule"===e){var g=p(o);return{windowCenter:h(o,"x00281050",1),windowWidth:h(o,"x00281051",1),voiLUTSequence:f(g,o.elements.x00283010)}}if("sopCommonModule"===e)return{sopClassUID:o.string("x00080016"),sopInstanceUID:o.string("x00080018")};if("petIsotopeModule"===e){var v=o.elements.x00540016;if(void 0===v)return;var y=v.items[0].dataSet;return{radiopharmaceuticalInfo:{radiopharmaceuticalStartTime:n.parseTM(y.string("x00181072")||""),radionuclideTotalDose:y.floatString("x00181074"),radionuclideHalfLife:y.floatString("x00181075")}}}return"overlayPlaneModule"===e?function(e){for(var t=[],n=0;n<=30;n+=2){var r="x60".concat(n.toString(16));4===r.length&&(r="x600".concat(n.toString(16)));var o=e.elements["".concat(r,"3000")];if(o){for(var a=[],i=0;i<o.length;i++)for(var s=0;s<8;s++){var l=e.byteArray[o.dataOffset+i];a[8*i+s]=l>>s&1}t.push({rows:e.uint16("".concat(r,"0010")),columns:e.uint16("".concat(r,"0011")),type:e.string("".concat(r,"0040")),x:e.int16("".concat(r,"0050"),1)-1,y:e.int16("".concat(r,"0050"),0)-1,pixelData:a,description:e.string("".concat(r,"0022")),label:e.string("".concat(r,"1500")),roiArea:e.string("".concat(r,"1301")),roiMean:e.string("".concat(r,"1302")),roiStandardDeviation:e.string("".concat(r,"1303"))})}}return{overlays:t}}(o):"transferSyntax"===e?{transferSyntaxUID:o.string("x00020010")}:void 0}};var Qe=[];const et={add:function(e){var t=Qe.push(e);return"dicomfile:".concat(t-1)},get:function(e){return Qe[e]},remove:function(e){Qe[e]=void 0},purge:function(){Qe=[]}};function tt(e,t){var n=We.dicomParser;if(e.elements.x7fe00010&&e.elements.x7fe00010.basicOffsetTable.length)return n.readEncapsulatedImageFrame(e,e.elements.x7fe00010,t);if(function(e){return e.intString("x00280008")!==e.elements.x7fe00010.fragments.length}(e)){var r=n.createJPEGBasicOffsetTable(e,e.elements.x7fe00010);return n.readEncapsulatedImageFrame(e,e.elements.x7fe00010,t,r)}return n.readEncapsulatedPixelDataFromFragments(e,e.elements.x7fe00010,t)}function rt(e,t){return e&1<<t}const nt=function(e,t,n){for(var r=new Uint8Array(n),o=0;o<n;o++){var a=e[Math.floor(o/8)+t],i=o%8;r[o]=rt(a,i)?1:0}return r},at=function(e,t){var n=e.elements.x7fe00010||e.elements.x7fe00008,r=e.uint16("x00280100"),o=e.uint16("x00280010"),a=e.uint16("x00280011"),i=e.uint16("x00280002");"YBR_FULL_422"===e.string("x00280004")&&(i=2,console.warn("Using SamplesPerPixel of 2 for YBR_FULL_422 photometric interpretation.\n      See http://dicom.nema.org/medical/dicom/current/output/chtml/part03/sect_C.7.6.3.html for more information."));var s,l=n.dataOffset,c=o*a*i;if(8===r){if((s=l+t*c)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(e.byteArray.buffer,s,c)}if(16===r){if((s=l+t*c*2)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(e.byteArray.buffer,s,2*c)}if(1===r){if((s=l+t*c*.125)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return nt(e.byteArray,s,c)}if(32===r){if((s=l+t*c*4)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(e.byteArray.buffer,s,4*c)}throw new Error("unsupported pixel format")},ot=function(e){var t=Ge(e),n=parseInt(t.url,10),r=et.get(n);return new(I())((function(e,t){var n=new FileReader;n.onload=function(t){var n=t.target.result;e(n)},n.onerror=t,n.readAsArrayBuffer(r)}))},it=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e.elements.x7fe00010||e.elements.x7fe00008;return n?n.encapsulatedPixelData?tt(e,t):at(e,t):null};function st(e,t){e.decache=function(){var e=Ge(t);Je.unload(e.url)}}function lt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,i=(new Date).getTime(),s={cancelFn:void 0};return s.promise=new(I())((function(l,c){e.then((function(e){var u=it(e,n),d=e.string("x00020010"),f=(new Date).getTime(),p=Re(t,u,d,o);st(s,t),p.then((function(t){t.data=e,t.sharedCacheKey=r;var n=(new Date).getTime();t.loadTimeInMS=f-i,t.totalTimeInMS=n-i,void 0!==a&&void 0!==a.imageDoneCallback&&a.imageDoneCallback(t),l(t)}),(function(t){c({error:t,dataSet:e})}))}),(function(e){c({error:e})}))})),s}function ut(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,a=(new Date).getTime(),i=new(I())((function(i,s){var l,c=(new Date).getTime();try{var u=it(e,n),d=e.string("x00020010");l=Re(t,u,d,o)}catch(t){return void s({error:t,dataSet:e})}l.then((function(t){t.data=e,t.sharedCacheKey=r;var n=(new Date).getTime();t.loadTimeInMS=c-a,t.totalTimeInMS=n-a,i(t)}),s)}));return{promise:i,cancelFn:void 0}}function ct(e){return"dicomweb"===e||"wadouri"===e?R:"dicomfile"===e?ot:void 0}function ft(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ge(e),r=(t=P()({},t)).loader;return void 0===r?r=ct(n.scheme):delete t.loader,Je.isLoaded(n.url)?ut(Je.get(n.url,r,e),e,n.frame,n.url,t):lt(Je.load(n.url,r,e),e,n.frame,n.url,t)}const dt={metaData:{getImagePixelModule:u,getLUTs:f,getModalityLUTOutputPixelRepresentation:p,getNumberValues:h,metaDataProvider:$e},dataSetCacheManager:Je,fileManager:et,getEncapsulatedImageFrame:tt,getUncompressedImageFrame:at,loadFileRequest:ot,loadImageFromPromise:lt,getLoaderForScheme:ct,loadImage:ft,parseImageId:Ge,unpackBinaryFrame:nt,register:function(e){e.registerImageLoader("dicomweb",ft),e.registerImageLoader("wadouri",ft),e.registerImageLoader("dicomfile",ft),e.metaData.addProvider($e)}},ht=function(e){L(e)},gt="4.2.1",mt={convertRGBColorByPixel:e,convertRGBColorByPlane:t,convertYBRFullByPixel:o,convertYBRFullByPlane:a,convertPALETTECOLOR:s,wadouri:dt,wadors:He,configure:ht,convertColorSpace:Ee,createImage:Re,decodeImageFrame:je,decodeJPEGBaseline8BitColor:be,getImageFrame:$,getPixelData:N,getMinMax:ve,isColorImage:we,isJPEGBaseline8BitColor:Oe,webWorkerManager:he,version:gt,internal:B,external:qe}})(),r})()},581:function(e,t,n){var r;window,r=function(){return function(e){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(e,n){!function(e,t){if(S[e]&&C[e]){for(var n in C[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(j[n]=t[n]);0==--T&&0===E&&_()}}(e,n),t&&t(e,n)};var n,r=!0,o="0508e3ca1dab256990d7",l={},c=[],d=[];function f(e){var t=k[e];if(!t)return L;var r=function(r){return t.hot.active?(k[r]?-1===k[r].parents.indexOf(e)&&k[r].parents.push(e):(c=[e],n=r),-1===t.children.indexOf(r)&&t.children.push(r)):(console.warn("[HMR] unexpected require("+r+") from disposed module "+e),c=[]),L(r)},o=function(e){return{configurable:!0,enumerable:!0,get:function(){return L[e]},set:function(t){L[e]=t}}};for(var l in L)Object.prototype.hasOwnProperty.call(L,l)&&"e"!==l&&"t"!==l&&Object.defineProperty(r,l,o(l));return r.e=function(e){return"ready"===v&&y("prepare"),E++,L.e(e).then(t,(function(e){throw t(),e}));function t(){E--,"prepare"===v&&(O[e]||P(e),0===E&&0===T&&_())}},r.t=function(e,t){return 1&t&&(e=r(e)),L.t(e,-2&t)},r}function h(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:n!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var i=0;i<e.length;i++)t._acceptedDependencies[e[i]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var i=0;i<e.length;i++)t._declinedDependencies[e[i]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:M,apply:D,status:function(e){if(!e)return v;m.push(e)},addStatusHandler:function(e){m.push(e)},removeStatusHandler:function(e){var t=m.indexOf(e);t>=0&&m.splice(t,1)},data:l[e]};return n=void 0,t}var m=[],v="idle";function y(e){v=e;for(var i=0;i<m.length;i++)m[i].call(null,e)}var x,j,w,T=0,E=0,O={},C={},S={};function I(e){return+e+""===e?+e:e}function M(e){if("idle"!==v)throw new Error("check() is only allowed in idle status");return r=e,y("check"),(t=1e4,t=t||1e4,new Promise((function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var r=new XMLHttpRequest,l=L.p+""+o+".hot-update.json";r.open("GET",l,!0),r.timeout=t,r.send(null)}catch(e){return n(e)}r.onreadystatechange=function(){if(4===r.readyState)if(0===r.status)n(new Error("Manifest request to "+l+" timed out."));else if(404===r.status)e();else if(200!==r.status&&304!==r.status)n(new Error("Manifest request to "+l+" failed."));else{try{var t=JSON.parse(r.responseText)}catch(e){return void n(e)}e(t)}}}))).then((function(e){if(!e)return y("idle"),null;C={},O={},S=e.c,w=e.h,y("prepare");var t=new Promise((function(e,t){x={resolve:e,reject:t}}));return j={},P("cornerstoneTools"),"prepare"===v&&0===E&&0===T&&_(),t}));var t}function P(e){S[e]?(C[e]=!0,T++,function(e){var script=document.createElement("script");script.charset="utf-8",script.src=L.p+""+e+"."+o+".hot-update.js",document.head.appendChild(script)}(e)):O[e]=!0}function _(){y("ready");var e=x;if(x=null,e)if(r)Promise.resolve().then((function(){return D(r)})).then((function(t){e.resolve(t)}),(function(t){e.reject(t)}));else{var t=[];for(var n in j)Object.prototype.hasOwnProperty.call(j,n)&&t.push(I(n));e.resolve(t)}}function D(t){if("ready"!==v)throw new Error("apply() is only allowed in ready status");var n,i,r,d,f;function h(e){for(var t=[e],n={},r=t.map((function(e){return{chain:[e],id:e}}));r.length>0;){var o=r.pop(),l=o.id,c=o.chain;if((d=k[l])&&!d.hot._selfAccepted){if(d.hot._selfDeclined)return{type:"self-declined",chain:c,moduleId:l};if(d.hot._main)return{type:"unaccepted",chain:c,moduleId:l};for(var i=0;i<d.parents.length;i++){var f=d.parents[i],h=k[f];if(h){if(h.hot._declinedDependencies[l])return{type:"declined",chain:c.concat([f]),moduleId:l,parentId:f};-1===t.indexOf(f)&&(h.hot._acceptedDependencies[l]?(n[f]||(n[f]=[]),m(n[f],[l])):(delete n[f],t.push(f),r.push({chain:c.concat([f]),id:f})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function m(a,b){for(var i=0;i<b.length;i++){var e=b[i];-1===a.indexOf(e)&&a.push(e)}}t=t||{};var x={},T=[],E={},O=function(){console.warn("[HMR] unexpected require("+M.moduleId+") to disposed module")};for(var C in j)if(Object.prototype.hasOwnProperty.call(j,C)){var M;f=I(C);var P=!1,_=!1,D=!1,A="";switch((M=j[C]?h(f):{type:"disposed",moduleId:C}).chain&&(A="\nUpdate propagation: "+M.chain.join(" -> ")),M.type){case"self-declined":t.onDeclined&&t.onDeclined(M),t.ignoreDeclined||(P=new Error("Aborted because of self decline: "+M.moduleId+A));break;case"declined":t.onDeclined&&t.onDeclined(M),t.ignoreDeclined||(P=new Error("Aborted because of declined dependency: "+M.moduleId+" in "+M.parentId+A));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(M),t.ignoreUnaccepted||(P=new Error("Aborted because "+f+" is not accepted"+A));break;case"accepted":t.onAccepted&&t.onAccepted(M),_=!0;break;case"disposed":t.onDisposed&&t.onDisposed(M),D=!0;break;default:throw new Error("Unexception type "+M.type)}if(P)return y("abort"),Promise.reject(P);if(_)for(f in E[f]=j[f],m(T,M.outdatedModules),M.outdatedDependencies)Object.prototype.hasOwnProperty.call(M.outdatedDependencies,f)&&(x[f]||(x[f]=[]),m(x[f],M.outdatedDependencies[f]));D&&(m(T,[M.moduleId]),E[f]=O)}var R,B=[];for(i=0;i<T.length;i++)f=T[i],k[f]&&k[f].hot._selfAccepted&&E[f]!==O&&B.push({module:f,errorHandler:k[f].hot._selfAccepted});y("dispose"),Object.keys(S).forEach((function(e){!1===S[e]&&function(e){delete installedChunks[e]}(e)}));for(var U,F,H=T.slice();H.length>0;)if(f=H.pop(),d=k[f]){var data={},N=d.hot._disposeHandlers;for(r=0;r<N.length;r++)(n=N[r])(data);for(l[f]=data,d.hot.active=!1,delete k[f],delete x[f],r=0;r<d.children.length;r++){var z=k[d.children[r]];z&&(R=z.parents.indexOf(f))>=0&&z.parents.splice(R,1)}}for(f in x)if(Object.prototype.hasOwnProperty.call(x,f)&&(d=k[f]))for(F=x[f],r=0;r<F.length;r++)U=F[r],(R=d.children.indexOf(U))>=0&&d.children.splice(R,1);for(f in y("apply"),o=w,E)Object.prototype.hasOwnProperty.call(E,f)&&(e[f]=E[f]);var V=null;for(f in x)if(Object.prototype.hasOwnProperty.call(x,f)&&(d=k[f])){F=x[f];var W=[];for(i=0;i<F.length;i++)if(U=F[i],n=d.hot._acceptedDependencies[U]){if(-1!==W.indexOf(n))continue;W.push(n)}for(i=0;i<W.length;i++){n=W[i];try{n(F)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:f,dependencyId:F[i],error:e}),t.ignoreErrored||V||(V=e)}}}for(i=0;i<B.length;i++){var G=B[i];f=G.module,c=[f];try{L(f)}catch(e){if("function"==typeof G.errorHandler)try{G.errorHandler(e)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:f,error:n,originalError:e}),t.ignoreErrored||V||(V=n),V||(V=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:f,error:e}),t.ignoreErrored||V||(V=e)}}return V?(y("fail"),Promise.reject(V)):(y("idle"),new Promise((function(e){e(T)})))}var k={};function L(t){if(k[t])return k[t].exports;var n=k[t]={i:t,l:!1,exports:{},hot:h(t),parents:(d=c,c=[],d),children:[]};return e[t].call(n.exports,n,n.exports,f(t)),n.l=!0,n.exports}return L.m=e,L.c=k,L.d=function(e,t,n){L.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},L.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},L.t=function(e,t){if(1&t&&(e=L(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(L.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)L.d(n,r,function(t){return e[t]}.bind(null,r));return n},L.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return L.d(t,"a",t),t},L.o=function(object,e){return Object.prototype.hasOwnProperty.call(object,e)},L.p="",L.h=function(){return o},f("./index.js")(L.s="./index.js")}({"../node_modules/@babel/runtime/helpers/arrayWithHoles.js":function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},"../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js":function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var i=0,t=new Array(e.length);i<e.length;i++)t[i]=e[i];return t}}},"../node_modules/@babel/runtime/helpers/assertThisInitialized.js":function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},"../node_modules/@babel/runtime/helpers/asyncToGenerator.js":function(e,t){function n(e,t,n,r,o,l,c){try{var d=e[l](c),f=d.value}catch(e){return void n(e)}d.done?t(f):Promise.resolve(f).then(r,o)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(o,l){var c=e.apply(t,r);function d(e){n(c,o,l,d,f,"next",e)}function f(e){n(c,o,l,d,f,"throw",e)}d(void 0)}))}}},"../node_modules/@babel/runtime/helpers/classCallCheck.js":function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},"../node_modules/@babel/runtime/helpers/createClass.js":function(e,t){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},"../node_modules/@babel/runtime/helpers/defineProperty.js":function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},"../node_modules/@babel/runtime/helpers/getPrototypeOf.js":function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},"../node_modules/@babel/runtime/helpers/inherits.js":function(e,t,n){var r=n("../node_modules/@babel/runtime/helpers/setPrototypeOf.js");e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},"../node_modules/@babel/runtime/helpers/iterableToArray.js":function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},"../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js":function(e,t){e.exports=function(e,i){var t=[],n=!0,r=!1,o=void 0;try{for(var l,c=e[Symbol.iterator]();!(n=(l=c.next()).done)&&(t.push(l.value),!i||t.length!==i);n=!0);}catch(e){r=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(r)throw o}}return t}},"../node_modules/@babel/runtime/helpers/nonIterableRest.js":function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},"../node_modules/@babel/runtime/helpers/nonIterableSpread.js":function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},"../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js":function(e,t,n){var r=n("../node_modules/@babel/runtime/helpers/typeof.js"),o=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js");e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?o(e):t}},"../node_modules/@babel/runtime/helpers/setPrototypeOf.js":function(e,t){function n(t,p){return e.exports=n=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e},n(t,p)}e.exports=n},"../node_modules/@babel/runtime/helpers/slicedToArray.js":function(e,t,n){var r=n("../node_modules/@babel/runtime/helpers/arrayWithHoles.js"),o=n("../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js"),l=n("../node_modules/@babel/runtime/helpers/nonIterableRest.js");e.exports=function(e,i){return r(e)||o(e,i)||l()}},"../node_modules/@babel/runtime/helpers/toConsumableArray.js":function(e,t,n){var r=n("../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js"),o=n("../node_modules/@babel/runtime/helpers/iterableToArray.js"),l=n("../node_modules/@babel/runtime/helpers/nonIterableSpread.js");e.exports=function(e){return r(e)||o(e)||l()}},"../node_modules/@babel/runtime/helpers/typeof.js":function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=r=function(e){return n(e)}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},r(t)}e.exports=r},"../node_modules/@babel/runtime/regenerator/index.js":function(e,t,n){e.exports=n("../node_modules/regenerator-runtime/runtime-module.js")},"../node_modules/ms/index.js":function(e,t){var s=1e3,n=60*s,r=60*n,o=24*r,l=7*o,c=365.25*o;function d(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,t){t=t||{};var f,h,m=typeof e;if("string"===m&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var d=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return d*c;case"weeks":case"week":case"w":return d*l;case"days":case"day":case"d":return d*o;case"hours":case"hour":case"hrs":case"hr":case"h":return d*r;case"minutes":case"minute":case"mins":case"min":case"m":return d*n;case"seconds":case"second":case"secs":case"sec":case"s":return d*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return d;default:return}}}}(e);if("number"===m&&isFinite(e))return t.long?(f=e,(h=Math.abs(f))>=o?d(f,h,o,"day"):h>=r?d(f,h,r,"hour"):h>=n?d(f,h,n,"minute"):h>=s?d(f,h,s,"second"):f+" ms"):function(e){var t=Math.abs(e);return t>=o?Math.round(e/o)+"d":t>=r?Math.round(e/r)+"h":t>=n?Math.round(e/n)+"m":t>=s?Math.round(e/s)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},"../node_modules/process/browser.js":function(e,t){var n,r,o=e.exports={};function l(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function d(e){if(n===setTimeout)return setTimeout(e,0);if((n===l||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:l}catch(e){n=l}try{r="function"==typeof clearTimeout?clearTimeout:c}catch(e){r=c}}();var f,h=[],m=!1,v=-1;function y(){m&&f&&(m=!1,f.length?h=f.concat(h):v=-1,h.length&&x())}function x(){if(!m){var e=d(y);m=!0;for(var t=h.length;t;){for(f=h,h=[];++v<t;)f&&f[v].run();v=-1,t=h.length}f=null,m=!1,function(marker){if(r===clearTimeout)return clearTimeout(marker);if((r===c||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(marker);try{r(marker)}catch(e){try{return r.call(null,marker)}catch(e){return r.call(this,marker)}}}(e)}}function j(e,t){this.fun=e,this.array=t}function w(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];h.push(new j(e,t)),1!==h.length||m||d(x)},j.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=w,o.addListener=w,o.once=w,o.off=w,o.removeListener=w,o.removeAllListeners=w,o.emit=w,o.prependListener=w,o.prependOnceListener=w,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},"../node_modules/regenerator-runtime/runtime-module.js":function(e,t,n){var g=function(){return this||"object"==typeof self&&self}()||Function("return this")(),r=g.regeneratorRuntime&&Object.getOwnPropertyNames(g).indexOf("regeneratorRuntime")>=0,o=r&&g.regeneratorRuntime;if(g.regeneratorRuntime=void 0,e.exports=n("../node_modules/regenerator-runtime/runtime.js"),r)g.regeneratorRuntime=o;else try{delete g.regeneratorRuntime}catch(e){g.regeneratorRuntime=void 0}},"../node_modules/regenerator-runtime/runtime.js":function(e,t){!function(t){"use strict";var n,r=Object.prototype,o=r.hasOwnProperty,l="function"==typeof Symbol?Symbol:{},c=l.iterator||"@@iterator",d=l.asyncIterator||"@@asyncIterator",f=l.toStringTag||"@@toStringTag",h="object"==typeof e,m=t.regeneratorRuntime;if(m)h&&(e.exports=m);else{(m=t.regeneratorRuntime=h?e.exports:{}).wrap=S;var v="suspendedStart",y="suspendedYield",x="executing",j="completed",w={},T={};T[c]=function(){return this};var E=Object.getPrototypeOf,O=E&&E(E(U([])));O&&O!==r&&o.call(O,c)&&(T=O);var C=_.prototype=M.prototype=Object.create(T);P.prototype=C.constructor=_,_.constructor=P,_[f]=P.displayName="GeneratorFunction",m.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===P||"GeneratorFunction"===(t.displayName||t.name))},m.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,f in e||(e[f]="GeneratorFunction")),e.prototype=Object.create(C),e},m.awrap=function(e){return{__await:e}},D(k.prototype),k.prototype[d]=function(){return this},m.AsyncIterator=k,m.async=function(e,t,n,r){var o=new k(S(e,t,n,r));return m.isGeneratorFunction(t)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},D(C),C[f]="Generator",C[c]=function(){return this},C.toString=function(){return"[object Generator]"},m.keys=function(object){var e=[];for(var t in object)e.push(t);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in object)return t.value=n,t.done=!1,t}return t.done=!0,t}},m.values=U,B.prototype={constructor:B,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(R),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,o){return c.type="throw",c.arg=e,t.next=r,o&&(t.method="next",t.arg=n),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var l=this.tryEntries[i],c=l.completion;if("root"===l.tryLoc)return r("end");if(l.tryLoc<=this.prev){var d=o.call(l,"catchLoc"),f=o.call(l,"finallyLoc");if(d&&f){if(this.prev<l.catchLoc)return r(l.catchLoc,!0);if(this.prev<l.finallyLoc)return r(l.finallyLoc)}else if(d){if(this.prev<l.catchLoc)return r(l.catchLoc,!0)}else{if(!f)throw new Error("try statement without catch or finally");if(this.prev<l.finallyLoc)return r(l.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var l=r?r.completion:{};return l.type=e,l.arg=t,r?(this.method="next",this.next=r.finallyLoc,w):this.complete(l)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),w},finish:function(e){for(var i=this.tryEntries.length-1;i>=0;--i){var t=this.tryEntries[i];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),R(t),w}},catch:function(e){for(var i=this.tryEntries.length-1;i>=0;--i){var t=this.tryEntries[i];if(t.tryLoc===e){var n=t.completion;if("throw"===n.type){var r=n.arg;R(t)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:U(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),w}}}function S(e,t,n,r){var o=t&&t.prototype instanceof M?t:M,l=Object.create(o.prototype),c=new B(r||[]);return l._invoke=function(e,t,n){var r=v;return function(o,l){if(r===x)throw new Error("Generator is already running");if(r===j){if("throw"===o)throw l;return F()}for(n.method=o,n.arg=l;;){var c=n.delegate;if(c){var d=L(c,n);if(d){if(d===w)continue;return d}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===v)throw r=j,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=x;var f=I(e,t,n);if("normal"===f.type){if(r=n.done?j:y,f.arg===w)continue;return{value:f.arg,done:n.done}}"throw"===f.type&&(r=j,n.method="throw",n.arg=f.arg)}}}(e,n,c),l}function I(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function M(){}function P(){}function _(){}function D(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function k(e){function t(n,r,l,c){var d=I(e[n],e,r);if("throw"!==d.type){var f=d.arg,h=f.value;return h&&"object"==typeof h&&o.call(h,"__await")?Promise.resolve(h.__await).then((function(e){t("next",e,l,c)}),(function(e){t("throw",e,l,c)})):Promise.resolve(h).then((function(e){f.value=e,l(f)}),(function(e){return t("throw",e,l,c)}))}c(d.arg)}var n;this._invoke=function(e,r){function o(){return new Promise((function(n,o){t(e,r,n,o)}))}return n=n?n.then(o,o):o()}}function L(e,t){var r=e.iterator[t.method];if(r===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,L(e,t),"throw"===t.method))return w;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return w}var o=I(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,w;var l=o.arg;return l?l.done?(t[e.resultName]=l.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,w):l:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,w)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function B(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function U(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,r=function t(){for(;++i<e.length;)if(o.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=n,t.done=!0,t};return r.next=r}}return{next:F}}function F(){return{value:n,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},"./drawing/draw.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){e.save(),t(e),e.restore()}},"./drawing/drawArrow.js":function(e,t,n){"use strict";n.r(t);var r=n("./drawing/drawLine.js"),o=n("./drawing/drawJoinedLines.js");t.default=function(e,t,n,l,c,d){var f=Math.atan2(n.y-t.y,n.x-t.x),h={color:l,lineWidth:c};d&&(h.lineDash=d),Object(r.default)(e,void 0,t,n,h,"canvas"),h={color:l,lineWidth:c,fillStyle:l};var m=[{x:n.x-10*Math.cos(f-Math.PI/7),y:n.y-10*Math.sin(f-Math.PI/7)},{x:n.x-10*Math.cos(f+Math.PI/7),y:n.y-10*Math.sin(f+Math.PI/7)},n];Object(o.default)(e,void 0,n,m,h,"canvas")}},"./drawing/drawCircle.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./drawing/path.js");t.default=function(e,element,t,n,l){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";"pixel"===c&&(t=r.default.cornerstone.pixelToCanvas(element,t)),Object(o.default)(e,l,(function(e){e.arc(t.x,t.y,n,0,2*Math.PI)}))}},"./drawing/drawEllipse.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./drawing/path.js"),l=n("./util/pointProjector.js");t.default=function(e,element,t,n,c){var d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel",f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;"pixel"===d&&(t=r.default.cornerstone.pixelToCanvas(element,t),n=r.default.cornerstone.pixelToCanvas(element,n));var h=r.default.cornerstone.getViewport(element),m=element.clientWidth,v=element.clientHeight,y=h.scale,x=h.translation,j=h.rotation-f,w={x:m/2+x.x*y,y:v/2+x.y*y};Math.abs(j)>.05&&(t=Object(l.rotatePoint)(t,w,-j),n=Object(l.rotatePoint)(n,w,-j));var T=Math.abs(t.x-n.x),E=Math.abs(t.y-n.y),O=Math.min(t.x,n.x),C=Math.min(t.y,n.y),S={x:O+T/2,y:C+E/2};Math.abs(j)>.05&&(S=Object(l.rotatePoint)(S,w,j));var I=j*Math.PI/180;Object(o.default)(e,c,(function(e){e.ellipse(S.x,S.y,T/2,E/2,I,0,2*Math.PI),e.closePath()}))}},"./drawing/drawHandles.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./stateManagement/toolStyle.js"),l=n("./stateManagement/toolColors.js"),c=n("./drawing/path.js"),d=n("./store/index.js");t.default=function(e,t,n){var f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},element=t.element,h=l.default.getToolColor();e.strokeStyle=f.color||h;for(var m=Object.keys(n),v=function(i){var t=m[i],l=n[t];if(!0===l.drawnIndependently)return"continue";if(!0===f.drawHandlesIfActive&&!l.active)return"continue";if(f.hideHandlesIfMoving&&l.moving)return"continue";var h={lineWidth:l.active?o.default.getActiveWidth():o.default.getToolWidth(),fillStyle:f.fill};f.lineDash&&(h.lineDash=f.lineDash),Object(c.default)(e,h,(function(e){var t=r.default.cornerstone.pixelToCanvas(element,l),n=l.radius||f.handleRadius||d.state.handleRadius;e.arc(t.x,t.y,n,0,2*Math.PI)}))},i=0;i<m.length;i++)v(i)}},"./drawing/drawJoinedLines.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./drawing/path.js");t.default=function(e,element,t,n,l){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";Object(o.default)(e,l,(function(e){"pixel"===c&&(t=r.default.cornerstone.pixelToCanvas(element,t),n=n.map((function(p){return r.default.cornerstone.pixelToCanvas(element,p)}))),e.moveTo(t.x,t.y),n.forEach((function(t){var n=t.x,r=t.y;e.lineTo(n,r)}))}))}},"./drawing/drawLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var r=n("./externalModules.js"),o=n("./drawing/path.js");function l(e,element,t,n,l){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";Object(o.default)(e,l,(function(e){"pixel"===c&&(t=r.default.cornerstone.pixelToCanvas(element,t),n=r.default.cornerstone.pixelToCanvas(element,n)),e.moveTo(t.x,t.y),e.lineTo(n.x,n.y)}))}},"./drawing/drawLines.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./drawing/path.js");t.default=function(e,element,t,n){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"pixel";Object(o.default)(e,n,(function(e){t.forEach((function(line){var t=line.start,n=line.end;if("pixel"===l){var o=r.default.cornerstone;t=o.pixelToCanvas(element,t),n=o.pixelToCanvas(element,n)}e.moveTo(t.x,t.y),e.lineTo(n.x,n.y)}))}))}},"./drawing/drawLink.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./drawing/drawLine.js");t.default=function(e,t,n,l,c,d){var f=e.length>0?r.default.cornerstoneMath.point.findClosestPoint(e,t):t,h=[{x:n.left+n.width/2,y:n.top},{x:n.left,y:n.top+n.height/2},{x:n.left+n.width/2,y:n.top+n.height},{x:n.left+n.width,y:n.top+n.height/2}],m=r.default.cornerstoneMath.point.findClosestPoint(h,f),v={color:c,lineWidth:d,lineDash:[2,3]};Object(o.default)(l,void 0,f,m,v,"canvas")}},"./drawing/drawLinkedTextBox.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./drawing/drawTextBox.js"),l=n("./drawing/drawLink.js"),c=n("./store/index.js"),d=n("./util/clip.js");t.default=function(e,element,t,text,n,f,h,m,v,y){var x=r.default.cornerstone.pixelToCanvas,j=x(element,t);v&&(j.x+=v);var w={centering:{x:!1,y:y}};if(c.state.preventTextBoxOutsideDisplayedArea&&(w.displacer=function(e){return Object(d.clipBoxToDisplayedArea)(element,e)}),t.boundingBox=Object(o.default)(e,text,j.x,j.y,h,w),t.hasMoved){var T=f(n).map((function(e){return x(element,e)}));Object(l.default)(T,j,t.boundingBox,e,h,m)}}},"./drawing/drawRect.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./drawing/path.js"),l=n("./util/pointProjector.js");t.default=function(e,element,t,n,c){var d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel",f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if("pixel"===d){var h=r.default.cornerstone;t=h.pixelToCanvas(element,t),n=h.pixelToCanvas(element,n)}var m=r.default.cornerstone.getViewport(element),v=element.clientWidth,y=element.clientHeight,x=m.scale,j=m.translation,w=m.rotation-f,T={x:v/2+j.x*x,y:y/2+j.y*x};Math.abs(w)>.05&&(t=Object(l.rotatePoint)(t,T,-w),n=Object(l.rotatePoint)(n,T,-w));var E=Math.abs(t.x-n.x),O=Math.abs(t.y-n.y);t={x:Math.min(t.x,n.x),y:Math.min(t.y,n.y)},n={x:t.x+E,y:t.y+O};var C={x:t.x+E,y:t.y},S={x:t.x,y:t.y+O};Math.abs(w)>.05&&(t=Object(l.rotatePoint)(t,T,w),n=Object(l.rotatePoint)(n,T,w),C=Object(l.rotatePoint)(C,T,w),S=Object(l.rotatePoint)(S,T,w)),Object(o.default)(e,c,(function(e){e.moveTo(t.x,t.y),e.lineTo(C.x,C.y),e.lineTo(n.x,n.y),e.lineTo(S.x,S.y),e.lineTo(t.x,t.y)}))}},"./drawing/drawTextBox.js":function(e,t,n){"use strict";n.r(t),n.d(t,"textBoxWidth",(function(){return d}));var r=n("./stateManagement/textStyle.js"),o=n("./drawing/draw.js"),l=n("./drawing/fillTextLines.js"),c=n("./drawing/fillBox.js");function d(e,text,t){var n=r.default.getFont(),o=e.font;n&&n!==o&&(e.font=n);var l=e.measureText(text).width;return n&&n!==o&&(e.font=o),l+2*t}t.default=function(e,t,n,f,h){var m=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);var v=5,y=r.default.getFontSize(),x=r.default.getBackgroundColor(),j=0;t.forEach((function(text){var t=d(e,text,v);j=Math.max(j,t)}));var w={width:j,height:v+t.length*(y+v)};return Object(o.default)(e,(function(e){e.strokeStyle=h,m.centering&&(!0===m.centering.x&&(n-=w.width/2),!0===m.centering.y&&(f-=w.height/2)),w.left=n,w.top=f,"function"==typeof m.displacer&&m.displacer(w),Object(c.default)(e,w,x),Object(l.default)(e,w,t,h,v)})),w}},"./drawing/fillBox.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){e.fillStyle=n,e.fillRect(t.left,t.top,t.width,t.height)}},"./drawing/fillOutsideRect.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./drawing/path.js");t.default=function(e,element,t,n,l){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pixel";if("pixel"===c){var d=r.default.cornerstone;t=d.pixelToCanvas(element,t),n=d.pixelToCanvas(element,n)}var f=Math.min(t.x,n.x),h=Math.min(t.y,n.y),m=Math.abs(t.x-n.x),v=Math.abs(t.y-n.y);Object(o.default)(e,l,(function(e){e.rect(0,0,e.canvas.clientWidth,e.canvas.clientHeight),e.rect(f+m,h,-m,v)}))}},"./drawing/fillTextLines.js":function(e,t,n){"use strict";n.r(t);var r=n("./stateManagement/textStyle.js");t.default=function(e,t,n,o,l){var c=r.default.getFontSize();e.font=r.default.getFont(),e.textBaseline="top",e.fillStyle=o,n.forEach((function(text,n){e.fillText(text,t.left+l,t.top+l+n*(c+l))}))}},"./drawing/getNewContext.js":function(e,t,n){"use strict";n.r(t),t.default=function(canvas){var e=canvas.getContext("2d");return e.setTransform(1,0,0,1,0,0),e}},"./drawing/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./drawing/draw.js");n.d(t,"draw",(function(){return r.default}));var o=n("./drawing/drawArrow.js");n.d(t,"drawArrow",(function(){return o.default}));var l=n("./drawing/drawCircle.js");n.d(t,"drawCircle",(function(){return l.default}));var c=n("./drawing/drawEllipse.js");n.d(t,"drawEllipse",(function(){return c.default}));var d=n("./drawing/drawHandles.js");n.d(t,"drawHandles",(function(){return d.default}));var f=n("./drawing/drawJoinedLines.js");n.d(t,"drawJoinedLines",(function(){return f.default}));var h=n("./drawing/drawLine.js");n.d(t,"drawLine",(function(){return h.default}));var m=n("./drawing/drawLines.js");n.d(t,"drawLines",(function(){return m.default}));var v=n("./drawing/drawLink.js");n.d(t,"drawLink",(function(){return v.default}));var y=n("./drawing/drawLinkedTextBox.js");n.d(t,"drawLinkedTextBox",(function(){return y.default}));var x=n("./drawing/drawRect.js");n.d(t,"drawRect",(function(){return x.default}));var j=n("./drawing/drawTextBox.js");n.d(t,"drawTextBox",(function(){return j.default}));var w=n("./drawing/fillBox.js");n.d(t,"fillBox",(function(){return w.default}));var T=n("./drawing/fillOutsideRect.js");n.d(t,"fillOutsideRect",(function(){return T.default}));var E=n("./drawing/fillTextLines.js");n.d(t,"fillTextLines",(function(){return E.default}));var O=n("./drawing/getNewContext.js");n.d(t,"getNewContext",(function(){return O.default}));var C=n("./drawing/path.js");n.d(t,"path",(function(){return C.default}));var S=n("./drawing/setShadow.js");n.d(t,"setShadow",(function(){return S.default}));var I=n("./drawing/transformCanvasContext.js");n.d(t,"transformCanvasContext",(function(){return I.default}));var M=n("./drawing/resetCanvasContextTransform.js");n.d(t,"resetCanvasContextTransform",(function(){return M.default}))},"./drawing/path.js":function(e,t,n){"use strict";n.r(t);var r=n("./stateManagement/toolStyle.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,o=t.color,l=t.lineWidth,c=t.fillStyle,d=t.lineDash,f=t.shouldDrawLines,h=void 0===f||f;e.beginPath(),e.strokeStyle=o||e.strokeStyle,e.lineWidth=l||void 0===l&&r.default.getToolWidth()||e.lineWidth,d&&e.setLineDash(d),n(e),c&&(e.fillStyle=c,e.fill()),h&&e.stroke(),d&&e.setLineDash([])}},"./drawing/resetCanvasContextTransform.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){e.setTransform(1,0,0,1,0,0)}},"./drawing/setShadow.js":function(e,t,n){"use strict";n.r(t);var r=n("./util/getDefault.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.shadow&&(e.shadowColor=Object(r.default)(t.shadowColor,"#000000"),e.shadowBlur=Object(r.default)(t.shadowBlur,0),e.shadowOffsetX=Object(r.default)(t.shadowOffsetX,1),e.shadowOffsetY=Object(r.default)(t.shadowOffsetY,1))}},"./drawing/transformCanvasContext.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,canvas,t){if(t.hflip||t.vflip||t.rotation){var n={x:canvas.width/2+t.translation.x*t.scale,y:canvas.height/2+t.translation.y*t.scale};e.translate(n.x,n.y),t.rotation&&e.rotate(t.rotation*Math.PI/180),t.vflip&&e.scale(1,-1),t.hflip&&e.scale(-1,1),e.translate(-n.x,-n.y)}}},"./eventDispatchers/imageRenderedEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var r=n("./store/index.js"),o=n("./stateManagement/toolState.js"),l=n("./eventListeners/onImageRenderedBrushEventHandler.js"),c=n("./externalModules.js"),d=Object(r.getModule)("segmentation"),f=function(e){var t=e.detail,element=t.element,n=r.state.tools.filter((function(e){return e.element===element&&("active"===e.mode||"passive"===e.mode||"enabled"===e.mode)})),c=Object(o.getToolState)(element,"stack"),f=d.configuration;c&&(f.renderFill||f.renderOutline)&&Object(l.default)(e);var h=t.canvasContext.canvas.getContext("2d");n.forEach((function(t){t.renderToolData&&(h.save(),t.renderToolData(e),h.restore())}))};t.default={enable:function(element){element.addEventListener(c.default.cornerstone.EVENTS.IMAGE_RENDERED,f)},disable:function(element){element.removeEventListener(c.default.cornerstone.EVENTS.IMAGE_RENDERED,f)}}},"./eventDispatchers/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./eventDispatchers/imageRenderedEventDispatcher.js");n.d(t,"imageRenderedEventDispatcher",(function(){return r.default}));var o=n("./eventDispatchers/mouseToolEventDispatcher.js");n.d(t,"mouseToolEventDispatcher",(function(){return o.default}));var l=n("./eventDispatchers/newImageEventDispatcher.js");n.d(t,"newImageEventDispatcher",(function(){return l.default}));var c=n("./eventDispatchers/touchToolEventDispatcher.js");n.d(t,"touchToolEventDispatcher",(function(){return c.default}))},"./eventDispatchers/mouseEventHandlers/addNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var r=n("./events.js"),o=n("./externalModules.js"),l=n("./stateManagement/toolState.js"),c=n("./manipulators/index.js"),d=n("./util/logger.js"),f=n("./util/triggerEvent.js"),h=Object(d.getLogger)("eventDispatchers:mouseEventHandlers");t.default=function(e,t){h.log("addNewMeasurement"),e.preventDefault(),e.stopPropagation();var n=e.detail,element=n.element,d=t.createNewMeasurement(n);if(d){Object(l.addToolState)(element,t.name,d),o.default.cornerstone.updateImage(element);var m=1===Object.keys(d.handles).length?c.moveHandle:c.moveNewHandle,v=(new Date).getTime();m(n,t.name,d,d.handles.end,t.options,"mouse",(function(e){if(!d.cancelled){var n=!(!t.configuration||!Object(t.configuration).hasOwnProperty("measurementCreationThreshold"))&&(new Date).getTime()-v<t.configuration.measurementCreationThreshold;if(e&&!1===n){var o=r.default.MEASUREMENT_COMPLETED,c={toolName:t.name,toolType:t.name,element:element,measurementData:d};Object(f.default)(element,o,c)}else Object(l.removeToolState)(element,t.name,d)}}))}}},"./eventDispatchers/mouseEventHandlers/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"mouseClick",(function(){return f})),n.d(t,"mouseDoubleClick",(function(){return h})),n.d(t,"mouseUp",(function(){return m})),n.d(t,"mouseWheel",(function(){return v}));var r=n("./eventDispatchers/shared/customCallbackHandler.js"),o=n("./eventDispatchers/mouseEventHandlers/mouseDown.js");n.d(t,"mouseDown",(function(){return o.default}));var l=n("./eventDispatchers/mouseEventHandlers/mouseDownActivate.js");n.d(t,"mouseDownActivate",(function(){return l.default}));var c=n("./eventDispatchers/mouseEventHandlers/mouseDrag.js");n.d(t,"mouseDrag",(function(){return c.default}));var d=n("./eventDispatchers/mouseEventHandlers/mouseMove.js");n.d(t,"mouseMove",(function(){return d.default}));var f=r.default.bind(null,"Mouse","mouseClickCallback"),h=r.default.bind(null,"Mouse","doubleClickCallback"),m=r.default.bind(null,"Mouse","mouseUpCallback"),v=r.default.bind(null,"MouseWheel","mouseWheelCallback")},"./eventDispatchers/mouseEventHandlers/mouseDown.js":function(e,t,n){"use strict";n.r(t);var r=n("./store/index.js"),o=n("./stateManagement/toolState.js"),l=n("./store/getToolsWithMoveableHandles.js"),c=n("./util/findAndMoveHelpers.js"),d=n("./store/getInteractiveToolsForElement.js"),f=n("./store/getToolsWithDataForElement.js"),h=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!r.state.isToolLocked){var t=e.detail,element=e.detail.element,n=e.detail.currentPoints.canvas,m=Object(d.default)(element,r.getters.mouseTools()),v=m.filter((function(e){return"active"===e.mode&&Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.includes(t.buttons)&&e.options.isMouseActive}));if(r.state.isMultiPartToolActive&&(v=Object(h.default)(v)),v.length>0){var y=v.find((function(e){return"function"==typeof e.preMouseDownCallback}));if(y&&y.preMouseDownCallback(e))return}if(!r.state.isMultiPartToolActive){var x=Object(f.default)(element,m),j=Object(l.default)(element,x,n,"mouse");if(j.length>0){var w=j[0],T=Object(o.getToolState)(element,w.name),E=Object(c.findHandleDataNearImagePoint)(element,T,w.name,n),O=E.handle,data=E.data;w.handleSelectedCallback(e,data,O,"mouse")}else{var C=m.filter((function(e){var t=Object(o.getToolState)(element,e.name),r=t&&t.data&&e.pointNearTool&&t.data.some((function(data){return e.pointNearTool(element,data,n,"mouse")}));return r}));if(C.length>0){var S=C[0],I=Object(o.getToolState)(element,S.name).data.find((function(data){return S.pointNearTool(element,data,n)}));S.toolSelectedCallback(e,I,"mouse")}else if(v.length>0){var M=v.find((function(e){return"function"==typeof e.postMouseDownCallback}));if(M&&M.postMouseDownCallback(e))return}}}}}},"./eventDispatchers/mouseEventHandlers/mouseDownActivate.js":function(e,t,n){"use strict";n.r(t);var r=n("./eventDispatchers/mouseEventHandlers/addNewMeasurement.js"),o=n("./store/index.js"),l=n("./tools/base/BaseAnnotationTool.js"),c=n("./util/getActiveTool.js");t.default=function(e){if(!o.state.isToolLocked){var t=e.detail,element=t.element,n=t.buttons,d=Object(c.default)(element,n,"mouse");if(d){if("function"==typeof d.preMouseDownActivateCallback&&d.preMouseDownActivateCallback(e))return;o.state.isMultiPartToolActive||(d.addNewMeasurement?d.addNewMeasurement(e,"mouse"):d instanceof l.default&&Object(r.default)(e,d))}}}},"./eventDispatchers/mouseEventHandlers/mouseDrag.js":function(e,t,n){"use strict";n.r(t);var r=n("./store/index.js"),o=n("./store/getActiveToolsForElement.js"),l=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!r.state.isToolLocked){var t,n=e.detail,element=n.element;t=(t=(t=Object(o.default)(element,r.getters.mouseTools())).filter((function(e){return Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.includes(n.buttons)&&e.options.isMouseActive}))).filter((function(e){return"function"==typeof e.mouseDragCallback})),r.state.isMultiPartToolActive&&(t=Object(l.default)(t)),0!==t.length&&t[0].mouseDragCallback(e)}}},"./eventDispatchers/mouseEventHandlers/mouseMove.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./store/index.js"),l=n("./store/getInteractiveToolsForElement.js"),c=n("./store/getToolsWithDataForElement.js");t.default=function(e){if(!o.state.isToolLocked&&!o.state.isMultiPartToolActive){var t,n=e.detail,element=n.element,d=n.currentPoints;o.state.mousePositionImage=d.image;var f=(t=Object(l.default)(element,o.getters.mouseTools())).filter((function(e){return"active"===e.mode&&e.options.isMouseActive})),h=!1;f.length>0&&(h=f.some((function(e){return e.updateOnMouseMove}))),t=Object(c.default)(element,t);for(var m=0;m<t.length;m++){var v=t[m];"function"==typeof v.mouseMoveCallback&&(h=v.mouseMoveCallback(e)||h)}!0===h&&r.default.cornerstone.updateImage(element)}}},"./eventDispatchers/mouseToolEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var r=n("./events.js"),o=n("./eventDispatchers/mouseEventHandlers/index.js");t.default={enable:function(element){element.addEventListener(r.default.MOUSE_CLICK,o.mouseClick),element.addEventListener(r.default.MOUSE_DOWN,o.mouseDown),element.addEventListener(r.default.MOUSE_DOWN_ACTIVATE,o.mouseDownActivate),element.addEventListener(r.default.MOUSE_DOUBLE_CLICK,o.mouseDoubleClick),element.addEventListener(r.default.MOUSE_DRAG,o.mouseDrag),element.addEventListener(r.default.MOUSE_MOVE,o.mouseMove),element.addEventListener(r.default.MOUSE_UP,o.mouseUp),element.addEventListener(r.default.MOUSE_WHEEL,o.mouseWheel)},disable:function(element){element.removeEventListener(r.default.MOUSE_CLICK,o.mouseClick),element.removeEventListener(r.default.MOUSE_DOWN,o.mouseDown),element.removeEventListener(r.default.MOUSE_DOWN_ACTIVATE,o.mouseDownActivate),element.removeEventListener(r.default.MOUSE_DOUBLE_CLICK,o.mouseDoubleClick),element.removeEventListener(r.default.MOUSE_DRAG,o.mouseDrag),element.removeEventListener(r.default.MOUSE_MOVE,o.mouseMove),element.removeEventListener(r.default.MOUSE_UP,o.mouseUp),element.removeEventListener(r.default.MOUSE_WHEEL,o.mouseWheel)}}},"./eventDispatchers/newImageEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var r=n("./store/index.js"),o=n("./externalModules.js"),l=function(e){if(r.state.isToolLocked)return!1;var element=e.detail.element,t=r.state.tools.filter((function(e){return e.element===element&&("active"===e.mode||"passive"===e.mode||"enabled"===e.mode)}));if(0===t.length)return!1;t.forEach((function(t){t.newImageCallback&&t.newImageCallback(e)}))};t.default={enable:function(element){element.addEventListener(o.default.cornerstone.EVENTS.NEW_IMAGE,l)},disable:function(element){element.removeEventListener(o.default.cornerstone.EVENTS.NEW_IMAGE,l)}}},"./eventDispatchers/shared/customCallbackHandler.js":function(e,t,n){"use strict";n.r(t);var r=n("./store/index.js"),o=n("./store/getActiveToolsForElement.js"),l=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e,t,n){if(r.state.isToolLocked)return!1;var element=n.detail.element,c=r.state.tools.filter((function(t){return t.supportedInteractionTypes.includes(e)}));if(c=(c=Object(o.default)(element,c,e)).filter((function(e){return"function"==typeof e[t]})),r.state.isMultiPartToolActive&&(c=Object(l.default)(c)),0===c.length)return!1;c[0][t](n)}},"./eventDispatchers/touchEventHandlers/addNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var r=n("./events.js"),o=n("./externalModules.js"),l=n("./store/index.js"),c=n("./manipulators/anyHandlesOutsideImage.js"),d=n("./manipulators/index.js"),f=n("./stateManagement/toolState.js"),h=n("./util/triggerEvent.js"),m=n("./util/logger.js"),v=Object(m.getLogger)("eventDispatchers:touchEventHandlers");t.default=function(e,t){v.log("addNewMeasurement"),e.preventDefault(),e.stopPropagation();var n=e.detail,element=n.element,m=t.createNewMeasurement(n);if(m){if(Object(f.addToolState)(element,t.name,m),1===Object.keys(m.handles).length&&n.type===r.default.TAP)return m.active=!1,m.handles.end.active=!1,m.handles.end.highlight=!1,m.invalidated=!0,(l.state.deleteIfHandleOutsideImage||t.options.deleteIfHandleOutsideImage)&&Object(c.default)(n,m.handles)&&Object(f.removeToolState)(element,t.name,m),void o.default.cornerstone.updateImage(element);o.default.cornerstone.updateImage(element),Object(d.moveNewHandle)(n,t.name,m,m.handles.end,t.options,"touch",(function(){var e=r.default.MEASUREMENT_COMPLETED,n={toolName:t.name,toolType:t.name,element:element,measurementData:m};Object(h.default)(element,e,n)}))}}},"./eventDispatchers/touchEventHandlers/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"doubleTap",(function(){return f})),n.d(t,"touchDrag",(function(){return h})),n.d(t,"touchEnd",(function(){return m})),n.d(t,"touchPinch",(function(){return v})),n.d(t,"touchPress",(function(){return y})),n.d(t,"touchRotate",(function(){return x}));var r=n("./eventDispatchers/shared/customCallbackHandler.js"),o=n("./eventDispatchers/touchEventHandlers/multiTouchDrag.js");n.d(t,"multiTouchDrag",(function(){return o.default}));var l=n("./eventDispatchers/touchEventHandlers/tap.js");n.d(t,"tap",(function(){return l.default}));var c=n("./eventDispatchers/touchEventHandlers/touchStart.js");n.d(t,"touchStart",(function(){return c.default}));var d=n("./eventDispatchers/touchEventHandlers/touchStartActive.js");n.d(t,"touchStartActive",(function(){return d.default}));var f=r.default.bind(null,"DoubleTap","doubleTapCallback"),h=r.default.bind(null,"Touch","touchDragCallback"),m=r.default.bind(null,"Touch","touchEndCallback"),v=r.default.bind(null,"TouchPinch","touchPinchCallback"),y=r.default.bind(null,"Touch","touchPressCallback"),x=r.default.bind(null,"TouchRotate","touchRotateCallback")},"./eventDispatchers/touchEventHandlers/multiTouchDrag.js":function(e,t,n){"use strict";n.r(t);var r=n("./store/index.js"),o=n("./store/getActiveToolsForElement.js"),l=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(r.state.isToolLocked)return!1;var t=e.detail,element=t.element,n=t.numPointers,c=r.state.tools.filter((function(e){return e.supportedInteractionTypes.includes("MultiTouch")}));if(c=(c=Object(o.default)(element,c,"MultiTouch")).filter((function(e){return"function"==typeof e.multiTouchDragCallback&&n===e.configuration.touchPointers})),r.state.isMultiPartToolActive&&(c=Object(l.default)(c)),0===c.length)return!1;c[0].multiTouchDragCallback(e)}},"./eventDispatchers/touchEventHandlers/shared/deactivateAllToolInstances.js":function(e,t,n){"use strict";function r(e){Object.keys(e).forEach((function(t){e[t].active=!1}))}n.r(t),t.default=function(e){if(e)for(var i=0;i<e.data.length;i++){var data=e.data[i];data.active=!1,data.handles&&r(data.handles)}}},"./eventDispatchers/touchEventHandlers/tap.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./eventDispatchers/touchEventHandlers/touchStartActive.js"),l=n("./store/index.js"),c=n("./store/getActiveToolsForElement.js"),d=n("./store/getToolsWithDataForElement.js"),f=n("./stateManagement/toolState.js"),h=n("./manipulators/getHandleNearImagePoint.js"),m=n("./manipulators/index.js"),v=n("./eventDispatchers/touchEventHandlers/shared/deactivateAllToolInstances.js");t.default=function(e){if(!l.state.isToolLocked&&!l.state.isMultiPartToolActive){var t,element=e.detail.element,n=e.detail.currentPoints.canvas;t=Object(c.default)(element,l.getters.touchTools());var y=(t=Object(d.default)(element,t)).filter((function(e){for(var t=Object(f.getToolState)(element,e.name),i=0;i<t.data.length;i++)if(void 0!==Object(h.default)(element,t.data[i].handles,n,28))return!0;return!1}));if(y.length>0){var x=y[0],j=Object(f.getToolState)(element,x.name),w=j.data.find((function(e){return void 0!==Object(h.default)(element,e.handles,n,28)}));return j.data.active=!0,w.active=!0,r.default.cornerstone.updateImage(element),Object(m.moveHandle)(e.detail,x.name,j.data,w,x.options,"touch",(function(){return Object(v.default)(j)})),e.stopImmediatePropagation(),void e.preventDefault()}var T=t.filter((function(e){var t=Object(f.getToolState)(element,e.name);return t&&t.data&&e.pointNearTool&&t.data.some((function(data){return e.pointNearTool(element,data,n)}))}));if(T.length>0){var E=T[0],O=Object(f.getToolState)(element,E.name),C=O.data.find((function(data){return E.pointNearTool(element,data,n)}));return C.active=!0,r.default.cornerstone.updateImage(element),Object(m.moveAllHandles)(e.detail,E.name,C,null,E.options,"touch",(function(){return Object(v.default)(O)})),e.stopImmediatePropagation(),void e.preventDefault()}var S=Object(c.default)(element,l.getters.touchTools());return S.length>0&&S[0].touchStartActiveCallback?S[0].touchStartActiveCallback(e):Object(o.default)(e),!1}}},"./eventDispatchers/touchEventHandlers/touchStart.js":function(e,t,n){"use strict";n.r(t);var r=n("./store/index.js"),o=n("./util/findAndMoveHelpers.js"),l=n("./store/getToolsWithMoveableHandles.js"),c=n("./stateManagement/toolState.js"),d=n("./store/getInteractiveToolsForElement.js"),f=n("./store/getToolsWithDataForElement.js"),h=n("./store/filterToolsUsableWithMultiPartTools.js");t.default=function(e){if(!r.state.isToolLocked){var t=e.detail,element=t.element,n=t.startPoints.canvas,m=Object(d.default)(element,r.getters.touchTools()),v=m.filter((function(e){return"active"===e.mode&&e.options.isTouchActive}));if(r.state.isMultiPartToolActive&&(v=Object(h.default)(v)),v.length>0){var y=v.find((function(e){return"function"==typeof e.preTouchStartCallback}));if(y&&y.preTouchStartCallback(e))return}if(!r.state.isMultiPartToolActive){var x=Object(f.default)(element,m),j=Object(l.default)(element,x,n,"touch");if(j.length>0){var w=j[0],T=Object(c.getToolState)(element,w.name),E=Object(o.findHandleDataNearImagePoint)(element,T,w.name,n,"touch"),O=E.handle,data=E.data;w.handleSelectedCallback(e,data,O,"touch")}else{var C=x.filter((function(e){var t=Object(c.getToolState)(element,e.name),r=t&&t.data&&e.pointNearTool&&t.data.some((function(data){return e.pointNearTool(element,data,n,"touch")}));return r}));if(C.length>0){var S=C[0],I=Object(c.getToolState)(element,S.name).data.find((function(data){return S.pointNearTool(element,data,n)}));S.toolSelectedCallback(e,I,"touch")}else if(v.length>0){var M=v.find((function(e){return"function"==typeof e.postTouchStartCallback}));if(M&&M.postTouchStartCallback(e))return}}}}}},"./eventDispatchers/touchEventHandlers/touchStartActive.js":function(e,t,n){"use strict";n.r(t);var r=n("./store/index.js"),o=n("./eventDispatchers/touchEventHandlers/addNewMeasurement.js"),l=n("./tools/base/BaseAnnotationTool.js"),c=n("./util/getActiveTool.js");t.default=function(e){if(!r.state.isToolLocked&&!r.state.isMultiPartToolActive){var element=e.detail.element,t=Object(c.default)(element,null,"touch");t&&t.addNewMeasurement?t.addNewMeasurement(e,"touch"):t instanceof l.default&&Object(o.default)(e,t)}}},"./eventDispatchers/touchToolEventDispatcher.js":function(e,t,n){"use strict";n.r(t);var r=n("./events.js"),o=n("./eventDispatchers/touchEventHandlers/index.js");t.default={enable:function(element){element.addEventListener(r.default.TAP,o.tap),element.addEventListener(r.default.TOUCH_START,o.touchStart,{passive:!1}),element.addEventListener(r.default.TOUCH_DRAG,o.touchDrag,{passive:!1}),element.addEventListener(r.default.TOUCH_END,o.touchEnd),element.addEventListener(r.default.TOUCH_START_ACTIVE,o.touchStartActive),element.addEventListener(r.default.TOUCH_PRESS,o.touchPress),element.addEventListener(r.default.DOUBLE_TAP,o.doubleTap),element.addEventListener(r.default.TOUCH_PINCH,o.touchPinch),element.addEventListener(r.default.TOUCH_ROTATE,o.touchRotate),element.addEventListener(r.default.MULTI_TOUCH_DRAG,o.multiTouchDrag)},disable:function(element){element.removeEventListener(r.default.TAP,o.tap),element.removeEventListener(r.default.TOUCH_START,o.touchStart),element.removeEventListener(r.default.TOUCH_DRAG,o.touchDrag),element.removeEventListener(r.default.TOUCH_END,o.touchEnd),element.removeEventListener(r.default.TOUCH_START_ACTIVE,o.touchStartActive),element.removeEventListener(r.default.TOUCH_PRESS,o.touchPress),element.removeEventListener(r.default.DOUBLE_TAP,o.doubleTap),element.removeEventListener(r.default.TOUCH_PINCH,o.touchPinch),element.removeEventListener(r.default.TOUCH_ROTATE,o.touchRotate),element.removeEventListener(r.default.MULTI_TOUCH_DRAG,o.multiTouchDrag)}}},"./eventListeners/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./eventListeners/mouseEventListeners.js");n.d(t,"mouseEventListeners",(function(){return r.default}));var o=n("./eventListeners/wheelEventListener.js");n.d(t,"wheelEventListener",(function(){return o.default}));var l=n("./eventListeners/touchEventListeners.js");n.d(t,"touchEventListeners",(function(){return l.default}))},"./eventListeners/internals/normalizeWheel.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=0,n=0,r=0,o=0;return"detail"in e&&(n=e.detail),"wheelDelta"in e&&(n=-e.wheelDelta/120),"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),r=10*t,o=10*n,"deltaY"in e&&(o=e.deltaY),"deltaX"in e&&(r=e.deltaX),(r||o)&&e.deltaMode&&(1===e.deltaMode?(r*=40,o*=40):(r*=800,o*=800)),r&&!t&&(t=r<1?-1:1),o&&!n&&(n=o<1?-1:1),{spinX:t,spinY:n,pixelX:r,pixelY:o}}},"./eventListeners/internals/renderSegmentation.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return d}));var r=n("./store/index.js"),o=n("./eventListeners/internals/renderSegmentationFill.js"),l=n("./eventListeners/internals/renderSegmentationOutline.js"),c=Object(r.getModule)("segmentation");function d(e,t,n,r,d){(function(e){var t=c.configuration;return t.renderFill&&(e&&0!==t.fillAlpha||!e&&0!==t.fillAlphaInactive)})(d)&&Object(o.default)(e,t,r,n,d),function(e){var t=c.configuration;return t.renderOutline&&(e&&0!==t.outlineAlpha||!e&&0!==t.outlineAlphaInactive)}(d)&&Object(l.default)(e,t,r,n,d)}},"./eventListeners/internals/renderSegmentationFill.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return d})),n.d(t,"getLabelmapCanvas",(function(){return f})),n.d(t,"renderFill",(function(){return h}));var r=n("./store/index.js"),o=n("./drawing/index.js"),l=n("./externalModules.js"),c=Object(r.getModule)("segmentation");function d(e,t,n,r,o){h(e,f(e,t,n),o)}function f(e,t,n){var r=c.state,image=e.detail.image,l=image.width,d=image.height,f=t.segmentsHidden,h=n.pixelData,m=r.colorLutTables[t.colorLUTIndex],v=document.createElement("canvas");v.width=l,v.height=d;for(var y=Object(o.getNewContext)(v),x=new ImageData(l,d),data=x.data,i=0;i<h.length;i++){var j=h[i];if(0!==j&&!f[j]){var w=m[h[i]];data[4*i]=w[0],data[4*i+1]=w[1],data[4*i+2]=w[2],data[4*i+3]=w[3]}}return y.putImageData(x,0,0),v}function h(e,t,n){var r=c.configuration,d=e.detail,f=Object(o.getNewContext)(d.canvasContext.canvas),h=l.default.cornerstone.pixelToCanvas(d.element,{x:0,y:0}),m=l.default.cornerstone.pixelToCanvas(d.element,{x:d.image.width,y:0}),v=l.default.cornerstone.pixelToCanvas(d.element,{x:d.image.width,y:d.image.height}),y=l.default.cornerstoneMath.point.distance(h,m),x=l.default.cornerstoneMath.point.distance(m,v),canvas=d.canvasContext.canvas,j=d.viewport,w=f.imageSmoothingEnabled,T=f.globalAlpha;f.imageSmoothingEnabled=!1,f.globalAlpha=n?r.fillAlpha:r.fillAlphaInactive,Object(o.transformCanvasContext)(f,canvas,j);var E=function(e){var t=e.viewport,image=e.image,n=t.scale,r=t.scale;return image.rowPixelSpacing<image.columnPixelSpacing?n*=image.columnPixelSpacing/image.rowPixelSpacing:image.columnPixelSpacing<image.rowPixelSpacing&&(r*=image.rowPixelSpacing/image.columnPixelSpacing),{x:t.translation.x*n,y:t.translation.y*r}}(d);f.drawImage(t,canvas.width/2-y/2+E.x,canvas.height/2-x/2+E.y,y,x),f.globalAlpha=T,f.imageSmoothingEnabled=w,Object(o.resetCanvasContextTransform)(f)}},"./eventListeners/internals/renderSegmentationOutline.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return d})),n.d(t,"renderOutline",(function(){return f})),n.d(t,"getOutline",(function(){return h})),n.d(t,"_addTopRightCorner",(function(){return y}));var r=n("./store/index.js"),o=n("./externalModules.js"),l=n("./drawing/index.js"),c=(n("./index.js"),Object(r.getModule)("segmentation"));function d(e,t,n,r,o){f(e,h(e,t,n,c.configuration.outlineWidth),t.colorLUTIndex,o)}function f(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=c.configuration,d=c.state,f=e.detail,element=f.element,h=f.canvasContext,m=o.outlineWidth||1,v=Object(l.getNewContext)(h.canvas),y=d.colorLutTables[n],x=v.globalAlpha;v.globalAlpha=r?o.outlineAlpha:o.outlineAlphaInactive,Object(l.draw)(v,(function(e){for(var i=1;i<t.length;i++)if(t[i]){var n=y[i];Object(l.drawLines)(e,element,t[i],{color:"rgba(".concat(n[0],", ").concat(n[1],", ").concat(n[2],", 1.0 )"),lineWidth:m},"canvas")}})),v.globalAlpha=x}function h(e,t,n,r){var o=e.detail,element=o.element,image=o.image,l=o.viewport,c=image.width,d=image.height;r=r||1;var f=t.segmentsHidden,h=n.pixelData,C=t.activeSegmentIndex,S=[];n.segmentsOnLabelmap.forEach((function(e){!f[e]&&(S[e]=[])})),S[C]||(S[C]=[]);for(var I,M=function(e,t){var n=t/2,r=e.rotation;r*=Math.PI/180;var o=Math.cos(r),l=Math.sin(r),c=[o,l],d=[-l,o],i={x:n*c[0],y:n*c[1]},f={x:n*d[0],y:n*d[1]};return e.hflip&&(i.x*=-1,i.y*=-1),e.vflip&&(f.x*=-1,f.y*=-1),{i:i,j:f}}(l,r),i=0;i<h.length;i++){var P=h[i];if(0!==P&&!f[P]){var _={x:(I=i)%c,y:Math.floor(I/c)},D=m(_,d,c);void 0!==D.top&&h[D.top]===P||w(S[P],element,_,M),void 0!==D.bottom&&h[D.bottom]===P||T(S[P],element,_,M),void 0!==D.left&&h[D.left]===P||E(S[P],element,_,M),void 0!==D.right&&h[D.right]===P||O(S[P],element,_,M),void 0!==D.topLeft&&h[D.topLeft]!==P&&h[D.top]===P&&h[D.left]===P&&v(S[P],element,_,M),void 0!==D.topRight&&h[D.topRight]!==P&&h[D.top]===P&&h[D.right]===P&&y(S[P],element,_,M),void 0!==D.bottomLeft&&h[D.bottomLeft]!==P&&h[D.bottom]===P&&h[D.left]===P&&x(S[P],element,_,M),void 0!==D.bottomRight&&h[D.bottomRight]!==P&&h[D.bottom]===P&&h[D.right]===P&&j(S[P],element,_,M)}}return S}function m(e,t,n){var r=e.y*n+e.x,o={},l=e.y-1>=0,c=e.y+1<t,d=e.x-1>=0,f=e.x+1<n;return l&&(o.top=r-n,f&&(o.topRight=o.top+1),d&&(o.topLeft=o.top-1)),c&&(o.bottom=r+n,f&&(o.bottomRight=o.bottom+1),d&&(o.bottomLeft=o.bottom-1)),d&&(o.left=r-1),f&&(o.right=r+1),o}function v(e,element,t,n){var r=(0,o.default.cornerstone.pixelToCanvas)(element,t);r.x+=n.j.x,r.y+=n.j.y;var l={x:r.x,y:r.y};l.x+=2*n.i.x,l.y+=2*n.i.y,e.push({start:r,end:l})}function y(e,element,t,n){var r=(0,o.default.cornerstone.pixelToCanvas)(element,{x:t.x+1,y:t.y});r.x+=n.j.x,r.y+=n.j.y;var l={x:r.x,y:r.y};l.x-=2*n.i.x,l.y-=2*n.i.y,e.push({start:r,end:l})}function x(e,element,t,n){var r=(0,o.default.cornerstone.pixelToCanvas)(element,{x:t.x,y:t.y+1});r.x-=n.j.x,r.y-=n.j.y;var l={x:r.x,y:r.y};l.x+=2*n.i.x,l.y+=2*n.i.y,e.push({start:r,end:l})}function j(e,element,t,n){var r=(0,o.default.cornerstone.pixelToCanvas)(element,{x:t.x+1,y:t.y+1});r.x-=n.j.x,r.y-=n.j.y;var l={x:r.x,y:r.y};l.x-=2*n.i.x,l.y-=2*n.i.y,e.push({start:r,end:l})}function w(e,element,t,n){var r=o.default.cornerstone.pixelToCanvas,l=r(element,t),c=r(element,{x:t.x+1,y:t.y});l.x+=n.j.x,l.y+=n.j.y,c.x+=n.j.x,c.y+=n.j.y,e.push({start:l,end:c})}function T(e,element,t,n){var r=o.default.cornerstone.pixelToCanvas,l=r(element,{x:t.x,y:t.y+1}),c=r(element,{x:t.x+1,y:t.y+1});l.x-=n.j.x,l.y-=n.j.y,c.x-=n.j.x,c.y-=n.j.y,e.push({start:l,end:c})}function E(e,element,t,n){var r=o.default.cornerstone.pixelToCanvas,l=r(element,t),c=r(element,{x:t.x,y:t.y+1});l.x+=n.i.x,l.y+=n.i.y,c.x+=n.i.x,c.y+=n.i.y,e.push({start:l,end:c})}function O(e,element,t,n){var r=o.default.cornerstone.pixelToCanvas,l=r(element,{x:t.x+1,y:t.y}),c=r(element,{x:t.x+1,y:t.y+1});l.x-=n.i.x,l.y-=n.i.y,c.x-=n.i.x,c.y-=n.i.y,e.push({start:l,end:c})}},"./eventListeners/mouseEventListeners.js":function(e,t,n){"use strict";n.r(t);var r,o=n("./events.js"),l=n("./externalModules.js"),c=n("./util/copyPoints.js"),d=n("./util/triggerEvent.js"),f=n("./util/logger.js"),h=Object(f.getLogger)("eventListeners:mouseEventListeners"),m=!0,v=new Map;function y(e){if("number"==typeof e.buttons)return e.buttons;switch(e.which){case 0:return 0;case 1:return 1;case 2:return 4;case 3:return 2}return 0}function x(){m=!1}function j(e){var element=e.currentTarget,t=l.default.cornerstone.getEnabledElement(element);if(t.image){var n=o.default.MOUSE_DOUBLE_CLICK,r={page:l.default.cornerstoneMath.point.pageToPoint(e),image:l.default.cornerstone.pageToPixel(element,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};r.canvas=l.default.cornerstone.pixelToCanvas(element,r.image);var f=Object(c.default)(r);h.log("double-click: %o",y(e));var m={event:e,buttons:y(e),viewport:l.default.cornerstone.getViewport(element),image:t.image,element:element,startPoints:r,lastPoints:f,currentPoints:r,deltaPoints:{x:0,y:0},type:n};Object(d.default)(element,n,m)}}function w(e){var element=e.currentTarget,t=l.default.cornerstone.getEnabledElement(element);if(t.image){r=setTimeout(x,200),element.removeEventListener("mousemove",T);var n={page:l.default.cornerstoneMath.point.pageToPoint(e),image:l.default.cornerstone.pageToPixel(element,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};n.canvas=l.default.cornerstone.pixelToCanvas(element,n.image);var f=Object(c.default)(n),j={event:e,buttons:y(e),viewport:l.default.cornerstone.getViewport(element),image:t.image,element:element,startPoints:n,lastPoints:f,currentPoints:n,deltaPoints:{x:0,y:0},type:o.default.MOUSE_DOWN};Object(d.default)(j.element,o.default.MOUSE_DOWN,j)&&(j.type=o.default.MOUSE_DOWN_ACTIVATE,Object(d.default)(j.element,o.default.MOUSE_DOWN_ACTIVATE,j)),document.addEventListener("mousemove",w),document.addEventListener("mouseup",E),v.set(w,"mousemove"),v.set(E,"mouseup")}function w(e){var r=o.default.MOUSE_DRAG,m={page:l.default.cornerstoneMath.point.pageToPoint(e),image:l.default.cornerstone.pageToPixel(element,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};m.canvas=l.default.cornerstone.pixelToCanvas(element,m.image);var v={page:l.default.cornerstoneMath.point.subtract(m.page,f.page),image:l.default.cornerstoneMath.point.subtract(m.image,f.image),client:l.default.cornerstoneMath.point.subtract(m.client,f.client),canvas:l.default.cornerstoneMath.point.subtract(m.canvas,f.canvas)};h.log("mousemove: %o",y(e));var x={buttons:y(e),viewport:l.default.cornerstone.getViewport(element),image:t.image,element:element,startPoints:n,lastPoints:f,currentPoints:m,deltaPoints:v,type:r,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};Object(d.default)(x.element,r,x),f=Object(c.default)(m)}function E(e){clearTimeout(r);var c=o.default.MOUSE_UP;m&&(c=o.default.MOUSE_CLICK);var x={page:l.default.cornerstoneMath.point.pageToPoint(e),image:l.default.cornerstone.pageToPixel(element,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};x.canvas=l.default.cornerstone.pixelToCanvas(element,x.image);var j={page:l.default.cornerstoneMath.point.subtract(x.page,f.page),image:l.default.cornerstoneMath.point.subtract(x.image,f.image),client:l.default.cornerstoneMath.point.subtract(x.client,f.client),canvas:l.default.cornerstoneMath.point.subtract(x.canvas,f.canvas)};h.log("mouseup: %o",y(e));var O={event:e,buttons:y(e),viewport:l.default.cornerstone.getViewport(element),image:t.image,element:element,startPoints:n,lastPoints:f,currentPoints:x,deltaPoints:j,type:c};Object(d.default)(O.element,c,O),document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",E),v.delete(w),v.delete(E),element.addEventListener("mousemove",T),m=!0}}function T(e){var element=e.currentTarget,t=l.default.cornerstone.getEnabledElement(element);if(t.image){var n=o.default.MOUSE_MOVE,r={page:l.default.cornerstoneMath.point.pageToPoint(e),image:l.default.cornerstone.pageToPixel(element,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};r.canvas=l.default.cornerstone.pixelToCanvas(element,r.image);var f=Object(c.default)(r),h={page:l.default.cornerstoneMath.point.pageToPoint(e),image:l.default.cornerstone.pageToPixel(element,e.pageX,e.pageY),client:{x:e.clientX,y:e.clientY}};h.canvas=l.default.cornerstone.pixelToCanvas(element,h.image);var m={page:l.default.cornerstoneMath.point.subtract(h.page,f.page),image:l.default.cornerstoneMath.point.subtract(h.image,f.image),client:l.default.cornerstoneMath.point.subtract(h.client,f.client),canvas:l.default.cornerstoneMath.point.subtract(h.canvas,f.canvas)},v={viewport:l.default.cornerstone.getViewport(element),image:t.image,element:element,startPoints:r,lastPoints:f,currentPoints:h,deltaPoints:m,type:n};Object(d.default)(element,n,v),f=Object(c.default)(h)}}function E(element){element.removeEventListener("mousedown",w),element.removeEventListener("mousemove",T),element.removeEventListener("dblclick",j),v.forEach((function(e,t){document.removeEventListener(e,t)})),v.clear()}t.default={enable:function(element){E(element),element.addEventListener("mousedown",w),element.addEventListener("mousemove",T),element.addEventListener("dblclick",j)},disable:E}},"./eventListeners/onImageRenderedBrushEventHandler.js":function(e,t,n){"use strict";n.r(t);var r=n("./store/index.js"),o=n("./eventListeners/internals/renderSegmentation.js"),l=Object(r.getModule)("segmentation");t.default=function(e){var element=e.detail.element,t=l.configuration,n=l.getters.labelmaps3D(element),r=n.activeLabelmapIndex,c=n.labelmaps3D,d=n.currentImageIdIndex;c&&(t.shouldRenderInactiveLabelmaps&&function(e,t,n,r){for(var i=0;i<t.length;i++){var l=t[i];if(i!==n&&l){var c=l.labelmaps2D[r];c&&Object(o.default)(e,l,i,c,!1)}}}(e,c,r,d),function(e,t,n,r){var l=t[n];if(l){var c=l.labelmaps2D[r];c&&Object(o.default)(e,l,n,c,!0)}}(e,c,r,d))}},"./eventListeners/preventGhostClick.js":function(e,t,n){"use strict";n.r(t);var r,o,l=0,c=1;function d(e,t){var n=Date.now();if(e!==r){if(n-o<=2e3)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1;r=e}o=n}var f=d.bind(null,l),h=d.bind(null,c);function m(element,e,t){var n=t?f:h;e.forEach((function(e){element.addEventListener(e,n,{passive:!1})}))}function v(element,e,t){var n=t?f:h;e.forEach((function(e){element.removeEventListener(e,n)}))}var y=["mousedown","mouseup"],x=["touchstart","touchend"];function j(element){v(element,y,l),v(element,x,c)}t.default={enable:function(element){j(element),m(element,y,l),m(element,x,c)},disable:j}},"./eventListeners/touchEventListeners.js":function(e,t,n){"use strict";n.r(t);var r,o,l,c,d,f,h,m,v,y=n("./events.js"),x=n("./externalModules.js"),j=n("./util/copyPoints.js"),w=n("./eventListeners/preventGhostClick.js"),T=n("./util/triggerEvent.js"),E=n("./toolOptions.js"),O=1,C=0,S=!1,I=!1,M="touchInput";function P(e){var element=e.currentTarget||e.srcEvent.currentTarget,t=x.default.cornerstone.getEnabledElement(element);if(t.image){var n,w,E,M;switch(e.preventDefault(),(e.pointers&&e.pointers.length>1||e.touches&&e.touches.length>1)&&(I=!1,clearTimeout(h)),e.type){case"tap":I=!1,clearTimeout(h),(o={page:x.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:x.default.cornerstone.pageToPixel(element,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=x.default.cornerstone.pixelToCanvas(element,o.image),n=y.default.TAP,d={event:e,viewport:x.default.cornerstone.getViewport(element),image:t.image,element:element,currentPoints:o,type:n,isTouchEvent:!0},Object(T.default)(element,n,d);break;case"doubletap":I=!1,clearTimeout(h),(o={page:x.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:x.default.cornerstone.pageToPixel(element,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=x.default.cornerstone.pixelToCanvas(element,o.image),n=y.default.DOUBLE_TAP,d={event:e,viewport:x.default.cornerstone.getViewport(element),image:t.image,element:element,currentPoints:o,type:n,isTouchEvent:!0},Object(T.default)(element,n,d);break;case"pinchstart":I=!1,clearTimeout(h),O=1;break;case"pinchmove":if(I=!1,clearTimeout(h),!0===S){O=e.scale,S=!1;break}w=(e.scale-O)/O,(r={page:e.center,image:x.default.cornerstone.pageToPixel(element,e.center.x,e.center.y)}).canvas=x.default.cornerstone.pixelToCanvas(element,r.image),n=y.default.TOUCH_PINCH,d={event:e,startPoints:r,viewport:x.default.cornerstone.getViewport(element),image:t.image,element:element,direction:e.scale<1?1:-1,scaleChange:w,type:n,isTouchEvent:!0},Object(T.default)(element,n,d),O=e.scale;break;case"touchstart":O=1,clearTimeout(h),clearTimeout(f),f=setTimeout((function(){(r={page:x.default.cornerstoneMath.point.pageToPoint(e.touches[0]),image:x.default.cornerstone.pageToPixel(element,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}}).canvas=x.default.cornerstone.pixelToCanvas(element,r.image),n=y.default.TOUCH_START,e.touches.length>1&&(n=y.default.MULTI_TOUCH_START),d={event:e,viewport:x.default.cornerstone.getViewport(element),image:t.image,element:element,startPoints:r,currentPoints:r,type:n,isTouchEvent:!0},!0===Object(T.default)(element,n,d)&&(n=y.default.TOUCH_START_ACTIVE,e.touches.length>1&&(n=y.default.MULTI_TOUCH_START_ACTIVE),d.type=n,Object(T.default)(element,n,d)),l=Object(j.default)(r)}),50),I=!0,m=0,h=setTimeout((function(){I&&((o={page:x.default.cornerstoneMath.point.pageToPoint(e.touches[0]),image:x.default.cornerstone.pageToPixel(element,e.touches[0].pageX,e.touches[0].pageY),client:{x:e.touches[0].clientX,y:e.touches[0].clientY}}).canvas=x.default.cornerstone.pixelToCanvas(element,r.image),n=y.default.TOUCH_PRESS,d={event:e,viewport:x.default.cornerstone.getViewport(element),image:t.image,element:element,currentPoints:o,type:n,isTouchEvent:!0},Object(T.default)(element,n,d))}),700);break;case"touchend":O=1,I=!1,clearTimeout(h),setTimeout((function(){(r={page:x.default.cornerstoneMath.point.pageToPoint(e.changedTouches[0]),image:x.default.cornerstone.pageToPixel(element,e.changedTouches[0].pageX,e.changedTouches[0].pageY),client:{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}}).canvas=x.default.cornerstone.pixelToCanvas(element,r.image),n=y.default.TOUCH_END,d={event:e,viewport:x.default.cornerstone.getViewport(element),image:t.image,element:element,startPoints:r,currentPoints:r,type:n,isTouchEvent:!0},Object(T.default)(element,n,d)}),50);break;case"panmove":E={x:e.deltaX-v.x,y:e.deltaY-v.y},v={x:e.deltaX,y:e.deltaY},(o={page:{x:l.page.x+E.x,y:l.page.y+E.y},image:x.default.cornerstone.pageToPixel(element,l.page.x+E.x,l.page.y+E.y),client:{x:l.client.x+E.x,y:l.client.y+E.y}}).canvas=x.default.cornerstone.pixelToCanvas(element,o.image),c={page:x.default.cornerstoneMath.point.subtract(o.page,l.page),image:x.default.cornerstoneMath.point.subtract(o.image,l.image),client:x.default.cornerstoneMath.point.subtract(o.client,l.client),canvas:x.default.cornerstoneMath.point.subtract(o.canvas,l.canvas)},(m+=Math.sqrt(c.page.x*c.page.x+c.page.y*c.page.y))>5&&(I=!1,clearTimeout(h)),n=y.default.TOUCH_DRAG,e.pointers.length>1&&(n=y.default.MULTI_TOUCH_DRAG),d={viewport:x.default.cornerstone.getViewport(element),image:t.image,element:element,startPoints:r,lastPoints:l,currentPoints:o,deltaPoints:c,numPointers:e.pointers.length,type:n,isTouchEvent:!0},Object(T.default)(element,n,d),l=Object(j.default)(o);break;case"panstart":v={x:e.deltaX,y:e.deltaY},(o={page:x.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:x.default.cornerstone.pageToPixel(element,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=x.default.cornerstone.pixelToCanvas(element,o.image),l=Object(j.default)(o);break;case"panend":if(I=!1,clearTimeout(h),!l)return!1;(o={page:x.default.cornerstoneMath.point.pageToPoint(e.pointers[0]),image:x.default.cornerstone.pageToPixel(element,e.pointers[0].pageX,e.pointers[0].pageY),client:{x:e.pointers[0].clientX,y:e.pointers[0].clientY}}).canvas=x.default.cornerstone.pixelToCanvas(element,o.image),c={page:x.default.cornerstoneMath.point.subtract(o.page,l.page),image:x.default.cornerstoneMath.point.subtract(o.image,l.image),client:x.default.cornerstoneMath.point.subtract(o.client,l.client),canvas:x.default.cornerstoneMath.point.subtract(o.canvas,l.canvas)},n=y.default.TOUCH_DRAG_END,d={event:e.srcEvent,viewport:x.default.cornerstone.getViewport(element),image:t.image,element:element,startPoints:r,lastPoints:l,currentPoints:o,deltaPoints:c,type:n,isTouchEvent:!0},Object(T.default)(element,n,d),2==e.pointers.length-e.changedPointers.length&&(S=!0);break;case"rotatemove":I=!1,clearTimeout(h),M=e.rotation-C,C=e.rotation,n=y.default.TOUCH_ROTATE,d={event:e.srcEvent,viewport:x.default.cornerstone.getViewport(element),image:t.image,element:element,rotation:M,type:n},Object(T.default)(element,n,d)}return!1}}function _(element){w.default.disable(element),["touchstart","touchend"].forEach((function(e){element.removeEventListener(e,P)}));var e=Object(E.getToolOptions)(M,element),t=e.hammer;t&&(t.off("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",P),t.input.destroy()),e.hammer=null,Object(E.clearToolOptions)(M,element)}var D={enable:function(element){_(element);var e=x.default.Hammer,t={inputClass:e.SUPPORT_POINTER_EVENTS?e.PointerEventInput:e.TouchInput},n=new e.Manager(element,t),r={pointers:0,direction:e.DIRECTION_ALL,threshold:0},o=new e.Pan(r),l=new e.Pinch({threshold:0}),c=new e.Rotate({threshold:0});l.recognizeWith(o),l.recognizeWith(c),c.recognizeWith(o);var d=new e.Tap({event:"doubletap",taps:2,interval:1500,threshold:50,posThreshold:50});d.recognizeWith(o),n.add([d,o,c,l]),n.on("tap doubletap panstart panmove panend pinchstart pinchmove rotatemove",P),w.default.enable(element),["touchstart","touchend"].forEach((function(e){element.addEventListener(e,P,{passive:!1})}));var f=Object(E.getToolOptions)(M,element);f.hammer=n,Object(E.setToolOptions)(M,element,f)},disable:_};t.default=D},"./eventListeners/wheelEventListener.js":function(e,t,n){"use strict";n.r(t);var r=n("./events.js"),o=n("./externalModules.js"),l=n("./util/triggerEvent.js"),c=n("./eventListeners/internals/normalizeWheel.js");function d(e){var element=e.currentTarget,t=o.default.cornerstone.getEnabledElement(element);if(t.image&&!(e.deltaY>-1&&e.deltaY<1)){e.preventDefault();var n=e.pageX,d=e.pageY,f=o.default.cornerstone.pageToPixel(element,n,d),h=Object(c.default)(e),m=h.spinX,v=h.spinY,y=h.pixelX,x=h.pixelY,j=v<0?-1:1,w={element:element,viewport:o.default.cornerstone.getViewport(element),detail:e,image:t.image,direction:j,spinX:m,spinY:v,pixelX:y,pixelY:x,pageX:n,pageY:d,imageX:f.x,imageY:f.y};Object(l.default)(element,r.default.MOUSE_WHEEL,w)}}function f(element){element.removeEventListener("wheel",d,{passive:!1})}t.default={enable:function(element){f(element),element.addEventListener("wheel",d,{passive:!1})},disable:f}},"./eventListeners/windowResizeHandler.js":function(e,t,n){"use strict";n.r(t),n.d(t,"forceEnabledElementResize",(function(){return f}));var r,o=n("./store/index.js"),l=n("./externalModules.js"),c=function(){window.removeEventListener("resize",d,!1)};function d(){r||(r=setTimeout((function(){r=null,f()}),66))}var f=function(){o.state.enabledElements.forEach((function(element){l.default.cornerstone.resize(element)}))};t.default={enable:function(){c(),window.addEventListener("resize",d,!1)},disable:c}},"./events.js":function(e,t,n){"use strict";n.r(t),t.default={MOUSE_DOWN:"cornerstonetoolsmousedown",MOUSE_UP:"cornerstonetoolsmouseup",MOUSE_DOWN_ACTIVATE:"cornerstonetoolsmousedownactivate",MOUSE_DRAG:"cornerstonetoolsmousedrag",MOUSE_MOVE:"cornerstonetoolsmousemove",MOUSE_CLICK:"cornerstonetoolsmouseclick",MOUSE_DOUBLE_CLICK:"cornerstonetoolsmousedoubleclick",MOUSE_WHEEL:"cornerstonetoolsmousewheel",TOUCH_START:"cornerstonetoolstouchstart",TOUCH_START_ACTIVE:"cornerstonetoolstouchstartactive",TOUCH_END:"cornerstonetoolstouchend",TOUCH_DRAG:"cornerstonetoolstouchdrag",TOUCH_DRAG_END:"cornerstonetoolstouchdragend",TOUCH_PINCH:"cornerstonetoolstouchpinch",TOUCH_ROTATE:"cornerstonetoolstouchrotate",TOUCH_PRESS:"cornerstonetoolstouchpress",TAP:"cornerstonetoolstap",DOUBLE_TAP:"cornerstonetoolsdoubletap",MULTI_TOUCH_START:"cornerstonetoolsmultitouchstart",MULTI_TOUCH_START_ACTIVE:"cornerstonetoolsmultitouchstartactive",MULTI_TOUCH_DRAG:"cornerstonetoolsmultitouchdrag",KEY_DOWN:"cornerstonetoolskeydown",KEY_UP:"cornerstonetoolskeyup",KEY_PRESS:"cornerstonetoolskeypress",MEASUREMENT_ADDED:"cornerstonetoolsmeasurementadded",MEASUREMENT_MODIFIED:"cornerstonetoolsmeasurementmodified",MEASUREMENT_COMPLETED:"cornerstonetoolsmeasurementcompleted",MEASUREMENT_REMOVED:"cornerstonetoolsmeasurementremoved",TOOL_DEACTIVATED:"cornerstonetoolstooldeactivated",CLIP_STOPPED:"cornerstonetoolsclipstopped",STACK_SCROLL:"cornerstonetoolsstackscroll",STACK_PREFETCH_IMAGE_LOADED:"cornerstonetoolsstackprefetchimageloaded",STACK_PREFETCH_DONE:"cornerstonetoolsstackprefetchdone",LABELMAP_MODIFIED:"cornersontetoolslabelmapmodified"}},"./externalModules.js":function(e,t,n){"use strict";n.r(t);var r=window.cornerstone,o=window.cornerstoneMath,l=window.Hammer;t.default={set cornerstone(e){r=e},get cornerstone(){return r},set cornerstoneMath(e){o=e},get cornerstoneMath(){return o},set Hammer(e){l=e},get Hammer(){return l}}},"./importInternal.js":function(e,t,n){"use strict";n.r(t);var r=n("./lib.js");t.default=function(e){return r.lib[e]}},"./index.js":function(e,t,n){"use strict";n.r(t);var r=n("./tools/annotation/index.js");n.d(t,"AngleTool",(function(){return r.AngleTool})),n.d(t,"ArrowAnnotateTool",(function(){return r.ArrowAnnotateTool})),n.d(t,"BidirectionalTool",(function(){return r.BidirectionalTool})),n.d(t,"CircleRoiTool",(function(){return r.CircleRoiTool})),n.d(t,"CobbAngleTool",(function(){return r.CobbAngleTool})),n.d(t,"EllipticalRoiTool",(function(){return r.EllipticalRoiTool})),n.d(t,"FreehandRoiTool",(function(){return r.FreehandRoiTool})),n.d(t,"LengthTool",(function(){return r.LengthTool})),n.d(t,"ProbeTool",(function(){return r.ProbeTool})),n.d(t,"RectangleRoiTool",(function(){return r.RectangleRoiTool})),n.d(t,"TextMarkerTool",(function(){return r.TextMarkerTool}));var o=n("./tools/segmentation/index.js");n.d(t,"BrushTool",(function(){return o.BrushTool})),n.d(t,"SphericalBrushTool",(function(){return o.SphericalBrushTool})),n.d(t,"RectangleScissorsTool",(function(){return o.RectangleScissorsTool})),n.d(t,"FreehandScissorsTool",(function(){return o.FreehandScissorsTool})),n.d(t,"CircleScissorsTool",(function(){return o.CircleScissorsTool})),n.d(t,"CorrectionScissorsTool",(function(){return o.CorrectionScissorsTool}));var l=n("./tools/index.js");n.d(t,"CrosshairsTool",(function(){return l.CrosshairsTool})),n.d(t,"DoubleTapFitToWindowTool",(function(){return l.DoubleTapFitToWindowTool})),n.d(t,"DragProbeTool",(function(){return l.DragProbeTool})),n.d(t,"EraserTool",(function(){return l.EraserTool})),n.d(t,"FreehandRoiSculptorTool",(function(){return l.FreehandRoiSculptorTool})),n.d(t,"MagnifyTool",(function(){return l.MagnifyTool})),n.d(t,"OverlayTool",(function(){return l.OverlayTool})),n.d(t,"OrientationMarkersTool",(function(){return l.OrientationMarkersTool})),n.d(t,"PanMultiTouchTool",(function(){return l.PanMultiTouchTool})),n.d(t,"PanTool",(function(){return l.PanTool})),n.d(t,"ReferenceLinesTool",(function(){return l.ReferenceLinesTool})),n.d(t,"RotateTool",(function(){return l.RotateTool})),n.d(t,"RotateTouchTool",(function(){return l.RotateTouchTool})),n.d(t,"ScaleOverlayTool",(function(){return l.ScaleOverlayTool})),n.d(t,"StackScrollMouseWheelTool",(function(){return l.StackScrollMouseWheelTool})),n.d(t,"StackScrollMultiTouchTool",(function(){return l.StackScrollMultiTouchTool})),n.d(t,"StackScrollTool",(function(){return l.StackScrollTool})),n.d(t,"WwwcRegionTool",(function(){return l.WwwcRegionTool})),n.d(t,"WwwcTool",(function(){return l.WwwcTool})),n.d(t,"ZoomMouseWheelTool",(function(){return l.ZoomMouseWheelTool})),n.d(t,"ZoomTool",(function(){return l.ZoomTool})),n.d(t,"ZoomTouchPinchTool",(function(){return l.ZoomTouchPinchTool}));var c=n("./init.js");n.d(t,"init",(function(){return c.default}));var d=n("./stackTools/stackPrefetch.js");n.d(t,"stackPrefetch",(function(){return d.default}));var f=n("./stackTools/stackRenderers.js");n.d(t,"stackRenderers",(function(){return f.default}));var h=n("./stackTools/playClip.js");n.d(t,"playClip",(function(){return h.playClip})),n.d(t,"stopClip",(function(){return h.stopClip}));var m=n("./store/index.js");n.d(t,"store",(function(){return m.default})),n.d(t,"getModule",(function(){return m.getModule}));var v=n("./store/getToolForElement.js");n.d(t,"getToolForElement",(function(){return v.default}));var y=n("./store/addTool.js");n.d(t,"addTool",(function(){return y.addTool})),n.d(t,"addToolForElement",(function(){return y.addToolForElement}));var x=n("./store/removeTool.js");n.d(t,"removeTool",(function(){return x.removeTool})),n.d(t,"removeToolForElement",(function(){return x.removeToolForElement}));var j=n("./store/setToolOptions.js");n.d(t,"setToolOptions",(function(){return j.setToolOptions})),n.d(t,"setToolOptionsForElement",(function(){return j.setToolOptionsForElement}));var w=n("./store/setToolMode.js");n.d(t,"setToolActive",(function(){return w.setToolActive})),n.d(t,"setToolActiveForElement",(function(){return w.setToolActiveForElement})),n.d(t,"setToolEnabled",(function(){return w.setToolEnabled})),n.d(t,"setToolEnabledForElement",(function(){return w.setToolEnabledForElement})),n.d(t,"setToolDisabled",(function(){return w.setToolDisabled})),n.d(t,"setToolDisabledForElement",(function(){return w.setToolDisabledForElement})),n.d(t,"setToolPassive",(function(){return w.setToolPassive})),n.d(t,"setToolPassiveForElement",(function(){return w.setToolPassiveForElement}));var T=n("./store/isToolActiveForElement.js");n.d(t,"isToolActiveForElement",(function(){return T.default}));var E=n("./stateManagement/toolState.js");n.d(t,"addToolState",(function(){return E.addToolState})),n.d(t,"getToolState",(function(){return E.getToolState})),n.d(t,"removeToolState",(function(){return E.removeToolState})),n.d(t,"clearToolState",(function(){return E.clearToolState})),n.d(t,"setElementToolStateManager",(function(){return E.setElementToolStateManager})),n.d(t,"getElementToolStateManager",(function(){return E.getElementToolStateManager}));var O=n("./stateManagement/textStyle.js");n.d(t,"textStyle",(function(){return O.default}));var C=n("./stateManagement/toolStyle.js");n.d(t,"toolStyle",(function(){return C.default}));var S=n("./stateManagement/toolColors.js");n.d(t,"toolColors",(function(){return S.default}));var I=n("./stateManagement/toolCoordinates.js");n.d(t,"toolCoordinates",(function(){return I.default}));var M=n("./stateManagement/stackSpecificStateManager.js");n.d(t,"stackSpecificStateManager",(function(){return M.stackSpecificStateManager})),n.d(t,"newStackSpecificToolStateManager",(function(){return M.newStackSpecificToolStateManager})),n.d(t,"addStackStateManager",(function(){return M.addStackStateManager}));var P=n("./stateManagement/loadHandlerManager.js");n.d(t,"loadHandlerManager",(function(){return P.default}));var _=n("./stateManagement/imageIdSpecificStateManager.js");n.d(t,"newImageIdSpecificToolStateManager",(function(){return _.newImageIdSpecificToolStateManager})),n.d(t,"globalImageIdSpecificToolStateManager",(function(){return _.globalImageIdSpecificToolStateManager}));var D=n("./stateManagement/frameOfReferenceStateManager.js");n.d(t,"newFrameOfReferenceSpecificToolStateManager",(function(){return D.newFrameOfReferenceSpecificToolStateManager})),n.d(t,"globalFrameOfReferenceSpecificToolStateManager",(function(){return D.globalFrameOfReferenceSpecificToolStateManager}));var k=n("./eventListeners/windowResizeHandler.js");n.d(t,"forceEnabledElementResize",(function(){return k.forceEnabledElementResize}));var L=n("./orientation/index.js");n.d(t,"orientation",(function(){return L.default}));var A=n("./util/SaveAs.js");n.d(t,"SaveAs",(function(){return A.default}));var R=n("./util/logger.js");n.d(t,"enableLogger",(function(){return R.enable})),n.d(t,"disableLogger",(function(){return R.disable}));var B=n("./thirdParty/register.js");n.d(t,"register",(function(){return B.default}));var U=n("./thirdParty/registerSome.js");n.d(t,"registerSome",(function(){return U.default}));var F=n("./synchronization/wwwcSynchronizer.js");n.d(t,"wwwcSynchronizer",(function(){return F.default}));var H=n("./synchronization/updateImageSynchronizer.js");n.d(t,"updateImageSynchronizer",(function(){return H.default}));var N=n("./synchronization/Synchronizer.js");n.d(t,"Synchronizer",(function(){return N.default}));var z=n("./synchronization/stackScrollSynchronizer.js");n.d(t,"stackScrollSynchronizer",(function(){return z.default}));var V=n("./synchronization/stackImagePositionSynchronizer.js");n.d(t,"stackImagePositionSynchronizer",(function(){return V.default}));var W=n("./synchronization/stackImagePositionOffsetSynchronizer.js");n.d(t,"stackImagePositionOffsetSynchronizer",(function(){return W.default}));var G=n("./synchronization/stackImageIndexSynchronizer.js");n.d(t,"stackImageIndexSynchronizer",(function(){return G.default}));var Y=n("./synchronization/panZoomSynchronizer.js");n.d(t,"panZoomSynchronizer",(function(){return Y.default}));var X=n("./externalModules.js");n.d(t,"external",(function(){return X.default}));var Z=n("./events.js");n.d(t,"EVENTS",(function(){return Z.default}));var K=n("./version.js");n.d(t,"version",(function(){return K.default}));var J=n("./importInternal.js");n.d(t,"importInternal",(function(){return J.default})),n.d(t,"import",(function(){return J.default}));var $={AngleTool:r.AngleTool,ArrowAnnotateTool:r.ArrowAnnotateTool,BidirectionalTool:r.BidirectionalTool,CircleRoiTool:r.CircleRoiTool,CobbAngleTool:r.CobbAngleTool,EllipticalRoiTool:r.EllipticalRoiTool,FreehandRoiTool:r.FreehandRoiTool,LengthTool:r.LengthTool,ProbeTool:r.ProbeTool,RectangleRoiTool:r.RectangleRoiTool,TextMarkerTool:r.TextMarkerTool,BrushTool:o.BrushTool,SphericalBrushTool:o.SphericalBrushTool,RectangleScissorsTool:o.RectangleScissorsTool,FreehandScissorsTool:o.FreehandScissorsTool,CircleScissorsTool:o.CircleScissorsTool,CorrectionScissorsTool:o.CorrectionScissorsTool,CrosshairsTool:l.CrosshairsTool,DoubleTapFitToWindowTool:l.DoubleTapFitToWindowTool,DragProbeTool:l.DragProbeTool,EraserTool:l.EraserTool,FreehandRoiSculptorTool:l.FreehandRoiSculptorTool,MagnifyTool:l.MagnifyTool,OverlayTool:l.OverlayTool,OrientationMarkersTool:l.OrientationMarkersTool,PanMultiTouchTool:l.PanMultiTouchTool,PanTool:l.PanTool,ReferenceLinesTool:l.ReferenceLinesTool,RotateTool:l.RotateTool,RotateTouchTool:l.RotateTouchTool,ScaleOverlayTool:l.ScaleOverlayTool,StackScrollMouseWheelTool:l.StackScrollMouseWheelTool,StackScrollMultiTouchTool:l.StackScrollMultiTouchTool,StackScrollTool:l.StackScrollTool,WwwcRegionTool:l.WwwcRegionTool,WwwcTool:l.WwwcTool,ZoomMouseWheelTool:l.ZoomMouseWheelTool,ZoomTool:l.ZoomTool,ZoomTouchPinchTool:l.ZoomTouchPinchTool,init:c.default,stackPrefetch:d.default,stackRenderers:f.default,playClip:h.playClip,stopClip:h.stopClip,store:m.default,getModule:m.getModule,getToolForElement:v.default,addTool:y.addTool,addToolForElement:y.addToolForElement,removeTool:x.removeTool,removeToolForElement:x.removeToolForElement,setToolOptions:j.setToolOptions,setToolOptionsForElement:j.setToolOptionsForElement,isToolActiveForElement:T.default,setToolActive:w.setToolActive,setToolActiveForElement:w.setToolActiveForElement,setToolEnabled:w.setToolEnabled,setToolEnabledForElement:w.setToolEnabledForElement,setToolDisabled:w.setToolDisabled,setToolDisabledForElement:w.setToolDisabledForElement,setToolPassive:w.setToolPassive,setToolPassiveForElement:w.setToolPassiveForElement,addToolState:E.addToolState,getToolState:E.getToolState,removeToolState:E.removeToolState,clearToolState:E.clearToolState,setElementToolStateManager:E.setElementToolStateManager,getElementToolStateManager:E.getElementToolStateManager,textStyle:O.default,toolStyle:C.default,toolColors:S.default,toolCoordinates:I.default,stackSpecificStateManager:M.stackSpecificStateManager,newStackSpecificToolStateManager:M.newStackSpecificToolStateManager,addStackStateManager:M.addStackStateManager,loadHandlerManager:P.default,newImageIdSpecificToolStateManager:_.newImageIdSpecificToolStateManager,globalImageIdSpecificToolStateManager:_.globalImageIdSpecificToolStateManager,newFrameOfReferenceSpecificToolStateManager:D.newFrameOfReferenceSpecificToolStateManager,globalFrameOfReferenceSpecificToolStateManager:D.globalFrameOfReferenceSpecificToolStateManager,forceEnabledElementResize:k.forceEnabledElementResize,orientation:L.default,SaveAs:A.default,enableLogger:R.enable,disableLogger:R.disable,importInternal:J.default,import:J.default,register:B.default,registerSome:U.default,wwwcSynchronizer:F.default,updateImageSynchronizer:H.default,Synchronizer:N.default,stackScrollSynchronizer:z.default,stackImagePositionSynchronizer:V.default,stackImagePositionOffsetSynchronizer:W.default,stackImageIndexSynchronizer:G.default,panZoomSynchronizer:Y.default,external:X.default,EVENTS:Z.default,version:K.default};t.default=$},"./init.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./store/index.js"),l=n("./store/internals/addEnabledElement.js"),c=n("./store/internals/removeEnabledElement.js"),d=n("./eventListeners/windowResizeHandler.js");function f(){!function(){var e=r.default.cornerstone,t=e.EVENTS.ELEMENT_ENABLED,n=e.EVENTS.ELEMENT_DISABLED;e.events.removeEventListener(t,l.default),e.events.removeEventListener(n,c.default)}();var e=r.default.cornerstone,t=e.EVENTS.ELEMENT_ENABLED,n=e.EVENTS.ELEMENT_DISABLED;e.events.addEventListener(t,l.default),e.events.addEventListener(n,c.default)}function h(){var e=o.default.modules;Object.keys(e).forEach((function(t){"function"==typeof e[t].onRegisterCallback&&e[t].onRegisterCallback()}))}t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f(),h();var t=Object(o.getModule)("globalConfiguration");Array.isArray(e)?e.forEach((function(e){var t=e.moduleName,n=e.configuration,r=Object(o.getModule)(t);r&&(r.configuration=Object.assign({},r.configuration,n))})):t.configuration=Object.assign({},t.configuration,e),t.configuration.autoResizeViewports&&d.default.enable()}},"./lib.js":function(e,t,n){"use strict";n.r(t),n.d(t,"lib",(function(){return le}));var r=n("./tools/base/BaseTool.js"),o=n("./tools/base/BaseAnnotationTool.js"),l=n("./tools/base/BaseBrushTool.js"),c=n("./manipulators/index.js"),d=n("./util/findAndMoveHelpers.js"),f=n("./mixins/index.js"),h=n("./tools/cursors/index.js"),m=n("./drawing/index.js"),v=n("./util/clip.js"),y=n("./util/debounce.js"),x=n("./util/deepmerge.js"),j=n("./util/getDefault.js"),w=n("./util/getPixelSpacing.js"),T=n("./util/isEmptyObject.js"),E=n("./util/isObject.js"),O=n("./util/isPointInImage.js"),C=n("./util/isPointInPolygon.js"),S=n("./util/throttle.js"),I=n("./util/wait.js"),M=n("./util/getKeyPressData.js"),P=n("./util/getProximityThreshold.js"),_=n("./drawing/drawTextBox.js"),D=n("./drawing/drawArrow.js"),k=n("./drawing/drawLink.js"),L=n("./drawing/drawLinkedTextBox.js"),A=n("./drawing/drawHandles.js"),R=n("./util/getActiveTool.js"),B=n("./util/getLuminance.js"),U=n("./util/getROITextBoxCoords.js"),F=n("./util/copyPoints.js"),H=n("./util/calculateSUV.js"),N=n("./util/setContextToDisplayFontSize.js"),z=n("./util/scrollToIndex.js"),V=n("./util/scroll.js"),W=n("./util/roundToDecimal.js"),G=n("./util/pointProjector.js"),Y=n("./util/lineSegDistance.js"),X=n("./util/logger.js"),Z=n("./util/pointInsideBoundingBox.js"),K=n("./util/makeUnselectable.js"),J=n("./util/getRGBPixels.js"),$=n("./util/getMaxSimultaneousRequests.js"),Q=n("./util/angleBetweenPoints.js"),ee=n("./util/numbersWithCommas.js"),te=n("./tools/cursors/MouseCursor.js"),ne=n("./util/ellipse/index.js"),ae=n("./util/freehand/index.js"),re=n("./util/segmentation/index.js"),oe=n("./util/zoom/index.js"),ie=n("./util/triggerEvent.js"),se=n("./util/convertToVector3.js"),le={"base/BaseTool":r.default,"base/BaseAnnotationTool":o.default,"base/BaseBrushTool":l.default,"tools/cursors/MouseCursor":te.default,"tools/cursors":h,"manipulators/anyHandlesOutsideImage":c.anyHandlesOutsideImage,"manipulators/getHandleNearImagePoint":c.getHandleNearImagePoint,"manipulators/getHandlePixelPosition":c.getHandlePixelPosition,"manipulators/handleActivator":c.handleActivator,"manipulators/moveAllHandles":c.moveAllHandles,"manipulators/moveHandle":c.moveHandle,"manipulators/moveNewHandle":c.moveNewHandle,"manipulators/moveHandleNearImagePoint":d.moveHandleNearImagePoint,"manipulators/findHandleDataNearImagePoint":d.findHandleDataNearImagePoint,"manipulators/moveAnnotation":d.moveAnnotation,"mixins/activeOrDisabledBinaryTool":f.default.activeOrDisabledBinaryTool,"mixins/enabledOrDisabledBinaryTool":f.default.enabledOrDisabledBinaryTool,"drawing/getNewContext":m.getNewContext,"drawing/draw":m.draw,"drawing/path":m.path,"drawing/setShadow":m.setShadow,"drawing/drawLine":m.drawLine,"drawing/drawLines":m.drawLines,"drawing/drawJoinedLines":m.drawJoinedLines,"drawing/drawCircle":m.drawCircle,"drawing/drawEllipse":m.drawEllipse,"drawing/drawRect":m.drawRect,"drawing/fillOutsideRect":m.fillOutsideRect,"drawing/drawTextBox":_.default,"drawing/drawArrow":D.default,"drawing/fillBox":m.fillBox,"drawing/fillTextLines":m.fillTextLines,"drawing/drawLink":k.default,"drawing/drawLinkedTextBox":L.default,"drawing/drawHandles":A.default,"drawing/textBoxWidth":_.textBoxWidth,"util/getActiveTool":R.default,"util/getLuminance":B.default,"util/getROITextBoxCoords":U.default,"util/copyPoints":F.default,"util/calculateSUV":H.default,"util/setContextToDisplayFontSize":N.default,"util/scrollToIndex":z.default,"util/scroll":V.default,"util/roundToDecimal":W.default,"util/projectPatientPointToImagePlane":G.projectPatientPointToImagePlane,"util/imagePointToPatientPoint":G.imagePointToPatientPoint,"util/planePlaneIntersection":G.planePlaneIntersection,"util/pointInsideBoundingBox":Z.default,"util/makeUnselectable":K.default,"util/getRGBPixels":J.default,"util/getBrowserInfo":$.getBrowserInfo,"util/isMobileDevice":$.isMobileDevice,"util/angleBetweenPoints":Q.default,"util/numbersWithCommas":ee.default,"util/lineSegDistance":Y.default,"util/triggerEvent":ie.default,"util/convertToVector3":se.default,"util/clip":v.clip,"util/clipToBox":v.clipToBox,"util/clipBoxToDisplayedArea":v.clipBoxToDisplayedArea,"util/debounce":y.default,"util/deepmerge":x.default,"util/getDefault":j.default,"util/getProximityThreshold":P.default,"util/getPixelSpacing":w.default,"util/isEmptyObject":T.default,"util/isObject":E.default,"util/isPointInImage":O.default,"util/isPointInPolygon":C.default,"util/getLogger":X.getLogger,"util/throttle":S.default,"util/wait":I.wait,"util/waitForEnabledElementImageToLoad":I.waitForEnabledElementImageToLoad,"util/getKeyPressData":M.default,"util/ellipseUtils":ne.default,"util/freehandUtils":ae.default,"util/segmentationUtils":re,"util/zoomUtils":oe.default}},"./manipulators/anyHandlesOutsideImage.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js");t.default=function(e,t){var image=e.image,n={left:0,top:0,width:image.width,height:image.height},o=!1;return Object.keys(t).forEach((function(e){var l=t[e];!0!==l.allowedOutsideImage&&!1===r.default.cornerstoneMath.point.insideRect(l,n)&&(o=!0)})),o}},"./manipulators/getHandleNearImagePoint.js":function(e,t,n){"use strict";n.r(t);var r=n("../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(r),l=n("./externalModules.js"),c=n("./util/pointInsideBoundingBox.js"),d=function(e,element,t,n){if(e.hasOwnProperty("pointNearHandle")){if(e.pointNearHandle(element,e,t))return!0}else if(!0===e.hasBoundingBox){if(Object(c.default)(e,t))return!0}else{var r=l.default.cornerstone.pixelToCanvas(element,e);if(l.default.cornerstoneMath.point.distance(r,t)<=n)return!0}return!1};t.default=function e(element,t,n,r){var l;if(t){if(Array.isArray(t))for(var c=Object.keys(t),i=0;i<c.length;i++){var f=t[c[i]];if(f.hasOwnProperty("x")&&f.hasOwnProperty("y")&&d(f,element,n,r)){l=f;break}}else if("object"===o()(t))for(var h=Object.keys(t),m=0;m<h.length;m++){var v=h[m];if(Array.isArray(t[v])){if(l=e(element,t[v],n,r))break}else{var y=t[v];if(d(y,element,n,r)){l=y;break}}}return l}}},"./manipulators/getHandlePixelPosition.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./store/index.js");t.default=function(e,t){var n=e.currentPoints,element=e.element,l=n.page,c=o.state.handleTouchOffset,d=0,f=0;return"touch"===t&&(d=c.x,f=c.y),r.default.cornerstone.pageToPixel(element,l.x+d,l.y+f)}},"./manipulators/handleActivator.js":function(e,t,n){"use strict";n.r(t);var r=n("./manipulators/getHandleNearImagePoint.js");t.default=function(element,e,t,n){n||(n=6);var o=function(e){var t;return Object.keys(e).forEach((function(n){var r=e[n];!0!==r.active||(t=r)})),t}(e),l=Object(r.default)(element,e,t,n);return o!==l&&(void 0!==l&&(l.active=!0),void 0!==o&&(o.active=!1),!0)}},"./manipulators/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./manipulators/anyHandlesOutsideImage.js");n.d(t,"anyHandlesOutsideImage",(function(){return r.default}));var o=n("./manipulators/getHandleNearImagePoint.js");n.d(t,"getHandleNearImagePoint",(function(){return o.default}));var l=n("./manipulators/getHandlePixelPosition.js");n.d(t,"getHandlePixelPosition",(function(){return l.default}));var c=n("./manipulators/handleActivator.js");n.d(t,"handleActivator",(function(){return c.default}));var d=n("./manipulators/moveAllHandles.js");n.d(t,"moveAllHandles",(function(){return d.default}));var f=n("./manipulators/moveHandle.js");n.d(t,"moveHandle",(function(){return f.default}));var h=n("./manipulators/moveNewHandle.js");n.d(t,"moveNewHandle",(function(){return h.default}))},"./manipulators/moveAllHandles.js":function(e,t,n){"use strict";n.r(t);var r=n("./events.js"),o=n("./externalModules.js"),l=n("./manipulators/anyHandlesOutsideImage.js"),c=n("./stateManagement/toolState.js"),d=n("./util/triggerEvent.js"),f=n("./util/clip.js"),h=n("./store/index.js"),m=n("./util/getActiveTool.js"),v=n("./tools/base/BaseAnnotationTool.js"),y=n("./util/logger.js"),x=Object(y.getLogger)("manipulators:moveAllHandles"),j=Object(h.getModule)("manipulatorState"),w={mouse:[r.default.MOUSE_DRAG],touch:[r.default.TOUCH_DRAG]},T={mouse:[r.default.MOUSE_UP,r.default.MOUSE_CLICK],touch:[r.default.TOUCH_END,r.default.TOUCH_DRAG_END,r.default.TOUCH_PINCH,r.default.TOUCH_PRESS,r.default.TAP]};function E(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0,h=c.detail,element=h.element,image=h.image,y=h.buttons,x=c.detail.deltaPoints.image,j=x.x,w=x.y;t.active=!0,t.invalidated=!0;for(var T=Object.keys(t.handles),i=0;i<T.length;i++){var E=T[i],O=t.handles[E];!0!==O.movesIndependently&&O.hasOwnProperty("x")&&O.hasOwnProperty("y")&&(O.x+=j,O.y+=w,n.preventHandleOutsideImage&&Object(f.clipToBox)(O,image))}o.default.cornerstone.updateImage(element);var C=Object(m.default)(element,y,l);C instanceof v.default&&C.updateCachedStats(image,element,t);var S=r.default.MEASUREMENT_MODIFIED,I={toolName:e,toolType:e,element:element,measurementData:t};Object(d.default)(element,S,I),c.preventDefault(),c.stopPropagation()}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=r.dragHandler,l=r.upOrEndHandler,element=arguments.length>4?arguments[4]:void 0,c=arguments.length>5?arguments[5]:void 0;S(e,t,n,{dragHandler:o,upOrEndHandler:l},element,c,!1)}function C(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,d=o.dragHandler,f=o.upOrEndHandler,h=arguments.length>5?arguments[5]:void 0,m=arguments.length>6?arguments[6]:void 0,v=h.detail,element=v.element;j.setters.removeActiveManipulatorForElement(element),n.deleteIfHandleOutsideImage&&Object(l.default)(v,t.handles)&&Object(c.removeToolState)(element,e,t),S(t,n,r,{dragHandler:d,upOrEndHandler:f},element,m,!0)}function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,l=r.dragHandler,c=r.upOrEndHandler,element=arguments.length>4?arguments[4]:void 0,d=arguments.length>5?arguments[5]:void 0,f=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];e.active=!1,e.invalidated=!0,h.state.isToolLocked=!1,w[n].forEach((function(e){element.removeEventListener(e,l)})),T[n].forEach((function(e){element.removeEventListener(e,c)})),"function"==typeof t.doneMovingCallback&&(x.warn("`options.doneMovingCallback` has been depricated. See https://github.com/cornerstonejs/cornerstoneTools/pull/915 for details."),t.doneMovingCallback(f)),"function"==typeof d&&d(f),o.default.cornerstone.updateImage(element)}t.default=function(e,t,n,r){var element=e.element,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"mouse",c=arguments.length>6?arguments[6]:void 0;o=Object.assign({deleteIfHandleOutsideImage:h.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:h.state.preventHandleOutsideImage},o);var d=E.bind(this,t,n,o,l),f=function e(r){C(t,n,o,l,{dragHandler:d,upOrEndHandler:e},r,c)};j.setters.addActiveManipulatorForElement(element,O.bind(null,n,o,l,{dragHandler:d,upOrEndHandler:f},element,c)),n.active=!0,h.state.isToolLocked=!0,w[l].forEach((function(e){element.addEventListener(e,d)})),T[l].forEach((function(e){element.addEventListener(e,f)}))}},"./manipulators/moveHandle.js":function(e,t,n){"use strict";n.r(t);var r=n("./events.js"),o=n("./externalModules.js"),l=n("./manipulators/anyHandlesOutsideImage.js"),c=n("./manipulators/getHandlePixelPosition.js"),d=n("./stateManagement/toolState.js"),f=n("./util/triggerEvent.js"),h=n("./util/clip.js"),m=n("./store/index.js"),v=n("./util/getActiveTool.js"),y=n("./tools/base/BaseAnnotationTool.js"),x=n("./util/logger.js"),j=Object(x.getLogger)("manipulators:moveHandle"),w=Object(m.getModule)("manipulatorState"),T={value:!1},E={mouse:[r.default.MOUSE_DRAG],touch:[r.default.TOUCH_DRAG]},O={mouse:[r.default.MOUSE_UP,r.default.MOUSE_CLICK],touch:[r.default.TOUCH_END,r.default.TOUCH_DRAG_END,r.default.TOUCH_PINCH,r.default.TOUCH_PRESS,r.default.TAP]};function C(e,t,n,l,d,m){var x=m.detail,image=x.image,element=x.element,j=x.buttons,w=Object(c.default)(m.detail,d);T.value=!1,n.active=!0,n.hasMoved=!0,n.x=w.x,n.y=w.y,t.invalidated=!0,l.preventHandleOutsideImage&&Object(h.clipToBox)(n,image),o.default.cornerstone.updateImage(element);var E=Object(v.default)(element,j,d);E instanceof y.default&&E.updateCachedStats(image,element,t);var O=r.default.MEASUREMENT_MODIFIED,C={toolName:e,toolType:e,element:element,measurementData:t};Object(f.default)(element,O,C)}function S(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},l=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,d=c.dragHandler,f=c.upOrEndHandler,h=arguments.length>7?arguments[7]:void 0;M(e,t,n,r,o,l,{dragHandler:d,upOrEndHandler:f},h,!1)}function I(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},l=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,d=c.dragHandler,f=c.upOrEndHandler,h=arguments.length>7?arguments[7]:void 0,element=t.element;w.setters.removeActiveManipulatorForElement(element),M(e,t,n,r,o,l,{dragHandler:d,upOrEndHandler:f},h,!0)}function M(e,t,n,r){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},f=arguments.length>5?arguments[5]:void 0,h=arguments.length>6?arguments[6]:void 0,v=h.dragHandler,y=h.upOrEndHandler,x=arguments.length>7?arguments[7]:void 0,w=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],element=t.element;r.active=!1,r.moving=!1,n.active=!1,n.invalidated=!0,T.value=!1,m.state.isToolLocked=!1,E[f].forEach((function(e){element.removeEventListener(e,v)})),O[f].forEach((function(e){element.removeEventListener(e,y)})),c.deleteIfHandleOutsideImage&&Object(l.default)(t,n.handles)&&Object(d.removeToolState)(element,e,n),"function"==typeof c.doneMovingCallback&&(j.warn("`options.doneMovingCallback` has been depricated. See https://github.com/cornerstonejs/cornerstoneTools/pull/915 for details."),c.doneMovingCallback(w)),"function"==typeof x&&x(w),o.default.cornerstone.updateImage(element)}function P(e,t,n,r){if(t.value){var l=Math.abs(e.y-r.y),c=l/10;if(l<1)return e.y=r.y,void(t.value=!1);e.y>r.y?e.y-=c:e.y<r.y&&(e.y+=c),o.default.cornerstone.updateImage(n.element),o.default.cornerstone.requestAnimationFrame((function(){P(e,t,n,r)}))}}t.default=function(e,t,n,r){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"mouse",f=arguments.length>6?arguments[6]:void 0;l=Object.assign({deleteIfHandleOutsideImage:m.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:m.state.preventHandleOutsideImage},l);var element=e.element,h=C.bind(this,t,n,r,l,d),v=function o(){I(t,e,n,r,l,d,{dragHandler:h,upOrEndHandler:o},f)};if(w.setters.addActiveManipulatorForElement(element,S.bind(null,t,e,n,r,l,d,{dragHandler:h,upOrEndHandler:v},f)),r.active=!0,r.moving=!0,n.active=!0,m.state.isToolLocked=!0,E[d].forEach((function(e){element.addEventListener(e,h)})),O[d].forEach((function(e){element.addEventListener(e,v)})),"touch"===d){T.value=!0;var y=o.default.cornerstone.getEnabledElement(element),x=Object(c.default)(e,d);P(r,T,y,x)}}},"./manipulators/moveNewHandle.js":function(e,t,n){"use strict";n.r(t);var r=n("./events.js"),o=n("./externalModules.js"),l=n("./manipulators/anyHandlesOutsideImage.js"),c=n("./manipulators/getHandlePixelPosition.js"),d=n("./stateManagement/toolState.js"),f=n("./util/triggerEvent.js"),h=n("./util/clip.js"),m=n("./store/index.js"),v=n("./util/getActiveTool.js"),y=n("./tools/base/BaseAnnotationTool.js"),x=n("./util/logger.js"),j=Object(x.getLogger)("manipulators:moveNewHandle"),w=Object(m.getModule)("manipulatorState"),T={mouse:[r.default.MOUSE_MOVE,r.default.MOUSE_DRAG],touch:[r.default.TOUCH_DRAG]},E={mouse:[r.default.MOUSE_UP,r.default.MOUSE_CLICK],touch:[r.default.TOUCH_END,r.default.TOUCH_PINCH,r.default.TAP]};function O(e,t,n,l,d,m){var x=m.detail,image=x.image,element=x.element,j=x.buttons,w=Object(c.default)(m.detail,d);l.hasMoved=!0,t.invalidated=!0,n.active=!0,n.x=w.x,n.y=w.y,l&&l.preventHandleOutsideImage&&Object(h.clipToBox)(n,image),o.default.cornerstone.updateImage(element);var T=Object(v.default)(element,j,d);T instanceof y.default&&T.updateCachedStats(image,element,t);var E=r.default.MEASUREMENT_MODIFIED,O={toolName:e,toolType:e,element:element,measurementData:t};Object(f.default)(element,E,O)}function C(e,t,element,n,l){var c=n.moveHandler,d=n.moveEndHandler,f=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];T[e].forEach((function(e){element.removeEventListener(e,c)})),E[e].forEach((function(e){element.removeEventListener(e,d)})),element.removeEventListener(r.default.TOUCH_START,M),m.state.isToolLocked=!1,"function"==typeof l&&l(f),"function"==typeof t.doneMovingCallback&&(j.warn("`options.doneMovingCallback` has been depricated. See https://github.com/cornerstonejs/cornerstoneTools/pull/915 for details."),t.doneMovingCallback(f)),o.default.cornerstone.updateImage(element)}function S(e,t,n,r,o,f,m,v){var y=f.moveHandler,x=f.moveEndHandler,j=m.detail,element=j.element,T=!0;if(!1!==r.hasMoved){var E=Object(c.default)(j,o);t.active=!1,t.invalidated=!0,n.active=!1,n.moving=!1,n.x=E.x,n.y=E.y,w.setters.removeActiveManipulatorForElement(element),r.preventHandleOutsideImage&&Object(h.clipToBox)(n,m.detail.image),r.deleteIfHandleOutsideImage&&Object(l.default)(m.detail,t.handles)&&(t.cancelled=!0,T=!1,Object(d.removeToolState)(element,e,t)),C(o,r,element,{moveHandler:y,moveEndHandler:x},v,T)}}function I(e,t,n,r,o,element,l){var c=o.moveHandler,d=o.moveEndHandler;e.active=!1,e.invalidated=!0,t.active=!1,C(r,n,element,{moveHandler:c,moveEndHandler:d},l,!1)}function M(e){return e.stopImmediatePropagation(),!1}t.default=function(e,t,n,o,l){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"mouse",d=arguments.length>6?arguments[6]:void 0;(l=Object.assign({deleteIfHandleOutsideImage:m.state.deleteIfHandleOutsideImage,preventHandleOutsideImage:m.state.preventHandleOutsideImage},l)).hasMoved=!1;var element=e.element;function f(e){O(t,n,o,l,c,e)}function h(e){S(t,n,o,l,c,{moveHandler:f,moveEndHandler:h},e,d)}n.active=!0,o.moving=!0,o.active=!0,m.state.isToolLocked=!0,T[c].forEach((function(e){element.addEventListener(e,f)})),element.addEventListener(r.default.TOUCH_START,M),E[c].forEach((function(e){element.addEventListener(e,h)})),w.setters.addActiveManipulatorForElement(element,I.bind(null,n,o,l,c,{moveHandler:f,moveEndHandler:h},element,d))}},"./mixins/activeOrDisabledBinaryTool.js":function(e,t,n){"use strict";n.r(t);var r=n("./store/setToolMode.js");t.default={passiveCallback:function(element){Object(r.setToolDisabledForElement)(element,this.name)},enabledCallback:function(element){Object(r.setToolActiveForElement)(element,this.name)}}},"./mixins/enabledOrDisabledBinaryTool.js":function(e,t,n){"use strict";n.r(t);var r=n("./store/setToolMode.js");t.default={passiveCallback:function(element){Object(r.setToolDisabledForElement)(element,this.name)},activeCallback:function(element){Object(r.setToolEnabledForElement)(element,this.name)}}},"./mixins/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./mixins/activeOrDisabledBinaryTool.js"),o=n("./mixins/enabledOrDisabledBinaryTool.js"),l=n("./mixins/segmentation/circleSegmentationMixin.js"),c=n("./mixins/segmentation/polylineSegmentationMixin.js"),d=n("./mixins/segmentation/freehandSegmentationMixin.js"),f=n("./mixins/segmentation/rectangleSegmentationMixin.js"),h=n("./mixins/segmentation/renderBrushMixin.js");t.default={activeOrDisabledBinaryTool:r.default,enabledOrDisabledBinaryTool:o.default,circleSegmentationMixin:l.default,polylineSegmentationMixin:c.default,freehandSegmentationMixin:d.default,rectangleSegmentationMixin:f.default,renderBrushMixin:h.default}},"./mixins/segmentation/circleSegmentationMixin.js":function(e,t,n){"use strict";n.r(t);var r=n("./drawing/index.js"),o=n("./externalModules.js"),l=n("./util/isEmptyObject.js"),c=n("./store/index.js"),d=n("./util/segmentation/index.js"),f=Object(c.getModule)("segmentation"),h=f.getters,m=f.setters;function v(){this.handles={start:{},end:{}}}function y(e){var element=e.detail.element,image=e.detail.currentPoints.image;return Object(l.default)(this.handles.start)?this.handles.start=image:(this.handles.end=image,this._applyStrategy(e)),o.default.cornerstone.updateImage(element),!0}function x(e){var t=e.detail,element=t.element,image=t.currentPoints.image;this.handles.end=image,o.default.cornerstone.updateImage(element)}function j(e){e.detail.handles=this.handles;var element=e.detail.element,t=h.labelmap2D(element),n=t.labelmap2D,r=t.labelmap3D,l=t.currentImageIdIndex,c=n.pixelData,f=c.slice(),v={points:{start:{x:this.handles.start.x,y:this.handles.start.y},end:{x:this.handles.end.x,y:this.handles.end.y}},pixelData:c,segmentIndex:r.activeSegmentIndex,segmentationMixinType:"circleSegmentationMixin"};this.applyActiveStrategy(e,v);var y={imageIdIndex:l,diff:Object(d.getDiffBetweenPixelData)(f,c)};m.pushState(this.element,[y]),m.updateSegmentsOnLabelmap2D(n),o.default.cornerstone.updateImage(element),this._resetHandles()}t.default={postTouchStartCallback:y,postMouseDownCallback:y,mouseClickCallback:y,touchDragCallback:x,mouseDragCallback:x,mouseMoveCallback:x,touchEndCallback:j,mouseUpCallback:j,initializeMixin:v,renderToolData:function(e){var t=this,n=e.detail,element=n.element,l=h.brushColor(element,!0),c=Object(r.getNewContext)(n.canvasContext.canvas),d=o.default.cornerstoneMath.point.distance;Object(r.draw)(c,(function(e){if(!t.handles)return null;var n=o.default.cornerstone.pixelToCanvas(element,t.handles.start),c=o.default.cornerstone.pixelToCanvas(element,t.handles.end),f=d(n,c);Object(r.drawCircle)(e,element,t.handles.start,f,{color:l})}))},_resetHandles:v,_applyStrategy:j}},"./mixins/segmentation/freehandSegmentationMixin.js":function(e,t,n){"use strict";n.r(t);var r=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(r),l=n("./externalModules.js"),c=n("./store/index.js"),d=n("./util/logger.js"),f=n("./drawing/index.js"),h=n("./util/segmentation/index.js"),m=Object(d.getLogger)("tools:ScissorsTool"),v=Object(c.getModule)("segmentation"),y=v.getters,x=v.setters;function j(e){var element=e.detail.element,image=e.detail.currentPoints.image,t=this.handles.points;if(!t.length)return m.warn("Something went wrong, empty handles detected."),null;t.push({x:image.x,y:image.y,lines:[]}),this.currentHandle+=1,l.default.cornerstone.updateImage(element)}function w(e){var t=e.detail,element=e.detail.element;this._addPoint(t),l.default.cornerstone.updateImage(element)}function T(e){var t=this.handles.points,element=e.detail.element,n=y.labelmap2D(element),r=n.labelmap2D,o=n.labelmap3D,c=n.currentImageIdIndex,d=r.pixelData,f=d.slice(),m={points:t,pixelData:d,segmentIndex:o.activeSegmentIndex,segmentationMixinType:"freehandSegmentationMixin"};this.applyActiveStrategy(e,m);var v={imageIdIndex:c,diff:Object(h.getDiffBetweenPixelData)(f,d)};x.pushState(this.element,[v]),x.updateSegmentsOnLabelmap2D(r),l.default.cornerstone.updateImage(element),this._resetHandles()}function E(){this.handles={points:[]},this.currentHandle=0}t.default={postTouchStartCallback:j,postMouseDownCallback:j,mouseClickCallback:j,touchDragCallback:w,mouseDragCallback:w,mouseMoveCallback:w,touchEndCallback:T,mouseUpCallback:T,initializeMixin:E,renderToolData:function(e){var t=e.detail,element=t.element,n=y.brushColor(element,!0),r=Object(f.getNewContext)(t.canvasContext.canvas),l=this.handles.points;l.length<2||Object(f.draw)(r,(function(e){for(var t=0;t<l.length;t++){var r=o()(l[t].lines);t===l.length-1&&r.push(l[0]),Object(f.drawJoinedLines)(e,element,l[t],r,{color:n})}}))},_resetHandles:E,_addPoint:function(e){var t=this.handles.points;t.length&&t[this.currentHandle-1].lines.push({x:e.currentPoints.image.x,y:e.currentPoints.image.y,lines:[]}),t.push({x:e.currentPoints.image.x,y:e.currentPoints.image.y,lines:[]}),this.currentHandle+=1,l.default.cornerstone.updateImage(e.element)},_applyStrategy:T}},"./mixins/segmentation/polylineSegmentationMixin.js":function(e,t,n){"use strict";n.r(t);var r=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(r),l=n("./drawing/index.js"),c=n("./store/index.js"),d=n("./mixins/segmentation/freehandSegmentationMixin.js"),f=Object(c.getModule)("segmentation").getters,h=Object.assign({},d.default,{renderToolData:function(e){var t=this,n=e.detail,element=n.element,r=f.brushColor(element,!0),c=Object(l.getNewContext)(n.canvasContext.canvas),d=this.handles;Object(l.draw)(c,(function(e){if(d.points.length>1)for(var n=0;n<d.points.length;n++){var c=o()(d.points[n].lines);Object(l.drawJoinedLines)(e,element,t.handles.points[n],c,{color:r})}}))}});t.default=h},"./mixins/segmentation/rectangleSegmentationMixin.js":function(e,t,n){"use strict";n.r(t);var r=n("./drawing/index.js"),o=n("./externalModules.js"),l=n("./util/isEmptyObject.js"),c=n("./store/index.js"),d=n("./util/segmentation/index.js"),f=Object(c.getModule)("segmentation"),h=f.getters,m=f.setters;function v(e){var element=e.detail.element,image=e.detail.currentPoints.image;return Object(l.default)(this.handles.start)?this.handles.start=image:(this.handles.end=image,this._applyStrategy(e)),o.default.cornerstone.updateImage(element),!0}function y(e){var t=e.detail,element=t.element,image=t.currentPoints.image;this.handles.end=image,o.default.cornerstone.updateImage(element)}function x(e){e.detail.handles=this.handles;var element=e.detail.element,t=h.labelmap2D(element),n=t.labelmap2D,r=t.labelmap3D,l=t.currentImageIdIndex,c=n.pixelData,f=c.slice(),v={points:[{x:this.handles.start.x,y:this.handles.start.y},{x:this.handles.end.x,y:this.handles.end.y}],pixelData:c,segmentIndex:r.activeSegmentIndex,segmentationMixinType:"rectangleSegmentationMixin"};this.applyActiveStrategy(e,v);var y={imageIdIndex:l,diff:Object(d.getDiffBetweenPixelData)(f,c)};m.pushState(this.element,[y]),m.updateSegmentsOnLabelmap2D(n),o.default.cornerstone.updateImage(element),this._resetHandles()}function j(){this.handles={start:{},end:{}}}t.default={postTouchStartCallback:v,postMouseDownCallback:v,mouseClickCallback:v,touchDragCallback:y,mouseDragCallback:y,mouseMoveCallback:y,touchEndCallback:x,mouseUpCallback:x,initializeMixin:j,renderToolData:function(e){var t=this,n=e.detail,element=n.element,o=h.brushColor(element,!0),l=Object(r.getNewContext)(n.canvasContext.canvas);Object(r.draw)(l,(function(e){Object(r.drawRect)(e,element,t.handles.start,t.handles.end,{color:o})}))},_resetHandles:j,_applyStrategy:x}},"./mixins/segmentation/renderBrushMixin.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./store/index.js");t.default={renderBrush:function(e){var t,n=r.default.cornerstone,l=Object(o.getModule)("segmentation"),c=l.getters,d=l.configuration,f=e.detail,h=f.viewport;if(this._drawing?t=this._lastImageCoords:this._mouseUpRender?(t=this._lastImageCoords,this._mouseUpRender=!1):t=o.default.state.mousePositionImage,t){var m=f.image,v=m.rows,y=m.columns,x=t,j=x.x,w=x.y;if(!(j<0||j>y||w<0||w>v)){var T=d.radius,E=f.canvasContext,element=f.element,O=c.brushColor(element,this._drawing);E.setTransform(1,0,0,1,0,0);var C=T*h.scale,S=n.pixelToCanvas(element,t);E.beginPath(),E.strokeStyle=O,E.ellipse(S.x,S.y,C,C,0,0,2*Math.PI),E.stroke()}}}}},"./orientation/getOrientationString.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./util/convertToVector3.js");t.default=function(e){for(var t=Object(o.default)(e),n="",l=t.x<0?"R":"L",c=t.y<0?"A":"P",d=t.z<0?"F":"H",f=new r.default.cornerstoneMath.Vector3(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z)),h=1e-4,i=0;i<3;i++)if(f.x>h&&f.x>f.y&&f.x>f.z)n+=l,f.x=0;else if(f.y>h&&f.y>f.x&&f.y>f.z)n+=c,f.y=0;else if(f.z>h&&f.z>f.x&&f.z>f.y)n+=d,f.z=0;else if(f.x>h&&f.y>h&&f.x===f.y)n+=l+c,f.x=0,f.y=0;else if(f.x>h&&f.z>h&&f.x===f.z)n+=l+d,f.x=0,f.z=0;else{if(!(f.y>h&&f.z>h&&f.y===f.z))break;n+=c+d,f.y=0,f.z=0}return n}},"./orientation/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./orientation/getOrientationString.js"),o=n("./orientation/invertOrientationString.js"),l={getOrientationString:r.default,invertOrientationString:o.default};t.default=l},"./orientation/invertOrientationString.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.replace("H","f");return t=(t=(t=(t=(t=(t=t.replace("F","h")).replace("R","l")).replace("L","r")).replace("A","p")).replace("P","a")).toUpperCase()}},"./stackTools/fusionRenderer.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("./externalModules.js"),f=n("./stateManagement/toolState.js"),h=function(){function e(){o()(this,e),this.currentImageIdIndex=0,this.layerIds=[],this.findImageFn=void 0}return c()(e,[{key:"render",value:function(element,e){var t=this;if(!Number.isInteger(this.currentImageIdIndex))throw new Error("FusionRenderer: render - Image ID Index is not an integer");if(!this.findImageFn)throw new Error("No findImage function has been defined");e||(e=Object(f.getToolState)(element,"stack").data);var n=d.default.cornerstone,r=e[0],o=r.imageIds[this.currentImageIdIndex],l=e.slice(1,e.length);n.loadAndCacheImage(o).then((function(e){var c=t.layerIds[0];c?n.setLayerImage(element,e,c):(c=n.addLayer(element,e,r.options),t.layerIds.push(c)),n.displayImage(element,e),l.forEach((function(e,r){var l=t.findImageFn(e.imageIds,o),d=r+1,f=t.layerIds[d];f||(f=n.addLayer(element,void 0,e.options),t.layerIds.push(f)),l?n.loadAndCacheImage(l).then((function(image){n.setLayerImage(element,image,f),n.updateImage(element)})):(n.setLayerImage(element,void 0,f),n.setActiveLayer(element,c),n.updateImage(element))}))}))}}]),e}()},"./stackTools/playClip.js":function(e,t,n){"use strict";n.r(t),n.d(t,"playClip",(function(){return m})),n.d(t,"stopClip",(function(){return v}));var r=n("./events.js"),o=n("./externalModules.js"),l=n("./stateManagement/loadHandlerManager.js"),c=n("./stateManagement/toolState.js"),d=n("./util/triggerEvent.js"),f="playClip";function h(e){var t=e.intervalId;void 0!==t&&(e.intervalId=void 0,e.usingFrameTimeVector?clearTimeout(t):clearInterval(t))}function m(element,e){var t,n;if(void 0===element)throw new Error("playClip: element must not be undefined");var m=Object(c.getToolState)(element,"stack");if(m&&m.data&&m.data.length){var v,y=o.default.cornerstone;if(m.data.length>1){var x=Object(c.getToolState)(element,"stackRenderer");x&&x.data&&x.data.length&&(v=x.data[0])}var j=m.data[0],w=Object(c.getToolState)(element,f);w&&w.data&&w.data.length?h(t=w.data[0]):(t={intervalId:void 0,framesPerSecond:30,lastFrameTimeStamp:void 0,frameRate:0,frameTimeVector:void 0,ignoreFrameTimeVector:!1,usingFrameTimeVector:!1,speed:1,reverse:!1,loop:!0},Object(c.addToolState)(element,f,t)),(e<0||e>0)&&(t.framesPerSecond=Number(e),t.reverse=t.framesPerSecond<0,t.ignoreFrameTimeVector=!0),!0!==t.ignoreFrameTimeVector&&t.frameTimeVector&&t.frameTimeVector.length===j.imageIds.length&&(n=function(e,t){var i,n,r,o=0,l=e.length,c=[];for(c.isTimeVarying=!1,("number"!=typeof t||t<=0)&&(t=1),i=1;i<l;i++)r=Number(e[i])/t|0,c.push(r),1===i?n=r:r!==n&&(c.isTimeVarying=!0),o+=r;return c.length>0&&(r=c.isTimeVarying?o/c.length|0:c[0],c.push(r)),c}(t.frameTimeVector,t.speed));var T=function(){var e,n,o,c=j.currentImageIdIndex,f=j.imageIds.length;if(t.reverse?c--:c++,!t.loop&&(c<0||c>=f))return h(t),void function(element){var e={element:element};Object(d.default)(element,r.default.CLIP_STOPPED,e)}(element);c>=f&&(c=0),c<0&&(c=f-1),c!==j.currentImageIdIndex&&(e=l.default.getStartLoadHandler(element),n=l.default.getEndLoadHandler(element),o=l.default.getErrorLoadingHandler(element),e&&e(element),(!0===j.preventCache?y.loadImage(j.imageIds[c]):y.loadAndCacheImage(j.imageIds[c])).then((function(image){try{j.currentImageIdIndex=c,v?(v.currentImageIdIndex=c,v.render(element,m.data)):y.displayImage(element,image),n&&n(element,image)}catch(e){return}}),(function(e){var t=j.imageIds[c];o&&o(element,t,e)})))};n&&n.length>0&&n.isTimeVarying?(t.usingFrameTimeVector=!0,t.intervalId=setTimeout((function e(){t.intervalId=setTimeout(e,n[j.currentImageIdIndex]),T()}),0)):(t.usingFrameTimeVector=!1,t.intervalId=setInterval(T,1e3/Math.abs(t.framesPerSecond)))}}function v(element){var e=Object(c.getToolState)(element,f);e&&e.data&&e.data.length&&h(e.data[0])}},"./stackTools/stackPrefetch.js":function(e,t,n){"use strict";n.r(t);var r,o=n("./externalModules.js"),l=n("./stateManagement/loadHandlerManager.js"),c=n("./stateManagement/toolState.js"),d=n("./util/logger.js"),f=(n("./util/triggerEvent.js"),n("./events.js"),Object(d.getLogger)("stackTools:stackPrefetch")),h="stackPrefetch",m="prefetch",v={maxImagesToPrefetch:1/0,preserveExistingPool:!1};function y(e,t){e=Math.round(e)||0;var n=[],r=(t=Math.round(t)||0)-e+1;if(r<=0)return n;for(;r--;)n[r]=t--;return n}function x(element){var e=Object(c.getToolState)(element,"stack");if(e&&e.data&&e.data.length){var t=e.data[0],n=Object(c.getToolState)(element,h);if(n){var r=n.data[0]||{};if(r.indicesToRequest&&r.indicesToRequest.length||(r.enabled=!1),!1!==r.enabled&&(n.data[0].indicesToRequest.sort((function(a,b){return a-b})),r.indicesToRequest.slice().forEach((function(e){var n=t.imageIds[e];n&&o.default.cornerstone.imageCache.getImageLoadObject(n)&&D(e)})),r.indicesToRequest.length)){v.preserveExistingPool||o.default.cornerstone.imageLoadPoolManager.clearRequestStack(m);for(var d,f,y,x,j,w,T,E=(d=r.indicesToRequest,f=t.currentImageIdIndex,y=0,x=d.length-1,d.forEach((function(e,t){e<f?y=Math.max(t,y):e>f&&(x=Math.min(t,x))})),{low:y,high:x}),O=(l.default.getErrorLoadingHandler(element),E.low),C=E.high,S=[];O>=0||C<r.indicesToRequest.length;){var I=t.currentImageIdIndex,M=!(I-r.indicesToRequest[O]>v.maxImagesToPrefetch)&&O>=0,P=!(r.indicesToRequest[C]-I>v.maxImagesToPrefetch)&&C<r.indicesToRequest.length;if(!P&&!M)break;M&&(w=r.indicesToRequest[O--],j=t.imageIds[w],S.push(j)),P&&(w=r.indicesToRequest[C++],j=t.imageIds[w],S.push(j))}var _={addToBeginning:!0,priority:0,requestType:m};T=function(e){return o.default.cornerstone.loadAndCacheImage(e,_)},S.reverse().forEach((function(e){o.default.cornerstone.imageLoadPoolManager.addRequest(T.bind(null,e),m,{imageId:e},0,!0)}))}}}function D(e){var t=r.indicesToRequest.indexOf(e);t>-1&&r.indicesToRequest.splice(t,1)}}function j(element){return function(e){var t,n=e.detail;try{t=Object(c.getToolState)(element,"stack")}catch(e){return}if(t&&t.data&&t.data.length){var r=t.data[0].imageIds.indexOf(n.imageId);if(!(r<0)){var o=Object(c.getToolState)(element,h);o&&o.data&&o.data.length&&o.data[0].indicesToRequest.push(r)}}}}function w(e){clearTimeout(r),r=setTimeout((function(){var element=e.target;try{x(element)}catch(e){return}}),10)}var T={enable:function(element){Object(c.getToolState)(element,h).data=[];var e=Object(c.getToolState)(element,"stack");if(e&&e.data&&e.data.length){var t=e.data[0];if(!0!==t.preventCache){var n={indicesToRequest:y(0,t.imageIds.length-1),enabled:!0,direction:1},r=n.indicesToRequest.indexOf(t.currentImageIdIndex);n.indicesToRequest.splice(r,1),Object(c.addToolState)(element,h,n),x(element),element.removeEventListener(o.default.cornerstone.EVENTS.NEW_IMAGE,w),element.addEventListener(o.default.cornerstone.EVENTS.NEW_IMAGE,w);var l=j(element);o.default.cornerstone.events.removeEventListener(o.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,l),o.default.cornerstone.events.addEventListener(o.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,l)}else f.warn("A stack that should not be cached was given the stackPrefetch")}},disable:function(element){clearTimeout(r),element.removeEventListener(o.default.cornerstone.EVENTS.NEW_IMAGE,w);var e=j(element);o.default.cornerstone.events.removeEventListener(o.default.cornerstone.EVENTS.IMAGE_CACHE_PROMISE_REMOVED,e);var t=Object(c.getToolState)(element,h);t&&t.data.length&&(t.data[0].enabled=!1,o.default.cornerstone.imageLoadPoolManager.clearRequestStack(m))},getConfiguration:function(){return v},setConfiguration:function(e){v=e}};t.default=T},"./stackTools/stackRenderers.js":function(e,t,n){"use strict";n.r(t);var r=n("./stackTools/fusionRenderer.js"),o={};o.FusionRenderer=r.default,t.default=o},"./stateManagement/frameOfReferenceStateManager.js":function(e,t,n){"use strict";function r(){var e={};return{get:function(t,n){if(!1!==e.hasOwnProperty(t)){var r=e[t];if(!1!==r.hasOwnProperty(n))return r[n]}},add:function(t,n,data){!1===e.hasOwnProperty(t)&&(e[t]={});var r=e[t];!1===r.hasOwnProperty(n)&&(r[n]={data:[]}),r[n].data.push(data)},remove:function(t,n,data){if(!1!==e.hasOwnProperty(t)){var r=e[t];if(!1!==r.hasOwnProperty(n)){for(var o=r[n],l=-1,i=0;i<o.data.length;i++)o.data[i]===data&&(l=i);-1!==l&&o.data.splice(l,1)}}}}}n.r(t),n.d(t,"newFrameOfReferenceSpecificToolStateManager",(function(){return r})),n.d(t,"globalFrameOfReferenceSpecificToolStateManager",(function(){return o}));var o=r()},"./stateManagement/imageIdSpecificStateManager.js":function(e,t,n){"use strict";n.r(t),n.d(t,"newImageIdSpecificToolStateManager",(function(){return o})),n.d(t,"globalImageIdSpecificToolStateManager",(function(){return l}));var r=n("./externalModules.js");function o(){var e={};function t(t,n,data){!1===e.hasOwnProperty(t)&&(e[t]={});var r=e[t];!1===r.hasOwnProperty(n)&&(r[n]={data:[]}),r[n].data.push(data)}function n(t,n){if(!1!==e.hasOwnProperty(t)){var r=e[t];if(!1!==r.hasOwnProperty(n))return r[n]}}function o(t,n,data){e[t][n]=data}function l(t){!1!==e.hasOwnProperty(t)&&delete e[t]}return{get:function(element,e){var t=r.default.cornerstone.getEnabledElement(element);if(t.image)return n(t.image.imageId,e)},add:function(element,e,data){var n=r.default.cornerstone.getEnabledElement(element);n.image&&t(n.image.imageId,e,data)},set:function(element,e,data){var t=r.default.cornerstone.getEnabledElement(element);t.image&&o(t.image.imageId,e,data)},clear:function(element){var e=r.default.cornerstone.getEnabledElement(element);e.image&&l(e.image.imageId)},getImageIdToolState:n,addImageIdToolState:t,setImageIdToolState:o,clearImageIdToolState:l,saveImageIdToolState:function(t){return e[t]},restoreImageIdToolState:function(t,n){e[t]=n},saveToolState:function(){return e},restoreToolState:function(t){e=t},toolState:e}}var l=o()},"./stateManagement/loadHandlerManager.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o="DEFAULT",l={},c={},d={};function f(element){if(!element)return o;var e=r.default.cornerstone.getEnabledElement(element).uuid;if(!e)throw new Error("Something went wrong when getting uuid from element");return e}var h={setStartLoadHandler:function(e){var element=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!e)throw new Error("The Handler function must be defined");var t=f(element);l[t]=e},getStartLoadHandler:function(element){var e=f(element);return l[e]||l.DEFAULT},setEndLoadHandler:function(e){var element=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!e)throw new Error("The Handler function must be defined");var t=f(element);c[t]=e},getEndLoadHandler:function(element){var e=f(element);return c[e]||c.DEFAULT},setErrorLoadingHandler:function(e){var element=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(!e)throw new Error("The Handler function must be defined");var t=f(element);d[t]=e},getErrorLoadingHandler:function(element){var e=f(element);return d[e]||d.DEFAULT},removeHandlers:function(element){var e=f(element);delete l[e],delete c[e],delete d[e]}};t.default=h},"./stateManagement/stackSpecificStateManager.js":function(e,t,n){"use strict";n.r(t),n.d(t,"stackSpecificStateManager",(function(){return f})),n.d(t,"newStackSpecificToolStateManager",(function(){return l})),n.d(t,"addStackStateManager",(function(){return d}));var r=n("./stateManagement/imageIdSpecificStateManager.js"),o=n("./stateManagement/toolState.js");function l(e,t){var n={};return{get:function(element,r){return e.indexOf(r)>=0?(!1===n.hasOwnProperty(r)&&(n[r]={data:[]}),n[r]):t.get(element,r)},add:function(element,r,data){if(!(e.indexOf(r)>=0))return t.add(element,r,data);!1===n.hasOwnProperty(r)&&(n[r]={data:[]}),n[r].data.push(data)},saveToolState:function(){return n},restoreToolState:function(e){n=e},toolState:n}}var c=[];function d(element,e){var t=Object(o.getElementToolStateManager)(element);t||(t=r.globalImageIdSpecificToolStateManager);var n=["stack","stackPrefetch","playClip","volume","slab","referenceLines","crosshairs","stackRenderer"];e&&(n=n.concat(e));var d=l(n,t);c.push(d),Object(o.setElementToolStateManager)(element,d)}var f={newStackSpecificToolStateManager:l,addStackStateManager:d}},"./stateManagement/textStyle.js":function(e,t,n){"use strict";n.r(t);var r={fontSize:15,fontFamily:"Arial",backgroundColor:"transparent"};function o(e){if("string"!=typeof e)throw new Error("Font family must be a valid string");r.fontFamily=e}function l(e){if("number"!=typeof e||isNaN(e)||!isFinite(e))throw new Error("Font size must be a valid number");r.fontSize=parseFloat(e)}var c={setFont:function(e){var t=e.split("px ");2===t.length&&(l(parseFloat(t[0])),o(t[1]))},getFont:function(){return"".concat(r.fontSize,"px ").concat(r.fontFamily)},setFontSize:l,getFontSize:function(){return r.fontSize},setFontFamily:o,getFontFamily:function(){return r.fontFamily},setBackgroundColor:function(e){r.backgroundColor=e},getBackgroundColor:function(){return r.backgroundColor}};t.default=c},"./stateManagement/toolColors.js":function(e,t,n){"use strict";n.r(t);var r="white",o="greenyellow",l="transparent",c={setFillColor:function(e){l=e},getFillColor:function(){return l},setToolColor:function(e){r=e},getToolColor:function(){return r},setActiveColor:function(e){o=e},getActiveColor:function(){return o},getColorIfActive:function(data){return data.color?data.color:data.active?o:r}};t.default=c},"./stateManagement/toolCoordinates.js":function(e,t,n){"use strict";var r;n.r(t);var o={setCoords:function(e){r=e.currentPoints.canvas},getCoords:function(){return r}};t.default=o},"./stateManagement/toolState.js":function(e,t,n){"use strict";n.r(t),n.d(t,"addToolState",(function(){return h})),n.d(t,"getToolState",(function(){return m})),n.d(t,"removeToolState",(function(){return v})),n.d(t,"clearToolState",(function(){return y})),n.d(t,"setElementToolStateManager",(function(){return x})),n.d(t,"getElementToolStateManager",(function(){return f}));var r=n("./events.js"),o=n("./externalModules.js"),l=n("./stateManagement/imageIdSpecificStateManager.js"),c=n("./util/triggerEvent.js"),d=n("./util/uuidv4.js");function f(element){var e=o.default.cornerstone.getEnabledElement(element);return void 0===e.toolStateManager&&(e.toolStateManager=l.globalImageIdSpecificToolStateManager),e.toolStateManager}function h(element,e,t){var n=f(element);t.uuid=t.uuid||Object(d.default)(),n.add(element,e,t);var o=r.default.MEASUREMENT_ADDED,l={toolName:e,toolType:e,element:element,measurementData:t};Object(c.default)(element,o,l)}function m(element,e){return f(element).get(element,e)}function v(element,e,data){var t=f(element).get(element,e);if(t&&t.data&&t.data.length){for(var n=-1,i=0;i<t.data.length;i++)t.data[i]===data&&(n=i);if(-1!==n){t.data.splice(n,1);var o=r.default.MEASUREMENT_REMOVED,l={toolName:e,toolType:e,element:element,measurementData:data};Object(c.default)(element,o,l)}}}function y(element,e){var t=f(element).get(element,e);void 0!==t&&(t.data=[])}function x(element,e){o.default.cornerstone.getEnabledElement(element).toolStateManager=e}},"./stateManagement/toolStyle.js":function(e,t,n){"use strict";n.r(t);var r=1,o=2,l={setToolWidth:function(e){r=e},getToolWidth:function(){return r},setActiveWidth:function(e){o=e},getActiveWidth:function(){return o}};t.default=l},"./store/addTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"addTool",(function(){return f})),n.d(t,"addToolForElement",(function(){return d}));var r=n("./store/index.js"),o=n("./store/getToolForElement.js"),l=n("./util/logger.js"),c=Object(l.getLogger)("addTool"),d=function(element,e,t){var n=new e(t);Object(o.default)(element,n.name)?c.warn("%s has already been added to the target element",n.name):(n.element=element,r.default.state.tools.push(n))},f=function(e,t){h(e,t),r.default.state.enabledElements.forEach((function(element){d(element,e,t)}))},h=function(e,t){if(Object(r.getModule)("globalConfiguration").configuration.globalToolSyncEnabled){var n=new e(t);void 0!==r.default.state.globalTools[n.name]?c.warn("%s has already been added globally",n.name):r.default.state.globalTools[n.name]={tool:e,props:t,activeBindings:[]}}}},"./store/filterToolsUsableWithMultiPartTools.js":function(e,t,n){"use strict";n.r(t);var r=n("./tools/base/BaseAnnotationTool.js"),o=n("./tools/base/BaseBrushTool.js");t.default=function(e){return e.filter((function(e){return!(e.isMultiPartTool||e instanceof r.default||e instanceof o.default)}))}},"./store/getActiveToolsForElement.js":function(e,t,n){"use strict";n.r(t),t.default=function(element,e,t){return e.filter((function(e){return e.element===element&&"active"===e.mode&&(void 0===t||e.options["is".concat(t,"Active")])}))}},"./store/getInteractiveToolsForElement.js":function(e,t,n){"use strict";n.r(t),t.default=function(element,e){return e.filter((function(e){return e.element===element&&("active"===e.mode||"passive"===e.mode)}))}},"./store/getToolForElement.js":function(e,t,n){"use strict";n.r(t);var r=n("./store/index.js");t.default=function(element,e){return r.state.tools.find((function(t){return t.element===element&&t.name===e}))}},"./store/getToolsWithDataForElement.js":function(e,t,n){"use strict";n.r(t);var r=n("./stateManagement/toolState.js");t.default=function(element,e){return e.filter((function(e){var t=Object(r.getToolState)(element,e.name);return t&&t.data.length>0}))}},"./store/getToolsWithMoveableHandles.js":function(e,t,n){"use strict";n.r(t);var r=n("./stateManagement/toolState.js"),o=n("./manipulators/getHandleNearImagePoint.js"),l=n("./util/getProximityThreshold.js");t.default=function(element,e,t){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse";return e.filter((function(e){for(var c=Object(l.default)(n,e.name),d=Object(r.getToolState)(element,e.name),i=0;i<d.data.length;i++)if(void 0!==Object(o.default)(element,d.data[i].handles,t,c))return!0;return!1}))}},"./store/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"state",(function(){return h})),n.d(t,"getters",(function(){return m})),n.d(t,"modules",(function(){return v})),n.d(t,"getModule",(function(){return y}));var r=n("./store/modules/segmentationModule/index.js"),o=n("./store/modules/manipulatorStateModule.js"),l=n("./store/modules/cursorModule.js"),c=n("./store/modules/globalConfigurationModule.js"),d=n("./externalModules.js"),f=n("./util/logger.js"),h=(Object(f.getLogger)("store:modules:storeLogger"),{globalTools:{},globalToolChangeHistory:[],enabledElements:[],tools:[],isToolLocked:!1,activeMultiPartTool:null,mousePositionImage:{},clickProximity:6,touchProximity:10,handleRadius:6,deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1,preventTextBoxOutsideDisplayedArea:!1,handleTouchOffset:{x:0,y:-57},svgCursorUrl:null}),m={mouseTools:function(){return h.tools.filter((function(e){return e.supportedInteractionTypes.includes("Mouse")}))},touchTools:function(){return h.tools.filter((function(e){return e.supportedInteractionTypes.includes("Touch")}))},enabledElementByUID:function(e){return h.enabledElements.find((function(element){return d.default.cornerstone.getEnabledElement(element).uuid===e}))}},v={segmentation:r.default,cursor:l.default,globalConfiguration:c.default,manipulatorState:o.default};function y(e){return v[e]}t.default={modules:v,state:h,getters:m}},"./store/internals/addEnabledElement.js":function(e,t,n){"use strict";n.r(t);var r=n("./eventListeners/index.js"),o=n("./eventDispatchers/index.js"),l=n("./store/addTool.js"),c=n("./store/setToolMode.js"),d=n("./store/index.js"),f=n("./util/logger.js"),h=Object(f.getLogger)("internals:addEnabledElement");t.default=function(e){h.log("EVENT:ELEMENT_ENABLED");var t=e.detail.element;o.imageRenderedEventDispatcher.enable(t),o.newImageEventDispatcher.enable(t);var n=Object(d.getModule)("globalConfiguration").configuration;n.mouseEnabled&&(r.mouseEventListeners.enable(t),r.wheelEventListener.enable(t),o.mouseToolEventDispatcher.enable(t)),n.touchEnabled&&(r.touchEventListeners.enable(t),o.touchToolEventDispatcher.enable(t)),m(t)};var m=function(e){d.default.state.enabledElements.push(e),d.default.modules&&function(e){var t=d.default.modules;Object.keys(t).forEach((function(n){"function"==typeof t[n].enabledElementCallback&&t[n].enabledElementCallback(e)}))}(e),function(e){Object(d.getModule)("globalConfiguration").configuration.globalToolSyncEnabled&&Object.keys(d.default.state.globalTools).forEach((function(t){var n=d.default.state.globalTools[t],r=n.tool,o=n.props;Object(l.addToolForElement)(e,r,o)}))}(e),function(e){if(Object(d.getModule)("globalConfiguration").configuration.globalToolSyncEnabled){var t={active:c.setToolActiveForElement,passive:c.setToolPassiveForElement,enabled:c.setToolEnabledForElement,disabled:c.setToolDisabledForElement};d.default.state.globalToolChangeHistory.forEach((function(n){var r=n.args.slice(0);r.unshift(e),t[n.mode].apply(null,r)}))}}(e)}},"./store/internals/removeEnabledElement.js":function(e,t,n){"use strict";n.r(t);var r=n("./eventListeners/index.js"),o=n("./eventDispatchers/index.js"),l=n("./store/index.js"),c=n("./util/logger.js"),d=n("./stateManagement/loadHandlerManager.js"),f=n("./store/setToolMode.js"),h=Object(c.getLogger)("internals:removeEnabledElement");t.default=function(e){h.log("EVENT:ELEMENT_DISABLED");var t=e.detail.element,n=Object(l.getModule)("globalConfiguration").configuration;o.imageRenderedEventDispatcher.disable(t),o.newImageEventDispatcher.disable(t),n.mouseEnabled&&(r.mouseEventListeners.disable(t),r.wheelEventListener.disable(t),o.mouseToolEventDispatcher.disable(t)),n.touchEnabled&&(r.touchEventListeners.disable(t),o.touchToolEventDispatcher.disable(t)),m(t),v(t),y(t)};var m=function(e){l.default.state.tools.forEach((function(t){t.element===e&&Object(f.setToolDisabledForElement)(t.element,t.name)})),l.default.state.tools=l.default.state.tools.filter((function(t){return t.element!==e}))},v=function(e){l.default.modules&&function(e){var t=l.default.modules;Object.keys(t).forEach((function(n){"function"==typeof t[n].removeEnabledElementCallback&&t[n].removeEnabledElementCallback(e)}))}(e);var t=l.default.state.enabledElements.findIndex((function(element){return element===e}));t>-1?l.default.state.enabledElements.splice(t,1):h.warn("unable to remove element")},y=function(element){d.default.removeHandlers(element)}},"./store/isToolActiveForElement.js":function(e,t,n){"use strict";n.r(t);var r=n("./store/getToolForElement.js");t.default=function(element,e){return"active"===Object(r.default)(element,e).mode}},"./store/modules/cursorModule.js":function(e,t,n){"use strict";n.r(t),n("./externalModules.js");var r={iconSize:16,viewBox:{x:16,y:16},mousePoint:{x:8,y:8},mousePointerGroupString:'\n    <path stroke="ACTIVE_COLOR" d="M8 16L8 0"></path>\n    <path stroke="ACTIVE_COLOR" d="M16 8L0 8"></path>\n  '},o={defaultOptions:function(e){Object.assign(r,e)}},l={defaultOptions:function(){return r}};t.default={configuration:r,getters:l,setters:o}},"./store/modules/globalConfigurationModule.js":function(e,t,n){"use strict";n.r(t),t.default={configuration:{mouseEnabled:!0,touchEnabled:!0,globalToolSyncEnabled:!1,showSVGCursors:!1,autoResizeViewports:!0,lineDash:[4,4]}}},"./store/modules/manipulatorStateModule.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o={activeManipulators:{}};function l(element){var e=r.default.cornerstone.getEnabledElement(element).uuid;delete o.activeManipulators[e]}function c(e){var t=o.activeManipulators,n=t[e];"function"==typeof n&&n(),delete t[e]}function d(e){l(e.detail.element)}t.default={setters:{addActiveManipulatorForElement:function(element,e){var t=r.default.cornerstone.getEnabledElement(element).uuid;o.activeManipulators[t]=e},removeActiveManipulatorForElement:l,cancelActiveManipulatorsForElement:function(element){c(r.default.cornerstone.getEnabledElement(element).uuid)},cancelActiveManipulators:function(){var e=o.activeManipulators;Object.keys(e).forEach((function(e){return c(e)}))}},state:o,enabledElementCallback:function(element){var e=r.default.cornerstone.EVENTS.NEW_IMAGE;element.removeEventListener(e,d),element.addEventListener(e,d)},removeEnabledElementCallback:function(element){var e=r.default.cornerstone.EVENTS.NEW_IMAGE;element.removeEventListener(e,d),l(element)}}},"./store/modules/segmentationModule/activeLabelmapIndex.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getActiveLabelmapIndex",(function(){return f})),n.d(t,"setActiveLabelmapIndex",(function(){return h}));var r=n("./store/modules/segmentationModule/getElement.js"),o=n("./stateManagement/toolState.js"),l=n("./store/modules/segmentationModule/addLabelmap3D.js"),c=n("./store/modules/segmentationModule/state.js"),d=n("./externalModules.js");function f(e){var element=Object(r.default)(e);if(element){var t=Object(o.getToolState)(element,"stack").data[0].imageIds[0],n=c.default.series[t];if(n)return n.activeLabelmapIndex}}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,element=Object(r.default)(e);if(element){var n=d.default.cornerstone,f=Object(o.getToolState)(element,"stack"),h=f.data[0],m=n.getEnabledElement(element),v=m.image,y=v.rows,x=v.columns,j=h.imageIds.length,w=y*x*j,T=h.imageIds[0],E=c.default.series[T];E?(E.activeLabelmapIndex=t,E.labelmaps3D[t]||Object(l.default)(E,t,w)):(c.default.series[T]={activeLabelmapIndex:t,labelmaps3D:[]},E=c.default.series[T],Object(l.default)(E,t,w)),n.updateImage(element)}}},"./store/modules/segmentationModule/activeSegmentIndex.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getActiveSegmentIndex",(function(){return d})),n.d(t,"setActiveSegmentIndex",(function(){return f})),n.d(t,"incrementActiveSegmentIndex",(function(){return h})),n.d(t,"decrementActiveSegmentIndex",(function(){return m}));var r=n("./store/modules/segmentationModule/getElement.js"),o=n("./stateManagement/toolState.js"),l=n("./store/modules/segmentationModule/state.js"),c=n("./store/index.js");function d(e,t){var element=Object(r.default)(e);if(element){var n=Object(o.getToolState)(element,"stack").data[0].imageIds[0],c=l.default.series[n];if(c){t=void 0===t?c.activeLabelmapIndex:t;var d=c.labelmaps3D[t];if(d)return d.activeSegmentIndex}return 1}}function f(e,t){var element=Object(r.default)(e);if(element){var n=Object(o.getToolState)(element,"stack").data[0].imageIds[0],d=l.default.series[n];if(d){var f=d.activeLabelmapIndex,h=d.labelmaps3D[f],m=Object(c.getModule)("segmentation").configuration;t<=0?t=1:t>m.segmentsPerLabelmap&&(t=m.segmentsPerLabelmap),h.activeSegmentIndex=t}}}function h(e){var element=Object(r.default)(e);element&&v(element,"increase")}function m(e){var element=Object(r.default)(e);element&&v(element,"decrease")}function v(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"increase",t=Object(c.getModule)("segmentation"),n=t.configuration,r=Object(o.getToolState)(element,"stack"),d=r.data[0],f=d.imageIds[0],h=l.default.series[f];if(h){var m=h.activeLabelmapIndex,v=h.labelmaps3D[m];switch(e){case"increase":v.activeSegmentIndex++,v.activeSegmentIndex>n.segmentsPerLabelmap&&(v.activeSegmentIndex=1);break;case"decrease":v.activeSegmentIndex--,v.activeSegmentIndex<=0&&(v.activeSegmentIndex=n.segmentsPerLabelmap)}}}},"./store/modules/segmentationModule/addLabelmap2D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return d}));var r=n("./store/modules/segmentationModule/arrayTypes.js"),o=n("./store/index.js"),l=r.default.UINT_16_ARRAY,c=r.default.FLOAT_32_ARRAY;function d(e,t,n,r,d){var f,h=Object(o.getModule)("segmentation").configuration,m=r*d,v=m*n;switch(h.arrayType){case l:f=new Uint16Array(e.labelmaps3D[t].buffer,2*v,m);break;case c:f=new Float32Array(e.labelmaps3D[t].buffer,4*v,m);break;default:throw new Error("Unsupported Array Type ".concat(h.arrayType))}e.labelmaps3D[t].labelmaps2D[n]={pixelData:f,segmentsOnLabelmap:[]}}},"./store/modules/segmentationModule/addLabelmap3D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return d}));var r=n("./store/modules/segmentationModule/arrayTypes.js"),o=n("./store/index.js"),l=r.default.UINT_16_ARRAY,c=r.default.FLOAT_32_ARRAY;function d(e,t,n){var r,d=Object(o.getModule)("segmentation").configuration;switch(d.arrayType){case l:r=2;break;case c:r=4;break;default:throw new Error("Unsupported Array Type ".concat(d.arrayType))}e.labelmaps3D[t]={buffer:new ArrayBuffer(n*r),labelmaps2D:[],metadata:[],activeSegmentIndex:1,colorLUTIndex:0,segmentsHidden:[],undo:[],redo:[]}}},"./store/modules/segmentationModule/arrayTypes.js":function(e,t,n){"use strict";n.r(t),t.default={UINT_16_ARRAY:0,FLOAT_32_ARRAY:1}},"./store/modules/segmentationModule/colorLUT.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h})),n.d(t,"setColorLUTIndexForLabelmap3D",(function(){return m})),n.d(t,"getColorForSegmentIndexColorLUT",(function(){return v})),n.d(t,"setColorForSegmentIndexOfColorLUT",(function(){return y})),n.d(t,"getColorLUT",(function(){return x}));var r=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(r),l=n("./util/logger.js"),c=n("./store/modules/segmentationModule/state.js"),d=n("./store/index.js"),f=Object(l.getLogger)("store:modules:segmentationModule:setColorLUT");function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Object(d.getModule)("segmentation"),r=n.configuration,l=r.segmentsPerLabelmap;t?(j(t,l),t.length<l&&(t=[].concat(o()(t),o()(w(l-t.length))))):t=t||w(l),t.unshift([0,0,0,0]),c.default.colorLutTables[e]=t}function m(e,t){e.colorLUTIndex=t}function v(e,t){return x(e)[t]}function y(e,t,n){x(e)[t]=n}function x(e){return"number"==typeof e?c.default.colorLutTables[e]:c.default.colorLutTables[e.colorLUTIndex]}function j(e,t){e.length<t?f.warn("The provided colorLUT only provides ".concat(e.length," labels, whereas segmentsPerLabelmap is set to ").concat(t,". Autogenerating the rest.")):e.length>t&&f.warn("segmentsPerLabelmap is set to ".concat(t,", and the provided colorLUT provides ").concat(e.length,". Using the first ").concat(t," colors from the LUT."))}function w(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:255,t=[],i=0;i<e;i++)t.push(S(E(),C()));return t}var T=222.5;function E(){return(T+=137.5)>=360&&(T-=360),T}var O=.6;function C(){return(O+=.07)>.82&&(O=O-.82+.3),O}function S(e){var t,g,b,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.6,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255,o=(1-Math.abs(2*n-1))*s,l=o*(1-Math.abs(e/60%2-1)),c=n-o/2;return e<60?(t=o,g=l,b=0):e<120?(t=l,g=o,b=0):e<180?(t=0,g=o,b=l):e<240?(t=0,g=l,b=o):e<300?(t=l,g=0,b=o):e<360&&(t=o,g=0,b=l),[255*(t+c),255*(g+c),255*(b+c),r]}},"./store/modules/segmentationModule/defaultConfiguration.js":function(e,t,n){"use strict";n.r(t);var r={renderOutline:!0,renderFill:!0,shouldRenderInactiveLabelmaps:!0,radius:10,minRadius:1,maxRadius:50,fillAlpha:.2,fillAlphaInactive:.1,outlineAlpha:.7,outlineAlphaInactive:.35,outlineWidth:3,storeHistory:!0,segmentsPerLabelmap:65535,arrayType:n("./store/modules/segmentationModule/arrayTypes.js").default.UINT_16_ARRAY};t.default=r},"./store/modules/segmentationModule/deleteSegment.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return d}));var r=n("./store/modules/segmentationModule/getElement.js"),o=n("./stateManagement/toolState.js"),l=n("./store/modules/segmentationModule/state.js"),c=n("./externalModules.js");function d(e,t,n){if(t){var element=Object(r.default)(e);if(element){var d=Object(o.getToolState)(element,"stack").data[0].imageIds[0],f=l.default.series[d];if(f){n=void 0===n?f.activeLabelmapIndex:n;var h=f.labelmaps3D[n];if(h){delete h.metadata[t];for(var m=h.labelmaps2D,i=0;i<m.length;i++){var v=m[i];if(v&&v.segmentsOnLabelmap.includes(t)){var y=v.pixelData,x=v.segmentsOnLabelmap.indexOf(t);v.segmentsOnLabelmap.splice(x,1);for(var p=0;p<y.length;p++)y[p]===t&&(y[p]=0)}}c.default.cornerstone.updateImage(element)}}}}}},"./store/modules/segmentationModule/getBrushColor.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return f}));var r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/state.js"),l=n("./store/modules/segmentationModule/getElement.js"),c=n("./util/logger.js"),d=Object(c.getLogger)("store:modules:segmentationModule:getBrushColor");function f(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],element=Object(l.default)(e);if(element){var n=Object(r.getToolState)(element,"stack");if(n){var c,f=n.data[0],h=f.imageIds[0],m=o.default.series[h];if(m){var v=m.activeLabelmapIndex,y=m.labelmaps3D[v],x=y.activeSegmentIndex;c=o.default.colorLutTables[y.colorLUTIndex][x]}else c=o.default.colorLutTables[0][1];return t?"rgba(".concat(c[0],", ").concat(c[1],", ").concat(c[2],", 1.0 )"):"rgba(".concat(c[0],", ").concat(c[1],", ").concat(c[2],", 0.8 )")}d.error("Consumers must define stacks in their application if using segmentations in cornerstoneTools.")}}},"./store/modules/segmentationModule/getElement.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n("./store/index.js");function o(e){return e instanceof HTMLElement?e:r.getters.enabledElementByUID(e)}},"./store/modules/segmentationModule/getLabelmap2D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return T})),n.d(t,"getLabelmap2DByImageIdIndex",(function(){return E}));var r=n("./store/modules/segmentationModule/getElement.js"),o=n("./stateManagement/toolState.js"),l=n("./store/modules/segmentationModule/getSegmentsOnPixeldata.js"),c=n("./store/modules/segmentationModule/addLabelmap3D.js"),d=n("./store/modules/segmentationModule/addLabelmap2D.js"),f=n("./externalModules.js"),h=n("./store/modules/segmentationModule/state.js"),m=n("./store/modules/segmentationModule/arrayTypes.js"),v=n("./store/index.js"),y=n("./util/logger.js"),x=m.default.UINT_16_ARRAY,j=m.default.FLOAT_32_ARRAY,w=Object(y.getLogger)("store:modules:segmentationModule:getLabelmap2D");function T(e){var element=Object(r.default)(e);if(element){var t=f.default.cornerstone,n=Object(o.getToolState)(element,"stack");if(n){var l,m=n.data[0],v=t.getEnabledElement(element),y=m.currentImageIdIndex,x=v.image,j=x.rows,T=x.columns,E=m.imageIds.length,O=m.imageIds[0],C=h.default.series[O];if(C){if(l=C.activeLabelmapIndex,!C.labelmaps3D[l]){var S=j*T*E;Object(c.default)(C,l,S)}C.labelmaps3D[l].labelmaps2D[y]||Object(d.default)(C,l,y,j,T)}else{l=0,h.default.series[O]={activeLabelmapIndex:l,labelmaps3D:[]},C=h.default.series[O];var I=j*T*E;Object(c.default)(C,l,I),Object(d.default)(C,l,y,j,T)}var M=C.labelmaps3D[l];return{labelmap2D:M.labelmaps2D[y],labelmap3D:M,currentImageIdIndex:y,activeLabelmapIndex:l}}w.error("Consumers must define stacks in their application if using segmentations in cornerstoneTools.")}}function E(e,t,n,r){if(!e.labelmaps2D[t]){var o,c=Object(v.getModule)("segmentation").configuration,d=n*r,f=d*t;switch(c.arrayType){case x:o=new Uint16Array(e.buffer,2*f,d);break;case j:o=new Float32Array(e.buffer,4*f,d);break;default:throw new Error("Unsupported Array Type ".concat(c.arrayType))}e.labelmaps2D[t]={pixelData:o,segmentsOnLabelmap:Object(l.default)(o)}}return e.labelmaps2D[t]}},"./store/modules/segmentationModule/getLabelmapBuffers.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getLabelmapBuffers",(function(){return v})),n.d(t,"getActiveLabelmapBuffer",(function(){return y}));var r=n("./store/modules/segmentationModule/getElement.js"),o=n("./stateManagement/toolState.js"),l=n("./store/modules/segmentationModule/getLabelmaps3D.js"),c=n("./store/modules/segmentationModule/state.js"),d=n("./store/modules/segmentationModule/arrayTypes.js"),f=n("./store/index.js"),h=d.default.UINT_16_ARRAY,m=d.default.FLOAT_32_ARRAY;function v(e,t){var element=Object(r.default)(e);if(element){var n=Object(l.default)(element).labelmaps3D;if(!n)return[];var o,d,v=Object(f.getModule)("segmentation").configuration;switch(v.arrayType){case h:o="Uint16Array",d="2";break;case m:o="Float32Array",d="4";break;default:throw new Error("Unsupported Array Type ".concat(v.arrayType))}var y=c.default.colorLutTables;if(void 0!==t){var x=n[t];return x?{labelmapIndex:t,bytesPerVoxel:d,type:o,buffer:x.buffer,colorLUT:y[x.colorLUTIndex]}:void 0}for(var j=[],i=0;i<n.length;i++){var w=n[i];w&&j.push({labelmapIndex:i,bytesPerVoxel:2,buffer:w.buffer,colorLUT:y[w.colorLUTIndex]})}return j}}function y(e){var element=Object(r.default)(e);if(element){var t=Object(o.getToolState)(element,"stack").data[0].imageIds[0],n=c.default.series[t];if(n)return v(element,n.activeLabelmapIndex)}}},"./store/modules/segmentationModule/getLabelmapStats.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h})),n.d(t,"_calculateLabelmapStats",(function(){return m}));var r=n("./store/modules/segmentationModule/getElement.js"),o=n("./stateManagement/toolState.js"),l=n("./store/modules/segmentationModule/state.js"),c=n("./externalModules.js"),d=n("./util/logger.js"),f=Object(d.getLogger)("store:modules:segmentationModule:getLabelmapStats");function h(e,t,n){var d=c.default.cornerstone,element=Object(r.default)(e);if(!element)return null;var h=Object(o.getToolState)(element,"stack").data[0].imageIds,v=h[0];return new Promise((function(e){var r=l.default.series[v];r||e(null);var o=function(e){for(var t=[],n=c.default.cornerstone.metaData,r=!0,i=0;i<e.length;i++){var o=n.get("imagePlaneModule",e[i]);if(!o){r=!1;break}t.push(o)}return{sufficientMetadata:r,imagePlanes:t}}(h),y=o.sufficientMetadata,x=o.imagePlanes;y||(f.warn("Insufficient imagePlaneModule information to calculate volume statistics."),e(null)),n=void 0===n?r.activeLabelmapIndex:n;for(var j=r.labelmaps3D[n],w=[],i=0;i<h.length;i++)w.push(d.loadAndCacheImage(h[i]));Promise.all(w).then((function(n){var r=m(j,n,x,t);e(r)}))}))}function m(e,t,n,r){for(var o=function(e,t,n,r){for(var o=t[0],l=o.rowPixelSpacing,c=o.columnPixelSpacing,d=e.labelmaps2D,f=[],i=0;i<d.length;i++){var h=d[i];if(h&&h.segmentsOnLabelmap.includes(r)){for(var m=v(t,n,i)*l*c,y=h.pixelData,x=t[i].getPixelData(),j=[],p=0;p<y.length;p++)y[p]===r&&j.push(x[p]);f.push({voxelInMM3:m,values:j})}}return f}(e,t,n,r),l=0,c=o[0].values[0],d=c,f=0,i=0;i<o.length;i++){var h=o[i],m=h.values;f+=(T=h.voxelInMM3)*m.length;var y=0;m.forEach((function(e){e>c?c=e:e<d&&(d=e),y+=e})),l+=y*T}l/=f;for(var x=0,j=0;j<o.length;j++){var w=o[j],T=(m=w.values,w.voxelInMM3),E=0;m.forEach((function(e){E+=Math.pow(e-l,2)})),x+=E*T}return x/=f,x=Math.sqrt(x),{volume:f,mean:l,stdDev:x,max:c,min:d}}function v(e,t,n){var r=e.length,o=t[n].imagePositionPatient;if(0===n)return y(o,t[n+1].imagePositionPatient);if(n===r-1)return y(o,t[n-1].imagePositionPatient);var l=t[n-1].imagePositionPatient,c=t[n+1].imagePositionPatient;return(y(o,l)+y(o,c))/2}function y(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))}},"./store/modules/segmentationModule/getLabelmaps3D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return f})),n.d(t,"getLabelmap3D",(function(){return h}));var r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/getElement.js"),l=n("./store/modules/segmentationModule/state.js"),c=n("./util/logger.js"),d=Object(c.getLogger)("store:modules:segmentationModule:getLabelmaps3D");function f(e){var element=Object(o.default)(e);if(element){var t=Object(r.getToolState)(element,"stack");if(t){var n,c,f=t.data[0],h=f.imageIds[0],m=l.default.series[h];return m&&(n=m.labelmaps3D,c=m.activeLabelmapIndex),{labelmaps3D:n,activeLabelmapIndex:c,currentImageIdIndex:f.currentImageIdIndex}}d.error("Consumers must define stacks in their application if using segmentations in cornerstoneTools.")}}function h(e,t){var n=f(e),r=n.labelmaps3D,o=n.activeLabelmapIndex;return r[t=void 0!==t?t:o]}},"./store/modules/segmentationModule/getSegmentOfActiveLabelmapAtEvent.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return f}));var r=n("./stateManagement/toolState.js"),o=n("./store/modules/segmentationModule/state.js"),l=n("./util/isPointInImage.js"),c=n("./util/logger.js"),d=Object(c.getLogger)("store:modules:segmentationModule:getSegmentOfActiveLabelmapAtEvent");function f(e){var t=e.detail,element=t.element,image=t.image,n=t.currentPoints;if(n){var c=image.width,f=image.height;if(element){var h=Object(r.getToolState)(element,"stack").data[0],m=h.currentImageIdIndex,v=h.imageIds[0],y=o.default.series[v],x=y.activeLabelmapIndex,j=y.labelmaps3D[x];if(j){var w=j.labelmaps2D[m];if(w){var T=w.pixelData,E=n.image,O=E.x,C=E.y;if(O=Math.floor(O),C=Math.floor(C),Object(l.default)({x:O,y:C},f,c)){var S=T[C*c+O];if(0===S)return;return{segmentIndex:S,metadata:j.metadata[S]}}}}}}else d.warn("Not a cornerstone input event.")}},"./store/modules/segmentationModule/getSegmentsOnPixeldata.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var r=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(r);function l(e){return o()(new Set(e))}},"./store/modules/segmentationModule/history.js":function(e,t,n){"use strict";n.r(t),n.d(t,"pushState",(function(){return d})),n.d(t,"undo",(function(){return f})),n.d(t,"redo",(function(){return h}));var r=n("./store/modules/segmentationModule/getLabelmaps3D.js"),o=n("./util/logger.js"),l=n("./externalModules.js"),c=Object(o.getLogger)("util:segmentation:labelmap3DHistory");function d(element,e,t){var n=Object(r.getLabelmap3D)(element,t);n.undo.push(e),n.redo=[]}function f(element,e){var t=Object(r.getLabelmap3D)(element,e),n=t.undo,o=t.redo;if(n.length){var d=n.pop();m(t,d,1),o.push(d),l.default.cornerstone.updateImage(element)}else c.warn("No undos left.")}function h(element,e){var t=Object(r.getLabelmap3D)(element,e),n=t.undo,o=t.redo;if(o.length){var d=o.pop();m(t,d,2),n.push(d),l.default.cornerstone.updateImage(element)}else c.warn("No redos left.")}function m(e,t,n){var r=e.labelmaps2D;t.forEach((function(e){for(var t=e.imageIdIndex,o=e.diff,l=r[t].pixelData,i=0;i<o.length;i++){var c=o[i];l[c[0]]=c[n]}}))}},"./store/modules/segmentationModule/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./store/modules/segmentationModule/metadata.js"),o=n("./store/modules/segmentationModule/activeLabelmapIndex.js"),l=n("./store/modules/segmentationModule/activeSegmentIndex.js"),c=n("./store/modules/segmentationModule/segmentVisibility.js"),d=n("./store/modules/segmentationModule/getLabelmapBuffers.js"),f=n("./store/modules/segmentationModule/setLabelmap3D.js"),h=n("./store/modules/segmentationModule/getLabelmapStats.js"),m=n("./store/modules/segmentationModule/getLabelmaps3D.js"),v=n("./store/modules/segmentationModule/getLabelmap2D.js"),y=n("./store/modules/segmentationModule/getSegmentOfActiveLabelmapAtEvent.js"),x=n("./store/modules/segmentationModule/colorLUT.js"),j=n("./store/modules/segmentationModule/getBrushColor.js"),w=n("./store/modules/segmentationModule/getSegmentsOnPixeldata.js"),T=n("./store/modules/segmentationModule/deleteSegment.js"),E=n("./store/modules/segmentationModule/state.js"),O=n("./store/modules/segmentationModule/defaultConfiguration.js"),C=n("./store/modules/segmentationModule/history.js"),S=n("./store/modules/segmentationModule/setRadius.js");t.default={state:E.default,configuration:O.default,onRegisterCallback:function(){Object(x.default)(0)},getters:{metadata:r.getMetadata,labelmap3D:m.getLabelmap3D,labelmaps3D:m.default,activeLabelmapIndex:o.getActiveLabelmapIndex,activeSegmentIndex:l.getActiveSegmentIndex,isSegmentVisible:c.isSegmentVisible,labelmap2D:v.default,labelmap2DByImageIdIndex:v.getLabelmap2DByImageIdIndex,labelmapStats:h.default,segmentOfActiveLabelmapAtEvent:y.default,brushColor:j.default,labelmapBuffers:d.getLabelmapBuffers,activeLabelmapBuffer:d.getActiveLabelmapBuffer,colorLUT:x.getColorLUT,colorForSegmentIndexColorLUT:x.getColorForSegmentIndexColorLUT},setters:{metadata:r.setMetadata,labelmap3DForElement:f.setLabelmap3DForElement,labelmap3DByFirstImageId:f.setLabelmap3DByFirstImageId,incrementActiveSegmentIndex:l.incrementActiveSegmentIndex,decrementActiveSegmentIndex:l.decrementActiveSegmentIndex,activeSegmentIndex:l.setActiveSegmentIndex,toggleSegmentVisibility:c.toggleSegmentVisibility,updateSegmentsOnLabelmap2D:function(e){e.segmentsOnLabelmap=Object(w.default)(e.pixelData)},deleteSegment:T.default,colorLUT:x.default,colorLUTIndexForLabelmap3D:x.setColorLUTIndexForLabelmap3D,colorForSegmentIndexOfColorLUT:x.setColorForSegmentIndexOfColorLUT,activeLabelmapIndex:o.setActiveLabelmapIndex,radius:S.default,pushState:C.pushState,undo:C.undo,redo:C.redo}}},"./store/modules/segmentationModule/metadata.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getMetadata",(function(){return m})),n.d(t,"setMetadata",(function(){return v}));var r=n("./store/modules/segmentationModule/getElement.js"),o=n("./store/modules/segmentationModule/addLabelmap3D.js"),l=n("./stateManagement/toolState.js"),c=n("./externalModules.js"),d=n("./util/logger.js"),f=n("./store/modules/segmentationModule/state.js"),h=Object(d.getLogger)("store:modules:segmentationModule:metadata");function m(e,t,n){var element=Object(r.default)(e);if(element){var o=Object(l.getToolState)(element,"stack").data[0].imageIds[0],c=f.default.series[o];if(c){if(t=void 0===t?c.activeLabelmapIndex:t,c.labelmaps3D[t]){var d=c.labelmaps3D[t];return void 0===n?d.metadata:d.metadata[n]}h.warn("No labelmap3D of labelmap index ".concat(t," on stack."))}else h.warn("brushStackState is undefined")}}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,d=arguments.length>3?arguments[3]:void 0,element=Object(r.default)(e);if(element){var h=c.default.cornerstone,m=Object(l.getToolState)(element,"stack"),v=m.data[0],y=v.imageIds[0],x=f.default.series[y];if(x||(f.default.series[y]={labelmapIndex:t,labelmaps3D:[]},x=f.default.series[y]),!x.labelmaps3D[t]){var j=h.getEnabledElement(element),w=j.image,T=w.rows,E=w.columns,O=v.imageIds.length,C=T*E*O;Object(o.default)(x,t,C)}var S=x.labelmaps3D[t];S.metadata[n]=d}}},"./store/modules/segmentationModule/segmentVisibility.js":function(e,t,n){"use strict";n.r(t),n.d(t,"isSegmentVisible",(function(){return f})),n.d(t,"toggleSegmentVisibility",(function(){return h}));var r=n("./store/modules/segmentationModule/getElement.js"),o=n("./stateManagement/toolState.js"),l=n("./store/modules/segmentationModule/state.js"),c=n("./util/logger.js"),d=Object(c.getLogger)("store:modules:segmentationModule:segmentVisibility");function f(e,t,n){if(t){var element=Object(r.default)(e);if(element){var c=Object(o.getToolState)(element,"stack").data[0].imageIds[0],f=l.default.series[c];if(f){if(n=void 0===n?f.activeLabelmapIndex:n,f.labelmaps3D[n])return!f.labelmaps3D[n].segmentsHidden[t];d.warn("No labelmap3D of labelmap index ".concat(n," on stack."))}else d.warn("brushStackState is undefined")}}}function h(e,t,n){if(t){var element=Object(r.default)(e);if(element){var c=Object(o.getToolState)(element,"stack").data[0].imageIds[0],f=l.default.series[c];if(f){if(n=void 0===n?f.activeLabelmapIndex:n,f.labelmaps3D[n]){var h=f.labelmaps3D[n].segmentsHidden;return h[t]=!h[t],!h[t]}d.warn("No labelmap3D of labelmap index ".concat(n," on stack."))}else d.warn("brushStackState is undefined")}}}},"./store/modules/segmentationModule/setLabelmap3D.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setLabelmap3DByFirstImageId",(function(){return x})),n.d(t,"setLabelmap3DForElement",(function(){return y}));var r=n("./store/modules/segmentationModule/getElement.js"),o=n("./stateManagement/toolState.js"),l=n("./store/modules/segmentationModule/state.js"),c=n("./store/modules/segmentationModule/getSegmentsOnPixeldata.js"),d=n("./util/segmentation/index.js"),f=n("./store/modules/segmentationModule/arrayTypes.js"),h=n("./store/index.js"),m=f.default.UINT_16_ARRAY,v=f.default.FLOAT_32_ARRAY;function y(e,t,n){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],c=arguments.length>4?arguments[4]:void 0,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,element=Object(r.default)(e);if(element){var h=Object(o.getToolState)(element,"stack"),m=h.data[0].imageIds.length,v=h.data[0].imageIds[0];x(v,t,n,l,m,c,f),Object(d.triggerLabelmapModifiedEvent)(element,n)}}function x(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4?arguments[4]:void 0,d=arguments.length>5?arguments[5]:void 0,f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,y=Object(h.getModule)("segmentation"),x=y.configuration,j=l.default.series[e];j||(l.default.series[e]={activeLabelmapIndex:n,labelmaps3D:[]},j=l.default.series[e]),j.labelmaps3D[n]={buffer:t,labelmaps2D:[],metadata:r,activeSegmentIndex:1,colorLUTIndex:f,segmentsHidden:[],undo:[],redo:[]};for(var w=j.labelmaps3D[n].labelmaps2D,T=t.byteLength/o,i=0;i<o;i++){var E=void 0;switch(x.arrayType){case m:E=new Uint16Array(t,T*i,T/2);break;case v:E=new Float32Array(t,T*i,T/4);break;default:throw new Error("Unsupported Array Type ".concat(x.arrayType))}var O=d?d[i]:Object(c.default)(E);O&&O.some((function(e){return e}))&&(w[i]={pixelData:E,segmentsOnLabelmap:O})}}},"./store/modules/segmentationModule/setRadius.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n("./store/index.js");function o(e){var t=Object(r.getModule)("segmentation").configuration;t.radius=Math.min(Math.max(e,t.minRadius),t.maxRadius)}},"./store/modules/segmentationModule/state.js":function(e,t,n){"use strict";n.r(t),t.default={series:{},colorLutTables:[]}},"./store/removeTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"removeTool",(function(){return l})),n.d(t,"removeToolForElement",(function(){return o}));var r=n("./store/index.js"),o=function(element,e){var t=r.default.state.tools.findIndex((function(t){return t.element===element&&t.name===e}));t>=0&&r.default.state.tools.splice(t,1)},l=function(e){c(e),r.default.state.enabledElements.forEach((function(element){o(element,e)}))},c=function(e){Object(r.getModule)("globalConfiguration").configuration.globalToolSyncEnabled&&r.default.state.globalTools[e]&&delete r.default.state.globalTools[e]}},"./store/setToolCursor.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setToolCursor",(function(){return l})),n.d(t,"resetToolCursor",(function(){return c})),n.d(t,"hideToolCursor",(function(){return d}));var r=n("./store/index.js"),o=r.modules.globalConfiguration;function l(element,e){if(o.configuration.showSVGCursors){var t=e.getIconWithPointerSVG(),n=e.mousePoint,l=window.URL.createObjectURL(t);element.style.cursor="url('".concat(l,"') ").concat(n,", auto"),r.state.svgCursorUrl=l}}function c(element){f(element,"initial")}function d(element){o.configuration.showSVGCursors&&f(element,"none")}function f(element,e){r.state.svgCursorUrl&&window.URL.revokeObjectURL(r.state.svgCursorUrl),r.state.svgCursorUrl=null,element.style.cursor=e}},"./store/setToolMode.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setToolActive",(function(){return y})),n.d(t,"setToolActiveForElement",(function(){return v})),n.d(t,"setToolDisabled",(function(){return j})),n.d(t,"setToolDisabledForElement",(function(){return x})),n.d(t,"setToolEnabled",(function(){return T})),n.d(t,"setToolEnabledForElement",(function(){return w})),n.d(t,"setToolPassive",(function(){return O})),n.d(t,"setToolPassiveForElement",(function(){return E})),n.d(t,"setToolMode",(function(){return S})),n.d(t,"setToolModeForElement",(function(){return C})),n.d(t,"_getNormalizedOptions",(function(){return _})),n.d(t,"_mergeMouseButtonMask",(function(){return D}));var r=n("./events.js"),o=n("./util/triggerEvent.js"),l=n("./store/getToolForElement.js"),c=n("./store/setToolCursor.js"),d=n("./util/logger.js"),f=n("./store/index.js"),h=Object(f.getModule)("globalConfiguration"),m=Object(d.getLogger)("store:setToolMode"),v=function(element,e,t,n){void 0===n&&Array.isArray(t)&&(n=t,t=null);var r=Object(l.default)(element,e);r&&(function(element,e,t,n){e.supportedInteractionTypes.forEach((function(r){if(void 0===n||n.includes(r)){var o=P[r];o?o(e,element,t):m.warn("Unable to resolve input conflicts for type %s",r)}})),f.default.state.tools.filter((function(e){return e.element===element&&"active"===e.mode&&e.supportedInteractionTypes.length>0})).forEach((function(e){var t=!1;e.supportedInteractionTypes.forEach((function(n){e.options["is".concat(n,"Active")]&&(t=!0)})),t||(m.log("Setting tool %s's to PASSIVE",e.name),E(element,e.name))}))}(element,r,t,n),r.supportedInteractionTypes.forEach((function(e){void 0===n||n.includes(e)?t["is".concat(e,"Active")]=!0:t["is".concat(e,"Active")]=!1})),h.configuration.showSVGCursors&&r.supportedInteractionTypes.includes("Mouse")&&function(element,e,t){("number"==typeof e?[e]:e.mouseButtonMask).includes(1)&&(t.svgCursor?Object(c.setToolCursor)(t.element,t.svgCursor):t.hideDefaultCursor?Object(c.hideToolCursor)(element):Object(c.resetToolCursor)(element))}(element,t,r)),C("active",null,element,e,t)},y=function(e,t,n){M("active",e,t,n),f.default.state.enabledElements.forEach((function(element){v(element,e,t,n)}))},x=C.bind(null,"disabled",null),j=S.bind(null,"disabled",null),w=C.bind(null,"enabled",null),T=S.bind(null,"enabled",null),E=C.bind(null,"passive",r.default.TOOL_DEACTIVATED),O=S.bind(null,"passive",r.default.TOOL_DEACTIVATED);function C(e,t,element,n,r){var c=Object(l.default)(element,n);if(c){if(r=_(r),Array.isArray(r.mouseButtonMask)&&0!==r.mouseButtonMask.length&&Array.isArray(c.options.mouseButtonMask)&&(r.mouseButtonMask=D(r.mouseButtonMask,c.options.mouseButtonMask)),c.mode=e,c.mergeOptions(r),c["".concat(e,"Callback")]&&c["".concat(e,"Callback")](element,r),t){var d={options:r,toolName:n,toolType:n,type:t};Object(o.default)(element,t,d)}}else m.warn('Unable to find tool "%s" for enabledElement',n)}function S(e,t,n,r){M(e,n,r),f.default.state.enabledElements.forEach((function(element){C(e,t,element,n,r)}))}function I(e,t,element){var n="is".concat(e,"Active"),r=f.default.state.tools.find((function(e){return e.element===element&&"active"===e.mode&&!0===e.options[n]}));r&&(m.log("Setting tool %s's %s to false",r.name,n),r.options[n]=!1)}function M(e,t,n,r){if(h.configuration.globalToolSyncEnabled){var o={mode:e,args:[t,n]};r&&o.push(r),f.default.state.globalToolChangeHistory.push(o),f.default.state.globalToolChangeHistory.length>50&&f.default.state.globalToolChangeHistory.shift();var l=f.default.state.globalTools[t];if(l)if("active"===e){var c=function(e,t,n){void 0===n&&Array.isArray(t)&&(n=t,t=null);var r=[],o=f.default.state.globalTools[e];if(o){var l=new o.tool(o.props);l.supportedInteractionTypes.forEach((function(e){if(void 0===n||n.includes(e))if("Mouse"===e){var o=_(t).mouseButtonMask;Array.isArray(o)&&o.length>0?o.forEach((function(mask){return r.push("".concat(e,"-").concat(mask))})):Array.isArray(o)&&0===o.length&&r.push("".concat(e,"-DELETE"))}else"MultiTouch"===e?r.push("".concat(e,"-").concat(l.configuration.touchPointers)):r.push(e)}))}return r}(t,n,r);Object.keys(f.default.state.globalTools).forEach((function(e){var t=f.default.state.globalTools[e];t.activeBindings=t.activeBindings.filter((function(e){return!c.includes(e)}))})),c.some((function(e){return e.includes("Mouse-DELETE")}))&&(l.activeBindings=l.activeBindings.filter((function(e){return!e.includes("Mouse")})),c=c.filter((function(e){return!e.includes("Mouse")}))),l.activeBindings=l.activeBindings.concat(c)}else l.activeBindings=[];else m.warn("setToolMode call for tool not available globally: ".concat(t))}}var P={Mouse:function(e,element,t){var n=_(t).mouseButtonMask;if(Array.isArray(n)&&n.length>0){var r=f.default.state.tools.find((function(e){return e.element===element&&"active"===e.mode&&!0===e.options.isMouseActive&&Array.isArray(e.options.mouseButtonMask)&&e.options.mouseButtonMask.some((function(e){return n.includes(e)}))}));r&&(r.options.mouseButtonMask=r.options.mouseButtonMask.filter((function(mask){return!n.includes(mask)})),0===r.options.mouseButtonMask.length&&(r.options.isMouseActive=!1))}},MouseWheel:I.bind(void 0,"MouseWheel"),Touch:function(e,element){var t=f.default.state.tools.find((function(e){return e.element===element&&"active"===e.mode&&!0===e.options.isTouchActive})),n=f.default.state.tools.find((function(e){return e.element===element&&"active"===e.mode&&!0===e.options.isMultiTouchActive&&1===e.configuration.touchPointers}));t&&(m.log("Setting tool %s's isTouchActive to false",t.name),t.options.isTouchActive=!1),n&&(m.log("Setting tool %s's isTouchActive to false",n.name),n.options.isMultiTouchActive=!1)},TouchPinch:I.bind(void 0,"TouchPinch"),TouchRotate:I.bind(void 0,"TouchRotate"),DoubleTap:I.bind(void 0,"DoubleTap"),MultiTouch:function(e,element){var t,n=f.default.state.tools.find((function(t){return t.element===element&&"active"===t.mode&&!0===t.options.isMultiTouchActive&&t.configuration.touchPointers===e.configuration.touchPointers}));1===e.configuration.touchPointers&&(t=f.default.state.tools.find((function(e){return e.element===element&&"active"===e.mode&&!0===e.options.isTouchActive}))),n&&(m.log("Setting tool %s's isMultiTouchActive to false",n.name),n.options.isMultiTouchActive=!1),t&&(m.log("Setting tool %s's isTouchActive to false",t.name),t.options.isTouchActive=!1)}};function _(e){return Array.isArray(e)?e={mouseButtonMask:e}:e!==Object(e)&&(e={mouseButtonMask:[e]}),e.hasOwnProperty("mouseButtonMask")||(e.mouseButtonMask=[]),Array.isArray(e.mouseButtonMask)||(e.mouseButtonMask=[e.mouseButtonMask]),e.mouseButtonMask=e.mouseButtonMask.filter((function(e){return"number"==typeof e&&0!==e})),e}function D(e,t){return e.concat(t).reduce((function(e,t){return-1===e.indexOf(t)&&e.push(t),e}),[])}},"./store/setToolOptions.js":function(e,t,n){"use strict";n.r(t),n.d(t,"setToolOptions",(function(){return c})),n.d(t,"setToolOptionsForElement",(function(){return l}));var r=n("./store/getToolForElement.js"),o=n("./store/index.js"),l=function(element,e,t){var n=Object(r.default)(element,e);n&&n.mergeOptions(t)},c=function(e,t){o.state.enabledElements.forEach((function(element){l(element,e,t)}))}},"./synchronization/Synchronizer.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./util/convertToVector3.js"),l=n("./toolOptions.js");function c(e){return e.filter((function(e,t,n){return n.indexOf(e)===t}))}t.default=function(e,t){r.default.cornerstone;var n=this,d=[],f=[],h=!1,m={},v=t;function y(e){var element=e.detail.element;n.remove(element),Object(l.clearToolOptionsByElement)(element)}this.enabled=!0,this.setHandler=function(e){v=e},this.getHandler=function(){return v},this.getDistances=function(){if(d.length&&f.length){var e=r.default.cornerstone;m.distances={},m.imageIds={sourceElements:[],targetElements:[]},d.forEach((function(t){var n=e.getEnabledElement(t);if(n&&n.image){var r=n.image.imageId,l=e.metaData.get("imagePlaneModule",r);if(l&&l.imagePositionPatient){var c=Object(o.default)(l.imagePositionPatient);m.hasOwnProperty(n)||(m.distances[r]={},m.imageIds.sourceElements.push(r),f.forEach((function(n){var l=e.getEnabledElement(n);if(l&&l.image){var d=l.image.imageId;if(m.imageIds.targetElements.push(d),t!==n&&r!==d&&!m.distances[r].hasOwnProperty(d)){var f=e.metaData.get("imagePlaneModule",d);if(f&&f.imagePositionPatient){var h=Object(o.default)(f.imagePositionPatient);m.distances[r][d]=h.clone().sub(c)}}}})),Object.keys(m.distances[r]).length||delete m.distances[r])}}}))}},this.fireEvent=function(e,t){var r=!n.enabled,o=!d.length||!f.length;r||o||(h=!0,f.forEach((function(r){var o=f.indexOf(r);if(-1!==o){var l=m.imageIds.targetElements[o],c=d.indexOf(e);if(-1!==c){var h,y=m.imageIds.sourceElements[c];y===l?h=0:void 0!==m.distances[y]&&(h=m.distances[y][l]),v(n,e,r,t,h)}}})),h=!1)},this.onEvent=function(e){var t=e.detail;!0!==h&&n.fireEvent(e.currentTarget,t)},this.addSource=function(element){-1===d.indexOf(element)&&(d.push(element),e.split(" ").forEach((function(e){element.addEventListener(e,n.onEvent)})),n.getDistances(),n.updateDisableHandlers())},this.addTarget=function(element){-1===f.indexOf(element)&&(f.push(element),n.getDistances(),v(n,element,element,0),n.updateDisableHandlers())},this.add=function(element){n.addSource(element),n.addTarget(element)},this.removeSource=function(element){var t=d.indexOf(element);-1!==t&&(d.splice(t,1),e.split(" ").forEach((function(e){element.removeEventListener(e,n.onEvent)})),n.getDistances(),n.fireEvent(element),n.updateDisableHandlers())},this.removeTarget=function(element){var e=f.indexOf(element);-1!==e&&(f.splice(e,1),n.getDistances(),v(n,element,element,0),n.updateDisableHandlers())},this.remove=function(element){n.removeTarget(element),n.removeSource(element)},this.getSourceElements=function(){return d},this.getTargetElements=function(){return f},this.displayImage=function(element,image,e){h=!0,r.default.cornerstone.displayImage(element,image,e),h=!1},this.setViewport=function(element,e){h=!0,r.default.cornerstone.setViewport(element,e),h=!1},this.updateDisableHandlers=function(){c(d.concat(f)).forEach((function(element){element.removeEventListener(r.default.cornerstone.EVENTS.ELEMENT_DISABLED,y),element.addEventListener(r.default.cornerstone.EVENTS.ELEMENT_DISABLED,y)}))},this.destroy=function(){c(d.concat(f)).forEach((function(element){n.remove(element)}))}}},"./synchronization/panZoomSynchronizer.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js");t.default=function(e,t,n){if(n!==t){var o=r.default.cornerstone,l=o.getViewport(t),c=o.getViewport(n);c.scale===l.scale&&c.translation.x===l.translation.x&&c.translation.y===l.translation.y||(c.scale=l.scale,c.translation.x=l.translation.x,c.translation.y=l.translation.y,e.setViewport(n,c))}}},"./synchronization/stackImageIndexSynchronizer.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./stateManagement/toolState.js"),l=n("./stateManagement/loadHandlerManager.js"),c=n("./util/clip.js");t.default=function(e,t,n){if(n!==t){var d=r.default.cornerstone,f=Object(o.getToolState)(t,"stack").data[0],h=Object(o.getToolState)(n,"stack").data[0],m=f.currentImageIdIndex;if((m=Object(c.default)(m,0,h.imageIds.length-1))!==h.currentImageIdIndex){var v=l.default.getStartLoadHandler(n),y=l.default.getEndLoadHandler(n),x=l.default.getErrorLoadingHandler(n);v&&v(n),(!0===h.preventCache?d.loadImage(h.imageIds[m]):d.loadAndCacheImage(h.imageIds[m])).then((function(image){var t=d.getViewport(n);h.currentImageIdIndex=m,e.displayImage(n,image,t),y&&y(n,image)}),(function(e){var t=h.imageIds[m];x&&x(n,t,e)}))}}}},"./synchronization/stackImagePositionOffsetSynchronizer.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./stateManagement/toolState.js"),l=n("./stateManagement/loadHandlerManager.js"),c=n("./util/convertToVector3.js");t.default=function(e,t,n,d,f){if(n!==t){var h=r.default.cornerstone,m=Object(o.getToolState)(t,"stack").data[0],v=m.imageIds[m.currentImageIdIndex],y=h.metaData.get("imagePlaneModule",v);if(void 0!==y&&void 0!==y.imagePositionPatient){var x=Object(c.default)(y.imagePositionPatient),j=Object(o.getToolState)(n,"stack").data[0],w=Number.MAX_VALUE,T=-1;if(f){var E=x.clone().add(f);if(j.imageIds.forEach((function(e,t){var n=h.metaData.get("imagePlaneModule",e);if(void 0!==n&&void 0!==n.imagePositionPatient){var r=Object(c.default)(n.imagePositionPatient),o=E.distanceToSquared(r);o<w&&(w=o,T=t)}})),T!==j.currentImageIdIndex&&-1!==T){var O=l.default.getStartLoadHandler(n),C=l.default.getEndLoadHandler(n),S=l.default.getErrorLoadingHandler(n);j.currentImageIdIndex=T;var I=j.imageIds[T];O&&O(n),(!0===j.preventCache?h.loadImage(I):h.loadAndCacheImage(I)).then((function(image){var t=h.getViewport(n);j.currentImageIdIndex===T&&(e.displayImage(n,image,t),C&&C(n,image))}),(function(e){var t=j.imageIds[T];S&&S(n,t,e)}))}}}}}},"./synchronization/stackImagePositionSynchronizer.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./stateManagement/toolState.js"),l=n("./stateManagement/loadHandlerManager.js"),c=n("./util/convertToVector3.js");t.default=function(e,t,n){if(n!==t){var d=r.default.cornerstone,f=Object(o.getToolState)(t,"stack").data[0],h=f.imageIds[f.currentImageIdIndex],m=d.metaData.get("imagePlaneModule",h);if(void 0!==m&&void 0!==m.imagePositionPatient){var v=Object(c.default)(m.imagePositionPatient),y=Object(o.getToolState)(n,"stack").data[0],x=Number.MAX_VALUE,j=-1;if(y.imageIds.forEach((function(e,t){var n=d.metaData.get("imagePlaneModule",e);if(void 0!==n&&void 0!==n.imagePositionPatient){var r=Object(c.default)(n.imagePositionPatient).distanceToSquared(v);r<x&&(x=r,j=t)}})),j!==y.currentImageIdIndex){var w=l.default.getStartLoadHandler(n),T=l.default.getEndLoadHandler(n),E=l.default.getErrorLoadingHandler(n);y.currentImageIdIndex=j;var O=y.imageIds[j];w&&w(n),-1!==j&&(!0===y.preventCache?d.loadImage(O):d.loadAndCacheImage(O)).then((function(image){var t=d.getViewport(n);y.currentImageIdIndex===j&&(e.displayImage(n,image,t),T&&T(n,image))}),(function(e){var t=y.imageIds[j];E&&E(n,t,e)}))}}}}},"./synchronization/stackScrollSynchronizer.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./stateManagement/toolState.js"),l=n("./stateManagement/loadHandlerManager.js"),c=n("./util/clip.js");t.default=function(e,t,n,d){if(t!==n&&d&&d.direction){var f=r.default.cornerstone,h=Object(o.getToolState)(n,"stack").data[0],m=h.currentImageIdIndex+d.direction;if(m=Object(c.default)(m,0,h.imageIds.length-1),h.currentImageIdIndex!==m){var v=l.default.getStartLoadHandler(n),y=l.default.getEndLoadHandler(n),x=l.default.getErrorLoadingHandler(n);h.currentImageIdIndex=m;var j=h.imageIds[m];v&&v(n),(!0===h.preventCache?f.loadImage(j):f.loadAndCacheImage(j)).then((function(image){var t=f.getViewport(n);h.currentImageIdIndex===m&&(e.displayImage(n,image,t),y&&y(n,image))}),(function(e){var t=h.imageIds[m];x&&x(n,t,e)}))}}}},"./synchronization/updateImageSynchronizer.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js");t.default=function(e,t,n){n!==t&&r.default.cornerstone.updateImage(n)}},"./synchronization/wwwcSynchronizer.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js");t.default=function(e,t,n){if(n!==t){var o=r.default.cornerstone,l=o.getViewport(t),c=o.getViewport(n);c.voi.windowWidth===l.voi.windowWidth&&c.voi.windowCenter===l.voi.windowCenter&&c.invert===l.invert||(c.voi.windowWidth=l.voi.windowWidth,c.voi.windowCenter=l.voi.windowCenter,c.invert=l.invert,e.setViewport(n,c))}}},"./thirdParty/register.js":function(e,t,n){"use strict";n.r(t);var r=n("../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(r),l=n("./thirdParty/registerModule.js"),c=n("./thirdParty/registerMixin.js"),d=n("./thirdParty/registerItem.js"),f=n("./util/logger.js"),h=Object(f.getLogger)("thirdParty:register");function m(e,t,n){return e?t?"object"===o()(n)||"function"==typeof n||(h.warn("The %s is a %s, it should be an Object or a function.",n,o()(n)),!1):(h.warn("The %s must have a name in order to register.",e),!1):(h.warn("The type must be given in order to register."),!1)}t.default=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(m(e,t,n))switch(e){case"module":Object(l.default)(t,n,r);break;case"mixin":Object(c.default)(t,n,r);break;default:Object(d.default)(e,t,n,r)}}},"./thirdParty/registerItem.js":function(e,t,n){"use strict";n.r(t);var r=n("./lib.js"),o=n("./util/logger.js"),l=Object(o.getLogger)("thirdParty:registerType");function c(e){return void 0!==r.lib[e]}t.default=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],d="".concat(e,"/").concat(t),f=c(d);!f||o?(f&&l.warn("Overwriting %s",d),r.lib[d]=n):l.warn("%s is already registered",d)}},"./thirdParty/registerMixin.js":function(e,t,n){"use strict";n.r(t);var r=n("./lib.js"),o=n("./mixins/index.js"),l=n("./util/logger.js"),c=Object(l.getLogger)("thirdParty:registerMixin");function d(e){return void 0!==o.default[e]}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=d(e);!l||n?(l&&c.warn("Overwriting mixins/%s",e),o.default[e]=t,r.lib["mixins/".concat(e)]=o.default[e]):c.warn("mixins/%s is already registered",e)}},"./thirdParty/registerModule.js":function(e,t,n){"use strict";n.r(t);var r=n("./store/index.js"),o=n("./util/logger.js"),l=Object(o.getLogger)("thirdParty:registerModule");function c(e){return void 0!==r.modules[e]}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=c(e);!o||n?(o&&l.warn("Overwriting module %s",e),r.modules[e]=t,"function"==typeof r.modules[e].onRegisterCallback&&r.modules[e].onRegisterCallback()):l.warn("A module with the name %s is already registered",e)}},"./thirdParty/registerSome.js":function(e,t,n){"use strict";n.r(t);var r=n("./thirdParty/register.js");t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.forEach((function(e){var n=e.type,o=e.name,l=e.item;Object(r.default)(n,o,l,t)}))}},"./toolOptions.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getToolOptions",(function(){return o})),n.d(t,"setToolOptions",(function(){return l})),n.d(t,"clearToolOptions",(function(){return c})),n.d(t,"clearToolOptionsByToolType",(function(){return d})),n.d(t,"clearToolOptionsByToolName",(function(){return f})),n.d(t,"clearToolOptionsByElement",(function(){return h}));var r={};function o(e,element){if(!r[e])return{};var t=r[e].find((function(e){return e.element===element}));return t?t.options:{}}function l(e,element,t){if(r[e]){var n=r[e].findIndex((function(e){return e.element===element}));if(-1===n)r[e].push({element:element,options:t});else{var o=r[e][n].options||{};r[e][n].options=Object.assign(o,t)}}else r[e]=[{element:element,options:t}]}function c(e,element){var t=r[e];t&&(r[e]=t.filter((function(e){return e.element!==element})))}function d(e){return f(e)}function f(e){delete r[e]}function h(element){for(var e in r)r[e]=r[e].filter((function(e){return e.element!==element}))}},"./tools/CrosshairsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return P}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),y=n.n(v),x=n("../node_modules/@babel/runtime/helpers/inherits.js"),j=n.n(x),w=n("./tools/base/BaseTool.js"),T=n("./externalModules.js"),E=n("./stateManagement/loadHandlerManager.js"),O=n("./stateManagement/toolState.js"),C=n("./util/pointProjector.js"),S=n("./util/convertToVector3.js"),I=n("./toolOptions.js"),M=n("./tools/cursors/index.js"),P=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"Crosshairs",supportedInteractionTypes:["Mouse","Touch"],svgCursor:M.crosshairsCursor};return(e=f()(this,m()(t).call(this,n,r))).preMouseDownCallback=e._chooseLocation.bind(y()(e)),e.mouseDragCallback=e._chooseLocation.bind(y()(e)),e.touchDragCallback=e._chooseLocation.bind(y()(e)),e}return j()(t,e),c()(t,[{key:"_chooseLocation",value:function(e){var t=e.detail,element=t.element;e.stopImmediatePropagation();var n=Object(O.getToolState)(element,this.name);if(n){var r=element,o=T.default.cornerstone.getEnabledElement(r).image.imageId,l=T.default.cornerstone.metaData.get("imagePlaneModule",o);if(l){var c=t.currentPoints.image,d=Object(C.imagePointToPatientPoint)(c,l);n.data[0].synchronizationContext.getSourceElements().forEach((function(e){if(e!==r){var t=Number.MAX_VALUE,n=-1,o=Object(O.getToolState)(e,"stack");if(void 0!==o){var l=o.data[0];if(l.imageIds.forEach((function(e,r){var o=T.default.cornerstone.metaData.get("imagePlaneModule",e);if(o&&o.imagePositionPatient&&o.rowCosines&&o.columnCosines){var l=Object(S.default)(o.imagePositionPatient),c=Object(S.default)(o.rowCosines),f=Object(S.default)(o.columnCosines).clone().cross(c.clone()),h=Math.abs(f.clone().dot(l)-f.clone().dot(d));h<t&&(t=h,n=r)}})),n!==l.currentImageIdIndex&&-1!==n&&void 0!==l.imageIds[n]){var c=E.default.getStartLoadHandler(e),f=E.default.getEndLoadHandler(e),h=E.default.getErrorLoadingHandler(e);c&&c(e),(!0===l.preventCache?T.default.cornerstone.loadImage(l.imageIds[n]):T.default.cornerstone.loadAndCacheImage(l.imageIds[n])).then((function(image){var t=T.default.cornerstone.getViewport(e);l.currentImageIdIndex=n,T.default.cornerstone.displayImage(e,image,t),f&&f(e,image)}),(function(t){var r=l.imageIds[n];h&&h(e,r,t)}))}}}}))}}}},{key:"activeCallback",value:function(element,e){var t=e.mouseButtonMask,n=e.synchronizationContext;Object(I.setToolOptions)(this.name,element,{mouseButtonMask:t}),Object(O.clearToolState)(element,this.name),Object(O.addToolState)(element,this.name,{synchronizationContext:n})}}]),t}(w.default)},"./tools/DoubleTapFitToWindowTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return j}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./externalModules.js"),j=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"DoubleTapFitToWindow",supportedInteractionTypes:["DoubleTap"]};return f()(this,m()(t).call(this,e,n))}return y()(t,e),c()(t,[{key:"doubleTapCallback",value:function(e){var t=e.detail;x.default.cornerstone.fitToWindow(t.element)}}]),t}(n("./tools/base/BaseTool.js").default)},"./tools/DragProbeTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return _}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),y=n.n(v),x=n("../node_modules/@babel/runtime/helpers/inherits.js"),j=n.n(x),w=n("./externalModules.js"),T=n("./tools/base/BaseTool.js"),E=n("./stateManagement/textStyle.js"),O=n("./stateManagement/toolColors.js"),C=n("./util/getRGBPixels.js"),S=n("./util/calculateSUV.js"),I=n("./drawing/index.js"),M=n("./drawing/drawTextBox.js"),P=n("./tools/cursors/index.js"),_=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"DragProbe",strategies:{default:D,minimal:k},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],svgCursor:P.probeCursor};return(e=f()(this,m()(t).call(this,n,r))).touchDragCallback=e._movingEventCallback.bind(y()(e)),e.touchEndCallback=e._endMovingEventCallback.bind(y()(e)),e.mouseDragCallback=e._movingEventCallback.bind(y()(e)),e.mouseUpCallback=e._endMovingEventCallback.bind(y()(e)),e.dragEventData={},e}return j()(t,e),c()(t,[{key:"_movingEventCallback",value:function(e){var t=e.detail,element=t.element;this.dragEventData=t,w.default.cornerstone.updateImage(element)}},{key:"_endMovingEventCallback",value:function(e){var element=e.detail.element;this.dragEventData={},w.default.cornerstone.updateImage(element)}},{key:"renderToolData",value:function(e){this.dragEventData.currentPoints&&e&&e.detail&&Boolean(Object.keys(this.dragEventData.currentPoints).length)&&(e.detail.currentPoints=this.dragEventData.currentPoints,this.applyActiveStrategy(e))}}]),t}(T.default);function D(e){var t=this.configuration,n=w.default.cornerstone,r=e.detail,element=r.element,image=r.image,o=r.currentPoints,l=r.canvasContext,c=Object(I.getNewContext)(l.canvas),d=O.default.getActiveColor(),f=E.default.getFontSize(),h=Math.round(o.image.x),m=Math.round(o.image.y);h<0||m<0||h>=image.columns||m>=image.rows||Object(I.draw)(c,(function(e){Object(I.setShadow)(e,t);var r,l,text="".concat(h,", ").concat(m);if(image.color)r=Object(C.default)(element,h,m,1,1),l="R: ".concat(r[0]," G: ").concat(r[1]," B: ").concat(r[2]," A: ").concat(r[3]);else{var c=(r=n.getStoredPixels(element,h,m,1,1))[0],v=c*image.slope+image.intercept,y=Object(S.default)(image,c);l="SP: ".concat(c," MO: ").concat(parseFloat(v.toFixed(3))),y&&(l+=" SUV: ".concat(parseFloat(y.toFixed(3))))}var x={x:o.canvas.x+5,y:o.canvas.y-5};Object(M.default)(e,l,x.x,x.y+f+5,d),Object(M.default)(e,text,x.x,x.y,d)}))}function k(e){var t=this.configuration,n=w.default.cornerstone,r=e.detail,element=r.element,image=r.image,o=r.currentPoints,l=r.canvasContext,c=r.isTouchEvent,d=Object(I.getNewContext)(l.canvas),f=O.default.getActiveColor(),h=o.page.y-E.default.getFontSize()/2;c&&(h=o.page.y-4*E.default.getFontSize());var m=n.pageToPixel(element,o.page.x,h);m.x<0||m.y<0||m.x>=image.columns||m.y>=image.rows||Object(I.draw)(d,(function(e){Object(I.setShadow)(e,t);var r,o=n.metaData.get("generalSeriesModule",image.imageId),l=o&&o.modality,text="";if(image.color)r=Object(C.default)(element,m.x,m.y,1,1),text="R: ".concat(r[0]," G: ").concat(r[1]," B: ").concat(r[2]);else{var d=(r=n.getStoredPixels(element,m.x,m.y,1,1))[0],h=d*image.slope+image.intercept,v=parseFloat(h.toFixed(2));if("CT"===l)text+="HU: ".concat(v);else if("PT"===l){text+=v;var y=Object(S.default)(image,d);y&&(text+=" SUV: ".concat(parseFloat(y.toFixed(2))))}else text+=v}var x=n.pixelToCanvas(element,m),j={x:12,y:-(E.default.getFontSize()+10)/2},w=Object(M.textBoxWidth)(e,text,5);c&&(j={x:-w/2,y:-E.default.getFontSize()-10-12}),Object(I.drawCircle)(e,element,x,6,{color:f},"canvas"),Object(M.default)(e,text,x.x+j.x,x.y+j.y,f)}))}},"./tools/EraserTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return S}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),y=n.n(v),x=n("../node_modules/@babel/runtime/helpers/inherits.js"),j=n.n(x),w=n("./externalModules.js"),T=n("./tools/base/BaseTool.js"),E=n("./stateManagement/toolState.js"),O=n("./store/index.js"),C=n("./tools/cursors/index.js"),S=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"Eraser",supportedInteractionTypes:["Mouse","Touch"],svgCursor:C.eraserCursor};return(e=f()(this,m()(t).call(this,n,r))).preMouseDownCallback=e._deleteAllNearbyTools.bind(y()(e)),e.preTouchStartCallback=e._deleteAllNearbyTools.bind(y()(e)),e}return j()(t,e),c()(t,[{key:"_deleteAllNearbyTools",value:function(e){var t=e.detail.currentPoints.canvas,element=e.detail.element;return O.state.tools.forEach((function(e){var n=Object(E.getToolState)(element,e.name);n&&n.data.forEach((function(data){"function"==typeof e.pointNearTool&&e.pointNearTool(element,data,t)&&(Object(E.removeToolState)(element,e.name,data),w.default.cornerstone.updateImage(element))}))})),!0}}]),t}(T.default)},"./tools/FreehandRoiSculptorTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return A}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),y=n.n(v),x=n("../node_modules/@babel/runtime/helpers/inherits.js"),j=n.n(x),w=n("./events.js"),T=n("./externalModules.js"),E=n("./stateManagement/toolColors.js"),O=n("./drawing/drawHandles.js"),C=n("./store/index.js"),S=n("./stateManagement/toolState.js"),I=n("./util/clip.js"),M=n("./store/getToolForElement.js"),P=n("./tools/base/BaseTool.js"),_=n("./store/setToolCursor.js"),D=n("./tools/cursors/index.js"),k=n("./util/freehand/index.js"),L=k.default.FreehandHandleData,A=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"FreehandRoiSculptor",referencedToolName:"FreehandRoi",supportedInteractionTypes:["Mouse","Touch","DoubleTap"],mixins:["activeOrDisabledBinaryTool"],configuration:R(),svgCursor:D.freehandRoiSculptorCursor};return(e=f()(this,m()(t).call(this,n,r))).updateOnMouseMove=!0,e.isMultiPartTool=!0,e.referencedToolName=e.initialConfiguration.referencedToolName,e._active=!1,e.activeMouseUpCallback=e.activeMouseUpCallback.bind(y()(e)),e.activeTouchEndCallback=e.activeTouchEndCallback.bind(y()(e)),e.activeMouseDragCallback=e.activeMouseDragCallback.bind(y()(e)),e}return j()(t,e),c()(t,[{key:"renderToolData",value:function(e){var t=e.detail;if(null===this.configuration.currentTool)return!1;var element=t.element,n=this.configuration;if(!Object(S.getToolState)(element,this.referencedToolName).data[n.currentTool])return!1;if(this._active){var r=t.canvasContext.canvas.getContext("2d"),o={color:this.configuration.dragColor,fill:null,handleRadius:this._toolSizeCanvas};Object(O.default)(r,t,this.configuration.mouseLocation.handles,o)}else this.configuration.showCursorOnHover&&!this._recentTouchEnd&&this._renderHoverCursor(e)}},{key:"doubleClickCallback",value:function(e){var t=e.detail;this._selectFreehandTool(t),T.default.cornerstone.updateImage(t.element)}},{key:"doubleTapCallback",value:function(e){var t=e.detail;this._selectFreehandTool(t),T.default.cornerstone.updateImage(t.element)}},{key:"preTouchStartCallback",value:function(e){return this._initialiseSculpting(e),!0}},{key:"preMouseDownCallback",value:function(e){if(this.options.mouseButtonMask.includes(e.detail.buttons))return this._initialiseSculpting(e),!0}},{key:"activeMouseDragCallback",value:function(e){var t=this.configuration;if(this._active){var n=e.detail,r=Object(S.getToolState)(n.element,this.referencedToolName);if(r){var o=r.data[t.currentTool].handles.points;this._getMouseLocation(n),this._sculpt(n,o),T.default.cornerstone.updateImage(n.element)}}}},{key:"activeMouseUpCallback",value:function(e){this._activeEnd(e)}},{key:"activeTouchEndCallback",value:function(e){this._activeEnd(e),this._deselectAllTools(e),this._recentTouchEnd=!0}},{key:"_activeEnd",value:function(e){var t=e.detail,element=t.element,n=this.configuration;this._active=!1,C.state.isMultiPartToolActive=!1,this._getMouseLocation(t),this._invalidateToolData(t),n.mouseUpRender=!0,this._deactivateSculpt(element),T.default.cornerstone.updateImage(t.element),function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}(e)}},{key:"_renderHoverCursor",value:function(e){var t,n=e.detail,element=n.element,r=n.canvasContext.canvas.getContext("2d"),data=Object(S.getToolState)(element,this.referencedToolName).data[this.configuration.currentTool];this._recentTouchEnd=!1,this.configuration.mouseUpRender?(t=this.configuration.mouseLocation.handles.start,this.configuration.mouseUpRender=!1):t=C.state.mousePositionImage;var o=Object(M.default)(element,this.referencedToolName).distanceFromPointCanvas(element,data,t);if(this.configuration.mouseLocation.handles.start.x=t.x,this.configuration.mouseLocation.handles.start.y=t.y,this.configuration.limitRadiusOutsideRegion){var l=o;o=this._limitCursorRadiusCanvas(n,o),l>this.configuration.hoverCursorFadeDistance*o&&(r.globalAlpha=this.configuration.hoverCursorFadeAlpha)}var c={fill:null,color:this.configuration.hoverColor,handleRadius:o};Object(O.default)(r,n,this.configuration.mouseLocation.handles,c),this.configuration.limitRadiusOutsideRegion&&(r.globalAlpha=1)}},{key:"newImageCallback",value:function(e){this._deselectAllTools(e)}},{key:"enabledCallback",value:function(e){this._deselectAllTools(e)}},{key:"passiveCallback",value:function(e){this._deselectAllTools(e)}},{key:"disabledCallback",value:function(e){this._deselectAllTools(e)}},{key:"_selectFreehandTool",value:function(e){var t=this.configuration,element=e.element,n=this._getClosestFreehandToolOnElement(element,e);void 0!==n&&(t.currentTool=n,Object(_.hideToolCursor)(element))}},{key:"_activateFreehandTool",value:function(element,e){var data=Object(S.getToolState)(element,this.referencedToolName).data;this.configuration.currentTool=e;for(var i=0;i<data.length;i++)data[i].active=i===e}},{key:"_initialiseSculpting",value:function(e){var t=e.detail,n=this.configuration,element=t.element;null===n.currentTool&&(this._selectFreehandTool(t),null===n.currentTool)||(this._active=!0,C.state.isMultiPartToolActive=!0,this._configureToolSize(t),this._getMouseLocation(t),this._activateFreehandTool(element,n.currentTool),this._activateSculpt(element),T.default.cornerstone.updateImage(t.element))}},{key:"_sculpt",value:function(e,t){var n=this.configuration;this._sculptData={element:e.element,image:e.image,mousePoint:e.currentPoints.image,points:t,toolSize:this._toolSizeImage,minSpacing:n.minSpacing,maxSpacing:Math.max(this._toolSizeImage,2*n.minSpacing)};var r=this._pushHandles();void 0!==r.first&&(this._insertNewHandles(r),this._consolidateHandles())}},{key:"_pushHandles",value:function(){for(var e=this._sculptData,t=e.points,n=e.mousePoint,r=e.toolSize,o={},i=0;i<t.length;i++){var l=T.default.cornerstoneMath.point.distance(t[i],n);l>r||(this._pushOneHandle(i,l),void 0===o.first?(o.first=i,o.last=i):o.last=i)}return o}},{key:"_pushOneHandle",value:function(i,e){var t=this._sculptData,n=t.points,r=t.mousePoint,o=t.toolSize,image=t.image,l=n[i],c=(l.x-r.x)/e,d=(l.y-r.y)/e,f={x:r.x+o*c,y:r.y+o*d};Object(I.clipToBox)(f,image),l.x=f.x,l.y=f.y;var h=this.constructor._getPreviousHandleIndex(i,n.length);n[h].lines.pop(),n[h].lines.push(l)}},{key:"_insertNewHandles",value:function(e){for(var t=this._findNewHandleIndicies(e),n=0,i=0;i<t.length;i++){var r=t[i]+1+n;this._insertHandleRadially(r),n++}}},{key:"_findNewHandleIndicies",value:function(e){for(var t=this._sculptData,n=t.points,r=t.maxSpacing,o=[],i=e.first;i<=e.last;i++)this._checkSpacing(i,n,o,r);var l=this.constructor._getNextHandleIndex(e.last,n.length);if(l!==e.first){this._checkSpacing(l,n,o,r);var c=this.constructor._getPreviousHandleIndex(e.first,n.length);c!==l&&this._checkSpacing(c,n,o,r)}return o}},{key:"_checkSpacing",value:function(i,e,t,n){var r=this.constructor._getNextHandleIndex(i,e.length);T.default.cornerstoneMath.point.distance(e[i],e[r])>n&&t.push(i)}},{key:"_insertHandleRadially",value:function(e){var t=this._sculptData.points,n=e-1,r=this.constructor._getNextHandleIndexBeforeInsert(e,t.length),o=this._getInsertPosition(e,n,r),l=new L(o);t.splice(e,0,l),t[n].lines.pop(),t[n].lines.push(t[e]),k.default.addLine(t,e)}},{key:"_consolidateHandles",value:function(){if(!(this._sculptData.points.length<=3)){var e=this._findCloseHandlePairs();this._mergeCloseHandles(e)}}},{key:"_findCloseHandlePairs",value:function(){for(var e=this._sculptData,t=e.points,n=e.minSpacing,r=[],o=t.length,i=0;i<o;i++){var l=this.constructor._getNextHandleIndex(i,t.length);if(T.default.cornerstoneMath.point.distance(t[i],t[l])<n){var c=[i,l];r.push(c),0===i&&(o-=1),i++}}return r}},{key:"_mergeCloseHandles",value:function(e){for(var t=0,i=0;i<e.length;i++){var n=this.constructor._getCorrectedPair(e[i],t);this._combineHandles(n),t++}var r=this._findCloseHandlePairs();r.length&&this._mergeCloseHandles(r)}},{key:"_combineHandles",value:function(e){var t=this._sculptData,n=t.points,image=t.image,r={x:(n[e[0]].x+n[e[1]].x)/2,y:(n[e[0]].y+n[e[1]].y)/2};Object(I.clipToBox)(r,image),n[e[0]].x=r.x,n[e[0]].y=r.y;var o=this.constructor._getNextHandleIndex(e[1],n.length);n[e[0]].lines.pop(),n[e[0]].lines.push(n[o]),n.splice(e[1],1)}},{key:"_configureToolSize",value:function(e){var element=e.element,t=this.configuration,n=t.currentTool,r=e.currentPoints.image,data=Object(S.getToolState)(element,this.referencedToolName).data[n],o=Object(M.default)(element,this.referencedToolName),l=o.distanceFromPoint(element,data,r),c=o.distanceFromPointCanvas(element,data,r);t.limitRadiusOutsideRegion&&(l=this._limitCursorRadiusImage(e,l),c=this._limitCursorRadiusCanvas(e,c)),this._toolSizeImage=l,this._toolSizeCanvas=c}},{key:"_getMouseLocation",value:function(e){var t=this.configuration;t.mouseLocation.handles.start.x=e.currentPoints.image.x,t.mouseLocation.handles.start.y=e.currentPoints.image.y,Object(I.clipToBox)(t.mouseLocation.handles.start,e.image)}},{key:"_activateSculpt",value:function(element){this._deactivateSculpt(element),element.addEventListener(w.default.MOUSE_UP,this.activeMouseUpCallback),element.addEventListener(w.default.MOUSE_CLICK,this.activeMouseUpCallback),element.addEventListener(w.default.MOUSE_DRAG,this.activeMouseDragCallback),element.addEventListener(w.default.TOUCH_END,this.activeTouchEndCallback),element.addEventListener(w.default.TOUCH_TAP,this.activeTouchEndCallback),element.addEventListener(w.default.TOUCH_DRAG,this.activeMouseDragCallback),T.default.cornerstone.updateImage(element)}},{key:"_deactivateSculpt",value:function(element){element.removeEventListener(w.default.MOUSE_UP,this.activeMouseUpCallback),element.removeEventListener(w.default.MOUSE_CLICK,this.activeMouseUpCallback),element.removeEventListener(w.default.MOUSE_DRAG,this.activeMouseDragCallback),element.removeEventListener(w.default.TOUCH_END,this.activeTouchEndCallback),element.removeEventListener(w.default.TOUCH_TAP,this.activeTouchEndCallback),element.removeEventListener(w.default.TOUCH_DRAG,this.activeMouseDragCallback),T.default.cornerstone.updateImage(element)}},{key:"_invalidateToolData",value:function(e){var t=this.configuration,element=e.element;Object(S.getToolState)(element,this.referencedToolName).data[t.currentTool].invalidated=!0}},{key:"_deselectAllTools",value:function(e){var t=this.configuration,n=Object(S.getToolState)(this.element,this.referencedToolName);if(t.currentTool=null,n)for(var i=0;i<n.data.length;i++)n.data[i].active=!1;Object(_.setToolCursor)(this.element,this.svgCursor),T.default.cornerstone.updateImage(this.element)}},{key:"_limitCursorRadiusCanvas",value:function(e,t){return this._limitCursorRadius(e,t,!0)}},{key:"_limitCursorRadiusImage",value:function(e,t){return this._limitCursorRadius(e,t,!1)}},{key:"_limitCursorRadius",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],element=e.element,image=e.image,r=this.configuration,o=Object(S.getToolState)(element,this.referencedToolName),data=o.data[r.currentTool],l=1;if(n){var c=T.default.cornerstone.pixelToCanvas(element,{x:0,y:0}),d=T.default.cornerstone.pixelToCanvas(element,{x:image.width,y:image.height}),f=(d.x-c.x)*(d.y-c.y);l=f/(image.width*image.height)}var area=data.area*l,h=Math.pow(area/Math.PI,.5);return Math.min(t,h)}},{key:"_getClosestFreehandToolOnElement",value:function(element,e){var t=Object(M.default)(element,this.referencedToolName),n=Object(S.getToolState)(element,this.referencedToolName);if(n){for(var data=n.data,r=e.currentPoints.image,o={distance:1/0,toolIndex:null},i=0;i<data.length;i++){var l=t.distanceFromPoint(element,data[i],r);-1!==l&&l<o.distance&&(o.distance=l,o.toolIndex=i)}return o.toolIndex}}},{key:"_getInsertPosition",value:function(e,t,n){var r,o=this._sculptData,l=o.points,c=o.toolSize,d=o.mousePoint,image=o.image,f={x:(l[t].x+l[n].x)/2,y:(l[t].y+l[n].y)/2},h=T.default.cornerstoneMath.point.distance(d,f);if(h<c){var m={x:(f.x-d.x)/h,y:(f.y-d.y)/h};r={x:d.x+c*m.x,y:d.y+c*m.y}}else r=f;return Object(I.clipToBox)(r,image),r}},{key:"minSpacing",get:function(){return this.configuration.minSpacing},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter minSpacing to a value other than a number.");this.configuration.minSpacing=e}},{key:"maxSpacing",get:function(){return this.configuration.maxSpacing},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter maxSpacing to a value other than a number.");this.configuration.maxSpacing=e}},{key:"showCursorOnHover",get:function(){return this.configuration.showCursorOnHover},set:function(e){if("boolean"!=typeof e)throw new Error("Attempting to set freehandSculpter showCursorOnHover to a value other than a boolean.");this.configuration.showCursorOnHover=e,T.default.cornerstone.updateImage(this.element)}},{key:"limitRadiusOutsideRegion",get:function(){return this.configuration.limitRadiusOutsideRegion},set:function(e){if("boolean"!=typeof e)throw new Error("Attempting to set freehandSculpter limitRadiusOutsideRegion to a value other than a boolean.");this.configuration.limitRadiusOutsideRegion=e,T.default.cornerstone.updateImage(this.element)}},{key:"hoverCursorFadeAlpha",get:function(){return this.configuration.hoverCursorFadeAlpha},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter hoverCursorFadeAlpha to a value other than a number.");e=Math.max(Math.min(e,1),0),this.configuration.hoverCursorFadeAlpha=e,T.default.cornerstone.updateImage(this.element)}},{key:"hoverCursorFadeDistance",get:function(){return this.configuration.hoverCursorFadeDistance},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehandSculpter hoverCursorFadeDistance to a value other than a number.");e=Math.max(e,1),this.configuration.hoverCursorFadeDistance=e,T.default.cornerstone.updateImage(this.element)}}],[{key:"_getCorrectedPair",value:function(e,t){var n=[e[0]-t,e[1]-t];return n[1]<0&&(n[1]=0),n}},{key:"_getNextHandleIndex",value:function(i,e){return i===e-1?0:i+1}},{key:"_getPreviousHandleIndex",value:function(i,e){return 0===i?e-1:i-1}},{key:"_getNextHandleIndexBeforeInsert",value:function(e,t){return e===t?0:e}}]),t}(P.default);function R(){return{mouseLocation:{handles:{start:{highlight:!0,active:!0}}},minSpacing:1,currentTool:null,dragColor:E.default.getActiveColor(),hoverColor:E.default.getToolColor(),showCursorOnHover:!0,limitRadiusOutsideRegion:!0,hoverCursorFadeAlpha:.5,hoverCursorFadeDistance:1.2}}},"./tools/MagnifyTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return S}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),y=n.n(v),x=n("../node_modules/@babel/runtime/helpers/inherits.js"),j=n.n(x),w=n("./externalModules.js"),T=n("./drawing/index.js"),E=n("./tools/base/BaseTool.js"),O=n("./store/setToolCursor.js"),C=n("./tools/cursors/index.js"),S=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"Magnify",supportedInteractionTypes:["Mouse","Touch"],configuration:{magnifySize:300,magnificationLevel:2},svgCursor:C.magnifyCursor};return(e=f()(this,m()(t).call(this,n,r))).zoomCanvas=void 0,e.zoomElement=void 0,e.activeCallback=e._createMagnificationCanvas.bind(y()(e)),e.enabledCallback=e._createMagnificationCanvas.bind(y()(e)),e.disabledCallback=e._destroyMagnificationCanvas.bind(y()(e)),e.postTouchStartCallback=e._addMagnifyingGlass.bind(y()(e)),e.touchDragCallback=e._updateMagnifyingGlass.bind(y()(e)),e.touchEndCallback=e._removeMagnifyingGlass.bind(y()(e)),e.touchDragEndCallback=e._removeMagnifyingGlass.bind(y()(e)),e.postMouseDownCallback=e._addMagnifyingGlass.bind(y()(e)),e.mouseDragCallback=e._updateMagnifyingGlass.bind(y()(e)),e.mouseUpCallback=e._removeMagnifyingGlass.bind(y()(e)),e.mouseClickCallback=e._removeMagnifyingGlass.bind(y()(e)),e.newImageCallback=e._drawMagnificationTool.bind(y()(e)),e}return j()(t,e),c()(t,[{key:"_addMagnifyingGlass",value:function(e){var t=this;this._removeZoomElement(),this._drawZoomedElement(e),window.requestAnimationFrame((function(){return t._drawMagnificationTool(e)})),Object(O.hideToolCursor)(e.detail.element),e.preventDefault(),e.stopPropagation()}},{key:"_updateMagnifyingGlass",value:function(e){this._drawMagnificationTool(e),e.preventDefault(),e.stopPropagation()}},{key:"_removeMagnifyingGlass",value:function(e){var element=e.detail.element;Object(O.setToolCursor)(this.element,this.svgCursor),element.querySelector(".magnifyTool").style.display="none",this._removeZoomElement()}},{key:"_drawMagnificationTool",value:function(e){var element=e.detail.element,t=element.querySelector(".magnifyTool");if(t||this._createMagnificationCanvas(element),void 0!==this.zoomCanvas){var canvas=element.querySelector("canvas:not(.magnifyTool)"),n=Object(T.getNewContext)(t),r=w.default.cornerstone.pixelToCanvas(e.detail.element,e.detail.currentPoints.image),o=Math.min(this.configuration.magnifySize,canvas.width,canvas.height),l=this.configuration.magnificationLevel;t.width=o,t.height=o,r.x=Math.max(r.x,.5*o/l),r.x=Math.min(r.x,canvas.width-.5*o/l),r.y=Math.max(r.y,.5*o/l),r.y=Math.min(r.y,canvas.height-.5*o/l);var c={x:r.x*l-.5*o,y:r.y*l-.5*o};c.x=Math.max(c.x,0),c.y=Math.max(c.y,0),n.drawImage(this.zoomCanvas,c.x,c.y,o,o,0,0,o,o);var d=e.detail.isTouchEvent?120:0,f={top:Math.max(r.y-.5*o-d,0),left:Math.max(r.x-.5*o,0)},h=t.getBoundingClientRect();f.top=Math.min(f.top,canvas.height-h.height),f.left=Math.min(f.left,canvas.width-h.width),t.style.top="".concat(f.top,"px"),t.style.left="".concat(f.left,"px"),t.style.display="block"}}},{key:"_drawZoomedElement",value:function(e){var element=e.detail.element,t=e.detail.enabledElement;void 0===t&&(t=w.default.cornerstone.getEnabledElement(element));var n=this.configuration.magnificationLevel,r=t.canvas,image=t.image;this.zoomElement||(this.zoomElement=document.createElement("div"),this.zoomElement.width=r.width*n,this.zoomElement.height=r.height*n,w.default.cornerstone.enable(this.zoomElement,t.options));var o=w.default.cornerstone.getEnabledElement(this.zoomElement),l=w.default.cornerstone.getViewport(t.element);this.zoomCanvas=o.canvas,this.zoomCanvas.width=r.width*n,this.zoomCanvas.height=r.height*n,o.viewport=Object.assign({},l),l.scale*=n,w.default.cornerstone.displayImage(this.zoomElement,image),w.default.cornerstone.setViewport(this.zoomElement,l)}},{key:"_removeZoomElement",value:function(){void 0!==this.zoomElement&&(w.default.cornerstone.disable(this.zoomElement),this.zoomElement=void 0,this.zoomCanvas=void 0)}},{key:"_createMagnificationCanvas",value:function(element){if(null===element.querySelector(".magnifyTool")){var e=document.createElement("canvas");e.classList.add("magnifyTool"),e.width=this.configuration.magnifySize,e.height=this.configuration.magnifySize,e.style.position="absolute",e.style.display="none",element.appendChild(e)}}},{key:"_destroyMagnificationCanvas",value:function(element){var e=element.querySelector(".magnifyTool");e&&element.removeChild(e)}}]),t}(E.default)},"./tools/OrientationMarkersTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return C}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./externalModules.js"),j=n("./tools/base/BaseTool.js"),w=n("./orientation/index.js"),T=n("./drawing/index.js"),E=n("./stateManagement/toolColors.js"),O=n("./drawing/drawTextBox.js"),C=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"OrientationMarkers",configuration:{drawAllMarkers:!0},mixins:["enabledOrDisabledBinaryTool"]};return f()(this,m()(t).call(this,e,n))}return y()(t,e),c()(t,[{key:"enabledCallback",value:function(element){this.forceImageUpdate(element)}},{key:"disabledCallback",value:function(element){this.forceImageUpdate(element)}},{key:"forceImageUpdate",value:function(element){var e=x.default.cornerstone;e.getEnabledElement(element).image&&e.updateImage(element)}},{key:"renderToolData",value:function(e){var t=e.detail,n=Object(T.getNewContext)(t.canvasContext.canvas),element=t.element,r=M(element);if(r){var o=P(element,r),l=E.default.getToolColor(),c={top:Object(O.textBoxWidth)(n,r.top,0),left:Object(O.textBoxWidth)(n,r.left,0),right:Object(O.textBoxWidth)(n,r.right,0),bottom:Object(O.textBoxWidth)(n,r.bottom,0),height:Object(O.textBoxWidth)(n,"M",0)};S(n,r,o,c,l),this.configuration.drawAllMarkers&&I(n,r,o,c,l)}}}]),t}(j.default),S=function(e,t,n,r,o){Object(O.default)(e,t.top,n.top.x-r.top/2,n.top.y,o),Object(O.default)(e,t.left,n.left.x-r.left/2,n.left.y,o)},I=function(e,t,n,r,o){Object(O.default)(e,t.right,n.right.x-r.right,n.right.y,o),Object(O.default)(e,t.bottom,n.bottom.x-r.bottom/2,n.bottom.y-r.height,o)},M=function(element){var e=x.default.cornerstone,t=e.getEnabledElement(element),n=e.metaData.get("imagePlaneModule",t.image.imageId);if(n&&n.rowCosines&&n.columnCosines){var r=w.default.getOrientationString(n.rowCosines),o=w.default.getOrientationString(n.columnCosines),l=w.default.invertOrientationString(r);return{top:w.default.invertOrientationString(o),bottom:o,left:l,right:r}}},P=function(element){var e=x.default.cornerstone.getEnabledElement(element);return{top:x.default.cornerstone.pixelToCanvas(element,{x:e.image.width/2,y:5}),bottom:x.default.cornerstone.pixelToCanvas(element,{x:e.image.width/2,y:e.image.height-15}),left:x.default.cornerstone.pixelToCanvas(element,{x:5,y:e.image.height/2}),right:x.default.cornerstone.pixelToCanvas(element,{x:e.image.width-10,y:e.image.height/2})}}},"./tools/OverlayTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return E}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./store/index.js"),j=n("./externalModules.js"),w=n("./tools/base/BaseTool.js"),T=x.modules.globalConfiguration,E=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"Overlay",configuration:{},mixins:["enabledOrDisabledBinaryTool"]},l=Object.assign(r,n);return(e=f()(this,m()(t).call(this,l))).initialConfiguration=l,e}return y()(t,e),c()(t,[{key:"enabledCallback",value:function(element){this.forceImageUpdate(element)}},{key:"disabledCallback",value:function(element){this.forceImageUpdate(element)}},{key:"forceImageUpdate",value:function(element){j.default.cornerstone.getEnabledElement(element).image&&j.default.cornerstone.updateImage(element)}},{key:"setupRender",value:function(image){if(image){var e=j.default.cornerstone.metaData.get("overlayPlaneModule",image.imageId);if(e&&e.overlays&&e.overlays.length)return e}}},{key:"setupViewport",value:function(e){if(void 0===e.overlayColor&&(e.overlayColor=T.configuration.overlayColor||"white"),!1!==e.overlayColor)return!0}},{key:"renderToolData",value:function(e){var t=e.detail,n=t.enabledElement,image=t.image,r=t.viewport,o=t.canvasContext,l=this.setupRender(image);if(t&&n&&l&&this.setupViewport(r)){var c=image.columns,d=image.rows;l.overlays.forEach((function(e){if(!1!==e.visible){var t=document.createElement("canvas");t.width=c,t.height=d;var n=t.getContext("2d");n.fillStyle=e.fillStyle||r.overlayColor,"R"===e.type&&(n.fillRect(0,0,t.width,t.height),n.globalCompositeOperation="xor");for(var i=0,l=0;l<e.rows;l++)for(var f=0;f<e.columns;f++)e.pixelData[i++]>0&&n.fillRect(f,l,1,1);var h=!isNaN(parseFloat(e.x))&&isFinite(e.x)?e.x:0,m=!isNaN(parseFloat(e.y))&&isFinite(e.y)?e.y:0;o.drawImage(t,h,m)}}))}}}]),t}(w.default)},"./tools/PanMultiTouchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return T}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),y=n.n(v),x=n("../node_modules/@babel/runtime/helpers/inherits.js"),j=n.n(x),w=n("./externalModules.js"),T=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"PanMultiTouch",supportedInteractionTypes:["MultiTouch"],configuration:{touchPointers:2}};return(e=f()(this,m()(t).call(this,n,r))).multiTouchDragCallback=e._dragCallback.bind(y()(e)),e}return j()(t,e),c()(t,[{key:"_dragCallback",value:function(e){var t=e.detail,element=t.element,n=t.viewport;if(t.numPointers===this.configuration.touchPointers){var r=this._getTranslation(t);this._applyTranslation(n,r),w.default.cornerstone.setViewport(element,n)}}},{key:"_getTranslation",value:function(e){var t=e.viewport,image=e.image,n=e.deltaPoints,r=t.scale,o=t.scale;return image.rowPixelSpacing<image.columnPixelSpacing?r*=image.columnPixelSpacing/image.rowPixelSpacing:image.columnPixelSpacing<image.rowPixelSpacing&&(o*=image.rowPixelSpacing/image.columnPixelSpacing),{x:n.page.x/r,y:n.page.y/o}}},{key:"_applyTranslation",value:function(e,t){e.translation.x+=t.x,e.translation.y+=t.y}}]),t}(n("./tools/base/BaseTool.js").default)},"./tools/PanTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return O}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),y=n.n(v),x=n("../node_modules/@babel/runtime/helpers/inherits.js"),j=n.n(x),w=n("./externalModules.js"),T=n("./tools/base/BaseTool.js"),E=n("./tools/cursors/index.js"),O=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"Pan",supportedInteractionTypes:["Mouse","Touch"],svgCursor:E.panCursor};return(e=f()(this,m()(t).call(this,n,r))).touchDragCallback=e._dragCallback.bind(y()(e)),e.mouseDragCallback=e._dragCallback.bind(y()(e)),e}return j()(t,e),c()(t,[{key:"_dragCallback",value:function(e){var t=e.detail,element=t.element,n=t.viewport,r=this._getTranslation(t);this._applyTranslation(n,r),w.default.cornerstone.setViewport(element,n)}},{key:"_getTranslation",value:function(e){var t=e.viewport,image=e.image,n=e.deltaPoints,r=t.scale,o=t.scale;return image.rowPixelSpacing<image.columnPixelSpacing?r*=image.columnPixelSpacing/image.rowPixelSpacing:image.columnPixelSpacing<image.rowPixelSpacing&&(o*=image.rowPixelSpacing/image.columnPixelSpacing),{x:n.page.x/r,y:n.page.y/o}}},{key:"_applyTranslation",value:function(e,t){e.translation.x+=t.x,e.translation.y+=t.y}}]),t}(T.default)},"./tools/ReferenceLinesTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return _}));var r=n("../node_modules/@babel/runtime/regenerator/index.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/asyncToGenerator.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/createClass.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),y=n.n(v),x=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),j=n.n(x),w=n("../node_modules/@babel/runtime/helpers/inherits.js"),T=n.n(w),E=n("./externalModules.js"),O=n("./tools/base/BaseTool.js"),C=n("./drawing/index.js"),S=n("./tools/referenceLines/renderActiveReferenceLine.js"),I=n("./util/wait.js"),M=n("./util/logger.js"),P=Object(M.getLogger)("tools:ReferenceLinesTool"),_=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f()(this,t);var r={name:"ReferenceLines",mixins:["enabledOrDisabledBinaryTool"],configuration:{renderer:S.default}};return(e=y()(this,j()(t).call(this,n,r))).renderer=null,e.synchronizationContext=null,e}var n;return T()(t,e),m()(t,[{key:"enabledCallback",value:(n=c()(o.a.mark((function e(element){var t,n,r,l=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>1&&void 0!==l[1]?l[1]:{},n=t.synchronizationContext,r=this.configuration.renderer,e.next=4,Object(I.waitForEnabledElementImageToLoad)(element);case 4:if(e.sent&&r&&n){e.next=8;break}return P.warn("Unable to enable ".concat(this.name,". Exiting enable callback. Tool will be enabled, but will not render.")),e.abrupt("return");case 8:this.renderer=r,this.synchronizationContext=n,this.forceImageUpdate(element);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"disabledCallback",value:function(element){this.forceImageUpdate(element)}},{key:"forceImageUpdate",value:function(element){E.default.cornerstone.getEnabledElement(element).image&&E.default.cornerstone.updateImage(element)}},{key:"renderToolData",value:function(e){var t=this,n=e.detail;if(this.renderer&&this.synchronizationContext){var r=this.synchronizationContext.getSourceElements(),o=Object(C.getNewContext)(n.canvasContext.canvas);E.default.cornerstone.setToPixelCoordinateSystem(n.enabledElement,o),r.forEach((function(r){r!==e.currentTarget&&t.renderer(o,n,e.currentTarget,r)}))}}}]),t}(O.default)},"./tools/RotateTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return E}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./externalModules.js"),j=n("./tools/base/BaseTool.js"),w=n("./util/angleBetweenPoints.js"),T=n("./tools/cursors/index.js"),E=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"Rotate",strategies:{default:O,horizontal:C,vertical:S},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],configuration:{roundAngles:!1,flipHorizontal:!1,flipVertical:!1,rotateScale:1},svgCursor:T.rotateCursor};return f()(this,m()(t).call(this,e,n))}return y()(t,e),c()(t,[{key:"touchDragCallback",value:function(e){this.dragCallback(e)}},{key:"mouseDragCallback",value:function(e){this.dragCallback(e)}},{key:"postMouseDownCallback",value:function(e){this.initialRotation=e.detail.viewport.rotation}},{key:"dragCallback",value:function(e){e.detail.viewport.initialRotation=this.initialRotation,this.applyActiveStrategy(e),x.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)}}]),t}(j.default);function O(e){var t=this.configuration,n=t.roundAngles,r=t.rotateScale,o=e.detail,element=o.element,l=o.viewport,c=o.startPoints,d=o.currentPoints,f=l.initialRotation?l.initialRotation:l.rotation,rect=element.getBoundingClientRect(element),h=element.clientWidth,m=element.clientHeight,v=l.scale,y=l.translation,x={x:rect.left+h/2+y.x*v,y:rect.top+m/2+y.y*v},j=Object(w.default)(x,c.client,d.client);j.angle*=r,n&&(j.angle=Math.ceil(j.angle)),j.direction<0&&(j.angle=-j.angle),l.rotation=f+j.angle}function C(e){var t=this.configuration,n=t.roundAngles,r=t.flipHorizontal,o=t.rotateScale,l=e.detail,c=l.viewport,d=l.startPoints,f=l.currentPoints,h=c.initialRotation,m=d.client.x,v=(f.client.x-m)*o;n&&(v=Math.round(Math.abs(v))*(v>0?1:-1)),r&&(v=-v),c.rotation=h+v}function S(e){var t=this.configuration,n=t.roundAngles,r=t.flipVertical,o=t.rotateScale,l=e.detail,c=l.viewport,d=l.startPoints,f=l.currentPoints,h=c.initialRotation,m=d.client.y,v=(f.client.y-m)*o;n&&(v=Math.round(Math.abs(v))*(v>0?1:-1)),r&&(v=-v),c.rotation=h+v}},"./tools/RotateTouchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return j}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./externalModules.js"),j=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"RotateTouch",supportedInteractionTypes:["TouchRotate"]};return f()(this,m()(t).call(this,e,n))}return y()(t,e),c()(t,[{key:"touchRotateCallback",value:function(e){var t=e.detail,element=t.element,n=t.viewport,r=t.rotation;n.rotation+=r,x.default.cornerstone.setViewport(element,n)}}]),t}(n("./tools/base/BaseTool.js").default)},"./tools/ScaleOverlayTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return S}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./externalModules.js"),j=n("./tools/base/BaseTool.js"),w=n("./drawing/index.js"),T=n("./stateManagement/toolStyle.js"),E=n("./stateManagement/toolColors.js"),O=n("./util/logger.js"),C=Object(O.getLogger)("tools:ScaleOverlayTool"),S=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"ScaleOverlay",configuration:{minorTickLength:12.5,majorTickLength:25},mixins:["enabledOrDisabledBinaryTool"]};return f()(this,m()(t).call(this,e,n))}return y()(t,e),c()(t,[{key:"enabledCallback",value:function(element){this.forceImageUpdate(element)}},{key:"disabledCallback",value:function(element){this.forceImageUpdate(element)}},{key:"forceImageUpdate",value:function(element){x.default.cornerstone.getEnabledElement(element).image&&x.default.cornerstone.updateImage(element)}},{key:"renderToolData",value:function(e){var t=e.detail,n=Object(w.getNewContext)(t.canvasContext.canvas),image=t.image,r=t.viewport,element=t.element,o=image.rowPixelSpacing,l=image.columnPixelSpacing,c=x.default.cornerstone.metaData.get("imagePlaneModule",image.imageId);if(c&&(o=c.rowPixelSpacing||c.rowImagePixelSpacing,l=c.columnPixelSpacing||c.colImagePixelSpacing),o&&l){var d={width:n.canvas.width,height:n.canvas.height},f=10/o*r.scale,h=10/l*r.scale,m=I(d,.25,.05),v=I(d,.05,.15);if(d.width&&d.height&&m&&v){var y=E.default.getToolColor(),j=T.default.getToolWidth(),O=Object.assign({},{hscaleBounds:m,vscaleBounds:v,verticalMinorTick:f,horizontalMinorTick:h,verticalLine:{start:{x:v.bottomRight.x,y:v.topLeft.y},end:{x:v.bottomRight.x,y:v.bottomRight.y}},horizontalLine:{start:{x:m.topLeft.x,y:m.bottomRight.y},end:{x:m.bottomRight.x,y:m.bottomRight.y}},color:y,lineWidth:j},this.configuration);Object(w.draw)(n,(function(e){Object(w.setShadow)(e,O),Object(w.drawLine)(e,element,O.verticalLine.start,O.verticalLine.end,{color:O.color,lineWidth:O.lineWidth},"canvas"),M(e,element,O),Object(w.drawLine)(e,element,O.horizontalLine.start,O.horizontalLine.end,{color:O.color,lineWidth:O.lineWidth},"canvas"),P(e,element,O)}))}}else C.warn("unable to define rowPixelSpacing or colPixelSpacing from data on ".concat(this.name,"'s renderToolData"))}}]),t}(j.default),I=function(e,t,n){var r=t*Math.min(1e3,e.width),o=n*Math.min(1e3,e.height),l={left:r,top:o,width:e.width-2*r,height:e.height-2*o};return{topLeft:{x:l.left,y:l.top},bottomRight:{x:l.left+l.width,y:l.top+l.height}}},M=function(e,element,t){for(var i=0;t.verticalLine.start.y+i*t.verticalMinorTick<=t.vscaleBounds.bottomRight.y;){var n=t.color,r=t.lineWidth,o={x:t.verticalLine.start.x,y:t.verticalLine.start.y+i*t.verticalMinorTick},l={x:0,y:t.verticalLine.start.y+i*t.verticalMinorTick};l.x=i%5==0?t.verticalLine.start.x-t.majorTickLength:t.verticalLine.start.x-t.minorTickLength,Object(w.drawLine)(e,element,o,l,{color:n,lineWidth:r},"canvas"),i++}},P=function(e,element,t){for(var i=0;t.horizontalLine.start.x+i*t.horizontalMinorTick<=t.hscaleBounds.bottomRight.x;){var n=t.color,r=t.lineWidth,o={x:t.horizontalLine.start.x+i*t.horizontalMinorTick,y:t.horizontalLine.start.y},l={x:t.horizontalLine.start.x+i*t.horizontalMinorTick,y:0};l.y=i%5==0?t.horizontalLine.start.y-t.majorTickLength:t.horizontalLine.start.y-t.minorTickLength,Object(w.drawLine)(e,element,o,l,{color:n,lineWidth:r},"canvas"),i++}}},"./tools/StackScrollMouseWheelTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return w}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./tools/base/BaseTool.js"),j=n("./util/scroll.js"),w=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"StackScrollMouseWheel",supportedInteractionTypes:["MouseWheel"],configuration:{loop:!1,allowSkipping:!0,invert:!1}};return f()(this,m()(t).call(this,e,n))}return y()(t,e),c()(t,[{key:"mouseWheelCallback",value:function(e){var t=e.detail,n=t.direction,element=t.element,r=this.configuration,o=r.loop,l=r.allowSkipping,c=r.invert?-n:n;Object(j.default)(element,c,o,l)}}]),t}(x.default)},"./tools/StackScrollMultiTouchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return C}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),y=n.n(v),x=n("../node_modules/@babel/runtime/helpers/inherits.js"),j=n.n(x),w=n("./tools/base/BaseTool.js"),T=n("./util/scroll.js"),E=n("./stateManagement/toolState.js"),O=n("./toolOptions.js"),C=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"StackScrollMultiTouch",supportedInteractionTypes:["MultiTouch"],configuration:{loop:!1,allowSkipping:!0,touchPointers:3}};return(e=f()(this,m()(t).call(this,n,r))).multiTouchDragCallback=e._dragCallback.bind(y()(e)),e}return j()(t,e),c()(t,[{key:"_dragCallback",value:function(e){var t=e.detail;if(t.numPointers===this.configuration.touchPointers){var element=t.element,n=t.deltaPoints,r=this.configuration,o=r.loop,l=r.allowSkipping,c=Object(O.getToolOptions)(this.name,element),d=this._getPixelPerImage(element),f=this._getDeltaY(element,n.page.y);if(!d)return;if(Math.abs(f)>=d){var h=Math.round(f/d);Object(T.default)(element,h,o,l),c.deltaY=f%d}else c.deltaY=f;Object(O.setToolOptions)(this.name,element,c)}}},{key:"_getDeltaY",value:function(element,e){return(Object(O.getToolOptions)(this.name,element).deltaY||0)+e}},{key:"_getPixelPerImage",value:function(element){var e=Object(E.getToolState)(element,"stack");if(e&&e.data&&e.data.length){var t=e.data[0];return this.configuration.stackScrollSpeed||Math.max(2,element.offsetHeight/Math.max(t.imageIds.length,8))}}}]),t}(w.default)},"./tools/StackScrollTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return S}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),y=n.n(v),x=n("../node_modules/@babel/runtime/helpers/inherits.js"),j=n.n(x),w=n("./tools/base/BaseTool.js"),T=n("./util/scroll.js"),E=n("./stateManagement/toolState.js"),O=n("./toolOptions.js"),C=n("./tools/cursors/index.js"),S=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"StackScroll",supportedInteractionTypes:["Mouse","Touch"],configuration:{loop:!1,allowSkipping:!0},svgCursor:C.stackScrollCursor};return(e=f()(this,m()(t).call(this,n,r))).mouseDragCallback=e._dragCallback.bind(y()(e)),e.touchDragCallback=e._dragCallback.bind(y()(e)),e}return j()(t,e),c()(t,[{key:"_dragCallback",value:function(e){var t=e.detail,element=t.element,n=t.deltaPoints,r=this.configuration,o=r.loop,l=r.allowSkipping,c=Object(O.getToolOptions)(this.name,element),d=this._getPixelPerImage(element),f=this._getDeltaY(element,n.page.y);if(d){if(Math.abs(f)>=d){var h=Math.round(f/d);Object(T.default)(element,h,o,l),c.deltaY=f%d}else c.deltaY=f;Object(O.setToolOptions)(this.name,element,c)}}},{key:"_getDeltaY",value:function(element,e){return(Object(O.getToolOptions)(this.name,element).deltaY||0)+e}},{key:"_getPixelPerImage",value:function(element){var e=Object(E.getToolState)(element,"stack");if(e&&e.data&&e.data.length){var t=e.data[0];return this.configuration.stackScrollSpeed||Math.max(2,element.offsetHeight/Math.max(t.imageIds.length,8))}}}]),t}(w.default)},"./tools/WwwcRegionTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return M}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),y=n.n(v),x=n("../node_modules/@babel/runtime/helpers/inherits.js"),j=n.n(x),w=n("./externalModules.js"),T=n("./tools/base/BaseTool.js"),E=n("./drawing/index.js"),O=n("./util/clip.js"),C=n("./util/getLuminance.js"),S=n("./stateManagement/toolColors.js"),I=n("./tools/cursors/index.js"),M=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"WwwcRegion",supportedInteractionTypes:["Mouse","Touch"],configuration:{minWindowWidth:10},svgCursor:I.wwwcRegionCursor};return(e=f()(this,m()(t).call(this,n,r)))._resetHandles(),e.postTouchStartCallback=e._startOutliningRegion.bind(y()(e)),e.touchDragCallback=e._setHandlesAndUpdate.bind(y()(e)),e.touchEndCallback=e._applyStrategy.bind(y()(e)),e.postMouseDownCallback=e._startOutliningRegion.bind(y()(e)),e.mouseClickCallback=e._startOutliningRegion.bind(y()(e)),e.mouseDragCallback=e._setHandlesAndUpdate.bind(y()(e)),e.mouseMoveCallback=e._setHandlesAndUpdate.bind(y()(e)),e.mouseUpCallback=e._applyStrategy.bind(y()(e)),e}return j()(t,e),c()(t,[{key:"renderToolData",value:function(e){var t=this,n=e.detail,element=n.element,r=S.default.getColorIfActive({active:!0}),o=Object(E.getNewContext)(n.canvasContext.canvas);Object(E.draw)(o,(function(e){Object(E.drawRect)(e,element,t.handles.start,t.handles.end,{color:r})}))}},{key:"_startOutliningRegion",value:function(e){var element=e.detail.element,image=e.detail.currentPoints.image;return P(this.handles.start)?this.handles.start=image:(this.handles.end=image,this._applyStrategy(e)),w.default.cornerstone.updateImage(element),!0}},{key:"_setHandlesAndUpdate",value:function(e){var element=e.detail.element,image=e.detail.currentPoints.image;this.handles.end=image,w.default.cornerstone.updateImage(element)}},{key:"_applyStrategy",value:function(e){P(this.handles.start)||P(this.handles.end)||(e.detail.handles=this.handles,_(e,this.configuration),this._resetHandles())}},{key:"_resetHandles",value:function(){this.handles={start:{},end:{}}}}]),t}(T.default),P=function(e){return 0===Object.keys(e).length&&e.constructor===Object},_=function(e,t){var n=e.detail,image=n.image,element=n.element,r=e.detail.handles,o=r.start,l=r.end,c=Math.min(o.x,l.x),d=Math.min(o.y,l.y),f=Math.abs(o.x-l.x),h=Math.abs(o.y-l.y);c=Object(O.default)(c,0,image.width),d=Object(O.default)(d,0,image.height),f=Math.floor(Math.min(f,Math.abs(image.width-c))),h=Math.floor(Math.min(h,Math.abs(image.height-d)));var m=Object(C.default)(element,c,d,f,h),v=D(m,image.minPixelValue,image.maxPixelValue),y=n.viewport;void 0===t.minWindowWidth&&(t.minWindowWidth=10),y.voi.windowWidth=Math.max(Math.abs(v.max-v.min),t.minWindowWidth),y.voi.windowCenter=v.mean,y.voiLUT=void 0,w.default.cornerstone.setViewport(element,y),w.default.cornerstone.updateImage(element)},D=function(e,t,n){var r=e.length,o=n,l=t,c=0;if(r<2)return{min:o,max:l,mean:(t+n)/2};for(var d=0;d<r;d++){var f=e[d];o=Math.min(o,f),l=Math.max(l,f),c+=f}return{min:o,max:l,mean:c/r}}},"./tools/WwwcTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return T}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./externalModules.js"),j=n("./tools/base/BaseTool.js"),w=n("./tools/cursors/index.js"),T=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"Wwwc",strategies:{basicLevelingStrategy:E},supportedInteractionTypes:["Mouse","Touch"],configuration:{orientation:0},svgCursor:w.wwwcCursor};return f()(this,m()(t).call(this,e,n))}return y()(t,e),c()(t,[{key:"mouseDragCallback",value:function(e){this.applyActiveStrategy(e),x.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)}},{key:"touchDragCallback",value:function(e){e.stopImmediatePropagation(),this.applyActiveStrategy(e),x.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)}}]),t}(j.default);function E(e){var t=this.configuration.orientation,n=e.detail,r=(n.image.maxPixelValue*n.image.slope+n.image.intercept-(n.image.minPixelValue*n.image.slope+n.image.intercept))/1024,o=n.deltaPoints.page.x*r,l=n.deltaPoints.page.y*r;0===t?(n.viewport.voi.windowWidth+=o,n.viewport.voi.windowCenter+=l):(n.viewport.voi.windowWidth+=l,n.viewport.voi.windowCenter+=o),n.viewport.voiLUT=void 0}},"./tools/ZoomMouseWheelTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return T}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./externalModules.js"),j=n("./tools/base/BaseTool.js"),w=n("./util/zoom/index.js"),T=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"ZoomMouseWheel",supportedInteractionTypes:["MouseWheel"],configuration:{minScale:.25,maxScale:20,invert:!1}};return f()(this,m()(t).call(this,e,n))}return y()(t,e),c()(t,[{key:"mouseWheelCallback",value:function(e){var t=e.detail,element=t.element,n=t.viewport,r=t.spinY,o=this.configuration,l=o.invert,c=o.maxScale,d=o.minScale,f=l?r/4:-r/4,h=Object(w.changeViewportScale)(n,f,{maxScale:c,minScale:d});x.default.cornerstone.setViewport(element,h)}}]),t}(j.default)},"./tools/ZoomTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return S}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./externalModules.js"),j=n("./tools/base/BaseTool.js"),w=n("./util/clip.js"),T=n("./util/zoom/index.js"),E=n("./tools/cursors/index.js"),O=T.default.correctShift,C=T.default.changeViewportScale,S=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"Zoom",strategies:{default:M,translate:P,zoomToCenter:_},defaultStrategy:"default",supportedInteractionTypes:["Mouse","Touch"],configuration:{invert:!1,preventZoomOutsideImage:!1,minScale:.25,maxScale:20},svgCursor:E.zoomCursor};return f()(this,m()(t).call(this,e,n))}return y()(t,e),c()(t,[{key:"touchDragCallback",value:function(e){I.call(this,e)}},{key:"mouseDragCallback",value:function(e){I.call(this,e)}}]),t}(j.default),I=function(e){if(!e.detail.deltaPoints.page.y)return!1;this.applyActiveStrategy(e,this.configuration),x.default.cornerstone.setViewport(e.detail.element,e.detail.viewport)};function M(e){var t=this.configuration,n=t.invert,r=t.maxScale,o=t.minScale,l=e.detail.deltaPoints.page.y,c=n?-l/100:l/100,d=e.detail,element=d.element,f=d.viewport,h=[e.detail.startPoints.page.x,e.detail.startPoints.page.y,e.detail.startPoints.image.x,e.detail.startPoints.image.y],m=h[0],v=h[1],y=h[2],j=h[3],w=C(f,c,{maxScale:r,minScale:o});x.default.cornerstone.setViewport(element,w);var T=x.default.cornerstone.pageToPixel(element,m,v),E={x:y-T.x,y:j-T.y};E=O(E,w),f.translation.x-=E.x,f.translation.y-=E.y}function P(e){var t=this.configuration,n=t.invert,r=t.preventZoomOutsideImage,o=t.maxScale,l=t.minScale,c=e.detail.deltaPoints.page.y,d=n?-c/100:c/100,image=e.detail.image,f=e.detail.viewport,h=[e.detail.startPoints.image.x,e.detail.startPoints.image.y],m=h[0],v=h[1],y=C(f,d,{maxScale:o,minScale:l}),x={x:0,y:0},j=.01;if(d<0)y.scale<3&&(Math.abs(y.translation.x)<j?y.translation.x=0:x.x=y.translation.x/8,Math.abs(y.translation.y)<j?y.translation.y=0:x.y=y.translation.y/8);else{r&&Object(w.clipToBox)(e.detail.startPoints.image,image);var T={x:image.width/2-m,y:image.height/2-v};T=O(T,y);var E={x:y.translation.x-T.x,y:y.translation.y-T.y};Math.abs(E.x)<j?y.translation.x=T.x:x.x=E.x/8,Math.abs(E.y)<j?y.translation.y=T.y:x.y=E.y/8}y.translation.x-=x.x,y.translation.y-=x.y}function _(e){var t=this.configuration,n=t.invert,r=t.maxScale,o=t.minScale,l=e.detail.deltaPoints.page.y,c=n?-l/100:l/100,d=e.detail.viewport;C(d,c,{maxScale:r,minScale:o})}},"./tools/ZoomTouchPinchTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return T}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./externalModules.js"),j=n("./tools/base/BaseTool.js"),w=n("./util/zoom/index.js").default.correctShift,T=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"ZoomTouchPinch",supportedInteractionTypes:["TouchPinch"],configuration:{minScale:.25,maxScale:20}};return f()(this,m()(t).call(this,e,n))}return y()(t,e),c()(t,[{key:"touchPinchCallback",value:function(e){var t=e.detail,element=t.element,n=t.viewport,r=t.scaleChange,o=[e.detail.startPoints.page.x,e.detail.startPoints.page.y,e.detail.startPoints.image.x,e.detail.startPoints.image.y],l=o[0],c=o[1],d=o[2],f=o[3],h=this.configuration,m=h.maxScale,v=h.minScale;n.scale+=r*n.scale,m&&n.scale>m?n.scale=m:v&&n.scale<v&&(n.scale=v),x.default.cornerstone.setViewport(element,n);var y=x.default.cornerstone.pageToPixel(element,l,c),j={x:d-y.x,y:f-y.y};j=w(j,n),n.translation.x-=j.x,n.translation.y-=j.y,x.default.cornerstone.setViewport(element,n)}}]),t}(j.default)},"./tools/annotation/AngleTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return U}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./externalModules.js"),j=n("./tools/base/BaseAnnotationTool.js"),w=n("./stateManagement/toolState.js"),T=n("./stateManagement/toolStyle.js"),E=n("./stateManagement/toolColors.js"),O=n("./manipulators/index.js"),C=n("./drawing/index.js"),S=n("./drawing/drawLinkedTextBox.js"),I=n("./drawing/drawTextBox.js"),M=n("./drawing/drawHandles.js"),P=n("./util/lineSegDistance.js"),_=n("./util/roundToDecimal.js"),D=n("./tools/cursors/index.js"),k=n("./util/triggerEvent.js"),L=n("./events.js"),A=n("./util/getPixelSpacing.js"),R=n("./util/throttle.js"),B=n("./store/index.js"),U=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"Angle",supportedInteractionTypes:["Mouse","Touch"],svgCursor:D.angleCursor,configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1}};return(e=f()(this,m()(t).call(this,n,r))).preventNewMeasurement=!1,e.throttledUpdateCachedStats=Object(R.default)(e.updateCachedStats,110),e}return y()(t,e),c()(t,[{key:"createNewMeasurement",value:function(e){return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},middle:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(element,data,e){return!1!==data.visible&&(Object(P.default)(element,data.handles.start,data.handles.middle,e)<25||Object(P.default)(element,data.handles.middle,data.handles.end,e)<25)}},{key:"updateCachedStats",value:function(image,element,data){var e=H(image,data.handles.middle,data.handles.start),t=H(image,data.handles.end,data.handles.middle),n=H(image,data.handles.end,data.handles.start),r=F(e),o=F(t),l=F(n),c=Math.acos((Math.pow(r,2)+Math.pow(o,2)-Math.pow(l,2))/(2*r*o));c*=180/Math.PI,data.rAngle=Object(_.default)(c,2),data.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,r=n.enabledElement,o=this.configuration,l=o.handleRadius,c=o.drawHandlesOnHover,d=o.hideHandlesIfMoving,f=o.renderDashed,h=Object(w.getToolState)(e.currentTarget,this.name),m=Object(B.getModule)("globalConfiguration").configuration.lineDash;if(h)for(var v=Object(C.getNewContext)(n.canvasContext.canvas),image=n.image,element=n.element,y=Object(A.default)(image),j=y.rowPixelSpacing,O=y.colPixelSpacing,P=T.default.getToolWidth(),_=function(i){var data=h.data[i];if(!1===data.visible)return"continue";Object(C.draw)(v,(function(e){Object(C.setShadow)(e,t.configuration);var o=E.default.getColorIfActive(data),h=x.default.cornerstone.pixelToCanvas(n.element,data.handles.start),v=x.default.cornerstone.pixelToCanvas(n.element,data.handles.middle),y={color:o};f&&(y.lineDash=m),Object(C.drawJoinedLines)(e,n.element,data.handles.start,[data.handles.middle,data.handles.end],y);var w={color:o,handleRadius:l,drawHandlesIfActive:c,hideHandlesIfMoving:d};if(t.configuration.drawHandles&&Object(M.default)(e,n,data.handles,w),!0===data.invalidated&&(data.rAngle?t.throttledUpdateCachedStats(image,element,data):t.updateCachedStats(image,element,data)),data.rAngle){var T,text=function(data,e,t){var n=e&&t?"":" (isotropic)",r="00B0";return data.rAngle.toString()+String.fromCharCode(parseInt(r,16))+n}(data,j,O);if(!data.handles.textBox.hasMoved){T={x:v.x,y:v.y};var _=Object(I.textBoxWidth)(e,text,5);v.x<h.x?T.x-=15+_+10:T.x+=15;var k=x.default.cornerstone.internal.getTransform(r);k.invert();var L=k.transformPoint(T.x,T.y);data.handles.textBox.x=L.x,data.handles.textBox.y=L.y}Object(S.default)(e,n.element,data.handles.textBox,text,data.handles,D,o,P,0,!0)}}))},i=0;i<h.data.length;i++)_(i);function D(e){return[e.start,e.middle,e.end]}}},{key:"addNewMeasurement",value:function(e,t){var n=this;if(!this.preventNewMeasurement){this.preventNewMeasurement=!0,e.preventDefault(),e.stopPropagation();var r=e.detail,o=this.createNewMeasurement(r),element=e.detail.element;Object(w.addToolState)(element,this.name,o),x.default.cornerstone.updateImage(element),Object(O.moveNewHandle)(r,this.name,o,o.handles.middle,this.options,t,(function(e){if(o.active=!1,!e)return Object(w.removeToolState)(element,n.name,o),void(n.preventNewMeasurement=!1);o.handles.end.active=!0,x.default.cornerstone.updateImage(element),Object(O.moveNewHandle)(r,n.name,o,o.handles.end,n.options,t,(function(e){e?(o.active=!1,x.default.cornerstone.updateImage(element)):Object(w.removeToolState)(element,n.name,o),n.preventNewMeasurement=!1,x.default.cornerstone.updateImage(element);var t={toolName:n.name,toolType:n.name,element:element,measurementData:o};Object(k.default)(element,L.default.MEASUREMENT_COMPLETED,t)}))}))}}}]),t}(j.default);function F(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function H(image,e,t){var n=Object(A.default)(image),r=n.rowPixelSpacing,o=n.colPixelSpacing;return{x:(e.x-t.x)*(o||1),y:(e.y-t.y)*(r||1)}}},"./tools/annotation/ArrowAnnotateTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return U}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./externalModules.js"),j=n("./tools/base/BaseAnnotationTool.js"),w=n("./events.js"),T=n("./stateManagement/toolStyle.js"),E=n("./stateManagement/textStyle.js"),O=n("./stateManagement/toolColors.js"),C=n("./manipulators/index.js"),S=n("./util/pointInsideBoundingBox.js"),I=n("./util/lineSegDistance.js"),M=n("./util/triggerEvent.js"),P=n("./stateManagement/toolState.js"),_=n("./drawing/drawLinkedTextBox.js"),D=n("./drawing/index.js"),k=n("./drawing/drawArrow.js"),L=n("./drawing/drawHandles.js"),A=n("./drawing/drawTextBox.js"),R=n("./tools/cursors/index.js"),B=n("./store/index.js"),U=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"ArrowAnnotate",supportedInteractionTypes:["Mouse","Touch"],configuration:{getTextCallback:F,changeTextCallback:H,drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,arrowFirst:!0,renderDashed:!1,allowEmptyLabel:!1},svgCursor:R.arrowAnnotateCursor};return(e=f()(this,m()(t).call(this,n,r))).preventNewMeasurement=!1,e}return y()(t,e),c()(t,[{key:"createNewMeasurement",value:function(e){return{visible:!0,active:!0,color:void 0,handles:{start:{x:e.detail.currentPoints.image.x,y:e.detail.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.detail.currentPoints.image.x,y:e.detail.currentPoints.image.y,highlight:!0,active:!1},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(element,data,e){return!1!==data.visible&&Object(I.default)(element,data.handles.start,data.handles.end,e)<25}},{key:"updateCachedStats",value:function(){}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,element=n.element,r=n.enabledElement,o=this.configuration,l=o.handleRadius,c=o.drawHandlesOnHover,d=o.hideHandlesIfMoving,f=o.renderDashed,h=Object(P.getToolState)(element,this.name);if(h){var m,canvas=e.detail.canvasContext.canvas,v=Object(D.getNewContext)(canvas),y=T.default.getToolWidth();f&&(m=Object(B.getModule)("globalConfiguration").configuration.lineDash);for(var j=function(i){var data=h.data[i];if(!1===data.visible)return"continue";Object(D.draw)(v,(function(n){Object(D.setShadow)(n,t.configuration);var o=O.default.getColorIfActive(data),f=x.default.cornerstone.pixelToCanvas(element,data.handles.start),h=x.default.cornerstone.pixelToCanvas(element,data.handles.end);t.configuration.arrowFirst?Object(k.default)(n,h,f,o,y,m):Object(k.default)(n,f,h,o,y,m);var v={color:o,handleRadius:l,drawHandlesIfActive:c,hideHandlesIfMoving:d};t.configuration.drawHandles&&Object(L.default)(n,e.detail,data.handles,v);var text=function(data){return data.text}(data);if(text&&""!==text){var j=Object(A.textBoxWidth)(n,text,5),T=E.default.getFontSize()+10,C=Math.max(j,T)/2+5;if(h.x<f.x&&(C=-C),!data.handles.textBox.hasMoved){var S;S=t.configuration.arrowFirst?{x:h.x-j/2+C,y:h.y-T/2}:{x:f.x-j/2-C,y:f.y-T/2};var I=x.default.cornerstone.internal.getTransform(r);I.invert();var M=I.transformPoint(S.x,S.y);data.handles.textBox.x=M.x,data.handles.textBox.y=M.y}Object(_.default)(n,element,data.handles.textBox,text,data.handles,w,o,y,0,!1)}}))},i=0;i<h.data.length;i++)j(i)}function w(e){var t={x:(e.start.x+e.end.x)/2,y:(e.start.y+e.end.y)/2};return[e.start,t,e.end]}}},{key:"addNewMeasurement",value:function(e,t){var n=this,element=e.detail.element,r=this.createNewMeasurement(e),o=this.configuration.allowEmptyLabel;Object(P.addToolState)(element,this.name,r),x.default.cornerstone.updateImage(element),Object(C.moveNewHandle)(e.detail,this.name,r,r.handles.end,this.options,t,(function(t){t?void 0===r.text&&n.configuration.getTextCallback((function(text){if(text||o){r.text=text,r.active=!1;var e={toolName:n.name,toolType:n.name,element:element,measurementData:r};x.default.cornerstone.updateImage(element),Object(M.default)(element,w.default.MEASUREMENT_COMPLETED,e)}else Object(P.removeToolState)(element,n.name,r)}),e.detail):Object(P.removeToolState)(element,n.name,r),x.default.cornerstone.updateImage(element)}))}},{key:"doubleClickCallback",value:function(e){return this._updateTextForNearbyAnnotation(e)}},{key:"touchPressCallback",value:function(e){return this._updateTextForNearbyAnnotation(e)}},{key:"_updateTextForNearbyAnnotation",value:function(e){var element=e.detail.element,t=e.detail.currentPoints.canvas,n=Object(P.getToolState)(element,this.name);if(!n)return!1;for(var i=0;i<n.data.length;i++){var data=n.data[i];if(this.pointNearTool(element,data,t)||Object(S.default)(data.handles.textBox,t))return data.active=!0,x.default.cornerstone.updateImage(element),this.configuration.changeTextCallback(data,e.detail,this._doneChangingTextCallback.bind(this,element,data)),e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation(),!0}}},{key:"_doneChangingTextCallback",value:function(element,e,t,n){!0===n?Object(P.removeToolState)(element,this.name,e):e.text=t,e.active=!1,x.default.cornerstone.updateImage(element),Object(M.default)(element,w.default.MEASUREMENT_MODIFIED,{toolName:this.name,toolType:this.name,element:element,measurementData:e})}}]),t}(j.default);function F(e){e(prompt("Enter your annotation:"))}function H(data,e,t){t(prompt("Change your annotation:"))}},"./tools/annotation/BidirectionalTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return R}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),y=n.n(v),x=n("../node_modules/@babel/runtime/helpers/inherits.js"),j=n.n(x),w=n("./tools/base/BaseAnnotationTool.js"),T=n("./tools/annotation/bidirectionalTool/createNewMeasurement.js"),E=n("./tools/annotation/bidirectionalTool/pointNearTool.js"),O=n("./tools/annotation/bidirectionalTool/renderToolData.js"),C=n("./tools/annotation/bidirectionalTool/addNewMeasurement.js"),S=n("./tools/annotation/bidirectionalTool/mouseMoveCallback.js"),I=n("./tools/annotation/bidirectionalTool/handleSelectedCallback.js"),M=n("./tools/annotation/bidirectionalTool/handleSelectedMouseCallback.js"),P=n("./tools/annotation/bidirectionalTool/handleSelectedTouchCallback.js"),_=n("./tools/cursors/index.js"),D=n("./util/throttle.js"),k=n("./util/getPixelSpacing.js"),L=n("./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js"),A=function(e,t,n){return n()},R=function(e){function t(e){var n;o()(this,t);var r={name:"Bidirectional",supportedInteractionTypes:["Mouse","Touch"],configuration:{changeMeasurementLocationCallback:A,getMeasurementLocationCallback:A,textBox:"",shadow:"",drawHandles:!0,drawHandlesOnHover:!0,hideHandlesIfMoving:!1,renderDashed:!1,additionalData:[]},svgCursor:_.bidirectionalCursor};return(n=f()(this,m()(t).call(this,e,r))).throttledUpdateCachedStats=Object(D.default)(n.updateCachedStats,110),n.createNewMeasurement=T.default.bind(y()(n)),n.pointNearTool=E.default.bind(y()(n)),n.renderToolData=O.default.bind(y()(n)),n.addNewMeasurement=C.default.bind(y()(n)),n._moveCallback=S.default.bind(y()(n)),n.handleSelectedCallback=I.default.bind(y()(n)),n.handleSelectedMouseCallback=M.default.bind(y()(n)),n.handleSelectedTouchCallback=P.default.bind(y()(n)),n}return j()(t,e),c()(t,[{key:"updateCachedStats",value:function(image,element,data){if(data.toolName===this.name){var e=Object(k.default)(image),t=Object(L.default)(data,e),n=t.longestDiameter,r=t.shortestDiameter;data.longestDiameter=n,data.shortestDiameter=r,data.invalidated=!1}}}]),t}(w.default)},"./tools/annotation/CircleRoiTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return B}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./externalModules.js"),j=n("./tools/base/BaseAnnotationTool.js"),w=n("./stateManagement/toolState.js"),T=n("./stateManagement/toolStyle.js"),E=n("./stateManagement/toolColors.js"),O=n("./store/index.js"),C=n("./drawing/index.js"),S=n("./util/calculateSUV.js"),I=n("./util/ellipse/index.js"),M=n("./util/getROITextBoxCoords.js"),P=n("./util/numbersWithCommas.js"),_=n("./util/throttle.js"),D=n("./util/logger.js"),k=n("./util/getPixelSpacing.js"),L=n("./tools/cursors/index.js"),A=n("./util/getCircleCoords.js"),R=Object(D.getLogger)("tools:annotation:CircleRoiTool"),B=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"CircleRoi",supportedInteractionTypes:["Mouse","Touch"],svgCursor:L.circleRoiCursor,configuration:{centerPointRadius:0,renderDashed:!1,hideHandlesIfMoving:!1}};return(e=f()(this,m()(t).call(this,n,r))).throttledUpdateCachedStats=Object(_.default)(e.updateCachedStats,110),e}return y()(t,e),c()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},initialRotation:e.viewport.rotation,textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};R.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(element,data,e,t){var n=data&&data.handles&&data.handles.start&&data.handles.end,r=x.default.cornerstoneMath.point.distance;if(n||R.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!n||!1===data.visible)return!1;var o="mouse"===t?15:25,l=x.default.cornerstone.pixelToCanvas(element,data.handles.start),c=x.default.cornerstone.pixelToCanvas(element,data.handles.end),d=r(l,e),f=r(l,c);return d>f-o/2&&d<f+o/2}},{key:"updateCachedStats",value:function(image,element,data){var e=(x.default.cornerstone.metaData.get("generalSeriesModule",image.imageId)||{}).modality,t=Object(k.default)(image),n=function(image,element,e,t,n){var r,o=Object(A.default)(e.start,e.end),l=x.default.cornerstone.getPixels(element,o.left,o.top,o.width,o.height),c=Object(I.calculateEllipseStatistics)(l,o);"PT"===t&&(r={mean:Object(S.default)(image,c.mean,!0)||0,stdDev:Object(S.default)(image,c.stdDev,!0)||0});var d=o.width*(n&&n.colPixelSpacing||1)/2,f=2*Math.PI*d;return{area:Math.PI*(o.width*(n&&n.colPixelSpacing||1)/2)*(o.height*(n&&n.rowPixelSpacing||1)/2)||0,radius:d||0,perimeter:f||0,count:c.count||0,mean:c.mean||0,variance:c.variance||0,stdDev:c.stdDev||0,min:c.min||0,max:c.max||0,meanStdDevSUV:r}}(image,element,data.handles,e,t);data.cachedStats=n,data.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=Object(w.getToolState)(e.currentTarget,this.name);if(n){var r=x.default.cornerstoneMath.point.distance,o=e.detail,image=o.image,element=o.element,l=o.canvasContext,c=T.default.getToolWidth(),d=this.configuration,f=d.handleRadius,h=d.drawHandlesOnHover,m=d.hideHandlesIfMoving,v=d.renderDashed,y=d.centerPointRadius,j=Object(C.getNewContext)(l.canvas),S=Object(k.default)(image),I=S.rowPixelSpacing,P=S.colPixelSpacing,_=Object(O.getModule)("globalConfiguration").configuration.lineDash,D=(x.default.cornerstone.metaData.get("generalSeriesModule",image.imageId)||{}).modality,L=I&&P;Object(C.draw)(j,(function(e){for(var i=0;i<n.data.length;i++){var data=n.data[i];if(!1!==data.visible){var l=E.default.getColorIfActive(data),d={color:l,handleRadius:f,drawHandlesIfActive:h,hideHandlesIfMoving:m};Object(C.setShadow)(e,t.configuration);var j=x.default.cornerstone.pixelToCanvas(element,data.handles.start),w=x.default.cornerstone.pixelToCanvas(element,data.handles.end),T=r(j,w),O={color:l};if(v&&(O.lineDash=_),Object(C.drawCircle)(e,element,data.handles.start,T,O,"pixel"),y&&T>3*y&&Object(C.drawCircle)(e,element,data.handles.start,y,O,"pixel"),data.handles&&(data.handles.start.drawnIndependently=!0,data.handles.end.drawnIndependently=!0),Object(C.drawHandles)(e,o,data.handles,d),!0===data.invalidated&&(data.cachedStats?t.throttledUpdateCachedStats(image,element,data):t.updateCachedStats(image,element,data)),!data.handles.textBox.hasMoved){var S=Object(M.default)(o.viewport,data.handles);Object.assign(data.handles.textBox,S)}var I=F(e,image.color,data.cachedStats,D,L,t.configuration);data.unit=U(D,t.configuration.showHounsfieldUnits),Object(C.drawLinkedTextBox)(e,element,data.handles.textBox,I,data.handles,(function(e){return t=e.start,n=e.end,r=Object(A.default)(t,n),o=r.left,l=r.top,c=r.width,d=r.height,[{x:o+c/2,y:l},{x:o,y:l+d/2},{x:o+c/2,y:l+d},{x:o+c,y:l+d/2}];var t,n,r,o,l,c,d}),l,c,10,!0)}}}))}}}]),t}(j.default);function U(e,t){return"CT"===e&&!1!==t?"HU":""}function F(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.area,area=void 0===r?0:r,o=n.radius,l=void 0===o?0:o,c=n.perimeter,d=void 0===c?0:c,f=n.mean,h=void 0===f?0:f,m=n.stdDev,v=void 0===m?0:m,y=n.min,x=void 0===y?0:y,j=n.max,w=void 0===j?0:j,T=n.meanStdDevSUV,E=void 0===T?0:T,O=arguments.length>3?arguments[3]:void 0,C=arguments.length>4?arguments[4]:void 0,S=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},I=S.showMinMax||!1,M=[],_=[];if(!t){var D=E&&0!==E.mean,k=U(O,S.showHounsfieldUnits),L="Mean: ".concat(Object(P.default)(h.toFixed(2))," ").concat(k),A="Std Dev: ".concat(Object(P.default)(v.toFixed(2))," ").concat(k);if(D){for(var R=" SUV: ",B="".concat(R).concat(Object(P.default)(E.mean.toFixed(2))),F="".concat(R).concat(Object(P.default)(E.stdDev.toFixed(2))),z=Math.floor(e.measureText("".concat(A,"     ")).width);e.measureText(L).width<z;)L+=" ";_.push("".concat(L).concat(B)),_.push("".concat(A,"     ").concat(F))}else _.push("".concat(L,"     ").concat(A));if(I){for(var V="Min: ".concat(x," ").concat(k),W="Max: ".concat(w," ").concat(k),G=D?Math.floor(e.measureText("".concat(A,"     ")).width):Math.floor(e.measureText("".concat(L,"     ")).width);e.measureText(V).width<G;)V+=" ";_.push("".concat(V).concat(W))}}return M.push(H(area,C)),l&&M.push(N(l,"Radius",C)),d&&M.push(N(d,"Perimeter",C)),_.forEach((function(e){return M.push(e)})),M}function H(area,e){var t=e?" mm".concat(String.fromCharCode(178)):" px".concat(String.fromCharCode(178));return"Area: ".concat(Object(P.default)(area.toFixed(2))).concat(t)}function N(e,t,n){if(!e)return"";var r=n?" mm":" px";return"".concat(t,": ").concat(Object(P.default)(e.toFixed(1))).concat(r)}},"./tools/annotation/CobbAngleTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return U}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./externalModules.js"),j=n("./tools/base/BaseAnnotationTool.js"),w=n("./stateManagement/textStyle.js"),T=n("./stateManagement/toolState.js"),E=n("./stateManagement/toolStyle.js"),O=n("./stateManagement/toolColors.js"),C=n("./manipulators/index.js"),S=n("./drawing/index.js"),I=n("./drawing/drawHandles.js"),M=n("./drawing/drawLinkedTextBox.js"),P=n("./util/lineSegDistance.js"),_=n("./util/roundToDecimal.js"),D=n("./events.js"),k=n("./tools/cursors/index.js"),L=n("./util/triggerEvent.js"),A=n("./util/throttle.js"),R=n("./util/getPixelSpacing.js"),B=n("./store/index.js"),U=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"CobbAngle",supportedInteractionTypes:["Mouse","Touch"],svgCursor:k.cobbAngleCursor,configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1}};return(e=f()(this,m()(t).call(this,n,r))).hasIncomplete=!1,e.throttledUpdateCachedStats=Object(A.default)(e.updateCachedStats,110),e}return y()(t,e),c()(t,[{key:"createNewMeasurement",value:function(e){return this.hasIncomplete=!0,{visible:!0,active:!0,color:void 0,invalidated:!0,complete:!1,value:"",handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},start2:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1,drawnIndependently:!0},end2:{x:e.currentPoints.image.x+1,y:e.currentPoints.image.y,highlight:!0,active:!1,drawnIndependently:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}},{key:"pointNearTool",value:function(element,data,e){if(!1===data.visible)return!1;if(this.hasIncomplete)return!1;var t=Object(P.default)(element,data.handles.start,data.handles.end,e)<25,n=Object(P.default)(element,data.handles.start2,data.handles.end2,e)<25;return t||n}},{key:"updateCachedStats",value:function(image,element,data){var e=Object(R.default)(image),t=e.rowPixelSpacing,n=e.colPixelSpacing,r=(Math.ceil(data.handles.start.x)-Math.ceil(data.handles.end.x))*(n||1),o=(Math.ceil(data.handles.start.y)-Math.ceil(data.handles.end.y))*(t||1),l=(Math.ceil(data.handles.start2.x)-Math.ceil(data.handles.end2.x))*(n||1),c=(Math.ceil(data.handles.start2.y)-Math.ceil(data.handles.end2.y))*(t||1),d=Math.acos(Math.abs((r*l+o*c)/(Math.sqrt(r*r+o*o)*Math.sqrt(l*l+c*c))));d*=180/Math.PI,data.rAngle=Object(_.default)(d,2),data.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,r=this.configuration,o=r.handleRadius,l=r.drawHandlesOnHover,c=r.hideHandlesIfMoving,d=r.renderDashed,f=Object(T.getToolState)(e.currentTarget,this.name);if(f)for(var h=Object(S.getNewContext)(n.canvasContext.canvas),m=E.default.getToolWidth(),v=Object(B.getModule)("globalConfiguration").configuration.lineDash,y=w.default.getFont(),element=e.detail.element,image=x.default.cornerstone.getEnabledElement(element).image,j=Object(R.default)(image),C=j.rowPixelSpacing,P=j.colPixelSpacing,_=function(i){var data=f.data[i];if(!1===data.visible)return"continue";data.value||(data.value=t.textBoxText(data,C,P)),Object(S.draw)(h,(function(e){Object(S.setShadow)(e,t.configuration);var r=O.default.getColorIfActive(data),f={color:r};d&&(f.lineDash=v),Object(S.drawLine)(e,n.element,data.handles.start,data.handles.end,f),data.complete&&Object(S.drawLine)(e,n.element,data.handles.start2,data.handles.end2,f);var h={color:r,handleRadius:o,drawHandlesIfActive:l,hideHandlesIfMoving:c};t.configuration.drawHandles&&Object(I.default)(e,n,data.handles,h),e.fillStyle=r;var text=data.value;if(!data.handles.textBox.hasMoved){var x={x:(data.handles.start.x+data.handles.end.x)/2,y:(data.handles.start.y+data.handles.end.y)/2-10};e.font=y,data.handles.textBox.x=x.x,data.handles.textBox.y=x.y}Object(M.default)(e,n.element,data.handles.textBox,text,data.handles,D,r,m,0,!0)}))},i=0;i<f.data.length;i++)_(i);function D(e){return[e.start,e.start2,e.end,e.end2]}}},{key:"getIncomplete",value:function(element){var e=Object(T.getToolState)(element,this.name);if(e&&Array.isArray(e.data))return e.data.find((function(e){return!1===e.complete}))}},{key:"addNewMeasurement",value:function(e,t){var n=this;e.preventDefault(),e.stopPropagation();var r,o,l=e.detail,c=function(e){if(e){var t=D.default.MEASUREMENT_COMPLETED,o={toolName:n.name,toolType:n.name,element:element,measurementData:r};Object(L.default)(element,t,o)}else Object(T.removeToolState)(element,n.name,r)},element=e.detail.element,d=this.getIncomplete(element);d?((r=d).complete=!0,r.handles.start2={x:l.currentPoints.image.x,y:l.currentPoints.image.y,drawnIndependently:!1,highlight:!0,active:!1},r.handles.end2={x:l.currentPoints.image.x,y:l.currentPoints.image.y,drawnIndependently:!1,highlight:!0,active:!0},o=r.handles.end2,this.hasIncomplete=!1,c=function(e){if(e){var t=D.default.MEASUREMENT_COMPLETED,o={toolName:n.name,toolType:n.name,element:element,measurementData:r};Object(L.default)(element,t,o)}else Object(T.removeToolState)(element,n.name,r)}):(r=this.createNewMeasurement(l),Object(T.addToolState)(element,this.name,r),o=r.handles.end),x.default.cornerstone.updateImage(element),Object(C.moveNewHandle)(l,this.name,r,o,this.options,t,c)}},{key:"onMeasureModified",value:function(e){var element=e.detail.element,image=x.default.cornerstone.getEnabledElement(element).image,t=Object(R.default)(image),n=t.rowPixelSpacing,r=t.colPixelSpacing;if(e.detail.toolName===this.name){var data=e.detail.measurementData;!0===data.invalidated&&(data.rAngle?this.throttledUpdateCachedStats(image,element,data):this.updateCachedStats(image,element,data)),data.value=this.textBoxText(data,n,r)}}},{key:"textBoxText",value:function(e,t,n){var r=e.rAngle;if(void 0===r)return"";if(Number.isNaN(r))return"";var o=t&&n?"":" (isotropic)";return"".concat(r,"°").concat(o)}},{key:"activeCallback",value:function(element){this.onMeasureModified=this.onMeasureModified.bind(this),element.addEventListener(D.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"passiveCallback",value:function(element){this.onMeasureModified=this.onMeasureModified.bind(this),element.addEventListener(D.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"enabledCallback",value:function(element){element.removeEventListener(D.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}},{key:"disabledCallback",value:function(element){element.removeEventListener(D.default.MEASUREMENT_MODIFIED,this.onMeasureModified)}}]),t}(j.default)},"./tools/annotation/EllipticalRoiTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return B}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./externalModules.js"),j=n("./tools/base/BaseAnnotationTool.js"),w=n("./stateManagement/toolState.js"),T=n("./stateManagement/toolStyle.js"),E=n("./stateManagement/toolColors.js"),O=n("./manipulators/getHandleNearImagePoint.js"),C=n("./drawing/index.js"),S=n("./util/calculateSUV.js"),I=n("./util/ellipse/index.js"),M=n("./util/getROITextBoxCoords.js"),P=n("./util/numbersWithCommas.js"),_=n("./util/throttle.js"),D=n("./tools/cursors/index.js"),k=n("./util/logger.js"),L=n("./util/getPixelSpacing.js"),A=n("./store/index.js"),R=Object(k.getLogger)("tools:annotation:EllipticalRoiTool"),B=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"EllipticalRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1},svgCursor:D.ellipticalRoiCursor};return(e=f()(this,m()(t).call(this,n,r))).throttledUpdateCachedStats=Object(_.default)(e.updateCachedStats,110),e}return y()(t,e),c()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},initialRotation:e.viewport.rotation,textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};R.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(element,data,e,t){var n=data&&data.handles&&data.handles.start&&data.handles.end;if(n||R.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!n||!1===data.visible)return!1;if(Object(O.default)(element,data.handles,e,6))return!0;var r="mouse"===t?15:25,o=x.default.cornerstone.pixelToCanvas(element,data.handles.start),l=x.default.cornerstone.pixelToCanvas(element,data.handles.end),c={left:Math.min(o.x,l.x)+r/2,top:Math.min(o.y,l.y)+r/2,width:Math.abs(o.x-l.x)-r,height:Math.abs(o.y-l.y)-r},d={left:Math.min(o.x,l.x)-r/2,top:Math.min(o.y,l.y)-r/2,width:Math.abs(o.x-l.x)+r,height:Math.abs(o.y-l.y)+r},f=Object(I.pointInEllipse)(c,e);return!(!Object(I.pointInEllipse)(d,e)||f)}},{key:"updateCachedStats",value:function(image,element,data){var e=(x.default.cornerstone.metaData.get("generalSeriesModule",image.imageId)||{}).modality,t=Object(L.default)(image),n=function(image,element,e,t,n){var r,o=N(e.start,e.end),l=x.default.cornerstone.getPixels(element,o.left,o.top,o.width,o.height),c=Object(I.calculateEllipseStatistics)(l,o);return"PT"===t&&(r={mean:Object(S.default)(image,c.mean,!0)||0,stdDev:Object(S.default)(image,c.stdDev,!0)||0}),{area:Math.PI*(o.width*(n.colPixelSpacing||1)/2)*(o.height*(n.rowPixelSpacing||1)/2)||0,count:c.count||0,mean:c.mean||0,variance:c.variance||0,stdDev:c.stdDev||0,min:c.min||0,max:c.max||0,meanStdDevSUV:r}}(image,element,data.handles,e,t);data.cachedStats=n,data.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=Object(w.getToolState)(e.currentTarget,this.name);if(n){var r=e.detail,image=r.image,element=r.element,o=T.default.getToolWidth(),l=Object(A.getModule)("globalConfiguration").configuration.lineDash,c=this.configuration,d=c.handleRadius,f=c.drawHandlesOnHover,h=c.hideHandlesIfMoving,m=c.renderDashed,v=Object(C.getNewContext)(r.canvasContext.canvas),y=Object(L.default)(image),j=y.rowPixelSpacing,O=y.colPixelSpacing,S=(x.default.cornerstone.metaData.get("generalSeriesModule",image.imageId)||{}).modality,I=j&&O;Object(C.draw)(v,(function(e){for(var i=0;i<n.data.length;i++){var data=n.data[i];if(!1!==data.visible){var c=E.default.getColorIfActive(data),v={color:c,handleRadius:d,drawHandlesIfActive:f,hideHandlesIfMoving:h};Object(C.setShadow)(e,t.configuration);var y={color:c};if(m&&(y.lineDash=l),Object(C.drawEllipse)(e,element,data.handles.start,data.handles.end,y,"pixel",data.handles.initialRotation),Object(C.drawHandles)(e,r,data.handles,v),!0===data.invalidated&&(data.cachedStats?t.throttledUpdateCachedStats(image,element,data):t.updateCachedStats(image,element,data)),!data.handles.textBox.hasMoved){var x=Object(M.default)(r.viewport,data.handles);Object.assign(data.handles.textBox,x)}var j=F(e,image.color,data.cachedStats,S,I,t.configuration);data.unit=U(S,t.configuration.showHounsfieldUnits),Object(C.drawLinkedTextBox)(e,element,data.handles.textBox,j,data.handles,(function(e){return t=e.start,n=e.end,r=N(t,n),o=r.left,l=r.top,c=r.width,d=r.height,[{x:o+c/2,y:l},{x:o,y:l+d/2},{x:o+c/2,y:l+d},{x:o+c,y:l+d/2}];var t,n,r,o,l,c,d}),c,o,10,!0)}}}))}}}]),t}(j.default);function U(e,t){return"CT"===e&&!1!==t?"HU":""}function F(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},area=n.area,r=n.mean,o=n.stdDev,l=n.min,c=n.max,d=n.meanStdDevSUV,f=arguments.length>3?arguments[3]:void 0,h=arguments.length>4?arguments[4]:void 0,m=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},v=m.showMinMax||!1,y=[],x=[];if(!t){var j=d&&0!==d.mean,w=U(f,m.showHounsfieldUnits),T="Mean: ".concat(Object(P.default)(r.toFixed(2))," ").concat(w),E="Std Dev: ".concat(Object(P.default)(o.toFixed(2))," ").concat(w);if(j){for(var O=" SUV: ",C="".concat(O).concat(Object(P.default)(d.mean.toFixed(2))),S="".concat(O).concat(Object(P.default)(d.stdDev.toFixed(2))),I=Math.floor(e.measureText("".concat(E,"     ")).width);e.measureText(T).width<I;)T+=" ";x.push("".concat(T).concat(C)),x.push("".concat(E,"     ").concat(S))}else x.push("".concat(T)),x.push("".concat(E));if(v){for(var M="Min: ".concat(l," ").concat(w),_="Max: ".concat(c," ").concat(w),D=j?Math.floor(e.measureText("".concat(E,"     ")).width):Math.floor(e.measureText("".concat(T,"     ")).width);e.measureText(M).width<D;)M+=" ";x.push("".concat(M).concat(_))}}return y.push(H(area,h)),x.forEach((function(e){return y.push(e)})),y}function H(area,e){var t=e?" mm".concat(String.fromCharCode(178)):" px".concat(String.fromCharCode(178));return"Area: ".concat(Object(P.default)(area.toFixed(2))).concat(t)}function N(e,t){return{left:Math.round(Math.min(e.x,t.x)),top:Math.round(Math.min(e.y,t.y)),width:Math.round(Math.abs(e.x-t.x)),height:Math.round(Math.abs(e.y-t.y))}}},"./tools/annotation/FreehandRoiTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return J}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),y=n.n(v),x=n("../node_modules/@babel/runtime/helpers/inherits.js"),j=n.n(x),w=n("./events.js"),T=n("./externalModules.js"),E=n("./tools/base/BaseAnnotationTool.js"),O=n("./stateManagement/toolState.js"),C=n("./stateManagement/toolStyle.js"),S=n("./stateManagement/toolColors.js"),I=n("./store/index.js"),M=n("./util/triggerEvent.js"),P=n("./util/findAndMoveHelpers.js"),_=n("./util/pointInsideBoundingBox.js"),D=n("./util/calculateSUV.js"),k=n("./util/numbersWithCommas.js"),L=n("./util/getPixelSpacing.js"),A=n("./drawing/index.js"),R=n("./drawing/drawLinkedTextBox.js"),B=n("./drawing/drawHandles.js"),U=n("./util/clip.js"),F=n("./store/setToolCursor.js"),H=n("./tools/cursors/index.js"),N=n("./util/freehand/index.js"),z=n("./util/logger.js"),V=n("./util/throttle.js"),W=Object(z.getLogger)("tools:annotation:FreehandRoiTool"),G=N.default.insertOrDelete,Y=N.default.freehandArea,X=N.default.calculateFreehandStatistics,Z=N.default.freehandIntersect,K=N.default.FreehandHandleData,J=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"FreehandRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{mouseLocation:{handles:{start:{highlight:!0,active:!0}}},spacing:1,activeHandleRadius:3,completeHandleRadius:6,completeHandleRadiusTouch:28,alwaysShowHandles:!1,invalidColor:"crimson",currentHandle:0,currentTool:-1,drawHandles:!0,renderDashed:!1},svgCursor:H.freehandRoiCursor};return(e=f()(this,m()(t).call(this,n,r))).isMultiPartTool=!0,e._drawing=!1,e._dragging=!1,e._modifying=!1,e._drawingMouseDownCallback=e._drawingMouseDownCallback.bind(y()(e)),e._drawingMouseMoveCallback=e._drawingMouseMoveCallback.bind(y()(e)),e._drawingMouseDragCallback=e._drawingMouseDragCallback.bind(y()(e)),e._drawingMouseUpCallback=e._drawingMouseUpCallback.bind(y()(e)),e._drawingMouseDoubleClickCallback=e._drawingMouseDoubleClickCallback.bind(y()(e)),e._editMouseUpCallback=e._editMouseUpCallback.bind(y()(e)),e._editMouseDragCallback=e._editMouseDragCallback.bind(y()(e)),e._drawingTouchStartCallback=e._drawingTouchStartCallback.bind(y()(e)),e._drawingTouchDragCallback=e._drawingTouchDragCallback.bind(y()(e)),e._drawingDoubleTapClickCallback=e._drawingDoubleTapClickCallback.bind(y()(e)),e._editTouchDragCallback=e._editTouchDragCallback.bind(y()(e)),e.throttledUpdateCachedStats=Object(V.default)(e.updateCachedStats,110),e}return j()(t,e),c()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image){var t={visible:!0,active:!0,invalidated:!0,color:void 0,handles:{points:[]}};return t.handles.textBox={active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0},t}W.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(element,data,e){var t=data&&data.handles&&data.handles.points;if(!t)throw new Error("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool"));return!(!t||!1===data.visible)&&void 0!==this._pointNearHandle(element,data,e)}},{key:"distanceFromPoint",value:function(element,data,e){for(var t=1/0,i=0;i<data.handles.points.length;i++){var n=T.default.cornerstoneMath.point.distance(data.handles.points[i],e);t=Math.min(t,n)}return t===1/0?-1:t}},{key:"distanceFromPointCanvas",value:function(element,data,e){var t=1/0;if(!data)return-1;for(var n=T.default.cornerstone.pixelToCanvas(element,e),r=data.handles.points,i=0;i<r.length;i++){var o=T.default.cornerstone.pixelToCanvas(element,r[i]),l=T.default.cornerstoneMath.point.distance(o,n);t=Math.min(t,l)}return t===1/0?-1:t}},{key:"updateCachedStats",value:function(image,element,data){for(var e,t,n=T.default.cornerstone.metaData.get("generalSeriesModule",image.imageId),r=n?n.modality:null,o=data.handles.points,l={left:o[0].x,right:o[0].x,bottom:o[0].y,top:o[0].x},i=0;i<o.length;i++)l.left=Math.min(l.left,o[i].x),l.right=Math.max(l.right,o[i].x),l.bottom=Math.min(l.bottom,o[i].y),l.top=Math.max(l.top,o[i].y);var c={left:l.left,top:l.bottom,width:Math.abs(l.right-l.left),height:Math.abs(l.top-l.bottom)};if(data.polyBoundingBox=c,!image.color){var d=T.default.cornerstone.getPixels(element,c.left,c.top,c.width,c.height);e=X.call(this,d,c,data.handles.points),"PT"===r&&(t={mean:Object(D.default)(image,(e.mean-image.intercept)/image.slope),stdDev:Object(D.default)(image,(e.stdDev-image.intercept)/image.slope)}),e&&!isNaN(e.mean)&&(data.meanStdDev=e,data.meanStdDevSUV=t)}var f=Object(L.default)(image),h=(f.colPixelSpacing||1)*(f.rowPixelSpacing||1),area=Y(data.handles.points,h);isNaN(area)||(data.area=area),data.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,r=Object(O.getToolState)(e.currentTarget,this.name);if(r)for(var image=n.image,element=n.element,o=this.configuration,l=T.default.cornerstone.metaData.get("generalSeriesModule",image.imageId),c=l?l.modality:null,d=Object(A.getNewContext)(n.canvasContext.canvas),f=C.default.getToolWidth(),h=o.renderDashed,m=Object(I.getModule)("globalConfiguration").configuration.lineDash,v=function(i){var data=r.data[i];if(!1===data.visible)return"continue";Object(A.draw)(d,(function(e){var r,l=S.default.getColorIfActive(data);data.active?data.handles.invalidHandlePlacement?(l=o.invalidColor,r=o.invalidColor):(l=S.default.getColorIfActive(data),r=S.default.getFillColor()):r=S.default.getToolColor();var c={color:l};if(h&&(c.lineDash=m),data.handles.points.length){var d=data.handles.points;Object(A.drawJoinedLines)(e,element,d[0],d,c),data.polyBoundingBox?Object(A.drawJoinedLines)(e,element,d[d.length-1],[d[0]],c):Object(A.drawJoinedLines)(e,element,d[d.length-1],[o.mouseLocation.handles.start],c)}if(c={color:l,fill:r},(o.alwaysShowHandles||data.active&&data.polyBoundingBox)&&(c.handleRadius=o.activeHandleRadius,t.configuration.drawHandles&&Object(B.default)(e,n,data.handles.points,c)),data.canComplete){c.handleRadius=o.completeHandleRadius;var v=data.handles.points[0];t.configuration.drawHandles&&Object(B.default)(e,n,[v],c)}if(data.active&&!data.polyBoundingBox){c.handleRadius=o.activeHandleRadius,t.configuration.drawHandles&&Object(B.default)(e,n,o.mouseLocation.handles,c);var j=data.handles.points[0];t.configuration.drawHandles&&Object(B.default)(e,n,[j],c)}if(!0!==data.invalidated||data.active||(data.meanStdDev&&data.meanStdDevSUV&&data.area?t.throttledUpdateCachedStats(image,element,data):t.updateCachedStats(image,element,data)),data.polyBoundingBox&&!data.handles.textBox.freehand){data.handles.textBox.hasMoved||(data.handles.textBox.x=data.polyBoundingBox.left+data.polyBoundingBox.width,data.handles.textBox.y=data.polyBoundingBox.top+data.polyBoundingBox.height/2);var text=y.call(t,data);Object(R.default)(e,element,data.handles.textBox,text,data.handles.points,x,l,f,0,!0)}}))},i=0;i<r.data.length;i++)v(i);function y(data){var e=data.meanStdDev,t=data.meanStdDevSUV,area=data.area,n=[];if(e&&void 0!==e.mean){var r="";"CT"===c&&(r="HU"),data.unit=r;var o="Mean: ".concat(Object(k.default)(e.mean.toFixed(2))," ").concat(r),l="StdDev: ".concat(Object(k.default)(e.stdDev.toFixed(2))," ").concat(r);if(t&&void 0!==t.mean){var d=" SUV: ";o+=d+Object(k.default)(t.mean.toFixed(2)),l+=d+Object(k.default)(t.stdDev.toFixed(2))}n.push(o),n.push(l)}if(area){var f=" mm".concat(String.fromCharCode(178)),h=Object(L.default)(image),m=h.rowPixelSpacing,v=h.colPixelSpacing;m&&v||(f=" pixels".concat(String.fromCharCode(178)));var y="Area: ".concat(Object(k.default)(area.toFixed(2))).concat(f);n.push(y)}return n}function x(e){return e}}},{key:"addNewMeasurement",value:function(e){var t=e.detail;this._startDrawing(e),this._addPoint(t),$(e)}},{key:"preMouseDownCallback",value:function(e){var t=e.detail,n=this._pointNearHandleAllTools(t);return!!t.event.ctrlKey&&(void 0!==n&&n.handleNearby.hasBoundingBox||G.call(this,e,n),$(e),!0)}},{key:"handleSelectedCallback",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",element=e.detail.element,o=Object(O.getToolState)(element,this.name);if(n.hasBoundingBox)Object(P.moveHandleNearImagePoint)(e,this,t,n,r);else{var l=this.configuration;l.dragOrigin={x:n.x,y:n.y};for(var c=0;c<o.data.length;c++)for(var d=o.data[c].handles.points,p=0;p<d.length;p++)d[p]===n&&(l.currentHandle=p,l.currentTool=c);this._modifying=!0,this._activateModify(element),$(e)}}},{key:"_drawingMouseMoveCallback",value:function(e){var t=e.detail,n=t.currentPoints,element=t.element,r=Object(O.getToolState)(element,this.name),o=this.configuration,l=o.currentTool,data=r.data[l],c=n.canvas;this._getMouseLocation(t),this._checkInvalidHandleLocation(data,t);var d=this._pointNearHandle(element,data,c),f=data.handles.points;void 0!==d&&!d.hasBoundingBox&&d<f.length-1&&(o.mouseLocation.handles.start.x=f[d].x,o.mouseLocation.handles.start.y=f[d].y),T.default.cornerstone.updateImage(element)}},{key:"_drawingMouseDragCallback",value:function(e){this.options.mouseButtonMask.includes(e.detail.buttons)&&this._drawingDrag(e)}},{key:"_drawingTouchDragCallback",value:function(e){this._drawingDrag(e)}},{key:"_drawingDrag",value:function(e){var t=e.detail,element=t.element,n=Object(O.getToolState)(element,this.name),r=this.configuration.currentTool,data=n.data[r];this._getMouseLocation(t),this._checkInvalidHandleLocation(data,t),this._addPointPencilMode(t,data.handles.points),this._dragging=!0,T.default.cornerstone.updateImage(element)}},{key:"_drawingMouseUpCallback",value:function(e){var element=e.detail.element;if(this._dragging){this._dragging=!1;var t=this.configuration,n=t.currentTool,data=Object(O.getToolState)(element,this.name).data[n];if(!Z.end(data.handles.points)&&data.canComplete){var r=t.currentHandle;this._endDrawing(element,r)}$(e)}}},{key:"_drawingMouseDownCallback",value:function(e){var t=e.detail,n=t.buttons,r=t.currentPoints,element=t.element;if(this.options.mouseButtonMask.includes(n)){var o=r.canvas,l=this.configuration,c=l.currentTool,data=Object(O.getToolState)(element,this.name).data[c],d=this._pointNearHandle(element,data,o);if(!Z.end(data.handles.points)&&data.canComplete){var f=l.currentHandle;this._endDrawing(element,f)}else void 0===d&&this._addPoint(t);$(e)}}},{key:"_drawingTouchStartCallback",value:function(e){var t=e.detail,n=t.currentPoints,element=t.element,r=n.canvas,o=this.configuration,l=o.currentTool,data=Object(O.getToolState)(element,this.name).data[l],c=this._pointNearHandle(element,data,r);if(!Z.end(data.handles.points)&&data.canComplete){var d=o.currentHandle;this._endDrawing(element,d)}else void 0===c&&this._addPoint(t);$(e)}},{key:"completeDrawing",value:function(element){if(this._drawing){var e=Object(O.getToolState)(element,this.name),t=this.configuration,data=e.data[t.currentTool];if(!Z.end(data.handles.points)&&data.handles.points.length>=2){var n=t.currentHandle;data.polyBoundingBox={},this._endDrawing(element,n)}}}},{key:"_drawingMouseDoubleClickCallback",value:function(e){var element=e.detail.element;this.completeDrawing(element),$(e)}},{key:"_drawingDoubleTapClickCallback",value:function(e){var element=e.detail.element;this.completeDrawing(element),$(e)}},{key:"_editMouseDragCallback",value:function(e){var t=e.detail,element=t.element,n=t.buttons;if(this.options.mouseButtonMask.includes(n)){var r,o=Object(O.getToolState)(element,this.name),l=this.configuration,data=o.data[l.currentTool],c=l.currentHandle,d=data.handles.points;if(this._getMouseLocation(t),data.handles.invalidHandlePlacement=Z.modify(d,c),data.active=!0,data.highlight=!0,d[c].x=l.mouseLocation.handles.start.x,d[c].y=l.mouseLocation.handles.start.y,r=this._getPrevHandleIndex(c,d),c>=0){var f=d[r].lines.length-1,h=d[r].lines[f];h.x=l.mouseLocation.handles.start.x,h.y=l.mouseLocation.handles.start.y}T.default.cornerstone.updateImage(element)}}},{key:"_editTouchDragCallback",value:function(e){var t,n=e.detail,element=n.element,r=Object(O.getToolState)(element,this.name),o=this.configuration,data=r.data[o.currentTool],l=o.currentHandle,c=data.handles.points;if(this._getMouseLocation(n),data.handles.invalidHandlePlacement=Z.modify(c,l),data.active=!0,data.highlight=!0,c[l].x=o.mouseLocation.handles.start.x,c[l].y=o.mouseLocation.handles.start.y,t=this._getPrevHandleIndex(l,c),l>=0){var d=c[t].lines.length-1,f=c[t].lines[d];f.x=o.mouseLocation.handles.start.x,f.y=o.mouseLocation.handles.start.y}T.default.cornerstone.updateImage(element)}},{key:"_getPrevHandleIndex",value:function(e,t){return 0===e?t.length-1:e-1}},{key:"_editMouseUpCallback",value:function(e){var t=e.detail,element=t.element,n=Object(O.getToolState)(element,this.name);this._deactivateModify(element),this._dropHandle(t,n),this._endDrawing(element),T.default.cornerstone.updateImage(element)}},{key:"_dropHandle",value:function(e,t){var n=this.configuration,r=n.currentTool,o=t.data[r].handles,l=o.points;if(o.invalidHandlePlacement){var c,d=n.currentHandle,f=l[d];c=0===d?l[l.length-1]:l[d-1],f.x=n.dragOrigin.x,f.y=n.dragOrigin.y,c.lines[0]=f,o.invalidHandlePlacement=!1}}},{key:"_startDrawing",value:function(e){var t,n=e.detail,r=this.createNewMeasurement(n),element=n.element,o=this.configuration;e.type===w.default.MOUSE_DOWN_ACTIVATE?t="Mouse":e.type===w.default.TOUCH_START_ACTIVE&&(t="Touch"),this._activateDraw(element,t),this._getMouseLocation(n),Object(O.addToolState)(element,this.name,r);var l=Object(O.getToolState)(element,this.name);o.currentTool=l.data.length-1,this._activeDrawingToolReference=l.data[o.currentTool]}},{key:"_addPoint",value:function(e){var t=e.currentPoints,element=e.element,n=Object(O.getToolState)(element,this.name),r=this.configuration,data=n.data[r.currentTool];if(!data.handles.invalidHandlePlacement){var o=new K(t.image);data.handles.points.length&&data.handles.points[r.currentHandle-1].lines.push(t.image),data.handles.points.push(o),r.currentHandle+=1,T.default.cornerstone.updateImage(element),this.fireModifiedEvent(element,data)}}},{key:"_addPointPencilMode",value:function(e,t){var n=this,r=this.configuration,element=e.element,o=r.mouseLocation.handles.start;t.every((function(e){return n._isDistanceLargerThanSpacing(element,e,o)}))&&this._addPoint(e)}},{key:"_endDrawing",value:function(element,e){var t=Object(O.getToolState)(element,this.name),n=this.configuration,data=t.data[n.currentTool];if(data.active=!1,data.highlight=!1,data.handles.invalidHandlePlacement=!1,void 0!==e){var r=data.handles.points;r[n.currentHandle-1].lines.push(r[0])}this._modifying&&(this._modifying=!1,data.invalidated=!0),n.currentHandle=0,n.currentTool=-1,data.canComplete=!1,this._drawing&&this._deactivateDraw(element),T.default.cornerstone.updateImage(element),this.fireModifiedEvent(element,data),this.fireCompletedEvent(element,data)}},{key:"_pointNearHandle",value:function(element,data,e){if(void 0!==data.handles&&void 0!==data.handles.points&&!1!==data.visible){for(var i=0;i<data.handles.points.length;i++){var t=T.default.cornerstone.pixelToCanvas(element,data.handles.points[i]);if(T.default.cornerstoneMath.point.distance(t,e)<6)return i}return data.handles.textBox&&Object(_.default)(data.handles.textBox,e)?data.handles.textBox:void 0}}},{key:"_pointNearHandleAllTools",value:function(e){var t=e.currentPoints,element=e.element,n=t.canvas,r=Object(O.getToolState)(element,this.name);if(r)for(var o,l=0;l<r.data.length;l++)if(void 0!==(o=this._pointNearHandle(element,r.data[l],n)))return{handleNearby:o,toolIndex:l}}},{key:"_getMouseLocation",value:function(e){var t=e.currentPoints,image=e.image,n=this.configuration;n.mouseLocation.handles.start.x=t.image.x,n.mouseLocation.handles.start.y=t.image.y,Object(U.clipToBox)(n.mouseLocation.handles.start,image)}},{key:"_checkInvalidHandleLocation",value:function(data,e){if(data.handles.points.length<2)return!0;var t;t=this._dragging?this._checkHandlesPencilMode(data,e):this._checkHandlesPolygonMode(data,e),data.handles.invalidHandlePlacement=t}},{key:"_checkHandlesPolygonMode",value:function(data,e){var t=this.configuration,element=e.element,n=t.mouseLocation.handles.start,r=data.handles.points,o=!1;return data.canComplete=!1,this._isDistanceSmallerThanCompleteSpacingCanvas(element,r[0],n)&&!Z.end(r)&&r.length>2?(data.canComplete=!0,o=!1):o=Z.newHandle(n,r),o}},{key:"_checkHandlesPencilMode",value:function(data,e){var t=this.configuration.mouseLocation.handles.start,n=data.handles.points,r=Z.newHandle(t,n);return!1===r&&(r=this._invalidHandlePencilMode(data,e)),r}},{key:"_invalidHandlePencilMode",value:function(data,e){var t=this.configuration,element=e.element,n=t.mouseLocation.handles.start,r=data.handles.points;if(this._isDistanceSmallerThanCompleteSpacingCanvas(element,r[0],n))return data.canComplete=!0,!1;data.canComplete=!1;for(var i=1;i<r.length-1;i++)if(this._isDistanceSmallerThanSpacing(element,r[i],n))return!0;return!1}},{key:"_isDistanceSmallerThanCompleteSpacingCanvas",value:function(element,e,t){var n,r=T.default.cornerstone.pixelToCanvas(element,e),o=T.default.cornerstone.pixelToCanvas(element,t);return"Mouse"===this._drawingInteractionType?n=this.configuration.completeHandleRadius:"Touch"===this._drawingInteractionType&&(n=this.configuration.completeHandleRadiusTouch),this._compareDistanceToSpacing(element,r,o,"<",n)}},{key:"_isDistanceSmallerThanSpacing",value:function(element,e,t){return this._compareDistanceToSpacing(element,e,t,"<")}},{key:"_isDistanceLargerThanSpacing",value:function(element,e,t){return this._compareDistanceToSpacing(element,e,t,">")}},{key:"_compareDistanceToSpacing",value:function(element,e,t){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:">",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.configuration.spacing;return">"===n?T.default.cornerstoneMath.point.distance(e,t)>r:T.default.cornerstoneMath.point.distance(e,t)<r}},{key:"_activateDraw",value:function(element){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Mouse";this._drawing=!0,this._drawingInteractionType=e,I.state.isMultiPartToolActive=!0,Object(F.hideToolCursor)(this.element),element.addEventListener(w.default.MOUSE_DOWN,this._drawingMouseDownCallback),element.addEventListener(w.default.MOUSE_MOVE,this._drawingMouseMoveCallback),element.addEventListener(w.default.MOUSE_DOUBLE_CLICK,this._drawingMouseDoubleClickCallback),element.addEventListener(w.default.MOUSE_DRAG,this._drawingMouseDragCallback),element.addEventListener(w.default.MOUSE_UP,this._drawingMouseUpCallback),element.addEventListener(w.default.TOUCH_START,this._drawingMouseMoveCallback),element.addEventListener(w.default.TOUCH_START,this._drawingTouchStartCallback),element.addEventListener(w.default.TOUCH_DRAG,this._drawingTouchDragCallback),element.addEventListener(w.default.TOUCH_END,this._drawingMouseUpCallback),element.addEventListener(w.default.DOUBLE_TAP,this._drawingDoubleTapClickCallback),T.default.cornerstone.updateImage(element)}},{key:"_deactivateDraw",value:function(element){this._drawing=!1,I.state.isMultiPartToolActive=!1,this._activeDrawingToolReference=null,this._drawingInteractionType=null,Object(F.setToolCursor)(this.element,this.svgCursor),element.removeEventListener(w.default.MOUSE_DOWN,this._drawingMouseDownCallback),element.removeEventListener(w.default.MOUSE_MOVE,this._drawingMouseMoveCallback),element.removeEventListener(w.default.MOUSE_DOUBLE_CLICK,this._drawingMouseDoubleClickCallback),element.removeEventListener(w.default.MOUSE_DRAG,this._drawingMouseDragCallback),element.removeEventListener(w.default.MOUSE_UP,this._drawingMouseUpCallback),element.removeEventListener(w.default.TOUCH_START,this._drawingTouchStartCallback),element.removeEventListener(w.default.TOUCH_DRAG,this._drawingTouchDragCallback),element.removeEventListener(w.default.TOUCH_START,this._drawingMouseMoveCallback),element.removeEventListener(w.default.TOUCH_END,this._drawingMouseUpCallback),T.default.cornerstone.updateImage(element)}},{key:"_activateModify",value:function(element){I.state.isToolLocked=!0,element.addEventListener(w.default.MOUSE_UP,this._editMouseUpCallback),element.addEventListener(w.default.MOUSE_DRAG,this._editMouseDragCallback),element.addEventListener(w.default.MOUSE_CLICK,this._editMouseUpCallback),element.addEventListener(w.default.TOUCH_END,this._editMouseUpCallback),element.addEventListener(w.default.TOUCH_DRAG,this._editTouchDragCallback),T.default.cornerstone.updateImage(element)}},{key:"_deactivateModify",value:function(element){I.state.isToolLocked=!1,element.removeEventListener(w.default.MOUSE_UP,this._editMouseUpCallback),element.removeEventListener(w.default.MOUSE_DRAG,this._editMouseDragCallback),element.removeEventListener(w.default.MOUSE_CLICK,this._editMouseUpCallback),element.removeEventListener(w.default.TOUCH_END,this._editMouseUpCallback),element.removeEventListener(w.default.TOUCH_DRAG,this._editTouchDragCallback),T.default.cornerstone.updateImage(element)}},{key:"passiveCallback",value:function(element){this._closeToolIfDrawing(element)}},{key:"enabledCallback",value:function(element){this._closeToolIfDrawing(element)}},{key:"disabledCallback",value:function(element){this._closeToolIfDrawing(element)}},{key:"_closeToolIfDrawing",value:function(element){if(this._drawing){var e=this.configuration.currentHandle;this._endDrawing(element,e),T.default.cornerstone.updateImage(element)}}},{key:"fireModifiedEvent",value:function(element,e){var t=w.default.MEASUREMENT_MODIFIED,n={toolName:this.name,toolType:this.name,element:element,measurementData:e};Object(M.default)(element,t,n)}},{key:"fireCompletedEvent",value:function(element,e){var t=w.default.MEASUREMENT_COMPLETED,n={toolName:this.name,toolType:this.name,element:element,measurementData:e};Object(M.default)(element,t,n)}},{key:"cancelDrawing",value:function(element){if(this._drawing){var e=Object(O.getToolState)(element,this.name),t=this.configuration,data=e.data[t.currentTool];data.active=!1,data.highlight=!1,data.handles.invalidHandlePlacement=!1,t.currentHandle=0,t.currentTool=-1,data.canComplete=!1,Object(O.removeToolState)(element,this.name,data),this._deactivateDraw(element),T.default.cornerstone.updateImage(element)}}},{key:"newImageCallback",value:function(e){var t=this.configuration;if(this._drawing&&this._activeDrawingToolReference){var element=e.detail.element,data=this._activeDrawingToolReference;data.active=!1,data.highlight=!1,data.handles.invalidHandlePlacement=!1;var n=data.handles.points;n[t.currentHandle-1].lines.push(n[0]),t.currentHandle=0,t.currentTool=-1,data.canComplete=!1,this._deactivateDraw(element),T.default.cornerstone.updateImage(element)}}},{key:"spacing",get:function(){return this.configuration.spacing},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehand spacing to a value other than a number.");this.configuration.spacing=e,T.default.cornerstone.updateImage(this.element)}},{key:"activeHandleRadius",get:function(){return this.configuration.activeHandleRadius},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehand activeHandleRadius to a value other than a number.");this.configuration.activeHandleRadius=e,T.default.cornerstone.updateImage(this.element)}},{key:"completeHandleRadius",get:function(){return this.configuration.completeHandleRadius},set:function(e){if("number"!=typeof e)throw new Error("Attempting to set freehand completeHandleRadius to a value other than a number.");this.configuration.completeHandleRadius=e,T.default.cornerstone.updateImage(this.element)}},{key:"alwaysShowHandles",get:function(){return this.configuration.alwaysShowHandles},set:function(e){if("boolean"!=typeof e)throw new Error("Attempting to set freehand alwaysShowHandles to a value other than a boolean.");this.configuration.alwaysShowHandles=e,T.default.cornerstone.updateImage(this.element)}},{key:"invalidColor",get:function(){return this.configuration.invalidColor},set:function(e){this.configuration.invalidColor=e,T.default.cornerstone.updateImage(this.element)}}]),t}(E.default);function $(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./tools/annotation/LengthTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return L}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./tools/base/BaseAnnotationTool.js"),j=n("./stateManagement/toolState.js"),w=n("./stateManagement/toolStyle.js"),T=n("./stateManagement/toolColors.js"),E=n("./drawing/index.js"),O=n("./drawing/drawLinkedTextBox.js"),C=n("./drawing/drawHandles.js"),S=n("./util/lineSegDistance.js"),I=n("./tools/cursors/index.js"),M=n("./util/logger.js"),P=n("./util/getPixelSpacing.js"),_=n("./util/throttle.js"),D=n("./store/index.js"),k=Object(M.getLogger)("tools:annotation:LengthTool"),L=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"Length",supportedInteractionTypes:["Mouse","Touch"],svgCursor:I.lengthCursor,configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1,digits:2}};return(e=f()(this,m()(t).call(this,n,r))).throttledUpdateCachedStats=Object(_.default)(e.updateCachedStats,110),e}return y()(t,e),c()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image){var t=e.currentPoints.image,n=t.x,r=t.y;return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:n,y:r,highlight:!0,active:!1},end:{x:n,y:r,highlight:!0,active:!0},textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}}}k.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(element,data,e){return data&&data.handles&&data.handles.start&&data.handles.end?!1!==data.visible&&Object(S.default)(element,data.handles.start,data.handles.end,e)<25:(k.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!1)}},{key:"updateCachedStats",value:function(image,element,data){var e=Object(P.default)(image),t=e.rowPixelSpacing,n=e.colPixelSpacing,r=(data.handles.end.x-data.handles.start.x)*(n||1),o=(data.handles.end.y-data.handles.start.y)*(t||1),l=Math.sqrt(r*r+o*o);data.length=l,data.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,r=this.configuration,o=r.handleRadius,l=r.drawHandlesOnHover,c=r.hideHandlesIfMoving,d=r.renderDashed,f=r.digits,h=Object(j.getToolState)(e.currentTarget,this.name);if(h)for(var m=Object(E.getNewContext)(n.canvasContext.canvas),image=n.image,element=n.element,v=Object(P.default)(image),y=v.rowPixelSpacing,x=v.colPixelSpacing,S=w.default.getToolWidth(),I=Object(D.getModule)("globalConfiguration").configuration.lineDash,M=function(i){var data=h.data[i];if(!1===data.visible)return"continue";Object(E.draw)(m,(function(e){Object(E.setShadow)(e,t.configuration);var r=T.default.getColorIfActive(data),h={color:r};d&&(h.lineDash=I),Object(E.drawLine)(e,element,data.handles.start,data.handles.end,h);var m={color:r,handleRadius:o,drawHandlesIfActive:l,hideHandlesIfMoving:c};if(t.configuration.drawHandles&&Object(C.default)(e,n,data.handles,m),!data.handles.textBox.hasMoved){var v={x:Math.max(data.handles.start.x,data.handles.end.x)};v.x===data.handles.start.x?v.y=data.handles.start.y:v.y=data.handles.end.y,data.handles.textBox.x=v.x,data.handles.textBox.y=v.y}!0===data.invalidated&&(data.length?t.throttledUpdateCachedStats(image,element,data):t.updateCachedStats(image,element,data));var text=function(e,t,n){var r,o,l=(r=e.length,o=Number(r),isNaN(o)?void 0:o);if(!l)return"";var c="mm";return t&&n||(c="pixels"),e.unit=c,"".concat(l.toFixed(f)," ").concat(c)}(data,y,x);Object(O.default)(e,element,data.handles.textBox,text,data.handles,_,r,S,10,!0)}))},i=0;i<h.data.length;i++)M(i);function _(e){var t={x:(e.start.x+e.end.x)/2,y:(e.start.y+e.end.y)/2};return[e.start,t,e.end]}}}]),t}(x.default)},"./tools/annotation/ProbeTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return A}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./externalModules.js"),j=n("./tools/base/BaseAnnotationTool.js"),w=n("./stateManagement/toolState.js"),T=n("./stateManagement/textStyle.js"),E=n("./stateManagement/toolColors.js"),O=n("./drawing/index.js"),C=n("./drawing/drawTextBox.js"),S=n("./drawing/drawHandles.js"),I=n("./util/getRGBPixels.js"),M=n("./util/calculateSUV.js"),P=n("./tools/cursors/index.js"),_=n("./util/logger.js"),D=n("./util/throttle.js"),k=n("./store/index.js"),L=Object(_.getLogger)("tools:annotation:ProbeTool"),A=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"Probe",supportedInteractionTypes:["Mouse","Touch"],svgCursor:P.probeCursor,configuration:{drawHandles:!0,renderDashed:!1}};return(e=f()(this,m()(t).call(this,n,r))).throttledUpdateCachedStats=Object(D.default)(e.updateCachedStats,110),e}return y()(t,e),c()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0}}};L.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(element,data,e){var t=data&&data.handles&&data.handles.end;if(t||L.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!t||!1===data.visible)return!1;var n=x.default.cornerstone.pixelToCanvas(element,data.handles.end);return x.default.cornerstoneMath.point.distance(n,e)<5}},{key:"updateCachedStats",value:function(image,element,data){var e=Math.round(data.handles.end.x),t=Math.round(data.handles.end.y),n={};e>=0&&t>=0&&e<image.columns&&t<image.rows&&(n.x=e,n.y=t,image.color?n.storedPixels=Object(I.default)(element,e,t,1,1):(n.storedPixels=x.default.cornerstone.getStoredPixels(element,e,t,1,1),n.sp=n.storedPixels[0],n.mo=n.sp*image.slope+image.intercept,n.suv=Object(M.default)(image,n.sp))),data.cachedStats=n,data.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=e.detail,r=this.configuration,o=r.handleRadius,l=r.renderDashed,c=Object(w.getToolState)(e.currentTarget,this.name);if(c)for(var d=Object(O.getNewContext)(n.canvasContext.canvas),image=n.image,element=n.element,f=T.default.getFontSize(),h=Object(k.getModule)("globalConfiguration").configuration.lineDash,m=function(i){var data=c.data[i];if(!1===data.visible)return"continue";Object(O.draw)(d,(function(e){var text,r,c=E.default.getColorIfActive(data);if(t.configuration.drawHandles){var d={handleRadius:o,color:c};l&&(d.lineDash=h),Object(S.default)(e,n,data.handles,d)}!0===data.invalidated&&(data.cachedStats?t.throttledUpdateCachedStats(image,element,data):t.updateCachedStats(image,element,data));var m=data.cachedStats,v=m.x,y=m.y,j=m.storedPixels,w=m.sp,T=m.mo,O=m.suv;if(v>=0&&y>=0&&v<image.columns&&y<image.rows){text="".concat(v,", ").concat(y),image.color?r="R: ".concat(j[0]," G: ").concat(j[1]," B: ").concat(j[2]):(r="SP: ".concat(w," MO: ").concat(parseFloat(T.toFixed(3))),O&&(r+=" SUV: ".concat(parseFloat(O.toFixed(3)))));var I={x:data.handles.end.x+3,y:data.handles.end.y-3},M=x.default.cornerstone.pixelToCanvas(n.element,I);Object(C.default)(e,r,M.x,M.y+f+5,c),Object(C.default)(e,text,M.x,M.y,c)}}))},i=0;i<c.data.length;i++)m(i)}}]),t}(j.default)},"./tools/annotation/RectangleRoiTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return A}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./externalModules.js"),j=n("./tools/base/BaseAnnotationTool.js"),w=n("./stateManagement/toolState.js"),T=n("./stateManagement/toolStyle.js"),E=n("./stateManagement/toolColors.js"),O=n("./drawing/index.js"),C=n("./util/calculateSUV.js"),S=n("./util/getROITextBoxCoords.js"),I=n("./util/numbersWithCommas.js"),M=n("./util/throttle.js"),P=n("./tools/cursors/index.js"),_=n("./util/logger.js"),D=n("./util/getPixelSpacing.js"),k=n("./store/index.js"),L=Object(_.getLogger)("tools:annotation:RectangleRoiTool"),A=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"RectangleRoi",supportedInteractionTypes:["Mouse","Touch"],configuration:{drawHandles:!0,drawHandlesOnHover:!1,hideHandlesIfMoving:!1,renderDashed:!1},svgCursor:P.rectangleRoiCursor};return(e=f()(this,m()(t).call(this,n,r))).throttledUpdateCachedStats=Object(M.default)(e.updateCachedStats,110),e}return y()(t,e),c()(t,[{key:"createNewMeasurement",value:function(e){if(e&&e.currentPoints&&e.currentPoints.image)return{visible:!0,active:!0,color:void 0,invalidated:!0,handles:{start:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!1},end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0},initialRotation:e.viewport.rotation,textBox:{active:!1,hasMoved:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0}}};L.error("required eventData not supplied to tool ".concat(this.name,"'s createNewMeasurement"))}},{key:"pointNearTool",value:function(element,data,e,t){var n=data&&data.handles&&data.handles.start&&data.handles.end;if(n||L.warn("invalid parameters supplied to tool ".concat(this.name,"'s pointNearTool")),!n||!1===data.visible)return!1;var r="mouse"===t?15:25,o=x.default.cornerstone.pixelToCanvas(element,data.handles.start),l=x.default.cornerstone.pixelToCanvas(element,data.handles.end),rect={left:Math.min(o.x,l.x),top:Math.min(o.y,l.y),width:Math.abs(o.x-l.x),height:Math.abs(o.y-l.y)};return x.default.cornerstoneMath.rect.distanceToPoint(rect,e)<r}},{key:"updateCachedStats",value:function(image,element,data){var e=(x.default.cornerstone.metaData.get("generalSeriesModule",image.imageId)||{}).modality,t=Object(D.default)(image),n=function(image,element,e,t,n){var r,o=R(e.start,e.end),l=function(e,t){for(var n=0,r=0,o=0,l=0,c=e?e[0]:null,d=e?e[0]:null,f=t.top;f<t.top+t.height;f++)for(var h=t.left;h<t.left+t.width;h++)n+=e[l],r+=e[l]*e[l],c=Math.min(c,e[l]),d=Math.max(d,e[l]),o++,l++;if(0===o)return{count:o,mean:0,variance:0,stdDev:0,min:0,max:0};var m=n/o,v=r/o-m*m;return{count:o,mean:m,variance:v,stdDev:Math.sqrt(v),min:c,max:d}}(x.default.cornerstone.getPixels(element,o.left,o.top,o.width,o.height),o);"PT"===t&&(r={mean:Object(C.default)(image,l.mean,!0)||0,stdDev:Object(C.default)(image,l.stdDev,!0)||0});var area=o.width*(n.colPixelSpacing||1)*(o.height*(n.rowPixelSpacing||1)),c=2*o.width*(n.colPixelSpacing||1)+2*o.height*(n.rowPixelSpacing||1);return{area:area||0,perimeter:c,count:l.count||0,mean:l.mean||0,variance:l.variance||0,stdDev:l.stdDev||0,min:l.min||0,max:l.max||0,meanStdDevSUV:r}}(image,element,data.handles,e,t);data.cachedStats=n,data.invalidated=!1}},{key:"renderToolData",value:function(e){var t=this,n=Object(w.getToolState)(e.currentTarget,this.name);if(n){var r=e.detail,image=r.image,element=r.element,o=T.default.getToolWidth(),l=Object(k.getModule)("globalConfiguration").configuration.lineDash,c=this.configuration,d=c.handleRadius,f=c.drawHandlesOnHover,h=c.hideHandlesIfMoving,m=c.renderDashed,v=Object(O.getNewContext)(r.canvasContext.canvas),y=Object(D.default)(image),j=y.rowPixelSpacing,C=y.colPixelSpacing,I=(x.default.cornerstone.metaData.get("generalSeriesModule",image.imageId)||{}).modality,M=j&&C;Object(O.draw)(v,(function(e){for(var i=0;i<n.data.length;i++){var data=n.data[i];if(!1!==data.visible){var c=E.default.getColorIfActive(data),v={color:c,handleRadius:d,drawHandlesIfActive:f,hideHandlesIfMoving:h};Object(O.setShadow)(e,t.configuration);var y={color:c};if(m&&(y.lineDash=l),Object(O.drawRect)(e,element,data.handles.start,data.handles.end,y,"pixel",data.handles.initialRotation),t.configuration.drawHandles&&Object(O.drawHandles)(e,r,data.handles,v),!0===data.invalidated&&(data.cachedStats?t.throttledUpdateCachedStats(image,element,data):t.updateCachedStats(image,element,data)),!data.handles.textBox.hasMoved){var x=Object(S.default)(r.viewport,data.handles);Object.assign(data.handles.textBox,x)}var j=F(e,image.color,data.cachedStats,I,M,t.configuration);data.unit=U(I,t.configuration.showHounsfieldUnits),Object(O.drawLinkedTextBox)(e,element,data.handles.textBox,j,data.handles,(function(e){return t=e.start,n=e.end,r=R(t,n),o=r.left,l=r.top,c=r.width,d=r.height,[{x:o+c/2,y:l},{x:o,y:l+d/2},{x:o+c/2,y:l+d},{x:o+c,y:l+d/2}];var t,n,r,o,l,c,d}),c,o,10,!0)}}}))}}}]),t}(j.default);function R(e,t){return{left:Math.min(e.x,t.x),top:Math.min(e.y,t.y),width:Math.abs(e.x-t.x),height:Math.abs(e.y-t.y)}}function B(area,e){var t=e?" mm".concat(String.fromCharCode(178)):" px".concat(String.fromCharCode(178));return"Area: ".concat(Object(I.default)(area.toFixed(2))).concat(t)}function U(e,t){return"CT"===e&&!1!==t?"HU":""}function F(e,t,n,r,o){var area=n.area,l=n.mean,c=n.stdDev,d=n.min,f=n.max,h=n.meanStdDevSUV,m=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},v=m.showMinMax||!1,y=[],x=[];if(!t){var j=h&&0!==h.mean,w=U(r,m.showHounsfieldUnits),T="Mean: ".concat(Object(I.default)(l.toFixed(2))," ").concat(w),E="Std Dev: ".concat(Object(I.default)(c.toFixed(2))," ").concat(w);if(j){for(var O=" SUV: ",C="".concat(O).concat(Object(I.default)(h.mean.toFixed(2))),S="".concat(O).concat(Object(I.default)(h.stdDev.toFixed(2))),M=Math.floor(e.measureText("".concat(E,"     ")).width);e.measureText(T).width<M;)T+=" ";x.push("".concat(T).concat(C)),x.push("".concat(E,"     ").concat(S))}else x.push("".concat(T)),x.push("".concat(E));if(v){for(var P="Min: ".concat(d," ").concat(w),_="Max: ".concat(f," ").concat(w),D=j?Math.floor(e.measureText("".concat(E,"     ")).width):Math.floor(e.measureText("".concat(T,"     ")).width);e.measureText(P).width<D;)P+=" ";x.push("".concat(P).concat(_))}}return y.push(B(area,o)),x.forEach((function(e){return y.push(e)})),y}},"./tools/annotation/TextMarkerTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return P}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),y=n.n(v),x=n("../node_modules/@babel/runtime/helpers/inherits.js"),j=n.n(x),w=n("./tools/base/BaseAnnotationTool.js"),T=n("./externalModules.js"),E=n("./util/pointInsideBoundingBox.js"),O=n("./stateManagement/toolColors.js"),C=n("./drawing/index.js"),S=n("./drawing/drawTextBox.js"),I=n("./stateManagement/toolState.js"),M=n("./tools/cursors/index.js"),P=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"TextMarker",supportedInteractionTypes:["Mouse","Touch"],configuration:{markers:[],current:"",ascending:!0,loop:!1,changeTextCallback:_},svgCursor:M.textMarkerCursor};return(e=f()(this,m()(t).call(this,n,r))).touchPressCallback=e._changeText.bind(y()(e)),e.doubleClickCallback=e._changeText.bind(y()(e)),e}return j()(t,e),c()(t,[{key:"createNewMeasurement",value:function(e){var t=this.configuration;if(t.current){var n={visible:!0,active:!0,text:t.current,color:void 0,handles:{end:{x:e.currentPoints.image.x,y:e.currentPoints.image.y,highlight:!0,active:!0,hasBoundingBox:!0}}},r={left:0,top:0,width:e.image.width,height:e.image.height};if(T.default.cornerstoneMath.point.insideRect(n.handles.end,r)){var o=t.markers.indexOf(t.current);return(o+=t.ascending?1:-1)>=t.markers.length?o=t.loop?0:-1:o<0&&(o=t.loop?t.markers.length:-1),t.current=t.markers[o],n}}}},{key:"pointNearTool",value:function(element,data,e){if(!1===data.visible)return!1;if(data.handles.end.boundingBox){var t=T.default.cornerstoneMath.rect.distanceToPoint(data.handles.end.boundingBox,e),n=Object(E.default)(data.handles.end,e);return t<10||n}}},{key:"updateCachedStats",value:function(){}},{key:"renderToolData",value:function(e){var t=e.detail,n=this.configuration,r=Object(I.getToolState)(t.element,this.name);if(r)for(var o=Object(C.getNewContext)(t.canvasContext.canvas),l=function(i){var data=r.data[i];if(!1===data.visible)return"continue";var e=O.default.getColorIfActive(data);Object(C.draw)(o,(function(r){Object(C.setShadow)(r,n);var o=T.default.cornerstone.pixelToCanvas(t.element,data.handles.end);data.handles.end.boundingBox=Object(S.default)(r,data.text,o.x,o.y-10,e,{centering:{x:!0,y:!0}})}))},i=0;i<r.data.length;i++)l(i)}},{key:"_changeText",value:function(e){var data,t=e.detail,element=t.element,n=t.currentPoints;function r(data,e,t){!0===t?Object(I.removeToolState)(element,this.name,data):data.text=e,data.active=!1,T.default.cornerstone.updateImage(element)}var o=this.configuration,l=n.canvas,c=Object(I.getToolState)(element,this.name);if(c)for(var i=0;i<c.data.length;i++)if(data=c.data[i],this.pointNearTool(element,data,l))return data.active=!0,T.default.cornerstone.updateImage(element),o.changeTextCallback(data,t,r),e.stopImmediatePropagation(),e.preventDefault(),void e.stopPropagation()}}]),t}(w.default),_=function(data,e,t){t(data,prompt("Change your annotation:"))}},"./tools/annotation/bidirectionalTool/addNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./events.js"),l=n("./manipulators/index.js"),c=n("./manipulators/anyHandlesOutsideImage.js"),d=n("./stateManagement/toolState.js"),f=n("./util/triggerEvent.js"),h=n("./util/getActiveTool.js"),m=n("./tools/annotation/BidirectionalTool.js"),v=n("./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js");t.default=function(e,t){var n=this,x=e.detail,element=x.element,image=x.image,j=x.buttons,w=this.configuration;if(!y(image)){var T=this.createNewMeasurement(x),E=function(){T.active=!1,r.default.cornerstone.updateImage(element)};Object(d.addToolState)(element,this.name,T),r.default.cornerstone.updateImage(element);var O=(new Date).getTime(),C=T.handles,S=C.end,I=C.perpendicularStart;Object(l.moveNewHandle)(x,this.name,T,S,{},t,(function(e){if(e){var l=T.handles,y=T.longestDiameter,C=T.shortestDiameter,S=Object(c.default)(x,l),M=parseFloat(y)||0,P=parseFloat(C)||0,_=M<1||P<1,D=(new Date).getTime()-O<150;S||_||D?(T.cancelled=!0,Object(d.removeToolState)(element,n.name,T)):w.getMeasurementLocationCallback(T,x,E),Object(v.default)(x,T),I.locked=!1,T.invalidated=!0,r.default.cornerstone.updateImage(element);var k=Object(h.default)(element,j,t);k instanceof m.default&&k.updateCachedStats(image,element,T);var L={toolName:n.name,toolType:n.name,element:element,measurementData:T};Object(f.default)(element,o.default.MEASUREMENT_MODIFIED,L),Object(f.default)(element,o.default.MEASUREMENT_COMPLETED,L)}else Object(d.removeToolState)(element,n.name,T)}))}};var y=function(image){var e=r.default.cornerstone.metaData.get("imagePlaneModule",image.imageId),t=image.rowPixelSpacing,n=image.columnPixelSpacing;return e&&(t=e.rowPixelSpacing||e.rowImagePixelSpacing,n=e.columnPixelSpacing||e.colImagePixelSpacing),!t||!n}},"./tools/annotation/bidirectionalTool/createNewMeasurement.js":function(e,t,n){"use strict";n.r(t);var r=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Object.assign({x:e,y:t,index:n,drawnIndependently:!1,allowedOutsideImage:!1,highlight:!0,active:!1},r)};t.default=function(e){var t=e.currentPoints.image,n=t.x,o=t.y;return{toolName:this.name,toolType:this.name,isCreating:!0,visible:!0,active:!0,invalidated:!0,handles:{start:r(n,o,0),end:r(n,o,1,{active:!0}),perpendicularStart:r(n,o,2,{locked:!0}),perpendicularEnd:r(n,o,3),textBox:r(n-50,o-70,null,{highlight:!1,hasMoved:!0,active:!1,movesIndependently:!1,drawnIndependently:!0,allowedOutsideImage:!0,hasBoundingBox:!0})},longestDiameter:0,shortestDiameter:0}}},"./tools/annotation/bidirectionalTool/handleSelectedCallback.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse";"touch"===r?this.handleSelectedTouchCallback(e):this.handleSelectedMouseCallback(e)}},"./tools/annotation/bidirectionalTool/handleSelectedMouseCallback.js":function(e,t,n){"use strict";n.r(t);var r=n("../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(r),l=n("./externalModules.js"),c=n("./events.js"),d=n("./stateManagement/toolState.js"),f=n("./manipulators/anyHandlesOutsideImage.js"),h=n("./manipulators/getHandleNearImagePoint.js"),m=n("./manipulators/index.js"),v=n("./tools/annotation/bidirectionalTool/moveHandle/moveHandle.js"),y=n("./tools/annotation/bidirectionalTool/invertHandles.js"),x=n("./store/setToolCursor.js"),j=n("./util/getProximityThreshold.js");t.default=function(e){var data,t=this,n=e.detail,element=n.element,r=Object(j.default)("mouse",this.name),O=function(e){data.invalidated=!0,Object(f.default)(n,data.handles)&&Object(d.removeToolState)(element,t.name,data),e&&(e.moving=!1,e.selected=!0),Object(x.setToolCursor)(t.element,t.svgCursor),l.default.cornerstone.updateImage(element),element.addEventListener(c.default.MOUSE_MOVE,t._moveCallback),element.addEventListener(c.default.TOUCH_START,t._moveCallback)},C=n.startPoints.canvas,S=Object(d.getToolState)(e.currentTarget,this.name);if(S){for(var I=function(i){data=S.data[i];var o=[element,data.handles,C,r],l=h.default.apply(void 0,o);if(l)return element.removeEventListener(c.default.MOUSE_MOVE,t._moveCallback),element.removeEventListener(c.default.TOUCH_START,t._moveCallback),data.active=!0,w(data.handles),l.moving=!0,(l=Object(y.default)(n,data,l)).hasBoundingBox||Object(x.hideToolCursor)(t.element),Object(v.default)(n,t.name,data,l,(function(){return O(l)})),E(e),{v:!0}},i=0;i<S.data.length;i++){var M=I(i);if("object"===o()(M))return M.v}var P=function(e){return function(){T(e,!1),O()}};for(i=0;i<S.data.length;i++)if(data=S.data[i],this.pointNearTool(element,data,C,"mouse")){element.removeEventListener(c.default.MOUSE_MOVE,this._moveCallback),element.removeEventListener(c.default.TOUCH_START,this._moveCallback),data.active=!0,w(data.handles),T(data.handles,!0);var _=P(data.handles);return Object(m.moveAllHandles)(n,this.name,data,null,{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1},"mouse",_),E(e),!0}}};var w=function(e){var t=!1;return Object.keys(e).forEach((function(n){"textBox"!==n&&(e[n].selected=!1,t=e[n].active||t,e[n].active=!1)})),t},T=function(e,t){Object.keys(e).forEach((function(n){"textBox"!==n&&(e[n].moving=t)}))},E=function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./tools/annotation/bidirectionalTool/handleSelectedTouchCallback.js":function(e,t,n){"use strict";n.r(t);var r=n("../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(r),l=n("./externalModules.js"),c=n("./store/index.js"),d=n("./events.js"),f=n("./stateManagement/toolState.js"),h=n("./manipulators/anyHandlesOutsideImage.js"),m=n("./manipulators/getHandleNearImagePoint.js"),v=n("./manipulators/index.js"),y=n("./tools/annotation/bidirectionalTool/moveHandle/touchMoveHandle.js");t.default=function(e){var data,t=this,n=e.detail,element=n.element,r=c.state.touchProximity,T=function(e){data.invalidated=!0,Object(h.default)(n,data.handles)&&Object(f.removeToolState)(element,t.name,data),e&&(e.moving=!1,e.selected=!0),l.default.cornerstone.updateImage(element),element.addEventListener(d.default.TOUCH_DRAG,t._moveCallback)},E=n.startPoints.canvas,O=Object(f.getToolState)(e.currentTarget,this.name);if(O){for(var C=function(i){data=O.data[i];var o=[element,data.handles,E,r],l=m.default.apply(void 0,o);if(l)return element.removeEventListener(d.default.TOUCH_DRAG,t._moveCallback),data.active=!0,x(data.handles),l.moving=!0,Object(y.default)(n,t.name,data,l,(function(){return T(l)})),w(e),{v:!0}},i=0;i<O.data.length;i++){var S=C(i);if("object"===o()(S))return S.v}var I=function(e){return function(){j(e,!1),T()}};for(i=0;i<O.data.length;i++)if(data=O.data[i],this.pointNearTool(element,data,E,"touch")){element.removeEventListener(d.default.TOUCH_DRAG,this._moveCallback),data.active=!0,x(data.handles),j(data.handles,!0);var M=I(data.handles);return Object(v.moveAllHandles)(n,this.name,data,null,{deleteIfHandleOutsideImage:!0,preventHandleOutsideImage:!1},"touch",M),w(e),!0}}};var x=function(e){var t=!1;return Object.keys(e).forEach((function(n){"textBox"!==n&&(e[n].selected=!1,t=e[n].active||t,e[n].active=!1)})),t},j=function(e,t){Object.keys(e).forEach((function(n){"textBox"!==n&&(e[n].moving=t)}))},w=function(e){e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./tools/annotation/bidirectionalTool/invertHandles.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var r=function(a,b,e){var t=a[e],n=b[e];a[e]=n,b[e]=t},o=function(a,b){r(a,b,"x"),r(a,b,"y"),r(a,b,"moving"),r(a,b,"hover"),r(a,b,"active"),r(a,b,"selected")};function l(e,t,n){var r=e.image,l=r.rowPixelSpacing,c=r.columnPixelSpacing,d=t.handles,f=d.start,h=d.end,m=d.perpendicularStart,v=d.perpendicularEnd,y=(f.x-h.x)*(c||1),x=(f.y-h.y)*(l||1),j=Math.sqrt(y*y+x*x),w=(m.x-v.x)*(c||1),T=(m.y-v.y)*(l||1);return(Math.sqrt(w*w+T*T)||0)>j?(o(f,h),o(f,m),o(h,v),Object.values(d).find((function(e){return!0===e.moving}))):n}},"./tools/annotation/bidirectionalTool/mouseMoveCallback.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./stateManagement/toolCoordinates.js"),l=n("./manipulators/getHandleNearImagePoint.js"),c=n("./stateManagement/toolState.js");t.default=function(e){var t=this,n=e.detail,element=n.element;o.default.setCoords(n);var d=Object(c.getToolState)(element,this.name);if(d){for(var f=!1,h=function(i){var e=n.currentPoints.canvas,data=d.data[i],r=function(element,e,t){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,r=Object(l.default)(element,e,t,n),o=!1;return Object.keys(e).forEach((function(t){if("textBox"!==t){var n=e[t],l=n===r;n.active!==l&&(o=!0),n.active=l}})),o}(element,data.handles,e);Object.keys(data.handles).forEach((function(e){if("textBox"!==e){var t=data.handles[e];t.hover=t.active}})),r&&(f=!0);var o=t.pointNearTool(element,data,e,"mouse"),c=o&&!data.active,h=!o&&data.active;(c||h)&&(data.active=!data.active,f=!0)},i=0;i<d.data.length;i++)h(i);!0===f&&r.default.cornerstone.updateImage(element)}}},"./tools/annotation/bidirectionalTool/moveHandle/getBaseData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var r=n("./externalModules.js"),o=n("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js");function l(e,t){return{start:e,end:t}}function c(e,t,n){var c=r.default.cornerstoneMath.lineSegment,d=e.handles,f=d.start,h=d.end,m=d.perpendicularStart,v=d.perpendicularEnd,y=t.image,x=y.columnPixelSpacing,j=void 0===x?1:x,w=y.rowPixelSpacing,T=void 0===w?1:w,E=l(f,h),O=l(m,v),C=c.intersectLine(E,O);return{columnPixelSpacing:j,rowPixelSpacing:T,start:f,end:h,perpendicularStart:m,perpendicularEnd:v,longLine:E,intersection:C,distanceToFixed:Object(o.default)(j,T,n,C),fixedPoint:n}}},"./tools/annotation/bidirectionalTool/moveHandle/moveHandle.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./store/index.js"),l=n("./events.js"),c=n("./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js"),d=n("./util/getActiveTool.js"),f=n("./tools/base/BaseAnnotationTool.js");t.default=function(e,t,data,n,h,m){var element=e.element,image=e.image,v=e.buttons,y={x:n.x-e.currentPoints.image.x,y:n.y-e.currentPoints.image.y},x=function(e){var o=e.detail;n.hasMoved=!0,void 0===n.index||null===n.index?(n.x=o.currentPoints.image.x+y.x,n.y=o.currentPoints.image.y+y.y):Object(c.default)(n,o,data,y),m&&(n.x=Math.max(n.x,0),n.x=Math.min(n.x,o.image.width),n.y=Math.max(n.y,0),n.y=Math.min(n.y,o.image.height)),data.invalidated=!0,r.default.cornerstone.updateImage(element);var h=Object(d.default)(element,v,"mouse");h instanceof f.default&&h.updateCachedStats(image,element,data);var x={toolName:t,toolType:t,element:element,measurementData:data};r.default.cornerstone.triggerEvent(element,l.default.MEASUREMENT_MODIFIED,x)};n.active=!0,n.moving=!0,o.state.isToolLocked=!0,element.addEventListener(l.default.MOUSE_DRAG,x),element.addEventListener(l.default.TOUCH_DRAG,x);var j=r.default.cornerstone.getImage(element),w=function(){r.default.cornerstone.getImage(element).imageId!==j.imageId&&T()};element.addEventListener(r.default.cornerstone.EVENTS.IMAGE_RENDERED,w);var T=function e(){n.active=!1,o.state.isToolLocked=!1,element.removeEventListener(r.default.cornerstone.EVENTS.IMAGE_RENDERED,w),element.removeEventListener(l.default.MOUSE_DRAG,x),element.removeEventListener(l.default.MOUSE_UP,e),element.removeEventListener(l.default.MOUSE_CLICK,e),element.removeEventListener(l.default.TOUCH_DRAG,x),element.removeEventListener(l.default.TOUCH_DRAG_END,e),element.removeEventListener(l.default.TAP,e),r.default.cornerstone.updateImage(element),"function"==typeof h&&h()};element.addEventListener(l.default.MOUSE_UP,T),element.addEventListener(l.default.MOUSE_CLICK,T),element.addEventListener(l.default.TOUCH_DRAG_END,T),element.addEventListener(l.default.TAP,T)}},"./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/moveLongLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var r=n("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js"),o=n("./tools/annotation/bidirectionalTool/moveHandle/getBaseData.js"),l=n("./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/updatePerpendicularLine.js");function c(e,t,n,c){var d=Object(o.default)(t,n,c),f=d.columnPixelSpacing,h=d.rowPixelSpacing,m=d.distanceToFixed,v=Object(r.default)(f,h,c,e);if(v<=m)return!1;var y=m/v,x={x:c.x+(e.x-c.x)*y,y:c.y+(e.y-c.y)*y},j=Object(l.default)(d,x);return t.handles.perpendicularStart.x=j.start.x,t.handles.perpendicularStart.y=j.start.y,t.handles.perpendicularEnd.x=j.end.x,t.handles.perpendicularEnd.y=j.end.y,!0}},"./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/updatePerpendicularLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var r=n("./tools/annotation/bidirectionalTool/utils/getLineVector.js"),o=n("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js");function l(e,t){var n=e.columnPixelSpacing,l=e.rowPixelSpacing,c=e.start,d=e.perpendicularStart,f=e.perpendicularEnd,h=e.intersection,m=e.fixedPoint,v=Object(o.default)(n,l,d,h),y=Object(o.default)(n,l,f,h),x=Object(r.default)(n,l,m,t),j=m===c?1:-1,w=j*l,T=j*n;return{start:{x:t.x+x.y*v*w,y:t.y+x.x*v*T*-1},end:{x:t.x+x.y*y*w*-1,y:t.y+x.x*y*T}}}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getDirectionMultiplier.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/isPerpendicularEndFixed.js");function o(e,t){return Object(r.default)(e,t)?-1:1}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getHelperLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getDirectionMultiplier.js");function o(e,t,n){var o=e.columnPixelSpacing,l=e.rowPixelSpacing,c=e.perpendicularEnd,d=e.fixedPoint,f=Number.MAX_SAFE_INTEGER,h=Object(r.default)(d,c)*f;return{start:t,end:{x:t.x+n.y*l*h,y:t.y+n.x*o*h*-1}}}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getMovingPoint.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/isPerpendicularEndFixed.js");function o(e,t,n){return Object(r.default)(e,n)?t:n}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/isPerpendicularEndFixed.js":function(e,t,n){"use strict";function r(e,t){return e===t}n.r(t),n.d(t,"default",(function(){return r}))},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/lineHasLength.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n("./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js");function o(e,t,line){return 0!==Object(r.default)(e,t,line.start,line.end)}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/movePerpendicularLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h}));var r=n("./externalModules.js"),o=n("./tools/annotation/bidirectionalTool/utils/getLineVector.js"),l=n("./tools/annotation/bidirectionalTool/moveHandle/getBaseData.js"),c=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/lineHasLength.js"),d=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getHelperLine.js"),f=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/updatePerpendicularLine.js");function h(e,t,n,h){var m=r.default.cornerstoneMath.lineSegment,v=Object(l.default)(t,n,h),y=v.columnPixelSpacing,x=v.rowPixelSpacing,j=v.start,w=v.longLine,T=v.intersection;if(!Object(c.default)(y,x,w))return!1;var E=Object(o.default)(y,x,j,T),O=Object(d.default)(v,e,E),C=m.intersectLine(w,O);if(!C)return!1;var S=Object(f.default)(v,C,O,E);return t.handles.perpendicularStart.x=S.start.x,t.handles.perpendicularStart.y=S.start.y,t.handles.perpendicularEnd.x=S.end.x,t.handles.perpendicularEnd.y=S.end.y,!0}},"./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/updatePerpendicularLine.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return d}));var r=n("../node_modules/@babel/runtime/helpers/defineProperty.js"),o=n.n(r),l=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getDirectionMultiplier.js"),c=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/getMovingPoint.js");function d(e,t,n,r){var d,f=e.columnPixelSpacing,h=e.rowPixelSpacing,m=e.fixedPoint,v=e.perpendicularStart,y=e.perpendicularEnd,x=e.distanceToFixed,j=Object(l.default)(m,y)*x,w=Object(c.default)(m,v,y)===v,T=w?"start":"end",E=w?"end":"start";return d={},o()(d,T,{x:n.start.x,y:n.start.y}),o()(d,E,{x:t.x+r.y*h*j,y:t.y+r.x*f*j*-1}),d}},"./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./tools/annotation/bidirectionalTool/moveHandle/moveLongLine/moveLongLine.js"),l=n("./tools/annotation/bidirectionalTool/moveHandle/movePerpendicularLine/movePerpendicularLine.js");t.default=function(e,t,data,n){var c,d,f,h,m={},v={},y={x:t.currentPoints.image.x+n.x,y:t.currentPoints.image.y+n.y};0===e.index?Object(o.default)(y,data,t,data.handles.end)?(e.x=y.x,e.y=y.y):(t.currentPoints.image.x=e.x,t.currentPoints.image.y=e.y):1===e.index?Object(o.default)(y,data,t,data.handles.start)?(e.x=y.x,e.y=y.y):(t.currentPoints.image.x=e.x,t.currentPoints.image.y=e.y):2===e.index?(c=!1,m.start={x:data.handles.start.x,y:data.handles.start.y},m.end={x:data.handles.end.x,y:data.handles.end.y},v.start={x:data.handles.perpendicularEnd.x,y:data.handles.perpendicularEnd.y},v.end={x:y.x,y:y.y},(d=r.default.cornerstoneMath.lineSegment.intersectLine(m,v))||(v.end={x:data.handles.perpendicularStart.x,y:data.handles.perpendicularStart.y},d=r.default.cornerstoneMath.lineSegment.intersectLine(m,v),f=r.default.cornerstoneMath.point.distance(d,data.handles.start),h=r.default.cornerstoneMath.point.distance(d,data.handles.end),(!d||f<3||h<3)&&(c=!0)),c||Object(l.default)(y,data,t,data.handles.perpendicularEnd)||(t.currentPoints.image.x=data.handles.perpendicularStart.x,t.currentPoints.image.y=data.handles.perpendicularStart.y)):3===e.index&&(c=!1,m.start={x:data.handles.start.x,y:data.handles.start.y},m.end={x:data.handles.end.x,y:data.handles.end.y},v.start={x:data.handles.perpendicularStart.x,y:data.handles.perpendicularStart.y},v.end={x:y.x,y:y.y},(d=r.default.cornerstoneMath.lineSegment.intersectLine(m,v))||(v.end={x:data.handles.perpendicularEnd.x,y:data.handles.perpendicularEnd.y},d=r.default.cornerstoneMath.lineSegment.intersectLine(m,v),f=r.default.cornerstoneMath.point.distance(d,data.handles.start),h=r.default.cornerstoneMath.point.distance(d,data.handles.end),(!d||f<3||h<3)&&(c=!0)),c||Object(l.default)(y,data,t,data.handles.perpendicularStart)||(t.currentPoints.image.x=data.handles.perpendicularEnd.x,t.currentPoints.image.y=data.handles.perpendicularEnd.y))}},"./tools/annotation/bidirectionalTool/moveHandle/touchMoveHandle.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./store/index.js"),l=n("./events.js"),c=n("./tools/annotation/bidirectionalTool/moveHandle/setHandlesPosition.js"),d=n("./util/getActiveTool.js"),f=n("./tools/base/BaseAnnotationTool.js"),h=[l.default.TOUCH_END,l.default.TOUCH_DRAG_END,l.default.TOUCH_PINCH,l.default.TOUCH_PRESS,l.default.TAP];t.default=function(e,t,data,n,m,v){var element=e.element,image=e.image,y=e.buttons,x={x:n.x-e.currentPoints.image.x,y:n.y-e.currentPoints.image.y},j=function(e){var o=e.detail;n.hasMoved=!0,void 0===n.index||null===n.index?(n.x=o.currentPoints.image.x+x.x,n.y=o.currentPoints.image.y+x.y):Object(c.default)(n,o,data,x),v&&(n.x=Math.max(n.x,0),n.x=Math.min(n.x,o.image.width),n.y=Math.max(n.y,0),n.y=Math.min(n.y,o.image.height)),data.invalidated=!0,r.default.cornerstone.updateImage(element);var h=Object(d.default)(element,y,"touch");h instanceof f.default&&h.updateCachedStats(image,element,data);var m={toolName:t,toolType:t,element:element,measurementData:data};r.default.cornerstone.triggerEvent(element,l.default.MEASUREMENT_MODIFIED,m)};n.active=!0,o.state.isToolLocked=!0,element.addEventListener(l.default.TOUCH_DRAG,j);var w=function e(){n.active=!1,o.state.isToolLocked=!1,element.removeEventListener(l.default.TOUCH_DRAG,j),h.forEach((function(t){element.removeEventListener(t,e)})),r.default.cornerstone.updateImage(element),"function"==typeof m&&m()};h.forEach((function(e){element.addEventListener(e,w)}))}},"./tools/annotation/bidirectionalTool/pointNearTool.js":function(e,t,n){"use strict";n.r(t);var r=n("./util/getProximityThreshold.js"),o=n("./externalModules.js"),l=n("./util/pointInsideBoundingBox.js"),c=function(element,e,t,n){var r=o.default.cornerstone,l=o.default.cornerstoneMath,c={start:r.pixelToCanvas(element,e.perpendicularStart),end:r.pixelToCanvas(element,e.perpendicularEnd)};return l.lineSegment.distanceToPoint(c,t)<n};t.default=function(element,data,e){var t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse",n=o.default.cornerstone,d=o.default.cornerstoneMath,f=data.handles,h={start:n.pixelToCanvas(element,f.start),end:n.pixelToCanvas(element,f.end)},m=d.lineSegment.distanceToPoint(h,e);if(Object(l.default)(f.textBox,e))return!0;var v=Object(r.default)(t,"Bidirectional");return!!c(element,f,e,v)||m<v}},"./tools/annotation/bidirectionalTool/renderToolData.js":function(e,t,n){"use strict";n.r(t);var r=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(r),l=n("./drawing/drawHandles.js"),c=n("./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js"),d=n("./store/index.js"),f=n("./stateManagement/toolStyle.js"),h=n("./stateManagement/toolColors.js"),m=n("./stateManagement/toolState.js"),v=n("./drawing/index.js"),y=n("./drawing/drawLinkedTextBox.js"),x=n("./util/getPixelSpacing.js");t.default=function(e){var t=this,n=e.detail,element=n.element,r=n.canvasContext,image=n.image,o=this.configuration,w=o.handleRadius,T=o.drawHandlesOnHover,E=o.hideHandlesIfMoving,O=o.renderDashed,C=Object(d.getModule)("globalConfiguration").configuration.lineDash,S=Object(m.getToolState)(element,this.name);if(S){var I=Object(x.default)(image),M=I.rowPixelSpacing,P=I.colPixelSpacing;if(M&&P)for(var _,D=Object(v.getNewContext)(r.canvas),k=f.default.getToolWidth(),L=function(i){var data=S.data[i];if(!1===data.visible)return"continue";_=h.default.getColorIfActive(data),!0===data.invalidated&&(data.longestDiameter&&data.shortestDiameter?t.throttledUpdateCachedStats(image,element,data):t.updateCachedStats(image,element,data)),Object(v.draw)(D,(function(e){Object(v.setShadow)(e,t.configuration);var r=data.handles,o=r.start,d=r.end,f=r.perpendicularStart,h=r.perpendicularEnd,m=r.textBox,x={color:_},S={color:_,strokeWidth:I};O&&(x.lineDash=C,S.lineDash=C),Object(v.drawLine)(e,element,o,d,x);var I=k;Object(c.default)(n,data),Object(v.drawLine)(e,element,f,h,S);var D={color:_,handleRadius:w,drawHandlesIfActive:T,hideHandlesIfMoving:E};t.configuration.drawHandles&&Object(l.default)(e,n,data.handles,D);var L=j(data,M,P);Object(y.default)(e,element,m,L,data.handles,(function(e){return[e.start,e.end,e.perpendicularStart,e.perpendicularEnd]}),_,k,10,!0)}))},i=0;i<S.data.length;i++)L(i)}};var j=function(data,e,t){var n=" mm";e&&t||(n=" pixels");var r=" L ".concat(data.longestDiameter).concat(n),l=" W ".concat(data.shortestDiameter).concat(n),c=data.labels;return c&&Array.isArray(c)?[].concat(o()(c),[r,l]):[r,l]}},"./tools/annotation/bidirectionalTool/utils/calculateLongestAndShortestDiameters.js":function(e,t,n){"use strict";function r(e,t){var n=t.rowPixelSpacing,r=t.colPixelSpacing,o=e.handles,l=o.start,c=o.end,d=o.perpendicularStart,f=o.perpendicularEnd,h=(l.x-c.x)*(r||1),m=(l.y-c.y)*(n||1),v=Math.sqrt(h*h+m*m),y=(d.x-f.x)*(r||1),x=(d.y-f.y)*(n||1),j=Math.sqrt(y*y+x*x);if(j||(j=0),j>v){var w=v;v=j,j=w}return{longestDiameter:v.toFixed(1),shortestDiameter:j.toFixed(1)}}n.r(t),n.d(t,"default",(function(){return r}))},"./tools/annotation/bidirectionalTool/utils/getDistanceWithPixelSpacing.js":function(e,t,n){"use strict";function r(e,t,n,r){var o=(n.x-r.x)/t,l=(n.y-r.y)/e;return Math.sqrt(o*o+l*l)}n.r(t),n.d(t,"default",(function(){return r}))},"./tools/annotation/bidirectionalTool/utils/getLineVector.js":function(e,t,n){"use strict";function r(e,t,n,r){var o=(n.x-r.x)*e,l=(n.y-r.y)*t,c=Math.sqrt(o*o+l*l);return{x:o/c,y:l/c,length:c}}n.r(t),n.d(t,"default",(function(){return r}))},"./tools/annotation/bidirectionalTool/utils/updatePerpendicularLineHandles.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n("./tools/annotation/bidirectionalTool/utils/getLineVector.js");function o(e,t){if(!t.handles.perpendicularStart.locked)return!1;var n,o,l,c,d=t.handles,f=d.start,h=d.end,m=e.image,v=m.columnPixelSpacing,y=void 0===v?1:v,x=m.rowPixelSpacing,j=void 0===x?1:x;if(f.x===h.x&&f.y===h.y)n=f.x,o=f.y,l=h.x,c=h.y;else{var w={x:(f.x+h.x)/2,y:(f.y+h.y)/2},T=Object(r.default)(y,j,f,h),E=T.length/2,O=E/(2*j),C=E/(2*y);n=w.x+C*T.y,o=w.y-O*T.x,l=w.x-C*T.y,c=w.y+O*T.x}return t.handles.perpendicularStart.x=n,t.handles.perpendicularStart.y=o,t.handles.perpendicularEnd.x=l,t.handles.perpendicularEnd.y=c,!0}},"./tools/annotation/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./tools/annotation/AngleTool.js"),o=n("./tools/annotation/ArrowAnnotateTool.js"),l=n("./tools/annotation/BidirectionalTool.js"),c=n("./tools/annotation/CircleRoiTool.js"),d=n("./tools/annotation/CobbAngleTool.js"),f=n("./tools/annotation/EllipticalRoiTool.js"),h=n("./tools/annotation/FreehandRoiTool.js"),m=n("./tools/annotation/LengthTool.js"),v=n("./tools/annotation/ProbeTool.js"),y=n("./tools/annotation/RectangleRoiTool.js"),x=n("./tools/annotation/TextMarkerTool.js");n.d(t,"AngleTool",(function(){return r.default})),n.d(t,"ArrowAnnotateTool",(function(){return o.default})),n.d(t,"BidirectionalTool",(function(){return l.default})),n.d(t,"CircleRoiTool",(function(){return c.default})),n.d(t,"CobbAngleTool",(function(){return d.default})),n.d(t,"EllipticalRoiTool",(function(){return f.default})),n.d(t,"FreehandRoiTool",(function(){return h.default})),n.d(t,"LengthTool",(function(){return m.default})),n.d(t,"ProbeTool",(function(){return v.default})),n.d(t,"RectangleRoiTool",(function(){return y.default})),n.d(t,"TextMarkerTool",(function(){return x.default})),t.default={AngleTool:r.default,ArrowAnnotateTool:o.default,BidirectionalTool:l.default,CircleRoiTool:c.default,CobbAngleTool:d.default,EllipticalRoiTool:f.default,FreehandRoiTool:h.default,LengthTool:m.default,ProbeTool:v.default,RectangleRoiTool:y.default,TextMarkerTool:x.default}},"./tools/base/BaseAnnotationTool.js":function(e,t,n){"use strict";n.r(t);var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/inherits.js"),y=n.n(v),x=n("./tools/base/BaseTool.js"),j=n("./stateManagement/toolState.js"),w=n("./manipulators/handleActivator.js"),T=n("./util/findAndMoveHelpers.js"),E=n("./util/logger.js"),O=Object(E.getLogger)("baseAnnotationTool"),C=function(e){function t(){return o()(this,t),f()(this,m()(t).apply(this,arguments))}return y()(t,e),c()(t,[{key:"createNewMeasurement",value:function(e){throw new Error("Method createNewMeasurement not implemented for ".concat(this.name,"."))}},{key:"pointNearTool",value:function(element,data,e){throw new Error("Method pointNearTool not implemented for ".concat(this.name,"."))}},{key:"distanceFromPoint",value:function(element,data,e){throw new Error("Method distanceFromPoint not implemented for ".concat(this.name,"."))}},{key:"renderToolData",value:function(e){throw new Error("renderToolData not implemented for ".concat(this.name,"."))}},{key:"mouseMoveCallback",value:function(e){for(var t=e.detail,element=t.element,n=t.currentPoints.canvas,r=Object(j.getToolState)(element,this.name),o=!1,l=0;l<r.data.length;l++){var data=r.data[l];!0===Object(w.default)(element,data.handles,n)&&(o=!0);var c=this.pointNearTool(element,data,n,"mouse")&&!data.active,d=!this.pointNearTool(element,data,n,"mouse")&&data.active;(c||d)&&(data.active=!data.active,o=!0)}return o}},{key:"handleSelectedCallback",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse";Object(T.moveHandleNearImagePoint)(e,this,t,n,r)}},{key:"toolSelectedCallback",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mouse";Object(T.moveAnnotation)(e,this,t,n)}},{key:"updateCachedStats",value:function(image,element,data){O.warn("updateCachedStats not implemented for ".concat(this.name,"."))}}]),t}(x.default);t.default=C},"./tools/base/BaseBrushTool.js":function(e,t,n){"use strict";n.r(t);var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),y=n.n(v),x=n("../node_modules/@babel/runtime/helpers/inherits.js"),j=n.n(x),w=n("./tools/base/BaseTool.js"),T=n("./events.js"),E=n("./externalModules.js"),O=n("./store/isToolActiveForElement.js"),C=n("./store/index.js"),S=n("./util/segmentation/index.js"),I=Object(C.getModule)("segmentation"),M=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o()(this,t),r.configuration||(r.configuration={alwaysEraseOnClick:!1}),(n=f()(this,m()(t).call(this,e,r))).updateOnMouseMove=!0,n.hideDefaultCursor=!0,n._drawing=!1,n._drawingMouseUpCallback=n._drawingMouseUpCallback.bind(y()(n)),n}return j()(t,e),c()(t,[{key:"renderBrush",value:function(e){throw new Error("Method renderBrush not implemented for ".concat(this.name,"."))}},{key:"_paint",value:function(e){throw new Error("Method _paint not implemented for ".concat(this.name,"."))}},{key:"mouseDragCallback",value:function(e){var t=e.detail.currentPoints;this._lastImageCoords=t.image,this._drawing&&this._paint(e)}},{key:"preMouseDownCallback",value:function(e){var t=e.detail,element=t.element,n=t.currentPoints;return this._startPainting(e),this._lastImageCoords=n.image,this._drawing=!0,this._startListeningForMouseUp(element),this._paint(e),!0}},{key:"_startPainting",value:function(e){var t=e.detail,element=t.element,n=I.configuration,r=I.getters.labelmap2D(element),o=r.labelmap2D,l=r.labelmap3D,c=r.currentImageIdIndex,d=r.activeLabelmapIndex,f=this._isCtrlDown(t)||this.configuration.alwaysEraseOnClick;if(this.paintEventData={labelmap2D:o,labelmap3D:l,currentImageIdIndex:c,activeLabelmapIndex:d,shouldErase:f},n.storeHistory){var h=o.pixelData.slice();this.paintEventData.previousPixelData=h}}},{key:"_endPainting",value:function(e){for(var t=I.configuration,n=I.setters,r=this.paintEventData,o=r.labelmap2D,l=r.currentImageIdIndex,c=new Set(o.pixelData).values(),d=[],f=!1;!f;){var h=c.next();(f=h.done)||d.push(h.value)}if(o.segmentsOnLabelmap=d,t.storeHistory){var m=this.paintEventData.previousPixelData,v=o.pixelData,y={imageIdIndex:l,diff:Object(S.getDiffBetweenPixelData)(m,v)};n.pushState(this.element,[y])}Object(S.triggerLabelmapModifiedEvent)(this.element)}},{key:"mouseMoveCallback",value:function(e){var t=e.detail.currentPoints;this._lastImageCoords=t.image}},{key:"renderToolData",value:function(e){var element=e.detail.element;Object(O.default)(element,this.name)&&this.renderBrush(e)}},{key:"passiveCallback",value:function(e){try{E.default.cornerstone.updateImage(this.element)}catch(e){return}}},{key:"_drawingMouseUpCallback",value:function(e){var element=e.detail.element;this._endPainting(e),this._drawing=!1,this._mouseUpRender=!0,this._stopListeningForMouseUp(element)}},{key:"newImageCallback",value:function(e){this._drawing&&(this._endPainting(e),this._startPainting(e))}},{key:"_startListeningForMouseUp",value:function(element){element.removeEventListener(T.default.MOUSE_UP,this._drawingMouseUpCallback),element.removeEventListener(T.default.MOUSE_CLICK,this._drawingMouseUpCallback),element.addEventListener(T.default.MOUSE_UP,this._drawingMouseUpCallback),element.addEventListener(T.default.MOUSE_CLICK,this._drawingMouseUpCallback),E.default.cornerstone.updateImage(element)}},{key:"_stopListeningForMouseUp",value:function(element){element.removeEventListener(T.default.MOUSE_UP,this._drawingMouseUpCallback),element.removeEventListener(T.default.MOUSE_CLICK,this._drawingMouseUpCallback),E.default.cornerstone.updateImage(element)}},{key:"increaseBrushSize",value:function(){var e=I.configuration,t=I.setters,n=e.radius,r=Math.floor(1.2*n);r===n&&(r+=1),t.radius(r)}},{key:"decreaseBrushSize",value:function(){var e=I.configuration,t=I.setters,n=e.radius,r=Math.floor(.8*n);t.radius(r)}},{key:"_isCtrlDown",value:function(e){return e.event&&e.event.ctrlKey||e.ctrlKey}}]),t}(w.default);t.default=M},"./tools/base/BaseTool.js":function(e,t,n){"use strict";n.r(t);var r=n("../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/createClass.js"),f=n.n(d),h=n("./mixins/index.js"),m=n("./util/logger.js"),v=n("./util/deepmerge.js"),y=n("./store/setToolCursor.js"),x=n("./store/index.js"),j=Object(m.getLogger)("tools:base:BaseTool"),w=Object(x.getModule)("globalConfiguration"),T=function(){function e(t,n){c()(this,e),this.initialConfiguration=Object(v.default)(n,t);var r=this.initialConfiguration,o=r.name,l=r.strategies,d=r.defaultStrategy,f=r.configuration,h=r.supportedInteractionTypes,m=r.mixins,y=r.svgCursor;this.name=o,this.mode="disabled",this.element=void 0,this.supportedInteractionTypes=h||[],this.strategies=l||{},this.defaultStrategy=d||Object.keys(this.strategies)[0]||void 0,this.activeStrategy=this.defaultStrategy,y&&(this.svgCursor=y),this._options={},this._configuration=Object.assign({},f),this.updateOnMouseMove=!1,this.hideDefaultCursor=!1,m&&m.length&&this._applyMixins(m),this._cursors=Object.assign({},this.initialConfiguration.cursors);var x=this.defaultStrategy&&this._cursors[this.activeStrategy];x&&(this.svgCursor=x)}return f()(e,[{key:"mergeOptions",value:function(e){this._options=Object.assign({},this._options,e)}},{key:"clearOptions",value:function(){this._options={}}},{key:"applyActiveStrategy",value:function(e,t){return this.strategies[this.activeStrategy].call(this,e,t)}},{key:"_applyMixins",value:function(e){for(var i=0;i<e.length;i++){var t=h.default["".concat(e[i])];"object"===o()(t)?(Object.assign(this,t),"function"==typeof this.initializeMixin&&this.initializeMixin()):j.warn("".concat(this.name,": mixin ").concat(h.default[i]," does not exist."))}"function"===this.initializeMixin&&delete this.initializeMixin}},{key:"setActiveStrategy",value:function(e){this.activeStrategy=e,w.configuration.showSVGCursors&&this.changeCursor(this.element,e)}},{key:"changeCursor",value:function(element,e){if(element){var cursor=this._cursors[e];cursor&&(this.svgCursor=cursor,"active"===this.mode&&Object(y.setToolCursor)(element,cursor))}}},{key:"configuration",get:function(){return this._configuration},set:function(e){this._configuration=e}},{key:"options",get:function(){return this._options}}],[{key:"configuration",get:function(){}}]),e}();t.default=T},"./tools/base/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./tools/base/BaseAnnotationTool.js"),o=n("./tools/base/BaseTool.js"),l=n("./tools/base/BaseBrushTool.js");n.d(t,"BaseAnnotationTool",(function(){return r.default})),n.d(t,"BaseBrushTool",(function(){return l.default})),n.d(t,"BaseTool",(function(){return o.default})),t.default={BaseAnnotationTool:r.default,BaseBrushTool:l.default,BaseTool:o.default}},"./tools/cursors/MouseCursor.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("./stateManagement/toolColors.js"),f=n("./store/index.js").modules.cursor,h=function(){function e(t,n){o()(this,e),this.iconGroupString=t,this.options=Object.assign({},f.getters.defaultOptions(),n)}return c()(e,[{key:"getIconSVG",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._generateIconSVGString(e);return new Blob([t],{type:"image/svg+xml"})}},{key:"getIconSVGString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._generateIconSVGString(e)}},{key:"getIconWithPointerSVG",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._generateIconWithPointerSVGString(e);return new Blob([t],{type:"image/svg+xml"})}},{key:"getIconWithPointerString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._generateIconWithPointerSVGString(e)}},{key:"_generateIconWithPointerSVGString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},this.options,e),n=t.mousePointerGroupString,r=t.iconSize,o=t.viewBox,l=r/Math.max(o.x,o.y),c=16+r,d='\n        <svg\n        data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"\n        width="'.concat(c,'" height="').concat(c,'" viewBox="0 0 ').concat(c," ").concat(c,'"\n      >\n        <g>\n          ').concat(n,'\n        </g>\n        <g transform="translate(16, 16) scale(').concat(l,')">\n          ').concat(this.iconGroupString,"\n        </g>\n      </svg>");return this._injectColors(d,t)}},{key:"_generateIconSVGString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},this.options,e),n=t.iconSize,r=t.viewBox,o='\n      <svg\n        data-icon="cursor" role="img" xmlns="http://www.w3.org/2000/svg"\n        width="'.concat(n,'" height="').concat(n,'" viewBox="0 0\n        ').concat(r.x," ").concat(r.y,'"\n      >\n        ').concat(this.iconGroupString,"\n      </svg>");return this._injectColors(o,t)}},{key:"_injectColors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.activeColor||d.default.getActiveColor(),r=t.toolColor||d.default.getToolColor(),o=t.fillColor||d.default.getFillColor();return e.replace(/ACTIVE_COLOR/g,"".concat(n)).replace(/TOOL_COLOR/g,"".concat(r)).replace(/FILL_COLOR/g,"".concat(o))}},{key:"mousePoint",get:function(){var e=this.options.mousePoint;return"".concat(e.x," ").concat(e.y)}}]),e}()},"./tools/cursors/index.js":function(e,t,n){"use strict";n.r(t),n.d(t,"angleCursor",(function(){return o})),n.d(t,"arrowAnnotateCursor",(function(){return l})),n.d(t,"bidirectionalCursor",(function(){return c})),n.d(t,"cobbAngleCursor",(function(){return d})),n.d(t,"circleRoiCursor",(function(){return f})),n.d(t,"ellipticalRoiCursor",(function(){return h})),n.d(t,"freehandRoiCursor",(function(){return m})),n.d(t,"freehandRoiSculptorCursor",(function(){return v})),n.d(t,"lengthCursor",(function(){return y})),n.d(t,"probeCursor",(function(){return x})),n.d(t,"rectangleRoiCursor",(function(){return j})),n.d(t,"textMarkerCursor",(function(){return w})),n.d(t,"crosshairsCursor",(function(){return T})),n.d(t,"eraserCursor",(function(){return E})),n.d(t,"magnifyCursor",(function(){return O})),n.d(t,"panCursor",(function(){return C})),n.d(t,"rotateCursor",(function(){return S})),n.d(t,"stackScrollCursor",(function(){return I})),n.d(t,"wwwcRegionCursor",(function(){return M})),n.d(t,"wwwcCursor",(function(){return P})),n.d(t,"zoomCursor",(function(){return _})),n.d(t,"freehandEraseInsideCursor",(function(){return U})),n.d(t,"freehandFillInsideCursor",(function(){return F})),n.d(t,"freehandEraseOutsideCursor",(function(){return H})),n.d(t,"freehandFillOutsideCursor",(function(){return N})),n.d(t,"segRectangleEraseInsideCursor",(function(){return z})),n.d(t,"segRectangleFillInsideCursor",(function(){return V})),n.d(t,"segRectangleEraseOutsideCursor",(function(){return W})),n.d(t,"segRectangleFillOutsideCursor",(function(){return G})),n.d(t,"segCircleEraseInsideCursor",(function(){return Y})),n.d(t,"segCircleFillInsideCursor",(function(){return X})),n.d(t,"segCircleEraseOutsideCursor",(function(){return Z})),n.d(t,"segCircleFillOutsideCursor",(function(){return K}));var r=n("./tools/cursors/MouseCursor.js"),o=new r.default('<path fill="ACTIVE_COLOR" d="M1203 544q0 13-10 23l-393 393 393 393q10 10 10 23t-10 23l-50\n        50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23\n        10l50 50q10 10 10 23z"\n      />',{viewBox:{x:1792,y:1792}}),l=new r.default('<g id="arrowAnnotate-group" fill="none" stroke-width="1" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n    <path id="arrowAnnotate-arrow" d="M23,7 l-15,15 M7,17 l0,6 6,0" stroke-width="2" />\n  </g>',{viewBox:{x:24,y:24}}),c=new r.default('<g fill="ACTIVE_COLOR" stroke-width="3" stroke="ACTIVE_COLOR">\n    <path d="M27.63 3.21L3.12 28.81"></path>\n    <path d="M27.63 15.75L15.27 4.43"></path>\n    <path d="M16.5 4.28C16.5 4.96 15.95 5.51 15.27 5.51C14.59 5.51 14.03 4.96 14.03 4.28C14.03 3.59 14.59 3.04 15.27 3.04C15.95 3.04 16.5 3.59 16.5 4.28Z" ></path>\n    <path d="M28.87 3.19C28.87 3.87 28.31 4.43 27.63 4.43C26.95 4.43 26.4 3.87 26.4 3.19C26.4 2.51 26.95 1.95 27.63 1.95C28.31 1.95 28.87 2.51 28.87 3.19Z"></path>\n    <path d="M28.87 15.75C28.87 16.43 28.31 16.99 27.63 16.99C26.95 16.99 26.4 16.43 26.4 15.75C26.4 15.07 26.95 14.51 27.63 14.51C28.31 14.51 28.87 15.07 28.87 15.75Z"></path>\n    <path d="M4.73 28.44C4.73 29.12 4.17 29.68 3.49 29.68C2.81 29.68 2.25 29.12 2.25 28.44C2.25 27.76 2.81 27.2 3.49 27.2C4.17 27.2 4.73 27.76 4.73 28.44Z"></path>\n  </g>',{viewBox:{x:48,y:48}}),d=new r.default('<g stroke="ACTIVE_COLOR" stroke-width="3">\n    <path d="M28.59 2.34L3.82 12.32"></path>\n    <path d="M28.59 29.66L3.82 19.68"></path>\n    <path stroke-dasharray="2" fill-opacity="0" d="M12.37\n      23.06C12.67 22.36 12.85 21.93 12.92 21.76C14.6 17.8 14.68 13.35 13.15\n      9.33C13.11 9.24 13.02 9 12.88 8.63">\n    </path>\n  </g>',{viewBox:{x:32,y:32}}),f=new r.default('<circle stroke="ACTIVE_COLOR" fill="none" stroke-width="3" cx="16" cy="16" r="14" />',{viewBox:{x:32,y:32}}),h=new r.default('<path stroke="ACTIVE_COLOR" fill="none" stroke-width="3" d="M30.74 15.76C30.74 20.99 24.14 25.23 16\n    25.23C7.86 25.23 1.26 20.99 1.26 15.76C1.26 10.54 7.86 6.3 16 6.3C24.14\n    6.3 30.74 10.54 30.74 15.76Z"\n    />',{viewBox:{x:32,y:32}}),m=new r.default('\n  <g fill="ACTIVE_COLOR" stroke="ACTIVE_COLOR" stroke-width="2">\n    <ellipse ry="1" rx="1" id="svg_3" cy="4.240343" cx="14.306499"/>\n    <line id="svg_4" y2="3.58462" x2="12.242186" y1="3.997482" x1="13.432202"/>\n    <line id="svg_5" y2="3.268901" x2="10.857882" y1="3.608906" x1="12.387902"/>\n    <line id="svg_6" y2="3.147471" x2="9.740724" y1="3.293187" x1="10.955026"/>\n    <line id="svg_7" y2="3.147471" x2="8.089274" y1="3.196043" x1="9.983585"/>\n    <line id="svg_8" y2="3.268901" x2="6.874972" y1="3.123185" x1="8.307848"/>\n    <line id="svg_9" y2="3.657478" x2="5.587812" y1="3.220329" x1="7.020688"/>\n    <line id="svg_10" y2="4.046054" x2="4.737801" y1="3.560334" x1="5.854959"/>\n    <line id="svg_11" y2="4.337487" x2="4.300652" y1="3.997482" x1="4.834945"/>\n    <line id="svg_12" y2="4.726063" x2="3.88779" y1="4.191771" x1="4.470655"/>\n    <line id="svg_15" y2="5.3575" x2="3.377783" y1="4.604633" x1="3.960648"/>\n    <line id="svg_16" y2="6.183226" x2="2.916348" y1="5.138926" x1="3.547785"/>\n    <line id="svg_17" y2="6.960379" x2="2.770632" y1="5.867507" x1="3.037779"/>\n    <line id="svg_18" y2="7.713246" x2="2.673488" y1="6.741804" x1="2.819204"/>\n    <line id="svg_19" y2="8.684687" x2="2.697774" y1="7.616102" x1="2.673488"/>\n    <line id="svg_20" y2="9.753273" x2="2.892062" y1="8.611829" x1="2.697774"/>\n    <line id="svg_21" y2="10.724714" x2="3.134923" y1="9.534698" x1="2.84349"/>\n    <line id="svg_23" y2="11.647583" x2="3.596357" y1="10.578998" x1="3.086351"/>\n    <line id="svg_25" y2="12.521881" x2="4.276366" y1="11.501867" x1="3.499213"/>\n    <line id="svg_26" y2="13.930471" x2="5.830673" y1="12.376165" x1="4.13065"/>\n    <line id="svg_28" y2="14.707624" x2="7.263549" y1="13.881899" x1="5.733528"/>\n    <line id="svg_29" y2="15.339061" x2="8.963571" y1="14.61048" x1="7.06926"/>\n    <line id="svg_30" y2="15.581921" x2="10.882168" y1="15.314775" x1="8.817855"/>\n    <line id="svg_31" y2="15.460491" x2="12.023612" y1="15.581921" x1="10.785024"/>\n    <line id="svg_33" y2="15.120487" x2="13.092197" y1="15.484777" x1="11.877895"/>\n    <line id="svg_34" y2="14.586194" x2="13.86935" y1="15.217631" x1="12.897909"/>\n    <line id="svg_35" y2="13.833327" x2="14.597931" y1="14.756196" x1="13.699348"/>\n    <line id="svg_37" y2="12.716169" x2="15.180796" y1="13.881899" x1="14.549359"/>\n    <line id="svg_39" y2="11.429009" x2="15.520801" y1="12.813313" x1="15.15651"/>\n    <ellipse ry="1" rx="1" id="svg_40" cy="10.967574" cx="15.520801"/>\n  </g>',{viewBox:{x:18,y:18}}),v=new r.default('<g id="icon-freehand-sculpt" fill="none" stroke-width="1.5" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n      <line id="svg_1" y2="2.559367" x2="10.184807" y1="4.467781" x1="8.81711"/>\n      <line id="svg_4" y2="1.493836" x2="11.727442" y1="2.766112" x1="10.089386"/>\n      <line id="svg_7" y2="1.080346" x2="13.047428" y1="1.748291" x1="11.345759"/>\n      <line id="svg_8" y2="1.000829" x2="14.351511" y1="1.112153" x1="12.77707"/>\n      <line id="svg_9" y2="1.350705" x2="15.242104" y1="0.905408" x1="13.969828"/>\n      <line id="svg_10" y2="2.098167" x2="15.862339" y1="1.14396" x1="14.955842"/>\n      <line id="svg_11" y2="3.195505" x2="16.41896" y1="1.939133" x1="15.766918"/>\n      <line id="svg_12" y2="4.292843" x2="16.530284" y1="2.925147" x1="16.387153"/>\n      <line id="svg_16" y2="5.644637" x2="16.196311" y1="3.831643" x1="16.593898"/>\n      <line id="svg_18" y2="7.266789" x2="15.623787" y1="5.19934" x1="16.275829"/>\n      <line id="svg_19" y2="10.813258" x2="14.526449" y1="6.726071" x1="15.766918"/>\n      <line id="svg_20" y2="5.056209" x2="8.085552" y1="4.181519" x1="8.976145"/>\n      <line id="svg_23" y2="5.326568" x2="7.481221" y1="4.78585" x1="8.403621"/>\n      <line id="svg_24" y2="5.565119" x2="6.749662" y1="5.294761" x1="7.624352"/>\n      <line id="svg_25" y2="5.994512" x2="5.429675" y1="5.533312" x1="6.956407"/>\n      <line id="svg_27" y2="6.551133" x2="4.284627" y1="5.962706" x1="5.572807"/>\n      <line id="svg_28" y2="7.584858" x2="3.044158" y1="6.392099" x1="4.427758"/>\n      <line id="svg_29" y2="8.84123" x2="2.185372" y1="7.489437" x1="3.219096"/>\n      <line id="svg_31" y2="10.606513" x2="1.644654" y1="8.602678" x1="2.280792"/>\n      <line id="svg_32" y2="13.214679" x2="1.48562" y1="10.352058" x1="1.724171"/>\n      <line id="svg_33" y2="14.375631" x2="1.676461" y1="12.992031" x1="1.453813"/>\n      <line id="svg_34" y2="15.298031" x2="2.264889" y1="14.152983" x1="1.517427"/>\n      <line id="svg_35" y2="16.172721" x2="3.521261" y1="14.948155" x1="1.915013"/>\n      <line id="svg_36" y2="16.824762" x2="5.207027" y1="15.997783" x1="3.28271"/>\n      <line id="svg_38" y2="17.063314" x2="7.035924" y1="16.745245" x1="4.968475"/>\n      <line id="svg_39" y2="16.888376" x2="9.278311" y1="17.047411" x1="6.733758"/>\n      <line id="svg_40" y2="16.284045" x2="10.661911" y1="16.983797" x1="8.992048"/>\n      <line id="svg_41" y2="15.313934" x2="11.647925" y1="16.395369" x1="10.455166"/>\n      <line id="svg_44" y2="13.898527" x2="12.82478" y1="15.425259" x1="11.504794"/>\n      <line id="svg_45" y2="12.037824" x2="14.144766" y1="14.312017" x1="12.522614"/>\n      <line id="svg_47" y2="10.59061" x2="14.605966" y1="12.228665" x1="13.953925"/>\n      <ellipse ry="1" rx="1" id="svg_48" cy="3.982726" cx="13.460918"/>\n    </g>',{viewBox:{x:18,y:18}}),y=new r.default('<g id="length-group" fill="none" stroke-width="1" stroke="ACTIVE_COLOR" stroke-linecap="round" stroke-linejoin="round">\n    <path id="length-dashes" d="m22.5,6 -16.5,16.5" stroke-width="3" stroke-dasharray="0.6666,5" />\n  </g>',{viewBox:{x:24,y:24}}),x=new r.default('<path fill="ACTIVE_COLOR" d="M1152 896q0 106-75 181t-181 75-181-75-75-181 75-181 181-75 181 75\n    75 181zm-256-544q-148 0-273 73t-198 198-73 273 73 273 198 198 273 73 273-73\n    198-198 73-273-73-273-198-198-273-73zm768 544q0 209-103 385.5t-279.5\n    279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5\n    385.5-103 385.5 103 279.5 279.5 103 385.5z"\n  />',{viewBox:{x:1792,y:1792}}),j=new r.default('<path fill="ACTIVE_COLOR" d="M1312 256h-832q-66 0-113 47t-47 113v832q0 66 47\n    113t113 47h832q66 0 113-47t47-113v-832q0-66-47-113t-113-47zm288 160v832q0\n    119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119\n    84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z"\n  />',{viewBox:{x:1792,y:1792}}),w=new r.default('<path fill="ACTIVE_COLOR" d="M789 559l-170 450q33 0 136.5 2t160.5 2q19 0\n    57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29\n    31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15\n    34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 5-.5\n    13.5t-.5 12.5q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0\n    12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11\n    2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0\n    22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58\n    0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z"\n  />',{viewBox:{x:1792,y:1792}}),T=new r.default('<path fill="ACTIVE_COLOR" d="M1325 1024h-109q-26 0-45-19t-19-45v-128q0-26\n    19-45t45-19h109q-32-108-112.5-188.5t-188.5-112.5v109q0 26-19 45t-45\n    19h-128q-26 0-45-19t-19-45v-109q-108 32-188.5 112.5t-112.5 188.5h109q26\n    0 45 19t19 45v128q0 26-19 45t-45 19h-109q32 108 112.5 188.5t188.5\n    112.5v-109q0-26 19-45t45-19h128q26 0 45 19t19 45v109q108-32\n    188.5-112.5t112.5-188.5zm339-192v128q0 26-19 45t-45 19h-143q-37 161-154.5\n    278.5t-278.5 154.5v143q0 26-19 45t-45 19h-128q-26\n    0-45-19t-19-45v-143q-161-37-278.5-154.5t-154.5-278.5h-143q-26\n    0-45-19t-19-45v-128q0-26 19-45t45-19h143q37-161\n    154.5-278.5t278.5-154.5v-143q0-26 19-45t45-19h128q26 0 45 19t19 45v143q161\n    37 278.5 154.5t154.5 278.5h143q26 0 45 19t19 45z"\n  />',{viewBox:{x:1792,y:1792}}),E=new r.default('<path transform="translate(0,1792) scale(1,-1)" fill="ACTIVE_COLOR" d="M960 1408l336-384h-768l-336 384h768zm1013-1077q15\n      34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38\n      0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38\n      0 69.5 20.5t47.5 54.5z"\n    />',{viewBox:{x:2048,y:1792}}),O=new r.default('<path fill="ACTIVE_COLOR" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n      312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n      0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n      0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n      32s176 78.7 176 176-78.7 176-176 176z"\n    />',{viewBox:{x:512,y:512}}),C=new r.default('<path fill="ACTIVE_COLOR" d="M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17\n      39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355\n      355 144 144q31 30 14 69-17 40-59 40h-448q-26 0-45-19t-19-45v-448q0-42 40-59\n      39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12\n      0-24-5-40-17-40-59v-448q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69l-144\n      144 355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19\n      45v448q0 42-39 59-13 5-25 5-26 0-45-19z"\n    />',{viewBox:{x:1792,y:1792}}),S=new r.default('<path fill="ACTIVE_COLOR" d="M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39\n      14-69l138-138q-148-137-349-137-104 0-198.5 40.5t-163.5 109.5-109.5\n      163.5-40.5 198.5 40.5 198.5 109.5 163.5 163.5 109.5 198.5 40.5q119 0\n      225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109\n      132-264 204.5t-327 72.5q-156 0-298-61t-245-164-164-245-61-298 61-298\n      164-245 245-164 298-61q147 0 284.5 55.5t244.5 156.5l130-129q29-31 70-14\n      39 17 39 59z"\n    />',{viewBox:{x:1792,y:1792}}),I=new r.default('<path fill="ACTIVE_COLOR" d="M24 21v2c0 0.547-0.453 1-1 1h-22c-0.547\n      0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1zM24 13v2c0\n      0.547-0.453 1-1 1h-22c-0.547 0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547\n      0 1 0.453 1 1zM24 5v2c0 0.547-0.453 1-1 1h-22c-0.547\n      0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1z"\n      />',{viewBox:{x:24,y:28}}),M=new r.default('<path fill="ACTIVE_COLOR" d="M1664 416v960q0 119-84.5 203.5t-203.5 84.5h-960q-119\n    0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5\n    84.5t84.5 203.5z"\n  />',{viewBox:{x:1792,y:1792}}),P=new r.default('<path fill="ACTIVE_COLOR" d="M14.5,3.5 a1 1 0 0 1 -11,11 Z" stroke="none" opacity="0.8" />\n    <circle cx="9" cy="9" r="8" fill="none" stroke-width="2" stroke="ACTIVE_COLOR" />',{viewBox:{x:18,y:18}}),_=new r.default('<path fill="ACTIVE_COLOR" d="M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n      312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n      0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n      0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n      32s176 78.7 176 176-78.7 176-176 176z"\n    />\n    <path fill="ACTIVE_COLOR" transform="scale(0.22,0.22) translate(1400,0)" d="M1216\n      320q0 26-19 45t-45 19h-128v1024h128q26 0 45 19t19 45-19 45l-256 256q-19\n      19-45 19t-45-19l-256-256q-19-19-19-45t19-45 45-19h128v-1024h-128q-26\n      0-45-19t-19-45 19-45l256-256q19-19 45-19t45 19l256 256q19 19 19 45z"\n    />',{viewBox:{x:640,y:512}}),D={x:127,y:60},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ACTIVE_COLOR";return'<rect fill="'.concat(e,'" x="80.19" y="25.03" width="47.14" height="15.85"/>')},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ACTIVE_COLOR";return'<rect fill="'.concat(e,'" x="80.19" y="25.03" width="47.14" height="15.85"/>\n      <rect fill="').concat(e,'" x="95.84" y="9.38" width="15.85" height="47.14"/>')},A='<path fill="ACTIVE_COLOR" d="M82.89,10a12.09,12.09,0,0,0-16.8-2.5l-27.5,20.4-8.5-6.3a2.93,2.93,0,0,1-1.1-3,14.66,14.66,0,0,0,.1-6.6,14.08,14.08,0,1,0-6.5,15.2,2.87,2.87,0,0,1,3.2.2l8.2,6.1-8.2,6.1a2.87,2.87,0,0,1-3.2.2,14.16,14.16,0,1,0,6.7,14.4,14,14,0,0,0-.3-5.8,2.93,2.93,0,0,1,1.1-3l8.5-6.3,27.5,20.4A11.91,11.91,0,0,0,82.89,57l-31.7-23.5ZM15.29,21a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,21Zm0,36.8a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,57.77Zm28.3-21.5a2.8,2.8,0,1,1,2.8-2.8A2.8,2.8,0,0,1,43.59,36.27Z" transform="translate(-1.17 -0.96)"/>',R='<path fill="ACTIVE_COLOR" d="M8.86,2.25V66.08H72.69V2.25H8.86ZM65.28,58.67h-49v-49h49v49Z" transform="translate(-8.86 -2.25)"/>',B='<path fill="ACTIVE_COLOR" d="M40.77,2.25A31.92,31.92,0,1,0,72.69,34.16,31.92,31.92,0,0,0,40.77,2.25Zm0,57.63A25.71,25.71,0,1,1,66.48,34.16,25.71,25.71,0,0,1,40.77,59.87Z" transform="translate(-8.86 -2.25)"/>',U=new r.default("".concat(A," ").concat(k()),{viewBox:D}),F=new r.default("".concat(A," ").concat(L()),{viewBox:D}),H=new r.default("".concat(A," ").concat(k()),{viewBox:D}),N=new r.default("".concat(A," ").concat(L()),{viewBox:D}),z=new r.default("".concat(R," ").concat(k()),{viewBox:D}),V=new r.default("".concat(R," ").concat(L()),{viewBox:D}),W=new r.default("".concat(R," ").concat(k()),{viewBox:D}),G=new r.default("".concat(R," ").concat(L()),{viewBox:D}),Y=new r.default("".concat(B," ").concat(k()),{viewBox:D}),X=new r.default("".concat(B," ").concat(L()),{viewBox:D}),Z=new r.default("".concat(B," ").concat(k()),{viewBox:D}),K=new r.default("".concat(B," ").concat(L()),{viewBox:D})},"./tools/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./tools/CrosshairsTool.js");n.d(t,"CrosshairsTool",(function(){return r.default}));var o=n("./tools/DoubleTapFitToWindowTool.js");n.d(t,"DoubleTapFitToWindowTool",(function(){return o.default}));var l=n("./tools/DragProbeTool.js");n.d(t,"DragProbeTool",(function(){return l.default}));var c=n("./tools/EraserTool.js");n.d(t,"EraserTool",(function(){return c.default}));var d=n("./tools/FreehandRoiSculptorTool.js");n.d(t,"FreehandRoiSculptorTool",(function(){return d.default}));var f=n("./tools/MagnifyTool.js");n.d(t,"MagnifyTool",(function(){return f.default}));var h=n("./tools/OverlayTool.js");n.d(t,"OverlayTool",(function(){return h.default}));var m=n("./tools/OrientationMarkersTool.js");n.d(t,"OrientationMarkersTool",(function(){return m.default}));var v=n("./tools/PanMultiTouchTool.js");n.d(t,"PanMultiTouchTool",(function(){return v.default}));var y=n("./tools/PanTool.js");n.d(t,"PanTool",(function(){return y.default}));var x=n("./tools/ReferenceLinesTool.js");n.d(t,"ReferenceLinesTool",(function(){return x.default}));var j=n("./tools/RotateTool.js");n.d(t,"RotateTool",(function(){return j.default}));var w=n("./tools/RotateTouchTool.js");n.d(t,"RotateTouchTool",(function(){return w.default}));var T=n("./tools/ScaleOverlayTool.js");n.d(t,"ScaleOverlayTool",(function(){return T.default}));var E=n("./tools/StackScrollMouseWheelTool.js");n.d(t,"StackScrollMouseWheelTool",(function(){return E.default}));var O=n("./tools/StackScrollMultiTouchTool.js");n.d(t,"StackScrollMultiTouchTool",(function(){return O.default}));var C=n("./tools/StackScrollTool.js");n.d(t,"StackScrollTool",(function(){return C.default}));var S=n("./tools/WwwcRegionTool.js");n.d(t,"WwwcRegionTool",(function(){return S.default}));var I=n("./tools/WwwcTool.js");n.d(t,"WwwcTool",(function(){return I.default}));var M=n("./tools/ZoomMouseWheelTool.js");n.d(t,"ZoomMouseWheelTool",(function(){return M.default}));var P=n("./tools/ZoomTool.js");n.d(t,"ZoomTool",(function(){return P.default}));var _=n("./tools/ZoomTouchPinchTool.js");n.d(t,"ZoomTouchPinchTool",(function(){return _.default})),t.default={CrosshairsTool:r.default,DoubleTapFitToWindowTool:o.default,DragProbeTool:l.default,EraserTool:c.default,FreehandRoiSculptorTool:d.default,MagnifyTool:f.default,OverlayTool:h.default,OrientationMarkersTool:m.default,PanMultiTouchTool:v.default,PanTool:y.default,ReferenceLinesTool:x.default,RotateTool:j.default,RotateTouchTool:w.default,ScaleOverlayTool:T.default,StackScrollMouseWheelTool:E.default,StackScrollMultiTouchTool:O.default,StackScrollTool:C.default,WwwcRegionTool:S.default,WwwcTool:I.default,ZoomMouseWheelTool:M.default,ZoomTool:P.default,ZoomTouchPinchTool:_.default}},"./tools/referenceLines/calculateReferenceLine.js":function(e,t,n){"use strict";n.r(t);var r=n("./util/pointProjector.js");t.default=function(e,t){var n=Object(r.planePlaneIntersection)(e,t);if(n)return{start:Object(r.projectPatientPointToImagePlane)(n.start,e),end:Object(r.projectPatientPointToImagePlane)(n.end,e)}}},"./tools/referenceLines/renderActiveReferenceLine.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=n("./tools/referenceLines/calculateReferenceLine.js"),l=n("./stateManagement/toolColors.js"),c=n("./util/convertToVector3.js"),d=n("./drawing/index.js");t.default=function(e,t,n,f){var h=r.default.cornerstone,m=h.getEnabledElement(n).image,v=h.getEnabledElement(f).image;if(m&&v){var y=h.metaData.get("imagePlaneModule",m.imageId),x=h.metaData.get("imagePlaneModule",v.imageId);if(y&&x&&y.rowCosines&&y.columnCosines&&y.imagePositionPatient&&x.rowCosines&&x.columnCosines&&x.imagePositionPatient&&y.frameOfReferenceUID===x.frameOfReferenceUID){y.rowCosines=Object(c.default)(y.rowCosines),y.columnCosines=Object(c.default)(y.columnCosines),y.imagePositionPatient=Object(c.default)(y.imagePositionPatient),x.rowCosines=Object(c.default)(x.rowCosines),x.columnCosines=Object(c.default)(x.columnCosines),x.imagePositionPatient=Object(c.default)(x.imagePositionPatient);var j=y.rowCosines.clone().cross(y.columnCosines),w=x.rowCosines.clone().cross(x.columnCosines),T=j.angleTo(w);if(!((T=Math.abs(T))<.5)){var E=Object(o.default)(y,x);if(E){var O=l.default.getActiveColor();e.setTransform(1,0,0,1,0,0),Object(d.draw)(e,(function(e){Object(d.drawLine)(e,t.element,E.start,E.end,{color:O})}))}}}}}},"./tools/segmentation/BrushTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return I}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),y=n.n(v),x=n("../node_modules/@babel/runtime/helpers/inherits.js"),j=n.n(x),w=n("./externalModules.js"),T=n("./tools/base/index.js"),E=n("./store/index.js"),O=n("./util/segmentation/index.js"),C=n("./util/logger.js"),S=(Object(C.getLogger)("tools:BrushTool"),Object(E.getModule)("segmentation")),I=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"Brush",supportedInteractionTypes:["Mouse","Touch"],configuration:{},mixins:["renderBrushMixin"]};return(e=f()(this,m()(t).call(this,n,r))).touchDragCallback=e._paint.bind(y()(e)),e}return j()(t,e),c()(t,[{key:"_paint",value:function(e){var t=S.configuration,n=e.detail,r=(n.element,n.image),o=r.rows,l=r.columns,c=n.currentPoints.image,d=c.x,f=c.y;if(!(d<0||d>l||f<0||f>o)){var h=t.radius,m=Object(O.getCircle)(h,o,l,d,f),v=this.paintEventData,y=v.labelmap2D,x=v.labelmap3D,j=v.shouldErase;Object(O.drawBrushPixels)(m,y.pixelData,x.activeSegmentIndex,l,j),w.default.cornerstone.updateImage(e.detail.element)}}}]),t}(T.BaseBrushTool)},"./tools/segmentation/CircleScissorsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return j}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),v=n("./tools/base/index.js"),y=n("./tools/segmentation/strategies/index.js"),x=n("./tools/cursors/index.js"),j=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"CircleScissors",strategies:{FILL_INSIDE:y.fillInsideCircle,FILL_OUTSIDE:y.fillOutsideCircle,ERASE_OUTSIDE:y.eraseOutsideCircle,ERASE_INSIDE:y.eraseInsideCircle},cursors:{FILL_INSIDE:x.segCircleFillInsideCursor,FILL_OUTSIDE:x.segCircleFillOutsideCursor,ERASE_OUTSIDE:x.segCircleEraseOutsideCursor,ERASE_INSIDE:x.segCircleEraseInsideCursor},defaultStrategy:"FILL_INSIDE",supportedInteractionTypes:["Mouse","Touch"],svgCursor:x.segCircleFillInsideCursor,mixins:["circleSegmentationMixin"]};return c()(this,f()(t).call(this,e,n))}return m()(t,e),t}(v.BaseTool)},"./tools/segmentation/CorrectionScissorsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return j}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),v=n("./tools/base/index.js"),y=n("./tools/cursors/index.js"),x=n("./tools/segmentation/strategies/index.js"),j=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"CorrectionScissors",strategies:{CORRECTION:x.correction},cursors:{CORRECTION:y.freehandFillInsideCursor},defaultStrategy:"CORRECTION",supportedInteractionTypes:["Mouse","Touch"],svgCursor:y.freehandFillInsideCursor,mixins:["polylineSegmentationMixin"]};return c()(this,f()(t).call(this,e,n))}return m()(t,e),t}(v.BaseTool)},"./tools/segmentation/FreehandScissorsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return x}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),v=n("./tools/cursors/index.js"),y=n("./tools/segmentation/strategies/index.js"),x=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"FreehandScissors",strategies:{FILL_INSIDE:y.fillInsideFreehand,FILL_OUTSIDE:y.fillOutsideFreehand,ERASE_OUTSIDE:y.eraseOutsideFreehand,ERASE_INSIDE:y.eraseInsideFreehand},cursors:{FILL_INSIDE:v.freehandFillInsideCursor,FILL_OUTSIDE:v.freehandFillOutsideCursor,ERASE_OUTSIDE:v.freehandEraseOutsideCursor,ERASE_INSIDE:v.freehandEraseInsideCursor},defaultStrategy:"FILL_INSIDE",supportedInteractionTypes:["Mouse","Touch"],svgCursor:v.freehandFillInsideCursor,mixins:["freehandSegmentationMixin"]};return c()(this,f()(t).call(this,e,n))}return m()(t,e),t}(n("./tools/base/index.js").BaseTool)},"./tools/segmentation/RectangleScissorsTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return j}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/inherits.js"),m=n.n(h),v=n("./tools/base/index.js"),y=n("./tools/segmentation/strategies/index.js"),x=n("./tools/cursors/index.js"),j=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var n={name:"RectangleScissors",strategies:{FILL_INSIDE:y.fillInsideRectangle,FILL_OUTSIDE:y.fillOutsideRectangle,ERASE_OUTSIDE:y.eraseOutsideRectangle,ERASE_INSIDE:y.eraseInsideRectangle},cursors:{FILL_INSIDE:x.segRectangleFillInsideCursor,FILL_OUTSIDE:x.segRectangleFillOutsideCursor,ERASE_OUTSIDE:x.segRectangleEraseOutsideCursor,ERASE_INSIDE:x.segRectangleEraseInsideCursor},defaultStrategy:"FILL_INSIDE",supportedInteractionTypes:["Mouse","Touch"],mixins:["rectangleSegmentationMixin"]};return c()(this,f()(t).call(this,e,n))}return m()(t,e),t}(v.BaseTool)},"./tools/segmentation/SphericalBrushTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return P}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),f=n.n(d),h=n("../node_modules/@babel/runtime/helpers/getPrototypeOf.js"),m=n.n(h),v=n("../node_modules/@babel/runtime/helpers/assertThisInitialized.js"),y=n.n(v),x=n("../node_modules/@babel/runtime/helpers/inherits.js"),j=n.n(x),w=n("./externalModules.js"),T=n("./tools/base/BaseBrushTool.js"),E=n("./store/index.js"),O=n("./util/segmentation/index.js"),C=n("./stateManagement/toolState.js"),S=n("./util/logger.js"),I=Object(S.getLogger)("tools:SphericalBrushTool"),M=Object(E.getModule)("segmentation"),P=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,t);var r={name:"SphericalBrush",supportedInteractionTypes:["Mouse","Touch"],configuration:{alwaysEraseOnClick:!1},mixins:["renderBrushMixin"]};return(e=f()(this,m()(t).call(this,n,r))).touchDragCallback=e._paint.bind(y()(e)),e}return j()(t,e),c()(t,[{key:"_startPainting",value:function(e){var t,n=M.configuration,r=M.getters,o=e.detail,element=o.element,image=o.image,l=w.default.cornerstone,c=n.radius,d=image.rows,f=image.columns,h=Math.max(image.rowPixelSpacing,image.columnPixelSpacing),m=Object(C.getToolState)(element,"stack").data[0].imageIds,v=r.labelmap2D(element),y=v.labelmap2D,x=v.labelmap3D,j=v.currentImageIdIndex,T=v.activeLabelmapIndex,E=this._isCtrlDown(o)||this.configuration.alwaysEraseOnClick,O=l.metaData.get("imagePlaneModule",image.imageId);if(O){var S=O.imagePositionPatient;t=this._getImagesInRange(j,S,m,c,h)}else I.warn("No imagePlane metadata found for image, defaulting to circle brush application."),t=[{imageIdIndex:j,radiusOnImage:c}];if(this.paintEventData={labelmap2D:y,labelmap3D:x,currentImageIdIndex:j,activeLabelmapIndex:T,shouldErase:E,imagesInRange:t},n.storeHistory){for(var P=[],i=0;i<t.length;i++){var _=t[i].imageIdIndex,D=r.labelmap2DByImageIdIndex(x,_,d,f).pixelData.slice();P.push(D)}this.paintEventData.previousPixeldataForImagesInRange=P}}},{key:"_paint",value:function(e){var t=M.getters,n=e.detail,image=(n.element,n.image),r=image.rows,o=image.columns,l=n.currentPoints.image,c=l.x,d=l.y;if(!(c<0||c>o||d<0||d>r)){for(var f=this.paintEventData,h=f.labelmap3D,m=f.imagesInRange,v=f.shouldErase,i=0;i<m.length;i++){var y=m[i],x=y.imageIdIndex,j=y.radiusOnImage,T=Object(O.getCircle)(j,r,o,c,d),E=t.labelmap2DByImageIdIndex(h,x,r,o);Object(O.drawBrushPixels)(T,E.pixelData,h.activeSegmentIndex,o,v)}w.default.cornerstone.updateImage(e.detail.element)}}},{key:"_getImagesInRange",value:function(e,t,n,r,o){for(var l=r*o,c=[{imageIdIndex:e,radiusOnImage:r}],i=e+1;i<n.length;i++){var d=this._getRadiusOnImage(n[i],t,l,o);if(!d)break;c.push({imageIdIndex:i,radiusOnImage:d})}for(var f=e-1;f>=0;f--){var h=this._getRadiusOnImage(n[f],t,l,o);if(!h)break;c.push({imageIdIndex:f,radiusOnImage:h})}return c}},{key:"_getRadiusOnImage",value:function(e,t,n,r){var o=w.default.cornerstone.metaData.get("imagePlaneModule",e);if(o){var l=o.imagePositionPatient,c=Math.sqrt(Math.pow(l[0]-t[0],2)+Math.pow(l[1]-t[1],2)+Math.pow(l[2]-t[2],2));if(!(c>n))return Math.floor(Math.sqrt(Math.pow(n,2)-Math.pow(c,2))/r)}else I.warn("Can't find imagePlane metadata for image, cancelling spherical brushing on: ".concat(e,","))}},{key:"_endPainting",value:function(e){for(var t=this.paintEventData,n=t.labelmap3D,r=t.imagesInRange,o=[],l=M.configuration,c=M.setters,i=0;i<r.length;i++){for(var d=r[i].imageIdIndex,f=n.labelmaps2D[d],h=new Set(f.pixelData).values(),m=[],v=!1;!v;){var y=h.next();(v=y.done)||m.push(y.value)}if(f.segmentsOnLabelmap=m,l.storeHistory){var x=this.paintEventData.previousPixeldataForImagesInRange[i],j=n.labelmaps2D[d].pixelData;o.push({imageIdIndex:d,diff:Object(O.getDiffBetweenPixelData)(x,j)})}}l.storeHistory&&c.pushState(this.element,o),Object(O.triggerLabelmapModifiedEvent)(this.element)}}]),t}(T.default)},"./tools/segmentation/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./tools/segmentation/BrushTool.js"),o=n("./tools/segmentation/SphericalBrushTool.js"),l=n("./tools/segmentation/FreehandScissorsTool.js"),c=n("./tools/segmentation/RectangleScissorsTool.js"),d=n("./tools/segmentation/CircleScissorsTool.js"),f=n("./tools/segmentation/CorrectionScissorsTool.js");n.d(t,"BrushTool",(function(){return r.default})),n.d(t,"SphericalBrushTool",(function(){return o.default})),n.d(t,"FreehandScissorsTool",(function(){return l.default})),n.d(t,"RectangleScissorsTool",(function(){return c.default})),n.d(t,"CircleScissorsTool",(function(){return d.default})),n.d(t,"CorrectionScissorsTool",(function(){return f.default})),t.default={BrushTool:r.default,SphericalBrushTool:o.default,CircleScissorsTool:d.default,CorrectionScissorsTool:f.default,FreehandScissorsTool:l.default,RectangleScissorsTool:c.default}},"./tools/segmentation/strategies/correction.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var r=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(r),l=n("./tools/segmentation/strategies/index.js"),c=n("./util/segmentation/index.js"),d=n("./util/clip.js"),f=n("./util/isPointInImage.js"),h=n("./util/logger.js"),m=Object(h.getLogger)("util:segmentation:operations:correction");function v(e,t){var n=t.pixelData,r=t.segmentIndex,h=t.segmentationMixinType;if("freehandSegmentationMixin"===h){var v=function(e,t){for(var n=t.pixelData,r=t.points,image=e.detail.image,o=image.width,l=image.height,c=[],i=0;i<r.length;i++){var f=r[i],h=Math.floor(f.x),m=Math.floor(f.y);h=Object(d.default)(h,0,o-1),m=Object(d.default)(m,0,l-1);var v=c[c.length-1];v&&h===v.x&&m===v.y||c.push({x:h,y:m,segment:n[m*o+h]})}return c}(e,t),w=function(e,t){for(var n=!0,r=!0,i=0;i<e.length&&(e[i].segment===t?r=!1:n=!1,n||r);i++);return r?{isScissorOperation:!0,operation:"fillInsideFreehand"}:n?{isScissorOperation:!0,operation:"eraseInsideFreehand"}:{isScissorOperation:!1}}(v,r);if(w.isScissorOperation)"fillInsideFreehand"===w.operation?(m.warn("The line never intersects a segment."),Object(l.fillInsideFreehand)(e,t)):"eraseInsideFreehand"===w.operation&&(m.warn("The line is only ever inside the segment."),Object(l.eraseInsideFreehand)(e,t));else{var T=new Uint8Array(n.length),E=function(e,t){var n=e[0].segment===t,r=[];r.push({additive:!n,nodes:[]});for(var o=0,i=0;i<e.length;i++){var l=e[i];n?(r[o].nodes.push(l),l.segment!==t&&(o++,n=!n,r.push({additive:!0,nodes:[]}),r[o].nodes.push(e[i-1]),r[o].nodes.push(l))):(r[o].nodes.push(l),l.segment===t&&(o++,n=!n,r.push({additive:!1,nodes:[]}),r[o].nodes.push(e[i-1]),r[o].nodes.push(l)))}return r.pop(),r.shift(),r}(v,r);E.forEach((function(t){!function(e,t,n,r,l){var d=l.detail.image,h=d.width,v=d.height,w=e.nodes,T=e.additive,E=T?0:1,O=function(e){return e.y*h+e.x},C=function(e){return{x:e%h,y:Math.floor(e/h)}};T?m.warn("additive operation..."):m.warn("subtractive operation...");for(var S=function(e){for(var t=[],i=0;i<e.length-1;i++)t.push(e[i]),t.push.apply(t,o()(Object(c.getPixelPathBetweenPixels)(e[i],e[i+1])));t.push[e[e.length-1]];for(var n=[],r=[],l=0;l<t.length-1;l++){var d=j(t[l],t[l+1]),f=d.left,h=d.right;n.push(f),r.push(h)}return{pixelPath:t,leftPath:n,rightPath:r}}(w),I=S.pixelPath,M=S.leftPath,P=S.rightPath,_=I[0],D={xMin:_.x,xMax:_.x,yMin:_.y,yMax:_.y},i=0;i<n.length;i++)t[i]===r?(y(D,C(i)),n[i]=1):n[i]=0;for(var k=0;k<I.length;k++){var L=I[k];n[O(L)]=2,y(D,L)}!function(e,t,n){var r=2;e.xMax=Math.min(e.xMax+r,n),e.xMin=Math.max(e.xMin-r,0),e.yMax=Math.min(e.yMax+r,t),e.yMin=Math.max(e.yMin-r,0)}(D,v,h);var A=D.xMin,R=D.xMax,B=D.yMin,U=D.yMax;function F(e,t){if(!(e>=R||e<A||t>=U||t<B))return n[t*h+e]}for(var H=0,N=0,z=0;z<M.length;z++){var V=M[z];n[O(V)]===E&&Object(f.default)(V,v,h)&&(H+=x(V,3,n,F,h));var W=P[z];n[O(W)]===E&&Object(f.default)(W,v,h)&&(N+=x(W,4,n,F,h))}if(0!==H&&0!==N){for(var G=T?r:0,Y=H<N?3:4,X=0;X<n.length;X++)n[X]===Y&&(t[X]=G);if(G===r)for(var Z=0;Z<I.length;Z++)t[O(I[Z])]=r;else for(var K=0;K<I.length;K++){var J=O(I[K]);t[J]===r&&(t[J]=0)}}}(t,n,T,r,e)}))}}else m.error("correction operation requires freehandSegmentationMixin operationData, recieved ".concat(h))}function y(e,t){var n=t.x,r=t.y;n<e.xMin&&(e.xMin=n),n>e.xMax&&(e.xMax=n),r<e.yMin&&(e.yMin=r),r>e.yMax&&(e.yMax=r)}function x(e,t,n,r,o){for(var l=Object(c.floodFill)(r,[e.x,e.y]).flooded,p=0;p<l.length;p++){var d=l[p];n[d[1]*o+d[0]]=t}return l.length}function j(e,t){var n={x:t.x-e.x,y:t.y-e.y};return-1===n.x&&1===n.y?{left:{x:e.x-1,y:e.y-1},right:{x:e.x+1,y:e.y+1}}:0===n.x&&1===n.y?{left:{x:e.x-1,y:e.y},right:{x:e.x+1,y:e.y}}:1===n.x&&1===n.y?{left:{x:e.x-1,y:e.y+1},right:{x:e.x+1,y:e.y-1}}:1===n.x&&0===n.y?{left:{x:e.x,y:e.y+1},right:{x:e.x,y:e.y-1}}:1===n.x&&-1===n.y?{left:{x:e.x+1,y:e.y+1},right:{x:e.x-1,y:e.y-1}}:0===n.x&&-1===n.y?{left:{x:e.x+1,y:e.y},right:{x:e.x-1,y:e.y}}:-1===n.x&&-1===n.y?{left:{x:e.x+1,y:e.y-1},right:{x:e.x-1,y:e.y+1}}:-1===n.x&&0===n.y?{left:{x:e.x,y:e.y-1},right:{x:e.x,y:e.y+1}}:void m.error("Unable to find left and right paths for flood fill ",e,t,n)}},"./tools/segmentation/strategies/eraseCircle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"eraseInsideCircle",(function(){return v})),n.d(t,"eraseOutsideCircle",(function(){return y}));var r=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=n.n(r),l=n("./util/ellipse/index.js"),c=n("./util/logger.js"),d=n("./util/segmentation/index.js"),f=n("./util/getCircleCoords.js"),h=Object(c.getLogger)("util:segmentation:operations:eraseInsideCircle");function m(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.segmentationMixinType;if("circleSegmentationMixin"===r){var c=e.detail,m=Object(d.getBoundingBoxAroundCircle)(e),v=o()(m,2),y=v[0],x=v[1],ellipse=Object(f.default)(c.handles.start,c.handles.end);n?Object(d.eraseInsideShape)(e,t,(function(e){return Object(l.pointInEllipse)(ellipse,e)}),y,x):Object(d.eraseOutsideShape)(e,t,(function(e){return Object(l.pointInEllipse)(ellipse,e)}),y,x)}else h.error("eraseInsideCircle operation requires circleSegmentationMixin operationData, recieved ".concat(r))}function v(e,t){m(e,t,!0)}function y(e,t){m(e,t,!1)}},"./tools/segmentation/strategies/eraseFreehand.js":function(e,t,n){"use strict";n.r(t),n.d(t,"eraseInsideFreehand",(function(){return m})),n.d(t,"eraseOutsideFreehand",(function(){return v}));var r=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=n.n(r),l=n("./util/segmentation/index.js"),c=n("./util/isPointInPolygon.js"),d=n("./util/logger.js"),f=Object(d.getLogger)("util:segmentation:operations:eraseInsideFreehand");function h(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.points,d=t.segmentationMixinType;if("freehandSegmentationMixin"===d){var image=e.detail.image,h=r.map((function(a){return[a.x,a.y]})),m=Object(l.getBoundingBoxAroundPolygon)(h,image),v=o()(m,2),y=v[0],x=v[1];n?Object(l.eraseInsideShape)(e,t,(function(e){return Object(c.default)([e.x,e.y],h)}),y,x):Object(l.eraseOutsideShape)(e,t,(function(e){return Object(c.default)([e.x,e.y],h)}),y,x)}else f.error("eraseInsideFreehand operation requires freehandSegmentationMixin operationData, recieved ".concat(d))}function m(e,t){h(e,t,!0)}function v(e,t){h(e,t,!1)}},"./tools/segmentation/strategies/eraseRectangle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"eraseInsideRectangle",(function(){return h})),n.d(t,"eraseOutsideRectangle",(function(){return m}));var r=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=n.n(r),l=n("./util/logger.js"),c=n("./util/segmentation/index.js"),d=Object(l.getLogger)("util:segmentation:operations:eraseInsideRectangle");function f(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.points,l=t.segmentationMixinType;if("rectangleSegmentationMixin"===l){var f=e.detail,image=f.image,h=r.map((function(a){return[a.x,a.y]})),m=Object(c.getBoundingBoxAroundPolygon)(h,image),v=o()(m,2),y=v[0],x=v[1];n?Object(c.eraseInsideShape)(e,t,(function(){return!0}),y,x):Object(c.eraseOutsideBoundingBox)(e,t,y,x)}else d.error("eraseInsideRectangle operation requires rectangleSegmentationMixin operationData, recieved ".concat(l))}function h(e,t){f(e,t,!0)}function m(e,t){f(e,t,!1)}},"./tools/segmentation/strategies/fillCircle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"fillInsideCircle",(function(){return v})),n.d(t,"fillOutsideCircle",(function(){return y}));var r=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=n.n(r),l=n("./util/segmentation/index.js"),c=n("./util/ellipse/index.js"),d=n("./util/getCircleCoords.js"),f=n("./util/logger.js"),h=Object(f.getLogger)("util:segmentation:operations:fillCircle");function m(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.segmentationMixinType;if("circleSegmentationMixin"===r){var f=e.detail,m=Object(l.getBoundingBoxAroundCircle)(e),v=o()(m,2),y=v[0],x=v[1],ellipse=Object(d.default)(f.handles.start,f.handles.end);n?Object(l.fillInsideShape)(e,t,(function(e){return Object(c.pointInEllipse)(ellipse,e)}),y,x):Object(l.fillOutsideShape)(e,t,(function(e){return Object(c.pointInEllipse)(ellipse,e)}),y,x)}else h.error("fillInsideCircle operation requires circleSegmentationMixin operationData, recieved ".concat(r))}function v(e,t){m(e,t,!0)}function y(e,t){m(e,t,!1)}},"./tools/segmentation/strategies/fillFreehand.js":function(e,t,n){"use strict";n.r(t),n.d(t,"fillInsideFreehand",(function(){return m})),n.d(t,"fillOutsideFreehand",(function(){return v}));var r=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=n.n(r),l=n("./util/segmentation/index.js"),c=n("./util/isPointInPolygon.js"),d=n("./util/logger.js"),f=Object(d.getLogger)("util:segmentation:operations:fillInsideFreehand");function h(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.points,d=t.segmentationMixinType;if("freehandSegmentationMixin"===d){var image=e.detail.image,h=r.map((function(a){return[a.x,a.y]})),m=Object(l.getBoundingBoxAroundPolygon)(h,image),v=o()(m,2),y=v[0],x=v[1];n?Object(l.fillInsideShape)(e,t,(function(e){return Object(c.default)([e.x,e.y],h)}),y,x):Object(l.fillOutsideShape)(e,t,(function(e){return Object(c.default)([e.x,e.y],h)}),y,x)}else f.error("eraseInsideFreehand operation requires freehandSegmentationMixin operationData, recieved ".concat(d))}function m(e,t){h(e,t,!0)}function v(e,t){h(e,t,!1)}},"./tools/segmentation/strategies/fillRectangle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"fillInsideRectangle",(function(){return h})),n.d(t,"fillOutsideRectangle",(function(){return m}));var r=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=n.n(r),l=n("./util/segmentation/index.js"),c=n("./util/logger.js"),d=Object(c.getLogger)("util:segmentation:operations:fillInsideRectangle");function f(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.points,c=t.segmentationMixinType;if("rectangleSegmentationMixin"===c){var image=e.detail.image,f=r.map((function(a){return[a.x,a.y]})),h=Object(l.getBoundingBoxAroundPolygon)(f,image),m=o()(h,2),v=m[0],y=m[1];n?Object(l.fillInsideShape)(e,t,(function(){return!0}),v,y):Object(l.fillOutsideBoundingBox)(e,t,v,y)}else d.error("eraseInsideRectangle operation requires rectangleSegmentationMixin operationData, recieved ".concat(c))}function h(e,t){f(e,t,!0)}function m(e,t){f(e,t,!1)}},"./tools/segmentation/strategies/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./tools/segmentation/strategies/correction.js");n.d(t,"correction",(function(){return r.default}));var o=n("./tools/segmentation/strategies/eraseFreehand.js");n.d(t,"eraseInsideFreehand",(function(){return o.eraseInsideFreehand})),n.d(t,"eraseOutsideFreehand",(function(){return o.eraseOutsideFreehand}));var l=n("./tools/segmentation/strategies/eraseRectangle.js");n.d(t,"eraseInsideRectangle",(function(){return l.eraseInsideRectangle})),n.d(t,"eraseOutsideRectangle",(function(){return l.eraseOutsideRectangle}));var c=n("./tools/segmentation/strategies/fillFreehand.js");n.d(t,"fillInsideFreehand",(function(){return c.fillInsideFreehand})),n.d(t,"fillOutsideFreehand",(function(){return c.fillOutsideFreehand}));var d=n("./tools/segmentation/strategies/fillRectangle.js");n.d(t,"fillInsideRectangle",(function(){return d.fillInsideRectangle})),n.d(t,"fillOutsideRectangle",(function(){return d.fillOutsideRectangle}));var f=n("./tools/segmentation/strategies/fillCircle.js");n.d(t,"fillInsideCircle",(function(){return f.fillInsideCircle})),n.d(t,"fillOutsideCircle",(function(){return f.fillOutsideCircle}));var h=n("./tools/segmentation/strategies/eraseCircle.js");n.d(t,"eraseInsideCircle",(function(){return h.eraseInsideCircle})),n.d(t,"eraseOutsideCircle",(function(){return h.eraseOutsideCircle}))},"./util/SaveAs.js":function(e,t,n){"use strict";n.r(t),t.default=function(element,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",canvas=element.querySelector("canvas");if(canvas.msToBlob){var n=canvas.msToBlob();return window.navigator.msSaveBlob(n,e)}var r=document.createElement("a");if(r.download=e,r.href=canvas.toDataURL(t,1),document.createEvent){var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(o)}else r.fireEvent&&r.fireEvent("onclick")}},"./util/angleBetweenPoints.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){var r=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),o=Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2)),l=Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2));return{angle:180*Math.acos((Math.pow(r,2)+Math.pow(o,2)-Math.pow(l,2))/(2*r*o))/Math.PI,direction:(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)}}},"./util/calculateSUV.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js");function o(e){return parseFloat(".".concat(e))}t.default=function(image,e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=r.default.cornerstone,l=n.metaData.get("patientStudyModule",image.imageId),c=n.metaData.get("generalSeriesModule",image.imageId);if(l&&c){var d=c.modality;if("PT"===d){var f=t?e:e*image.slope+image.intercept,h=l.patientWeight;if(h){var m=n.metaData.get("petIsotopeModule",image.imageId);if(m){var v=m.radiopharmaceuticalInfo,y=v.radiopharmaceuticalStartTime,x=v.radionuclideTotalDose,j=v.radionuclideHalfLife,w=c.seriesTime;if(y&&x&&j&&w){var T=o(w.fractionalSeconds||0)+w.seconds+60*w.minutes+60*w.hours*60,E=o(y.fractionalSeconds||0)+y.seconds+60*y.minutes+60*y.hours*60,O=T-E,C=x*Math.exp(-O*Math.log(2)/j),S=f*h/C*1e3;return S}}}}}}},"./util/clip.js":function(e,t,n){"use strict";n.r(t),n.d(t,"clip",(function(){return c})),n.d(t,"clipToBox",(function(){return d})),n.d(t,"clipBoxToDisplayedArea",(function(){return h}));var r=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(r),l=n("./externalModules.js");function c(e,t,n){return Math.min(Math.max(t,e),n)}function d(e,t){var n=t.left||0,r=t.top||0;e.x=c(e.x,n,n+t.width),e.y=c(e.y,r,r+t.height)}var f=function(e,t,n,r,o,l){l-o<r-n?(e[t]+=o-n,e[t]+=(l-o)/2,e[t]-=(r-n)/2):n<o?e[t]+=o-n:r>l&&(e[t]-=r-l)};function h(element,e){var t=l.default.cornerstone,n=t.pixelToCanvas,r=t.canvasToPixel,c=t.getViewport,d=t.getEnabledElement,h=t.getDisplayedArea,m=r(element,{x:e.left,y:e.top}),v=function(element,e){var t=function(e){return l.default.cornerstone.canvasToPixel(element,e)},n=e.top,r=e.left,c=e.width,d=e.height,f=[t({x:r,y:n}),t({x:r+c,y:n}),t({x:r,y:n+d}),t({x:r+c,y:n+d})],h=f.map((function(p){return p.x})),m=f.map((function(p){return p.y}));return{minX:Math.min.apply(Math,o()(h)),minY:Math.min.apply(Math,o()(m)),maxX:Math.max.apply(Math,o()(h)),maxY:Math.max.apply(Math,o()(m))}}(element,e),y=v.minX,x=v.minY,j=v.maxX,w=v.maxY,T=c(element),E=h(d(element).image,T),O=T.displayedArea?T.displayedArea:E,C=O.tlhc,S=O.brhc,I=C.y-1,M=C.x-1,P=S.y,_=S.x;f(m,"y",x,w,I,P),f(m,"x",y,j,M,_);var D=n(element,m);e.top=D.y,e.left=D.x}t.default=c},"./util/convertToVector3.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n("./externalModules.js");function o(e){var t=r.default.cornerstoneMath;if(e instanceof t.Vector3)return e;var n=Object.keys(e);return n.includes("x")&&n.includes("y")&&n.includes("z")?new t.Vector3(e.x,e.y,e.z):new t.Vector3(e[0],e[1],e[2])}},"./util/copyPoints.js":function(e,t,n){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.x,n=e.y;return{x:t,y:n}}n.r(t),t.default=function(e){return{page:r(e.page),image:r(e.image),client:r(e.client),canvas:r(e.canvas)}}},"./util/debounce.js":function(e,t,n){"use strict";n.r(t);var r=n("./util/isObject.js");t.default=function(e,t,n){var o,l,c,d,f,h,m=0,v=!1,y=!1,x=!0,j=!t&&0!==t&&"function"==typeof window.requestAnimationFrame;if("function"!=typeof e)throw new TypeError("Expected a function");function w(time){var t=o,n=l;return o=l=void 0,m=time,d=e.apply(n,t)}function T(e,t){return j?window.requestAnimationFrame(e):setTimeout(e,t)}function E(time){return m=time,f=T(C,t),v?w(time):d}function O(time){var e=time-h;return void 0===h||e>=t||e<0||y&&time-m>=c}function C(){var time=Date.now();if(O(time))return S(time);f=T(C,function(time){var e=time-m,n=t-(time-h);return y?Math.min(n,c-e):n}(time))}function S(time){return f=void 0,x&&o?w(time):(o=l=void 0,d)}function I(){for(var time=Date.now(),e=O(time),n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];if(o=r,l=this,h=time,e){if(void 0===f)return E(h);if(y)return f=T(C,t),w(h)}return void 0===f&&(f=T(C,t)),d}return t=Number(t)||0,Object(r.default)(n)&&(v=Boolean(n.leading),c=(y="maxWait"in n)?Math.max(Number(n.maxWait)||0,t):c,x="trailing"in n?Boolean(n.trailing):x),I.cancel=function(){void 0!==f&&function(e){if(j)return window.cancelAnimationFrame(e);clearTimeout(e)}(f),m=0,o=h=l=f=void 0},I.flush=function(){return void 0===f?d:S(Date.now())},I.pending=function(){return void 0!==f},I}},"./util/debugLib/common.js":function(e,t,n){"use strict";n.r(t);var r=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(r);t.default=function(e){function t(e){for(var t=0,i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return r.colors[Math.abs(t)%r.colors.length]}function r(e){var n;function o(){for(var e=arguments.length,t=new Array(e),l=0;l<e;l++)t[l]=arguments[l];if(o.enabled){var c=o,d=Number(new Date),f=d-(n||d);c.diff=f,c.prev=n,c.curr=d,n=d,t[0]=r.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var h=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(function(e,n){if("%%"===e)return e;h++;var o=r.formatters[n];if("function"==typeof o){var l=t[h];e=o.call(c,l),t.splice(h,1),h--}return e})),r.formatArgs.call(c,t);var m=c.log||r.log;m.apply(c,t)}}return o.namespace=e,o.enabled=r.enabled(e),o.useColors=r.useColors(),o.color=t(e),o.destroy=l,o.extend=c,"function"==typeof r.init&&r.init(o),r.instances.push(o),o}function l(){var e=r.instances.indexOf(this);return-1!==e&&(r.instances.splice(e,1),!0)}function c(e,t){var n=r(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function d(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return r.debug=r,r.default=r,r.coerce=function(e){return e instanceof Error?e.stack||e.message:e},r.disable=function(){var e=[].concat(o()(r.names.map(d)),o()(r.skips.map(d).map((function(e){return"-".concat(e)})))).join(",");return r.enable(""),e},r.enable=function(e){var i;r.save(e),r.names=[],r.skips=[];var t=("string"==typeof e?e:"").split(/[\s,]+/),n=t.length;for(i=0;i<n;i++)t[i]&&("-"===(e=t[i].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^".concat(e.substr(1),"$"))):r.names.push(new RegExp("^".concat(e,"$"))));for(i=0;i<r.instances.length;i++){var o=r.instances[i];o.enabled=r.enabled(o.namespace)}},r.enabled=function(e){if("*"===e[e.length-1])return!0;var i,t;for(i=0,t=r.skips.length;i<t;i++)if(r.skips[i].test(e))return!1;for(i=0,t=r.names.length;i<t;i++)if(r.names[i].test(e))return!0;return!1},r.humanize=n("../node_modules/ms/index.js"),Object.keys(e).forEach((function(t){r[t]=e[t]})),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=t,r.enable(r.load()),r}},"./util/debugLib/index.js":function(e,t,n){"use strict";n.r(t),function(e){var r=n("./util/debugLib/common.js"),o={formatArgs:function(e){if(e[0]="".concat((this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" "),"+").concat(l.humanize(this.diff)),this.useColors){var t="color: ".concat(this.color);e.splice(1,0,t,"color: inherit");var n=0,r=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(r=n))})),e.splice(r,0,t)}},save:function(e){try{e?o.storage.setItem("debug",e):o.storage.removeItem("debug")}catch(e){}},load:function(){var t;try{t=o.storage.getItem("debug")}catch(e){console.warn(e)}return!t&&void 0!==e&&"env"in e&&(t=e.env.DEBUG),t},useColors:function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},storage:function(){try{return localStorage}catch(e){}}(),colors:["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"]};o.log=console.debug||console.log||function(){};var l=Object(r.default)(o);l.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: ".concat(e.message)}},t.default=l}.call(this,n("../node_modules/process/browser.js"))},"./util/deepmerge.js":function(e,t,n){"use strict";n.r(t);var r=n("../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(r),l=function(e){return e&&"object"===o()(e)&&"[object RegExp]"!==Object.prototype.toString.call(e)&&"[object Date]"!==Object.prototype.toString.call(e)},c=function(e,t){var n;return t&&!0===t.clone&&l(e)?h((n=e,Array.isArray(n)?[]:{}),e,t):e},d=function(e,source,t){var n=e.slice();return source.forEach((function(r,i){void 0===n[i]?n[i]=c(r,t):l(r)?n[i]=h(e[i],r,t):-1===e.indexOf(r)&&n.push(c(r,t))})),n},f=function(e,source,t){var n={};return l(e)&&Object.keys(e).forEach((function(r){n[r]=c(e[r],t)})),Object.keys(source).forEach((function(r){l(source[r])&&e[r]?n[r]=h(e[r],source[r],t):n[r]=c(source[r],t)})),n},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},source=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0,n=Array.isArray(source),r=t||{arrayMerge:d},o=r.arrayMerge||d;if(n)return Array.isArray(e)?o(e,source,t):c(source,t);var l=f(e,source,t);return Object.getPrototypeOf(e)!==Object.prototype&&Object.setPrototypeOf(l,Object.getPrototypeOf(e)),l};t.default=h},"./util/ellipse/calculateEllipseStatistics.js":function(e,t,n){"use strict";n.r(t);var r=n("./util/ellipse/pointInEllipse.js");t.default=function(e,ellipse){for(var t=0,n=0,o=0,l=0,c=null,d=null,f=ellipse.top;f<ellipse.top+ellipse.height;f++)for(var h=ellipse.left;h<ellipse.left+ellipse.width;h++){var m={x:h,y:f};Object(r.default)(ellipse,m)&&(null===c&&(c=e[l],d=e[l]),t+=e[l],n+=e[l]*e[l],c=Math.min(c,e[l]),d=Math.max(d,e[l]),o++),l++}if(0===o)return{count:o,mean:0,variance:0,stdDev:0,min:0,max:0};var v=t/o,y=n/o-v*v;return{count:o,mean:v,variance:y,stdDev:Math.sqrt(y),min:c,max:d}}},"./util/ellipse/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./util/ellipse/calculateEllipseStatistics.js");n.d(t,"calculateEllipseStatistics",(function(){return r.default}));var o=n("./util/ellipse/pointInEllipse.js");n.d(t,"pointInEllipse",(function(){return o.default})),t.default={calculateEllipseStatistics:r.default,pointInEllipse:o.default}},"./util/ellipse/pointInEllipse.js":function(e,t,n){"use strict";n.r(t),t.default=function(ellipse,e){var t=ellipse.width/2,n=ellipse.height/2;if(t<=0||n<=0)return!1;var r=ellipse.left+t,o=ellipse.top+n,l=e.x-r,c=e.y-o;return l*l/(t*t)+c*c/(n*n)<=1}},"./util/findAndMoveHelpers.js":function(e,t,n){"use strict";n.r(t),n.d(t,"moveHandleNearImagePoint",(function(){return x})),n.d(t,"findHandleDataNearImagePoint",(function(){return j})),n.d(t,"moveAnnotation",(function(){return w}));var r=n("../node_modules/@babel/runtime/helpers/defineProperty.js"),o=n.n(r),l=n("./store/index.js"),c=n("./manipulators/getHandleNearImagePoint.js"),d=n("./manipulators/index.js"),f=n("./util/getProximityThreshold.js"),h=n("./events.js"),m=n("./util/triggerEvent.js");function v(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function y(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(source,!0).forEach((function(t){o()(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):v(source).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var x=function(e,t,n,r,o){n.active=!0,l.state.isToolLocked=!0,Object(d.moveHandle)(e.detail,t.name,n,r,t.options,o,(function(t){var element=e.detail.element,r=n.toolType||n.toolName,o={toolName:r,toolType:r,element:element,measurementData:y({},n,{active:!1})};Object(m.default)(element,h.default.MEASUREMENT_COMPLETED,o)})),e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()},j=function(element,e,t,n){for(var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"mouse",i=0;i<e.data.length;i++){var data=e.data[i],o=Object(c.default)(element,data.handles,n,Object(f.default)(r,t));if(o)return{handle:o,data:data}}},w=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mouse";n.active=!0,l.state.isToolLocked=!0,Object(d.moveAllHandles)(e.detail,t.name,n,null,t.options,r,(function(){n.active=!1,l.state.isToolLocked=!1})),e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault()}},"./util/freehand/ClickedLineData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=function e(t,n){o()(this,e),this.toolIndex=t,this.handleIndexArray=n}},"./util/freehand/FreehandHandleData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];o()(this,e),this.x=t.x,this.y=t.y,this.highlight=n,this.active=r,this.lines=[]}},"./util/freehand/FreehandLineFinder.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));var r=n("../node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(r),l=n("../node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(l),d=n("./stateManagement/toolState.js"),f=n("./externalModules.js"),h=n("./util/freehand/ClickedLineData.js"),m=function(){function e(t,n){o()(this,e),this._eventData=t,this._toolName=n}return c()(e,[{key:"findLine",value:function(){var e=this.findTool();if(null===e)return null;var t=this._getCloseLinesInTool(e);return t?this._findCorrectLine(e,t):null}},{key:"findTool",value:function(){return this._toolData=Object(d.getToolState)(this._eventData.element,this._toolName),this._mousePoint=this._eventData.currentPoints.canvas,this._toolData?this._nearestHandleToPointAllTools().toolIndex:null}},{key:"_nearestHandleToPointAllTools",value:function(){for(var e=this._toolData,t={toolIndex:null,handleIndex:null,distance:1/0},n=0;n<e.data.length;n++){var r=this._nearestHandleToPoint(n);null!==r&&r.distance<t.distance&&(t=r)}return t}},{key:"_nearestHandleToPoint",value:function(e){var t=this._eventData,data=this._toolData.data[e],n=data.handles.points;if(void 0===n)return null;if(!1===data.visible)return null;for(var r={toolIndex:e,handleIndex:null,distance:1/0},i=0;i<n.length;i++){var o=f.default.cornerstone.pixelToCanvas(t.element,n[i]),l=f.default.cornerstoneMath.point.distance(o,this._mousePoint);l<r.distance&&(r.handleIndex=i,r.distance=l)}return r}},{key:"_getCloseLinesInTool",value:function(t){for(var n=this._toolData.data[t].handles.points,r=[],i=0;i<n.length;i++){var o=e.getNextHandleIndex(i,n.length);this._distanceOfPointfromLine(n[i],n[o])<10&&r.push([i,o])}return r}},{key:"_findCorrectLine",value:function(e,t){for(var i=0;i<t.length;i++)if(this._pointProjectsToLineSegment(e,t[i]))return new h.default(e,t[i]);return null}},{key:"_pointProjectsToLineSegment",value:function(t,n){var r=this._eventData,data=this._toolData.data[t],o=data.handles.points;if(void 0!==data.handles.points){if(!1===data.visible)return!1;var l=o[n[0]],c=o[n[1]],p=e.getCanvasPointsFromHandles(l,c,r.element),d=e.getLineAsVector(p),f=this._getLineOriginToMouseAsVector(p),h=(f[0]*d[0]+f[1]*d[1])/d.magnitude;return h>0&&h<d.magnitude}}},{key:"_getLineOriginToMouseAsVector",value:function(p){return[this._mousePoint.x-p[0].x,this._mousePoint.y-p[0].y]}},{key:"_distanceOfPointfromLine",value:function(e,t){var n=this._eventData,r=f.default.cornerstone.pixelToCanvas(n.element,e),o=f.default.cornerstone.pixelToCanvas(n.element,t),l=this._mousePoint;return Math.abs((o.y-r.y)*l.x-(o.x-r.x)*l.y+o.x*r.y-o.y*r.x)/f.default.cornerstoneMath.point.distance(r,o)}}],[{key:"getCanvasPointsFromHandles",value:function(e,t,element){var p=[];return e.x<t.x?(p.push(f.default.cornerstone.pixelToCanvas(element,e)),p.push(f.default.cornerstone.pixelToCanvas(element,t))):(p.push(f.default.cornerstone.pixelToCanvas(element,t)),p.push(f.default.cornerstone.pixelToCanvas(element,e))),p}},{key:"getLineAsVector",value:function(p){var e=[p[1].x-p[0].x,p[1].y-p[0].y];return e.magnitude=f.default.cornerstoneMath.point.distance(p[0],p[1]),e}},{key:"getNextHandleIndex",value:function(e,t){return e<t-1?e+1:0}}]),e}()},"./util/freehand/addLine.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){t===e.length-1?e[t].lines.push(e[0]):e[t].lines.push(e[t+1])}},"./util/freehand/calculateFreehandStatistics.js":function(e,t,n){"use strict";n.r(t);var r=n("./util/freehand/pointInFreehand.js");function o(e,t,n,o){Object(r.default)(e,t)&&(n.value+=o,n.squared+=o*o,n.count++)}t.default=function(e,t,n){var r={count:0,mean:0,variance:0,stdDev:0},l=function(e,t,n){for(var r={value:0,squared:0,count:0},l=0,c=t.top;c<t.top+t.height;c++)for(var d=t.left;d<t.left+t.width;d++)o(n,{x:d,y:c},r,e[l]),l++;return r}(e,t,n);return 0===l.count||(r.count=l.count,r.mean=l.value/l.count,r.variance=l.squared/l.count-r.mean*r.mean,r.stdDev=Math.sqrt(r.variance)),r}},"./util/freehand/freehandArea.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=0,r=e.length-1;t=t||1;for(var i=0;i<e.length;i++)n+=(e[r].x+e[i].x)*(e[r].y-e[i].y),r=i;return Math.abs(n*t/2)}},"./util/freehand/freehandIntersect.js":function(e,t,n){"use strict";function r(e,t,n,r){for(var c=e.length-1,i=0;i<e.length;i++)if(-1===r.indexOf(i)&&-1===r.indexOf(c)){if(o(t,n,l(e[c]),l(e[i])))return!0;c=i}else c=i;return!1}function o(e,t,n,r){var o=!1,l=[c(e,t,n),c(e,t,r),c(n,r,e),c(n,r,t)];return l[0]!==l[1]&&l[2]!==l[3]||((0===l[0]&&d(e,n,t)||0===l[1]&&d(e,r,t)||0===l[2]&&d(n,e,r)||0===l[3]&&d(n,t,r))&&(o=!0),o)}function l(e){return{x:e.x,y:e.y}}function c(p,q,e){var t=(q.y-p.y)*(e.x-q.x)-(q.x-p.x)*(e.y-q.y);return 0===t?0:t>0?1:2}function d(p,q,e){return q.x<=Math.max(p.x,e.x)&&q.x>=Math.min(p.x,e.x)&&q.y<=Math.max(p.y,e.y)&&q.y>=Math.min(p.y,e.y)}n.r(t),t.default={newHandle:function(e,t){var n=t.length-1;return r(t,l(t[n]),l(e),[n])},end:function(e){var t=e.length-1;return r(e,l(e[t]),l(e[0]),[t,0])},modify:function(e,t){var n=l(e[t]),o=t-1;0===t&&(o=e.length-1);var c=l(e[o]);return!!r(e,n,c,[t,o])||r(e,n,c=l(e[o=t===e.length-1?0:t+1]),[t,o])}}},"./util/freehand/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./util/freehand/calculateFreehandStatistics.js"),o=n("./util/freehand/ClickedLineData.js"),l=n("./util/freehand/freehandArea.js"),c=n("./util/freehand/FreehandHandleData.js"),d=n("./util/freehand/freehandIntersect.js"),f=n("./util/freehand/FreehandLineFinder.js"),h=n("./util/freehand/insertOrDelete.js"),m=n("./util/freehand/pointInFreehand.js"),v=n("./util/freehand/addLine.js");t.default={calculateFreehandStatistics:r.default,ClickedLineData:o.default,freehandArea:l.default,FreehandHandleData:c.default,freehandIntersect:d.default,FreehandLineFinder:f.default,insertOrDelete:h.default,pointInFreehand:m.default,addLine:v.default}},"./util/freehand/insertOrDelete.js":function(e,t,n){"use strict";n.r(t);var r=n("./util/freehand/FreehandLineFinder.js"),o=n("./util/freehand/FreehandHandleData.js"),l=n("./stateManagement/toolState.js"),c=n("./externalModules.js"),d=n("./util/freehand/addLine.js");function f(e,t){var n=Object(l.getToolState)(e.element,this.name);if(void 0!==n){var r=t.handleIndex,o=t.toolIndex,data=n.data[o],d=data.handles.points;d.length<=3||(r===d.length-1?(d[r-1].lines.pop(),d[r-1].lines.push(d[0])):0===r?(d[d.length-1].lines.pop(),d[d.length-1].lines.push(d[r+1])):(d[r-1].lines.pop(),d[r-1].lines.push(d[r+1])),d.splice(r,1),data.invalidated=!0,data.active=!0,data.highlight=!0,c.default.cornerstone.updateImage(e.element))}}function h(e,t){var n=Object(l.getToolState)(e.element,this.name);if(void 0!==n){var data=n.data[t.toolIndex],r=function(e){for(var t=e.handleIndexArray,n=1/0,r=t.includes(0),i=0;i<t.length;i++){var o=t[i];0!==o&&o<n&&(n=o)}return r&&1===n&&(n=0),++n}(t);if(r!==1/0){var f=new o.default(e.currentPoints.image),h=data.handles.points;h.splice(r,0,f),h[r-1].lines.pop(),h[r-1].lines.push(e.currentPoints.image),Object(d.default)(h,r),data.active=!0,data.highlight=!0,data.invalidated=!0,c.default.cornerstone.updateImage(e.element)}}}t.default=function(e,t){var n=e.detail;if(t&&null!==t.handleNearby){var o={toolIndex:t.toolIndex,handleIndex:t.handleNearby};f.call(this,n,o)}else{var l=new r.default(n,this.name).findLine();l&&h.call(this,n,l)}}},"./util/freehand/pointInFreehand.js":function(e,t,n){"use strict";function r(e,t,n){return r=e.y,o=t.y,l=n.y,!(!(o<r&&r<l||l<r&&r<o)||!function(e,t,n){if(t.x>e.x&&n.x>e.x)return!0;if(t.x===n.x)return e.x<t.x;if(t.x>n.x){var r=t;t=n,n=r}var o=function(e,t,n){var r=(n.y-t.y)/(n.x-t.x);return{value:t.y+r*(e.x-t.x),gradient:r}}(e,t,n);return Math.sign(o.gradient)*e.y>Math.sign(o.gradient)*o.value}(e,t,n));var r,o,l}n.r(t),t.default=function(e,t){for(var n=!1,o=e.length-1,i=0;i<e.length;i++)r(t,e[i],e[o])&&(n=!n),o=i;return n}},"./util/getActiveTool.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var r=n("./store/index.js"),o=n("./store/getActiveToolsForElement.js"),l=n("./store/filterToolsUsableWithMultiPartTools.js");function c(element,e){var t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mouse";if("touch"===n?t=(t=Object(o.default)(element,r.getters.touchTools())).filter((function(e){return e.options.isTouchActive})):(t=(t=Object(o.default)(element,r.getters.mouseTools())).filter((function(t){return Array.isArray(t.options.mouseButtonMask)&&e&&t.options.mouseButtonMask.includes(e)&&t.options.isMouseActive})),r.state.isMultiPartToolActive&&(t=Object(l.default)(t))),0!==t.length)return t[0]}},"./util/getCircleCoords.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n("./externalModules.js");function o(e,t){var n=(0,r.default.cornerstoneMath.point.distance)(e,t);return{left:Math.floor(Math.min(e.x-n,t.x)),top:Math.floor(Math.min(e.y-n,t.y)),width:2*n,height:2*n}}},"./util/getDefault.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){return void 0===e?t:e}},"./util/getKeyPressData.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var r=n("./store/index.js"),o=n("./externalModules.js");function l(e){var t=o.default.cornerstone,element=e.currentTarget,n=t.getEnabledElement(element);if(n&&n.image){var l=r.default.state.mousePositionImage;return{event:window.event||e,element:element,viewport:t.getViewport(element),image:n.image,currentPoints:{image:l,canvas:t.pixelToCanvas(element,l)},keyCode:e.keyCode,which:e.which}}}},"./util/getLuminance.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js");t.default=function(element,e,t,n,o){if(!element)throw new Error("getLuminance: parameter element must not be undefined");e=Math.round(e),t=Math.round(t);var l,c,d,image=r.default.cornerstone.getEnabledElement(element).image,f=[],h=0,m=image.getPixelData();if(image.color)for(c=0;c<o;c++)for(d=0;d<n;d++){var v=m[l=4*((c+t)*image.columns+(d+e))],y=m[l+1],x=m[l+2];f[h++]=.2126*v+.7152*y+.0722*x}else for(c=0;c<o;c++)for(d=0;d<n;d++)l=(c+t)*image.columns+(d+e),f[h++]=m[l]*image.slope+image.intercept;return f}},"./util/getMaxSimultaneousRequests.js":function(e,t,n){"use strict";var r;n.r(t),n.d(t,"getDefaultSimultaneousRequests",(function(){return f})),n.d(t,"getMaxSimultaneousRequests",(function(){return d})),n.d(t,"setMaxSimultaneousRequests",(function(){return c})),n.d(t,"getBrowserInfo",(function(){return l})),n.d(t,"isMobileDevice",(function(){return h}));var o={default:6,IE:{9:6,10:8,default:8},Firefox:{default:6},Opera:{10:8,11:6,12:6,default:6},Chrome:{default:6},Safari:{default:6}};function l(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],"IE ".concat(e[1]||"")):"Chrome"===n[1]&&null!==(e=t.match(/\b(OPR|Edge)\/(\d+)/))?e.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n.join(" "))}function c(e){r=e}function d(){return r||f()}function f(){var e=l().split(" "),t=e[0],n=e[1],r=o[t];return r?r[n]?r[n]:r.default:o.default}function h(){return new RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini").test(navigator.userAgent)}},"./util/getPixelSpacing.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n("./externalModules.js");function o(image){var e=r.default.cornerstone.metaData.get("imagePlaneModule",image.imageId);return e?{rowPixelSpacing:e.rowPixelSpacing||e.rowImagePixelSpacing,colPixelSpacing:e.columnPixelSpacing||e.colImagePixelSpacing}:{rowPixelSpacing:image.rowPixelSpacing,colPixelSpacing:image.columnPixelSpacing}}},"./util/getProximityThreshold.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n("./store/index.js");function o(e,t){var n=r.state.clickProximity,o=r.state.touchProximity,l=r.state.tools.find((function(e){return e.name===t}));return l&&l.configuration&&(n=l.configuration.clickProximity||n,o=l.configuration.touchProximity||o),"mouse"===e?n:o}},"./util/getRGBPixels.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js");t.default=function(element,e,t,n,o){if(!element)throw new Error("getRGBPixels: parameter element must not be undefined");e=Math.round(e),t=Math.round(t);var l,c,d,f=r.default.cornerstone.getEnabledElement(element),h=[],m=0,v=f.image.getPixelData();if(f.image.color)for(c=0;c<o;c++)for(d=0;d<n;d++){var y=v[l=4*((c+t)*f.image.columns+(d+e))],x=v[l+1],j=v[l+2],w=v[l+3];h[m++]=y,h[m++]=x,h[m++]=j,h[m++]=w}return h}},"./util/getROITextBoxCoords.js":function(e,t,n){"use strict";function r(e,t){var n=function(e){var t=[e.start,e.end].sort(d),n=[e.start,e.end].sort(f),r=t[0],o=t[t.length-1],l=n[0],c=n[n.length-1];return{top:l,left:r,bottom:c,right:o};function d(a,b){return a.x<b.x?-1:1}function f(a,b){return a.y<b.y?-1:1}}(t),r=(n.left.x+n.right.x)/2,o=(n.top.y+n.bottom.y)/2,l={};return e.rotation>=0&&e.rotation<90&&(l.x=e.hflip?n.left.x:n.right.x,l.y=o),e.rotation>=90&&e.rotation<180&&(l.x=r,l.y=e.vflip?n.bottom.y:n.top.y),e.rotation>=180&&e.rotation<270&&(l.x=e.hflip?n.right.x:n.left.x,l.y=o),e.rotation>=270&&e.rotation<360&&(l.x=r,l.y=e.vflip?n.top.y:n.bottom.y),l}n.r(t),n.d(t,"default",(function(){return r}))},"./util/isEmptyObject.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){return 0===Object.keys(e).length&&e.constructor===Object}},"./util/isObject.js":function(e,t,n){"use strict";n.r(t);var r=n("../node_modules/@babel/runtime/helpers/typeof.js"),o=n.n(r);t.default=function(e){var t=o()(e);return null!==e&&("object"===t||"function"===t)}},"./util/isPointInImage.js":function(e,t,n){"use strict";function r(e,t,n){var r=e.x,o=e.y;return r<n&&r>=0&&o<t&&o>=0}n.r(t),n.d(t,"default",(function(){return r}))},"./util/isPointInPolygon.js":function(e,t,n){"use strict";function r(e,t){for(var n=e[0],r=e[1],o=!1,i=0,l=t.length-1;i<t.length;l=i++){var c=t[i][0],d=t[i][1],f=t[l][0],h=t[l][1];d>r!=h>r&&n<(f-c)*(r-d)/(h-d)+c&&(o=!o)}return o}n.r(t),n.d(t,"default",(function(){return r}))},"./util/lineSegDistance.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js");t.default=function(element,e,t,n){var o=r.default.cornerstone,l={start:o.pixelToCanvas(element,e),end:o.pixelToCanvas(element,t)};return r.default.cornerstoneMath.lineSegment.distanceToPoint(l,n)}},"./util/logger.js":function(e,t,n){"use strict";n.r(t),n.d(t,"getLogger",(function(){return c})),n.d(t,"enable",(function(){return d})),n.d(t,"disable",(function(){return f}));var r=n("./util/debugLib/index.js"),o="cornerstoneTools",l=Object(r.default)(o);l.enabled||(console.log("%cCornerstone Tools","background: #339955; padding: 4px; font-weight: bold; color: white"),console.info('run %clocalStorage.setItem("debug", "cornerstoneTools")%c to see console output',"background: #eaeaea; color: #333; font-family: monospace",""));var c=function(e){var t=l.extend(e);return{log:t,warn:console.warn.bind(console),error:console.error.bind(console)}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"".concat(o,":*");return r.default.enable(e)},f=function(){return r.default.disable()}},"./util/makeUnselectable.js":function(e,t,n){"use strict";n.r(t),t.default=function(element,e){element.style.webkitUserSelect="none",element.style.webkitTouchCallout="none",element.style.mozUserSelect="none",element.style.msUserSelect="none",element.style.oUserSelect="none",element.style.khtmlUserSelect="none",element.style.userSelect="none",element.unselectable="on",element.oncontextmenu=function(){return!1},!0===e&&(element.style.pointerEvents="none")}},"./util/numbersWithCommas.js":function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}},"./util/pointInsideBoundingBox.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js");t.default=function(e,t){if(e.boundingBox)return r.default.cornerstoneMath.point.insideRect(t,e.boundingBox)}},"./util/pointProjector.js":function(e,t,n){"use strict";n.r(t),n.d(t,"projectPatientPointToImagePlane",(function(){return l})),n.d(t,"imagePointToPatientPoint",(function(){return c})),n.d(t,"planePlaneIntersection",(function(){return d})),n.d(t,"rotatePoint",(function(){return f}));var r=n("./externalModules.js"),o=n("./util/convertToVector3.js");function l(e,t){var n=Object(o.default)(t.rowCosines),r=Object(o.default)(t.columnCosines),l=Object(o.default)(t.imagePositionPatient),c=e.clone().sub(l);return{x:n.dot(c)/t.columnPixelSpacing,y:r.dot(c)/t.rowPixelSpacing}}function c(e,t){var n=Object(o.default)(t.rowCosines),r=Object(o.default)(t.columnCosines),l=Object(o.default)(t.imagePositionPatient),c=n.clone().multiplyScalar(e.x);c.multiplyScalar(t.columnPixelSpacing);var d=r.clone().multiplyScalar(e.y);d.multiplyScalar(t.rowPixelSpacing);var f=c.add(d);return f.add(l),f}function d(e,t){var n=Object(o.default)(e.rowCosines),l=Object(o.default)(e.columnCosines),d=Object(o.default)(e.imagePositionPatient),f=Object(o.default)(t.rowCosines),h=Object(o.default)(t.columnCosines),m=Object(o.default)(t.imagePositionPatient),v=n.clone().cross(l),y=new r.default.cornerstoneMath.Plane;y.setFromNormalAndCoplanarPoint(v,d);var x=f.clone().cross(h),j=new r.default.cornerstoneMath.Plane;j.setFromNormalAndCoplanarPoint(x,m);var w=j.clone().intersectPlane(y),T=w.origin,E=w.direction,O=c({x:t.columns,y:t.rows},t),C=m.distanceTo(O),line=new r.default.cornerstoneMath.Line3;line.start=T,line.end=T.clone().add(E.multiplyScalar(C));var rect=function(e){var t=c({x:0,y:0},e),n=c({x:e.columns,y:0},e),o=c({x:0,y:e.rows},e),l=c({x:e.columns,y:e.rows},e);return{top:new r.default.cornerstoneMath.Line3(t,n),left:new r.default.cornerstoneMath.Line3(t,o),right:new r.default.cornerstoneMath.Line3(n,l),bottom:new r.default.cornerstoneMath.Line3(o,l)}}(t),S=function(line,rect){var e=[];return Object.keys(rect).forEach((function(t){var n=rect[t],r=line.intersectLine(n);r&&e.push(r)})),e}(line,rect);if(2===S.length)return{start:S[0],end:S[1]}}function f(e,t,n){var r=n*(Math.PI/180);return{x:Math.cos(r)*(e.x-t.x)-Math.sin(r)*(e.y-t.y)+t.x,y:Math.sin(r)*(e.x-t.x)+Math.cos(r)*(e.y-t.y)+t.y}}},"./util/roundToDecimal.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}},"./util/scroll.js":function(e,t,n){"use strict";n.r(t);var r=n("./util/scrollToIndex.js"),o=n("./stateManagement/toolState.js"),l=n("./util/clip.js"),c=n("./externalModules.js");function d(e,t,element){if(e.pending[0]===t){if(e.currentImageIdIndex===t.index)return e.pending.splice(e.pending.indexOf(t),1),void(e.pending.length>0&&d(e,e.pending[0],element));element.addEventListener(c.default.cornerstone.EVENTS.NEW_IMAGE,(function n(r){e.imageIds.indexOf(r.detail.image.imageId)===t.index&&(e.pending.splice(e.pending.indexOf(t),1),element.removeEventListener(c.default.cornerstone.EVENTS.NEW_IMAGE,n),e.pending.length>0&&d(e,e.pending[0],element))})),Object(r.default)(element,t.index)}}t.default=function(element,e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],c=Object(o.getToolState)(element,"stack");if(c&&c.data&&c.data.length){var f=c.data[0];f.pending||(f.pending=[]);var h=f.currentImageIdIndex+e;if(t){var m=f.imageIds.length;h%=m}else h=Object(l.default)(h,0,f.imageIds.length-1);if(n)Object(r.default)(element,h);else{var v={index:h};f.pending.push(v),d(f,v,element)}}}},"./util/scrollToIndex.js":function(e,t,n){"use strict";n.r(t);var r=n("./events.js"),o=n("./externalModules.js"),l=n("./stateManagement/toolState.js"),c=n("./stateManagement/loadHandlerManager.js"),d=n("./util/triggerEvent.js");t.default=function(element,e){var t=Object(l.getToolState)(element,"stack");if(t&&t.data&&t.data.length){var n,f=o.default.cornerstone;if(t.data.length>1){var h=Object(l.getToolState)(element,"stackRenderer");h&&h.data&&h.data.length&&(n=h.data[0])}var m=t.data[0];e<0&&(e+=m.imageIds.length);var v=c.default.getStartLoadHandler(element),y=c.default.getEndLoadHandler(element),x=c.default.getErrorLoadingHandler(element);if(e!==m.currentImageIdIndex){v&&v(element);var j={newImageIdIndex:e,direction:e-m.currentImageIdIndex};m.currentImageIdIndex=e;var w=m.imageIds[e];(Boolean(m.preventCache)?f.loadImage(w):f.loadAndCacheImage(w)).then((function(image){if(m.currentImageIdIndex===e){try{f.getEnabledElement(element)}catch(e){return}n?(n.currentImageIdIndex=e,n.render(element,t.data)):f.displayImage(element,image),y&&y(element,image)}}),(function(t){var n=m.imageIds[e];x&&x(element,n,t)})),Object(d.default)(element,r.default.STACK_SCROLL,j)}}}},"./util/segmentation/drawBrush.js":function(e,t,n){"use strict";n.r(t),n.d(t,"drawBrushPixels",(function(){return c}));var r=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(r),l=n("./util/segmentation/eraseIfSegmentIndex.js");function c(e,t,n,r){var c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],d=function(e,t){return t*r+e};e.forEach((function(e){var r=d.apply(void 0,o()(e));c?Object(l.default)(r,t,n):t[r]=n}))}},"./util/segmentation/eraseIfSegmentIndex.js":function(e,t,n){"use strict";function r(e,t,n){t[e]===n&&(t[e]=0)}n.r(t),n.d(t,"default",(function(){return r}))},"./util/segmentation/eraseOutsideBoundingBox.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n("./util/segmentation/eraseIfSegmentIndex.js");function o(e,t,n,o){for(var l=e.detail,c=t.pixelData,d=t.segmentIndex,image=l.image,f=image.width,h=image.height,i=0;i<f;i++)for(var m=0;m<n[1];m++)Object(r.default)(m*f+i,c,d);for(var v=0;v<n[0];v++)for(var y=n[1];y<o[1];y++)Object(r.default)(y*f+v,c,d);for(var x=o[0];x<f;x++)for(var j=n[1];j<o[1];j++)Object(r.default)(j*f+x,c,d);for(var w=0;w<f;w++)for(var T=o[1];T<h;T++)Object(r.default)(T*f+w,c,d)}},"./util/segmentation/eraseShape.js":function(e,t,n){"use strict";n.r(t),n.d(t,"eraseInsideShape",(function(){return h})),n.d(t,"eraseOutsideShape",(function(){return m}));var r=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=n.n(r),l=n("./util/segmentation/eraseOutsideBoundingBox.js"),c=n("./util/segmentation/isSameSegment.js"),d=n("./util/logger.js");function f(e,t,n,r,d){var f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"inside",h=e.detail.image.width,m=t.pixelData,v=t.segmentIndex,y=o()(r,2),x=y[0],j=y[1],w=o()(d,2),T=w[0],E=w[1];"outside"===f&&Object(l.default)(e,t,r,d);for(var O=x;O<T;O++)for(var C=j;C<E;C++){var S=C*h+O;Object(c.default)(S,m,v)&&n({x:O,y:C})&&(m[S]=0)}}function h(e,t,n,r,o){f(e,t,n,r,o,"inside")}function m(e,t,n,r,o){f(e,t,(function(e){return!n(e)}),r,o,"outside")}Object(d.getLogger)("util:segmentation:operations:eraseOutsideCircle")},"./util/segmentation/fillOutsideBoundingBox.js":function(e,t,n){"use strict";function r(e,t,n,r){for(var o=t.pixelData,l=t.segmentIndex,c=e.detail.image,d=c.width,f=c.height,i=0;i<d;i++)for(var h=0;h<n[1];h++)o[h*d+i]=l;for(var m=0;m<n[0];m++)for(var v=n[1];v<r[1];v++)o[v*d+m]=l;for(var y=r[0];y<d;y++)for(var x=n[1];x<r[1];x++)o[x*d+y]=l;for(var j=0;j<d;j++)for(var w=r[1];w<f;w++)o[w*d+j]=l}n.r(t),n.d(t,"default",(function(){return r}))},"./util/segmentation/fillShape.js":function(e,t,n){"use strict";n.r(t),n.d(t,"fillInsideShape",(function(){return h})),n.d(t,"fillOutsideShape",(function(){return m}));var r=n("../node_modules/@babel/runtime/helpers/slicedToArray.js"),o=n.n(r),l=n("./util/segmentation/fillOutsideBoundingBox.js"),c=n("./util/logger.js"),d=Object(c.getLogger)("util:segmentation:operations:helpers:fillShape");function f(e,t,n,r,c){var f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"inside",h=t.pixelData,m=t.segmentIndex;if(void 0!==h&&void 0!==m){var v=e.detail.image.width,y=o()(r,2),x=y[0],j=y[1],w=o()(c,2),T=w[0],E=w[1];"outside"===f&&Object(l.default)(e,t,r,c);for(var O=x;O<T;O++)for(var C=j;C<E;C++){var S=C*v+O;n({x:O,y:C})&&(h[S]=m)}}else d.error("fillInsideShape requires operationData to contain pixelData and segmentIndex")}function h(e,t,n,r,o){f(e,t,n,r,o,"inside")}function m(e,t,n,r,o){f(e,t,(function(e){return!n(e)}),r,o,"outside")}},"./util/segmentation/floodFill.js":function(e,t,n){"use strict";n.r(t);var r=n("../node_modules/@babel/runtime/helpers/toConsumableArray.js"),o=n.n(r);function l(a,b){return a===b}function c(e){for(var t=0,i=0;i<e.length;i+=1)0!==e[i]&&(t+=1);return t}function d(e,t,n){return(new Array(n+1).join(t)+e).slice(-n)}t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.onFlood||function(){},f=n.onBoundary||function(){},h=n.equals||l,m=n.diagonals||!1,v=_(t),y=k(),x=[],j=[],w={},T={};for(x.push({currentArgs:t});x.length>0;)E(x.pop());return{flooded:j,boundaries:A()};function E(e){var t=e.currentArgs,n=e.previousArgs;O(t)||(C(t),S(t)?(I(t),P(t)):M(n))}function O(e){return!0===w[e]}function C(e){w[e]=!0}function S(e){var t=D(_,[e]);return D(h,[t,v])}function I(e){j.push(e),r.apply(void 0,o()(e))}function M(e){T[e]=e,f.apply(void 0,o()(e))}function P(e){for(var i=0;i<y.length;i+=1){for(var t=y[i],n=e.slice(0),r=0;r<e.length;r+=1)n[r]+=t[r];x.push({currentArgs:n,previousArgs:e})}}function _(t){return e.apply(void 0,o()(t))}function D(e,t){try{return e.apply(void 0,o()(t))}catch(e){return}}function k(){return L(t.length).filter((function(e){var t=c(e);return 0!==t&&(1===t||m)}))}function L(e){for(var t=[],n=function(e){return e.split("").map((function(e){return parseInt(e,10)-1}))},i=0;i<Math.pow(3,e);i+=1){var r=d(i.toString(3),"0",e);t.push(n(r))}return t}function A(){var e=[];for(var t in T)T.hasOwnProperty(t)&&e.unshift(T[t]);return e}}},"./util/segmentation/getBoundingBoxAroundCircle.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n("./util/getCircleCoords.js");function o(e){var t=e.detail.handles,n=e.detail.image,o=n.width,l=n.height,c=Object(r.default)(t.start,t.end),d=c.width+c.left,f=c.left,h=c.top+c.height,m=c.top;return f=Math.floor(f),m=Math.floor(m),d=Math.floor(d),h=Math.floor(h),d=Math.min(o,d),f=Math.max(0,f),h=Math.min(l,h),[[f,m=Math.max(0,m)],[d,h]]}},"./util/segmentation/getBoundingBoxAroundPolygon.js":function(e,t,n){"use strict";function r(e,image){var t=1/0,n=0,r=1/0,o=0,l=image.width,c=image.height;return e.forEach((function(e){t=Math.min(e[0],t),n=Math.max(e[0],n),r=Math.min(e[1],r),o=Math.max(e[1],o)})),t=Math.floor(t),r=Math.floor(r),n=Math.floor(n),o=Math.floor(o),n=Math.min(l,n),t=Math.max(0,t),o=Math.min(c,o),r=Math.max(0,r),[[t,r],[n,o]]}n.r(t),n.d(t,"default",(function(){return r}))},"./util/segmentation/getCircle.js":function(e,t,n){"use strict";function r(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=Math.floor(r),c=Math.floor(o);if(1===e)return[[l,c]];for(var d=[],f=0,h=-e;h<=e;h++){var m=c+h;if(!(m>t||m<0))for(var v=-e;v<=e;v++){var y=l+v;y>=n||y<0||v*v+h*h<e*e&&(d[f++]=[l+v,c+h])}}return d}n.r(t),n.d(t,"default",(function(){return r}))},"./util/segmentation/getDiffBetweenPixelData.js":function(e,t,n){"use strict";function r(e,t){for(var n=[],i=0;i<e.length;i++)e[i]!==t[i]&&n.push([i,e[i],t[i]]);return n}n.r(t),n.d(t,"default",(function(){return r}))},"./util/segmentation/getPixelPathBetweenPixels.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js"),o=1/Math.sqrt(2),l={up:{x:0,y:1},upRight:{x:o,y:o},right:{x:1,y:0},downRight:{x:o,y:-o},down:{x:0,y:1},downLeft:{x:-o,y:-o},left:{x:-1,y:0},upLeft:{x:-o,y:o}};function c(p,e){var t=m(p,e);switch(y([v(t,l.up),v(t,l.right),v(t,l.upRight)])){case 0:p.y++;break;case 1:p.x++;break;case 2:p.y++,p.x++}}function d(p,e){var t=m(p,e);switch(y([v(t,l.up),v(t,l.left),v(t,l.upLeft)])){case 0:p.y++;break;case 1:p.x--;break;case 2:p.y++,p.x--}}function f(p,e){var t=m(p,e);switch(y([v(t,l.down),v(t,l.right),v(t,l.downRight)])){case 0:p.y--;break;case 1:p.x++;break;case 2:p.y--,p.x++}}function h(p,e){var t=m(p,e);switch(y([v(t,l.down),v(t,l.left),v(t,l.downLeft)])){case 0:p.y--;break;case 1:p.x--;break;case 2:p.y--,p.x--}}function m(p,e){var t=r.default.cornerstoneMath.point.distance(p,e);return{x:(e.x-p.x)/t,y:(e.y-p.y)/t}}function v(p,e){return p.x*e.x+p.y*e.y}function y(e){var t=e[0]>e[1]?0:1;return e[2]>e[t]&&(t=2),t}t.default=function(e,t){for(var p={x:e.x,y:e.y},path=[];t.x!==p.x||t.y!==p.y;)t.x===p.x?t.y>p.y?p.y++:p.y--:t.y===p.y?t.x>p.x?p.x++:p.x--:t.y>p.y?t.x>p.x?c(p,t):d(p,t):t.x>p.x?f(p,t):h(p,t),path.push({x:p.x,y:p.y});return path.pop(),path}},"./util/segmentation/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./util/segmentation/drawBrush.js");n.d(t,"drawBrushPixels",(function(){return r.drawBrushPixels}));var o=n("./util/segmentation/eraseIfSegmentIndex.js");n.d(t,"eraseIfSegmentIndex",(function(){return o.default}));var l=n("./util/segmentation/eraseOutsideBoundingBox.js");n.d(t,"eraseOutsideBoundingBox",(function(){return l.default}));var c=n("./util/segmentation/eraseShape.js");n.d(t,"eraseInsideShape",(function(){return c.eraseInsideShape})),n.d(t,"eraseOutsideShape",(function(){return c.eraseOutsideShape}));var d=n("./util/segmentation/fillOutsideBoundingBox.js");n.d(t,"fillOutsideBoundingBox",(function(){return d.default}));var f=n("./util/segmentation/fillShape.js");n.d(t,"fillInsideShape",(function(){return f.fillInsideShape})),n.d(t,"fillOutsideShape",(function(){return f.fillOutsideShape}));var h=n("./util/segmentation/floodFill.js");n.d(t,"floodFill",(function(){return h.default}));var m=n("./util/segmentation/getBoundingBoxAroundCircle.js");n.d(t,"getBoundingBoxAroundCircle",(function(){return m.default}));var v=n("./util/segmentation/getBoundingBoxAroundPolygon.js");n.d(t,"getBoundingBoxAroundPolygon",(function(){return v.default}));var y=n("./util/segmentation/getCircle.js");n.d(t,"getCircle",(function(){return y.default}));var x=n("./util/segmentation/getPixelPathBetweenPixels.js");n.d(t,"getPixelPathBetweenPixels",(function(){return x.default}));var j=n("./util/segmentation/isSameSegment.js");n.d(t,"isSameSegment",(function(){return j.default}));var w=n("./util/segmentation/triggerLabelmapModifiedEvent.js");n.d(t,"triggerLabelmapModifiedEvent",(function(){return w.default}));var T=n("./util/segmentation/getDiffBetweenPixelData.js");n.d(t,"getDiffBetweenPixelData",(function(){return T.default}))},"./util/segmentation/isSameSegment.js":function(e,t,n){"use strict";function r(e,t,n){return t[e]===n}n.r(t),n.d(t,"default",(function(){return r}))},"./util/segmentation/triggerLabelmapModifiedEvent.js":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var r=n("./externalModules.js"),o=n("./events.js"),l=n("./store/index.js");function c(element,e){var t=Object(l.getModule)("segmentation").getters;e=void 0===e?t.activeLabelmapIndex(element):e,r.default.cornerstone.triggerEvent(element,o.default.LABELMAP_MODIFIED,{labelmapIndex:e})}},"./util/setContextToDisplayFontSize.js":function(e,t,n){"use strict";n.r(t);var r=n("./externalModules.js");t.default=function(e,t,n){var o=.1;return r.default.cornerstone.setToPixelCoordinateSystem(e,t,o),{fontSize:n/e.viewport.scale/o,lineHeight:n/e.viewport.scale/o,fontScale:o}}},"./util/throttle.js":function(e,t,n){"use strict";n.r(t);var r=n("./util/debounce.js"),o=n("./util/isObject.js");t.default=function(e,t,n){var l=!0,c=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return Object(o.default)(n)&&(l="leading"in n?Boolean(n.leading):l,c="trailing"in n?Boolean(n.trailing):c),Object(r.default)(e,t,{leading:l,trailing:c,maxWait:t})}},"./util/triggerEvent.js":function(e,t,n){"use strict";function r(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"function"==typeof window.CustomEvent?n=new CustomEvent(t,{detail:r,cancelable:!0}):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,r),e.dispatchEvent(n)}n.r(t),n.d(t,"default",(function(){return r}))},"./util/uuidv4.js":function(e,t,n){"use strict";function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}n.r(t),n.d(t,"default",(function(){return r}))},"./util/wait.js":function(e,t,n){"use strict";n.r(t),n.d(t,"wait",(function(){return o})),n.d(t,"waitForEnabledElementImageToLoad",(function(){return l}));var r=n("./externalModules.js"),o=function(e){return new Promise((function(t){return setTimeout(t,e)}))};function l(element){try{var e=r.default.cornerstone.getEnabledElement(element);return e.image?e:o(250).then((function(){return l(element)}))}catch(e){return null}}t.default=o},"./util/zoom/changeViewportScale.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t,n){var r=n.maxScale,o=n.minScale,l=Math.log(e.scale)/Math.log(1.7)+t,c=Math.pow(1.7,l);return e.scale=r&&c>r?r:o&&c<o?o:c,e}},"./util/zoom/correctShift.js":function(e,t,n){"use strict";n.r(t),t.default=function(e,t){var n=t.hflip,r=t.vflip,o=t.rotation;if(e.x*=n?-1:1,e.y*=r?-1:1,0!==o){var l=o*Math.PI/180,c=Math.cos(l),d=Math.sin(l),f=e.x*c-e.y*d,h=e.x*d+e.y*c;e.x=f,e.y=h}return e}},"./util/zoom/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./util/zoom/changeViewportScale.js");n.d(t,"changeViewportScale",(function(){return r.default}));var o=n("./util/zoom/correctShift.js");n.d(t,"correctShift",(function(){return o.default})),t.default={changeViewportScale:r.default,correctShift:o.default}},"./version.js":function(e,t,n){"use strict";n.r(t),t.default="6.0.8"}})},e.exports=r()},595:function(e,t,n){"use strict";n(11),n(10),n(14),n(18),n(12),n(19);var r=n(57),o=n(2),l=(n(27),n(565),n(26),n(49),n(4),n(81),n(59),n(566),n(116)),c=n(224),d=n(37),f=n(307),h=n(21),m=n(8);function v(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}t.a=Object(m.a)(d.a,Object(f.a)({onVisible:["init"]}),h.a).extend({name:"v-pagination",directives:{Resize:c.a},props:{circle:Boolean,disabled:Boolean,length:{type:Number,default:0,validator:function(e){return e%1==0}},nextIcon:{type:String,default:"$next"},prevIcon:{type:String,default:"$prev"},totalVisible:[Number,String],value:{type:Number,default:0},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},wrapperAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.wrapper"}},data:function(){return{maxButtons:0,selected:null}},computed:{classes:function(){return function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({"v-pagination":!0,"v-pagination--circle":this.circle,"v-pagination--disabled":this.disabled},this.themeClasses)},items:function(){var e=parseInt(this.totalVisible,10);if(0===e||isNaN(this.length)||this.length>Number.MAX_SAFE_INTEGER)return[];var t=Math.min(Math.max(0,e)||this.length,Math.max(0,this.maxButtons)||this.length,this.length);if(this.length<=t)return this.range(1,this.length);var n=t%2==0?1:0,o=Math.floor(t/2),l=this.length-o+1+n;if(this.value>o&&this.value<l){var c=this.length,d=this.value-o+2,f=this.value+o-2-n,h=f+1===c-1?f+1:"...";return[1,d-1==2?2:"..."].concat(Object(r.a)(this.range(d,f)),[h,this.length])}if(this.value===o){var m=this.value+o-1-n;return[].concat(Object(r.a)(this.range(1,m)),["...",this.length])}if(this.value===l){var v=this.value-o+1;return[1,"..."].concat(Object(r.a)(this.range(v,this.length)))}return[].concat(Object(r.a)(this.range(1,o)),["..."],Object(r.a)(this.range(l,this.length)))}},watch:{value:function(){this.init()}},beforeMount:function(){this.init()},methods:{init:function(){var e=this;this.selected=null,this.onResize(),this.$nextTick(this.onResize),setTimeout((function(){return e.selected=e.value}),100)},onResize:function(){var e=this.$el&&this.$el.parentElement?this.$el.parentElement.clientWidth:window.innerWidth;this.maxButtons=Math.floor((e-96)/42)},next:function(e){e.preventDefault(),this.$emit("input",this.value+1),this.$emit("next")},previous:function(e){e.preventDefault(),this.$emit("input",this.value-1),this.$emit("previous")},range:function(e,t){for(var n=[],i=e=e>0?e:1;i<=t;i++)n.push(i);return n},genIcon:function(e,t,n,r,label){return e("li",[e("button",{staticClass:"v-pagination__navigation",class:{"v-pagination__navigation--disabled":n},attrs:{disabled:n,type:"button","aria-label":label},on:n?{}:{click:r}},[e(l.a,[t])])])},genItem:function(e,i){var t=this,n=i===this.value&&(this.color||"primary"),r=i===this.value,o=r?this.currentPageAriaLabel:this.pageAriaLabel;return e("button",this.setBackgroundColor(n,{staticClass:"v-pagination__item",class:{"v-pagination__item--active":i===this.value},attrs:{type:"button","aria-current":r,"aria-label":this.$vuetify.lang.t(o,i)},on:{click:function(){return t.$emit("input",i)}}}),[i.toString()])},genItems:function(e){var t=this;return this.items.map((function(i,n){return e("li",{key:n},[isNaN(Number(i))?e("span",{class:"v-pagination__more"},[i.toString()]):t.genItem(e,i)])}))},genList:function(e,t){return e("ul",{directives:[{modifiers:{quiet:!0},name:"resize",value:this.onResize}],class:this.classes},t)}},render:function(e){var t=[this.genIcon(e,this.$vuetify.rtl?this.nextIcon:this.prevIcon,this.value<=1,this.previous,this.$vuetify.lang.t(this.previousAriaLabel)),this.genItems(e),this.genIcon(e,this.$vuetify.rtl?this.prevIcon:this.nextIcon,this.value>=this.length,this.next,this.$vuetify.lang.t(this.nextAriaLabel))];return e("nav",{attrs:{role:"navigation","aria-label":this.$vuetify.lang.t(this.wrapperAriaLabel)}},[this.genList(e,t)])}})},602:function(e,t,n){"use strict";n(11),n(10),n(14),n(4),n(18),n(12),n(19);var r=n(2),o=(n(563),n(508)),l=o.a.extend({name:"button-group",provide:function(){return{btnToggle:this}},computed:{classes:function(){return o.a.options.computed.classes.call(this)}},methods:{genData:o.a.options.methods.genData}}),c=n(37),d=n(8);function f(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function h(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}t.a=Object(d.a)(l,c.a).extend({name:"v-btn-toggle",props:{backgroundColor:String,borderless:Boolean,dense:Boolean,group:Boolean,rounded:Boolean,shaped:Boolean,tile:Boolean},computed:{classes:function(){return h(h({},l.options.computed.classes.call(this)),{},{"v-btn-toggle":!0,"v-btn-toggle--borderless":this.borderless,"v-btn-toggle--dense":this.dense,"v-btn-toggle--group":this.group,"v-btn-toggle--rounded":this.rounded,"v-btn-toggle--shaped":this.shaped,"v-btn-toggle--tile":this.tile},this.themeClasses)}},methods:{genData:function(){var data=this.setTextColor(this.color,h({},l.options.methods.genData.call(this)));return this.group?data:this.setBackgroundColor(this.backgroundColor,data)}}})}}]);